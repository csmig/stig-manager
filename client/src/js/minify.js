var appName="STIG Manager";var appVersion="3.0";var copyrightStr="";var licenseStr="This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.\n\nThe GNU General Public License is available at  <http://www.gnu.org/licenses/>.";var curUser,appConfig;Ext.ns("SM");SM.he=Ext.util.Format.htmlEncode;SM.hd=Ext.util.Format.htmlDecode;SM.GetUserObject=async function(){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/user`,method:"GET"});curUser=JSON.parse(e.response.responseText);curUser.collectionGrants.sort((e,t)=>{const i=e.collection.name;const s=t.collection.name;if(i<s){return-1}if(i>s){return 1}return 0});return curUser};SM.styledEmptyRenderer=e=>e?e:'<span class="sm-empty-cell" />';SM.ResultTipText=`<b>Result</b><br>The result of an evaluation of a STIG ruleId.<br><br><b>Export Mappings</b><br><b>CKL:</b> &lt;CHECKLIST&gt;&lt;STIGS&gt;&lt;iSTIG&gt;&lt;VULN&gt;&lt;STATUS&gt;<br>
<b>XCCDF:</b> &lt;TestResult&gt;&lt;rule-result&gt;&lt;result&gt;`;SM.ResultTipTpl=new Ext.XTemplate(`<b>Result</b><br>The result of an evaluation of a STIG ruleId.<br><br><b>Export Mappings</b><br><b>CKL:</b> &lt;CHECKLIST&gt;&lt;STIGS&gt;&lt;iSTIG&gt;&lt;VULN&gt;&lt;STATUS&gt;<br>
<b>XCCDF:</b> &lt;TestResult&gt;&lt;rule-result&gt;&lt;result&gt;`);SM.DetailTipText=`<b>Detail</b><br>A description of how the evaluator or evaluation tool determined the result.<br><br><b>Export Mappings</b><br><b>CKL:</b> &lt;CHECKLIST&gt;&lt;STIGS&gt;&lt;iSTIG&gt;&lt;VULN&gt;&lt;FINDING_DETAILS&gt;<br>
<b>XCCDF:</b> &lt;TestResult&gt;&lt;rule-result&gt;&lt;message&gt;`;SM.DetailTipTpl=new Ext.XTemplate("<b>Detail</b><br>A description of how the evaluator or evaluation tool determined the result.<br><br>","<b>Collection Settings</b></br>This field is enabled ",`<tpl if="detailEnabled == 'always'">for any result.<br></tpl>`,`<tpl if="detailEnabled == 'findings'">for findings only.<br></tpl>`,`Content in this field is `,`<tpl if="detailRequired == 'always'">required to submit a review.<br></tpl>`,`<tpl if="detailRequired == 'findings'">required to submit a finding.<br></tpl>`,`<tpl if="detailRequired == 'optional'">optional.<br></tpl>`,`<br><b>Export Mappings</b><br><b>CKL:</b> &lt;CHECKLIST&gt;&lt;STIGS&gt;&lt;iSTIG&gt;&lt;VULN&gt;&lt;FINDING_DETAILS&gt;<br><b>XCCDF:</b> &lt;TestResult&gt;&lt;rule-result&gt;&lt;message&gt;`);SM.CommentTipText=`<b>Comment</b><br>Additional comment by the evaluator or evaluation tool.<br><br><b>Export Mappings</b><br><b>CKL:</b> &lt;CHECKLIST&gt;&lt;STIGS&gt;&lt;iSTIG&gt;&lt;VULN&gt;&lt;COMMENTS&gt;<br>
<b>XCCDF:</b> &lt;TestResult&gt;&lt;rule-result&gt;&lt;metadata comment&gt;`;SM.CommentTipTpl=new Ext.XTemplate("<b>Comment</b><br>Additional comment by the evaluator or evaluation tool.<br><br>","<b>Collection Settings</b></br>This field is enabled ",`<tpl if="commentEnabled == 'always'">for any result.<br></tpl>`,`<tpl if="commentEnabled == 'findings'">for findings only.<br></tpl>`,`Content in this field is `,`<tpl if="commentRequired == 'always'">required to submit a review.<br></tpl>`,`<tpl if="commentRequired == 'findings'">required to submit a finding.<br></tpl>`,`<tpl if="commentRequired == 'optional'">optional.<br></tpl>`,`<br><b>Export Mappings</b><br><b>CKL:</b> &lt;CHECKLIST&gt;&lt;STIGS&gt;&lt;iSTIG&gt;&lt;VULN&gt;&lt;COMMENTS&gt;<br>
    <b>XCCDF:</b> &lt;TestResult&gt;&lt;rule-result&gt;&lt;metadata comment&gt;`);SM.RenderResult={fail:{css:"sm-result-fail",textDisa:"O",textNist:"F"},pass:{css:"sm-result-pass",textDisa:"NF",textNist:"P"},notapplicable:{css:"sm-result-na",textDisa:"NA",textNist:"N"},notchecked:{css:"sm-result-nr",textDisa:"NR",textNist:"K"},unknown:{css:"sm-result-nr",textDisa:"U",textNist:"U"},error:{css:"sm-result-nr",textDisa:"E",textNist:"E"},notselected:{css:"sm-result-nr",textDisa:"S",textNist:"S"},informational:{css:"sm-result-nr",textDisa:"I",textNist:"I"},fixed:{css:"sm-result-pass",textDisa:"F",textNist:"F"}};SM.RuleContentTpl=new Ext.XTemplate("<div class=cs-home-header-top>{ruleId}",'<span class="sm-content-sprite sm-severity-{severity}">',`<tpl if="severity == 'high'">CAT 1</tpl>`,`<tpl if="severity == 'medium'">CAT 2</tpl>`,`<tpl if="severity == 'low'">CAT 3</tpl>`,"</span>","</div>","<div class=cs-home-header-sub>{[SM.he(values.title)]}</div>","<div class=cs-home-body-title>Manual Check","<div class=cs-home-body-text>",'<tpl for="checks">',"<pre>{[SM.he(values.content?.trim())]}</pre>","</tpl>","</div>","</div>","<div class=cs-home-body-title>Fix","<div class=cs-home-body-text>",'<tpl for="fixes">',"<pre>{[SM.he(values.text?.trim())]}</pre>","</tpl>","</div>","</div>","<div class=cs-home-header-sub></div>","<div class=cs-home-body-title>Other Data",'<tpl if="values.detail.vulnDiscussion">',"<div class=cs-home-body-text><b>Vulnerability Discussion</b><br><br>","<pre>{[SM.he(values.detail.vulnDiscussion?.trim())]}</pre>","</div>","</tpl>",'<tpl if="values.detail.documentable">',"<div class=cs-home-body-text><b>Documentable: </b>{[SM.he(values.detail.documentable)]}</div>","</tpl>",'<tpl if="values.detail.responsibility">',"<div class=cs-home-body-text><b>Responsibility: </b>{[SM.he(values.detail.responsibility)]}</div>","</tpl>",'<tpl if="values.ccis.length === 0">',"<div class=cs-home-body-text><b>Controls: </b>No mapped controls</div>","</tpl>",'<tpl if="values.ccis.length !== 0">',"<div class=cs-home-body-text><b>Controls: </b><br>",'<table class=cs-home-body-table border="1">',"<tr><td><b>CCI</b></td><td><b>AP Acronym</b></td><td><b>Control</b></td></tr>",'<tpl for="ccis">',"<tr><td>{cci}</td><td>{[SM.he(values.apAcronym)]}</td><td>{[SM.he(values.control)]}</td></tr>","</tpl>","</table>","</div>","</tpl>","</div>");SM.StoreRowCount=function(e){const t=e.data.length||0;const i=e.snapshot?.length||t;return`${t}${e.isFiltered()?" of "+i:""} row${i===1?"":"s"}`};SM.RowCountTextItem=Ext.extend(Ext.Toolbar.TextItem,{initComponent:function(){const t=this;const e={store:this.store};this.store?.on("load",function(e){t.setText(SM.StoreRowCount(e))});this.store?.on("datachanged",function(e){t.setText(SM.StoreRowCount(e))});this.store?.on("remove",function(e){t.setText(SM.StoreRowCount(e))});this.store?.on("clear",function(e){t.setText(SM.StoreRowCount(e))});this.store?.on("add",function(e){t.setText(SM.StoreRowCount(e))});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.RowCountTextItem.superclass.initComponent.call(this)}});Ext.ns("SM.TipContent");Ext.ns("SM.TipContent.CklParseOptions");SM.TipContent.CklParseOptions.Text=`If checked, <b>clear</b> existing Review Detail when &lt;FINDING_DETAILS&gt; 
  is empty and <b>clear</b> existing Review Comment when &lt;COMMENTS&gt; is empty.
  <br><br>
  If unchecked, <b>retain</b> existing Review Detail when &lt;FINDING_DETAILS&gt; 
  is empty and <b>retain</b> existing Review Comment when &lt;COMMENTS&gt; is empty.`;SM.TipContent.CklParseOptions.Revision=`If checked, skip CKL with results for a STIG revision that is not available.
  <br><br>
  If unchecked, process CKL with results for any revision of a STIG that is mapped to the corresponding Asset.`;Ext.lib.Ajax=function(){var s=["Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],d="Content-Type";function a(e){var t=e.conn,i,s={};function r(e,t){for(i in t){if(t.hasOwnProperty(i)){e.setRequestHeader(i,t[i])}}}Ext.apply(s,x.headers,x.defaultHeaders);r(t,s);delete x.headers}function o(e,t,i,s){return{tId:e,status:i?-1:0,statusText:i?"transaction aborted":"communication failure",isAbort:i,isTimeout:s,argument:t}}function c(e,t){(x.headers=x.headers||{})[e]=t}function l(e,t){var i={},s,r=e.conn,n,a,o=r.status==1223;try{s=e.conn.getAllResponseHeaders();Ext.each(s.replace(/\r\n/g,"\n").split("\n"),function(e){n=e.indexOf(":");if(n>=0){a=e.substr(0,n).toLowerCase();if(e.charAt(n+1)==" "){++n}i[a]=e.substr(n+1)}})}catch(e){}return{tId:e.tId,status:o?204:r.status,statusText:o?"No Content":r.statusText,getResponseHeader:function(e){return i[e.toLowerCase()]},getAllResponseHeaders:function(){return s},responseText:r.responseText,responseXML:r.responseXML,argument:t}}function f(e){if(e.tId){x.conn[e.tId]=null}e.conn=null;e=null}function u(e,t,i,s){if(!t){f(e);return}var r,n;try{if(e.conn.status!==undefined&&e.conn.status!=0){r=e.conn.status}else{r=13030}}catch(e){r=13030}if(r>=200&&r<300||Ext.isIE&&r==1223){n=l(e,t.argument);if(t.success){if(!t.scope){t.success(n)}else{t.success.apply(t.scope,[n])}}}else{switch(r){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:n=o(e.tId,t.argument,i?i:false,s);if(t.failure){if(!t.scope){t.failure(n)}else{t.failure.apply(t.scope,[n])}}break;default:n=l(e,t.argument);if(t.failure){if(!t.scope){t.failure(n)}else{t.failure.apply(t.scope,[n])}}}}f(e);n=null}function h(e,t,i,s,r,n){if(i&&i.readyState==4){clearInterval(r[s]);r[s]=null;if(n){clearTimeout(x.timeout[s]);x.timeout[s]=null}u(e,t)}}function p(e,t){x.abort(e,t,true)}function m(e,t){t=t||{};var i=e.conn,s=e.tId,r=x.poll,n=t.timeout||null;if(n){x.conn[s]=i;x.timeout[s]=setTimeout(p.createCallback(e,t),n)}r[s]=setInterval(h.createCallback(e,t,i,s,r,n),x.pollInterval)}function g(t,i,s,r){var n=e()||null;if(n){window.oidcProvider.updateToken(10).then(function(e){n.conn.open(t,i,true);if(window.oidcProvider.token){c("Authorization","Bearer "+window.oidcProvider.token)}if(x.useDefaultXhrHeader){c("X-Requested-With",x.defaultXhrHeader)}if(r&&x.useDefaultHeader&&(!x.headers||!x.headers[d])){c(d,x.defaultPostHeader)}if(x.defaultHeaders||x.headers){a(n)}m(n,s);n.conn.send(r||null)}).catch(function(e){console.info(`In Ext.lib.Ajax.asyncRequest - updateToken() error: ${e}`);x.abort(n,s,false)})}return n}function e(){var e;try{if(e=t(x.transactionId)){x.transactionId++}}catch(e){}finally{return e}}function t(e){var t;try{t=new XMLHttpRequest}catch(e){for(var i=Ext.isIE6?1:0;i<s.length;++i){try{t=new ActiveXObject(s[i]);break}catch(e){}}}finally{return{conn:t,tId:e}}}var x={request:function(e,t,i,s,r){if(r){var n=this,a=r.xmlData,o=r.jsonData,l;Ext.applyIf(n,r);if(a||o){l=n.headers;if(!l||!l[d]){c(d,a?"text/xml":"application/json")}s=a||(!Ext.isPrimitive(o)?Ext.encode(o):o)}}return g(e||r.method||"POST",t,i,s)},serializeForm:function(e){var t=e.elements||(document.forms[e]||Ext.getDom(e)).elements,i=false,s=encodeURIComponent,r,n="",a,o;Ext.each(t,function(e){r=e.name;a=e.type;if(!e.disabled&&r){if(/select-(one|multiple)/i.test(a)){Ext.each(e.options,function(e){if(e.selected){o=e.hasAttribute?e.hasAttribute("value"):e.getAttributeNode("value").specified;n+=String.format("{0}={1}&",s(r),s(o?e.value:e.text))}})}else if(!/file|undefined|reset|button/i.test(a)){if(!(/radio|checkbox/i.test(a)&&!e.checked)&&!(a=="submit"&&i)){n+=s(r)+"="+s(e.value)+"&";i=/submit/i.test(a)}}}});return n.substr(0,n.length-1)},useDefaultHeader:true,defaultPostHeader:"application/json",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",poll:{},timeout:{},conn:{},pollInterval:50,transactionId:0,abort:function(e,t,i){var s=this,r=e.tId,n=false;if(s.isCallInProgress(e)){e.conn.abort();clearInterval(s.poll[r]);s.poll[r]=null;clearTimeout(x.timeout[r]);s.timeout[r]=null;u(e,t,n=true,i)}return n},isCallInProgress:function(e){return e.conn&&!{0:true,4:true}[e.conn.readyState]}};return x}();Ext.ns("SM");window.oidcProvider.onRefreshExpWarn=function(t){let e=Math.round(t-(new Date).getTime()/1e3);let i="refresh";Ext.Msg.alert("Session Timeout",`Your session will expire in ${e} seconds. Click OK to coontinue session`,function(){if(i==="refresh"){window.oidcProvider.updateToken(-1)}else if(i==="reload"){window.location.reload()}});let s;s=setInterval(()=>{let e=Math.round(t-(new Date).getTime()/1e3);if(e<=0){clearInterval(s);i="reload";Ext.Msg.updateText(`Your session has expired.  Click OK to reload STIG Manager`)}else{Ext.Msg.updateText(`Your session will expire in ${e} seconds.  Click OK to coontinue session`)}},1e3)};"use strict";Ext.ns("SM");class Classification{constructor(e){this.showBanner=true;switch(e){case"U":this.classificationCls="unclassified";this.classificationText="UNCLASSIFIED (U)";break;case"CUI":case"FOUO":this.classificationCls="cui";this.classificationText="CONTROLLED (CUI)";break;case"C":this.classificationCls="confidential";this.classificationText="CONFIDENTIAL (C)";break;case"S":this.classificationCls="secret";this.classificationText="SECRET (S)";break;case"TS":this.classificationCls="topsecret";this.classificationText="TOP SECRET (TS)";break;case"SCI":this.classificationCls="sci";this.classificationText="TOP SECRET / SCI (TS/SCI)";break;case"NONE":default:this.showBanner=false;break}}}Ext.ns("SM");SM.Margin={adjacent:3,top:6,bottom:0,edge:0};SM.MainTabPanel=Ext.extend(Ext.TabPanel,{initComponent:function(){const s=this;this.onCollectionChanged=e=>{if(e.name){for(const t of s.items.items){if(t.collectionId===e.collectionId){t.collectionName=e.name;t.updateTitle.call(t)}}}};this.onCollectionDeleted=t=>{const e=s.items.items.filter(e=>e.collectionId===t);for(const i of e){s.remove(i)}};const e={plugins:new SM.TabEnhancements,title:"STIGManager",enableTabScroll:true,activeTab:0,listeners:{beforetabchange:function(e,t,i){if(Ext.isIE){if(Ext.isDefined(i)){if(i.sm_TabType=="asset_review"){var s=i.sm_GroupGridView;s.scrollTop=s.scroller.dom.scrollTop;s.scrollHeight=s.scroller.dom.scrollHeight}}if(Ext.isDefined(t)){if(t.sm_TabType=="asset_review"){var r=t.sm_GroupGridView;if(Ext.isDefined(r.scroller)){setTimeout(function(){r.scroller.dom.scrollTop=r.scrollTop+(r.scrollTop==0?0:r.scroller.dom.scrollHeight-r.scrollHeight)},100)}}}}},tabchange:function(e,t){if(t.sm_treePath){Ext.getCmp("app-nav-tree").selectPath(t.sm_treePath)}}},items:[]};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.MainTabPanel.superclass.initComponent.call(this);SM.Dispatcher.addListener("collectionchanged",this.onCollectionChanged);SM.Dispatcher.addListener("collectiondeleted",this.onCollectionDeleted)}});SM.HomeTab=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t={autoScroll:true};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.HomeTab.superclass.initComponent.call(this)}});SM.WelcomeWidget=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t=Ext.id();const i=new Ext.XTemplate(`<div class=sm-home-widget-header>`,`<div class='sm-home-widget-title'>Welcome</div>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class=sm-home-widget-image-text-wrap>`,`<img src="${STIGMAN.Env.welcome.image?STIGMAN.Env.welcome.image:"img/navy.svg"}" style="max-width:100%;max-height:100%;"/>`,`</div>`,`<b>STIG Manager</b> is an API and Web client for managing the assessment of Information Systems for compliance with <a href="https://public.cyber.mil/stigs/">security checklists</a> published by the United States Defense Information Systems Agency (DISA). The software is <a target="_blank" href="https://github.com/NUWCDIVNPT/stig-manager">an open source project</a> maintained by the Naval Sea Systems Command (NAVSEA) of the United States Navy.`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>${STIGMAN.Env.welcome.title?SM.he(STIGMAN.Env.welcome.title):STIGMAN.Env.welcome.message||STIGMAN.Env.welcome.link?"Support":""}</div>`,`${SM.he(STIGMAN.Env.welcome.message)}${STIGMAN.Env.welcome.message&&STIGMAN.Env.welcome.link?"<br><br>":""}`,`${STIGMAN.Env.welcome.link?'<a href="'+STIGMAN.Env.welcome.link+'">'+STIGMAN.Env.welcome.link+"</a>":""}`,`</div>`);const s={tpl:i,bodyCssClass:"sm-home-widget-body",border:false,data:[1]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.WelcomeWidget.superclass.initComponent.call(this)}});Ext.reg("sm-home-widget-welcome",SM.WelcomeWidget);SM.DocWidget=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t=Ext.id();const i=new Ext.XTemplate(`<div class=sm-home-widget-header>`,`<div class='sm-home-widget-title'>Documentation</div>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>Need help?</div>`,`Check out our <a target="_blank" href="docs/index.html">Documentation</a>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'> Just Geting Started? </div>`,`Check out our <a target="_blank" href="docs/user-guide/user-quickstart.html">User Walkthrough</a> or the <a target="_blank" href="docs/user-guide/user-guide.html">User Guide</a>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>Common Tasks </div>`,`Not sure how to do something in STIG Manager? Check out these links to <a target="_blank" href="docs/features/common-tasks.html">Common Tasks</a>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>Issues, Feature Requests, and Contributions</div>`,`Want to report a bug, request a feature, or help out the project? <a target="_blank" href="docs/the-project/contributing.html">Check out our Contribution Guide</a>`,`</div>`);const s={tpl:i,bodyCssClass:"sm-home-widget-body",border:false,data:[1]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.DocWidget.superclass.initComponent.call(this)}});Ext.reg("sm-home-widget-doc",SM.DocWidget);SM.ResourcesWidget=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t=Ext.id();const i=new Ext.XTemplate(`<div class=sm-home-widget-header>`,`<div class='sm-home-widget-title'>Resources</div>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>GitHub</div>`,`<p><a target="_blank" href="https://github.com/NUWCDIVNPT/stig-manager">STIG Manager</a></p>`,`<p><a target="_blank" href="https://github.com/NUWCDIVNPT/stigman-watcher">STIG Manager Watcher</a></p>`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>DISA STIGs</div>`,`Get the latest STIGs at <a target="_blank" href="https://public.cyber.mil/stigs/downloads/">cyber.mil</a>.`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>RMF Reference</div>`,`STIG Manager assists with STEP 4 of the <a target="_blank" href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-37r2.pdf">Risk Management Framework Process</a>.`,`</div>`,`<div class='sm-home-widget-text'>`,`<div class='sm-home-widget-subtitle'>DevSecOps</div>`,`STIG Manager is being developed as part of the <a target="_blank" href="https://software.af.mil/dsop/documents/">DoD Enterprise DevSecOps</a> and <a target="_blank" href="https://code.mil">Code.mil Open Source </a> initiatives.`,`</div>`);const s={tpl:i,bodyCssClass:"sm-home-widget-body",border:false,data:[1]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.ResourcesWidget.superclass.initComponent.call(this)}});Ext.reg("sm-home-widget-resources",SM.ResourcesWidget);SM.StigWidget=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t=Ext.id();const i=new Ext.XTemplate(`<div class=sm-home-widget-header>`,`<div class='sm-home-widget-title'>STIG updates</div>`,`</div>`,`<div class='sm-reviews-home-body-text'>Lorum ipsum sit dolor.</div>`);const s={tpl:i,bodyCssClass:"sm-home-widget-body",border:false,data:[1]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.StigWidget.superclass.initComponent.call(this)}});Ext.reg("sm-home-widget-stig",SM.StigWidget);"use strict";Ext.ns("SM");SM.Dispatcher=new Ext.util.Observable;SM.Dispatcher.addEvents("collectioncreated","collectiondeleted","collectionchanged","assetcreated","assetdeleted","assetchanged","usercreated","userdeleted","userchanged","stigassetschanged","fieldsettingschanged","statussettingschanged");Ext.ns("Ext.ux.form");Ext.ux.form.FileUploadField=Ext.extend(Ext.form.TextField,{buttonText:"Browse...",buttonOnly:false,buttonOffset:3,readOnly:true,autoSize:Ext.emptyFn,initComponent:function(){Ext.ux.form.FileUploadField.superclass.initComponent.call(this);this.addEvents("fileselected")},onRender:function(e,t){Ext.ux.form.FileUploadField.superclass.onRender.call(this,e,t);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-file-wrap"});this.el.addClass("x-form-file-text");this.el.dom.removeAttribute("name");this.createFileInput();var i=Ext.applyIf(this.buttonCfg||{},{text:this.buttonText});this.button=new Ext.Button(Ext.apply(i,{renderTo:this.wrap,cls:"x-form-file-btn"+(i.iconCls?" x-btn-icon":"")}));if(this.buttonOnly){this.el.hide();this.wrap.setWidth(this.button.getEl().getWidth())}this.bindListeners();this.resizeEl=this.positionEl=this.wrap},bindListeners:function(){this.fileInput.on({scope:this,mouseenter:function(){this.button.addClass(["x-btn-over","x-btn-focus"])},mouseleave:function(){this.button.removeClass(["x-btn-over","x-btn-focus","x-btn-click"])},mousedown:function(){this.button.addClass("x-btn-click")},mouseup:function(){this.button.removeClass(["x-btn-over","x-btn-focus","x-btn-click"])},change:function(){var e=this.fileInput.dom.value;e=e.replace(/^.*[\\\/]/,"");this.setValue(e);this.fireEvent("fileselected",this,e)}})},createFileInput:function(){this.fileInput=this.wrap.createChild({id:this.getFileInputId(),name:this.name||this.getId(),cls:"x-form-file",tag:"input",type:"file",title:" ",accept:this.accept||"*"});if(this.multiple){this.fileInput.dom.setAttribute("multiple","")}if(this.webkitdirectory){this.fileInput.dom.setAttribute("webkitdirectory","")}if(this.style){this.fileInput.dom.setAttribute("style",this.style)}},reset:function(){if(this.rendered){this.fileInput.remove();this.createFileInput();this.bindListeners()}Ext.ux.form.FileUploadField.superclass.reset.call(this)},getFileInputId:function(){return this.id+"-file"},onResize:function(e,t){Ext.ux.form.FileUploadField.superclass.onResize.call(this,e,t);this.wrap.setWidth(e);if(!this.buttonOnly){var e=this.wrap.getWidth()-this.button.getEl().getWidth()-this.buttonOffset;this.el.setWidth(e)}},onDestroy:function(){Ext.ux.form.FileUploadField.superclass.onDestroy.call(this);Ext.destroy(this.fileInput,this.button,this.wrap)},onDisable:function(){Ext.ux.form.FileUploadField.superclass.onDisable.call(this);this.doDisable(true)},onEnable:function(){Ext.ux.form.FileUploadField.superclass.onEnable.call(this);this.doDisable(false)},doDisable:function(e){this.fileInput.dom.disabled=e;this.button.setDisabled(e)},preFocus:Ext.emptyFn,alignErrorIcon:function(){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}});Ext.reg("fileuploadfield",Ext.ux.form.FileUploadField);Ext.form.FileUploadField=Ext.ux.form.FileUploadField;Ext.MessageBox=function(){var a,o,n,e,s,l,d,c,f,t,u,i,h,p,m,g="",x="",b=["ok","yes","no","cancel"];var r=function(e){h[e].blur();if(a.isVisible()){a.hide();v();Ext.callback(o.fn,o.scope||window,[e,p.dom.value,o],1)}};var v=function(){if(o&&o.cls){a.el.removeClass(o.cls)}f.reset()};var y=function(e,t,i){if(o&&o.closable!==false){a.hide();v()}if(i){i.stopEvent()}};var w=function(i){var s=0,r;if(!i){Ext.each(b,function(e){h[e].hide()});return s}a.footer.dom.style.display="";Ext.iterate(h,function(e,t){r=i[e];if(r){t.show();t.setText(Ext.isString(r)?r:Ext.MessageBox.buttonText[e]);s+=t.getEl().getWidth()+15}else{t.hide()}});return s};return{getDialog:function(e){if(!a){var t=[];h={};Ext.each(b,function(e){t.push(h[e]=new Ext.Button({text:this.buttonText[e],handler:r.createCallback(e),hideMode:"offsets"}))},this);a=new Ext.Window({autoCreate:true,title:e,resizable:false,constrain:true,constrainHeader:true,minimizable:false,maximizable:false,stateful:false,modal:true,shim:true,buttonAlign:"center",width:400,height:100,minHeight:80,plain:true,footer:true,closable:true,close:function(){if(o&&o.buttons&&o.buttons.no&&!o.buttons.cancel){r("no")}else{r("cancel")}},fbar:new Ext.Toolbar({items:t,enableOverflow:false})});a.render(Ext.getBody());a.getEl().addClass("x-window-dlg");n=a.mask;s=a.body.createChild({html:'<div class="ext-mb-icon"></div><div class="ext-mb-content"><span class="ext-mb-text"></span><br /><div class="ext-mb-fix-cursor"><input type="text" class="ext-mb-input" /><textarea class="ext-mb-textarea"></textarea></div></div>'});u=Ext.get(s.dom.firstChild);var i=s.dom.childNodes[1];l=Ext.get(i.firstChild);d=Ext.get(i.childNodes[2].firstChild);d.enableDisplayMode();d.addKeyListener([10,13],function(){if(a.isVisible()&&o&&o.buttons){if(o.buttons.ok){r("ok")}else if(o.buttons.yes){r("yes")}}});c=Ext.get(i.childNodes[2].childNodes[1]);c.enableDisplayMode();f=new Ext.ProgressBar({renderTo:s});s.createChild({cls:"x-clear"})}return a},updateText:function(e){if(!a.isVisible()&&!o.width){a.setSize(this.maxWidth,100)}l.update(e?e+" ":"&#160;");var t=x!=""?u.getWidth()+u.getMargins("lr"):0,i=l.getWidth()+l.getMargins("lr"),s=a.getFrameWidth("lr"),r=a.body.getFrameWidth("lr"),n;n=Math.max(Math.min(o.width||t+i+s+r,o.maxWidth||this.maxWidth),Math.max(o.minWidth||this.minWidth,m||0));if(o.prompt===true){p.setWidth(n-t-s-r)}if(o.progress===true||o.wait===true){f.setSize(n-t-s-r)}if(Ext.isIE9m&&n==m){n+=4}l.update(e||"&#160;");a.setSize(n,"auto").center();return this},updateProgress:function(e,t,i){f.updateProgress(e,t);if(i){this.updateText(i)}return this},isVisible:function(){return a&&a.isVisible()},hide:function(){var e=a?a.activeGhost:null;if(this.isVisible()||e){a.hide();v();if(e){a.unghost(false,false)}}return this},show:function(e){if(this.isVisible()){this.hide()}o=e;var t=this.getDialog(o.title||"&#160;");t.setTitle(SM.he(o.title)||"&#160;");var i=o.closable!==false&&o.progress!==true&&o.wait!==true;t.tools.close.setDisplayed(i);p=d;o.prompt=o.prompt||(o.multiline?true:false);if(o.prompt){if(o.multiline){d.hide();c.show();c.setHeight(Ext.isNumber(o.multiline)?o.multiline:this.defaultTextHeight);p=c}else{d.show();c.hide()}}else{d.hide();c.hide()}p.dom.value=o.value||"";if(o.prompt){t.focusEl=p}else{var s=o.buttons;var r=null;if(s&&s.ok){r=h["ok"]}else if(s&&s.yes){r=h["yes"]}if(r){t.focusEl=r}}if(Ext.isDefined(o.iconCls)){t.setIconClass(o.iconCls)}this.setIcon(Ext.isDefined(o.icon)?o.icon:g);m=w(o.buttons);f.setVisible(o.progress===true||o.wait===true);this.updateProgress(0,o.progressText);this.updateText(o.msg);if(o.cls){t.el.addClass(o.cls)}t.proxyDrag=o.proxyDrag===true;t.modal=o.modal!==false;t.mask=o.modal!==false?n:false;if(!t.isVisible()){Ext.getBody().appendChild(a.el.dom);t.setAnimateTarget(o.animEl);t.on("show",function(){if(i===true){t.keyMap.enable()}else{t.keyMap.disable()}},this,{single:true});t.show(o.animEl)}if(o.wait===true){f.wait(o.waitConfig)}return this},setIcon:function(e){if(!a){g=e;return}g=undefined;if(e&&e!=""){u.removeClass("x-hidden");u.replaceClass(x,e);s.addClass("x-dlg-icon");x=e}else{u.replaceClass(x,"x-hidden");s.removeClass("x-dlg-icon");x=""}return this},progress:function(e,t,i){this.show({title:e,msg:t,buttons:false,progress:true,closable:false,minWidth:this.minProgressWidth,progressText:i});return this},wait:function(e,t,i){this.show({title:t,msg:e,buttons:false,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:i});return this},alert:function(e,t,i,s){this.show({title:e,msg:t,buttons:this.OK,fn:i,scope:s,minWidth:this.minWidth});return this},confirm:function(e,t,i,s){this.show({title:e,msg:t,buttons:this.YESNO,fn:i,scope:s,icon:this.QUESTION,minWidth:this.minWidth});return this},prompt:function(e,t,i,s,r,n){this.show({title:e,msg:t,buttons:this.OKCANCEL,fn:i,minWidth:this.minPromptWidth,scope:s,prompt:true,multiline:r,value:n});return this},OK:{ok:true},CANCEL:{cancel:true},OKCANCEL:{ok:true,cancel:true},YESNO:{yes:true,no:true},YESNOCANCEL:{yes:true,no:true,cancel:true},INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",defaultTextHeight:75,maxWidth:600,minWidth:100,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"}}}();Ext.Msg=Ext.MessageBox;Ext.override(Ext.grid.CheckboxSelectionModel,{onMouseDown:function(e,t){if(e.button===0&&t.className=="x-grid3-row-checker"){e.stopEvent();var i=e.getTarget(".x-grid3-row");if(i){var s=i.rowIndex;if(this.isSelected(s)){this.deselectRow(s)}else{this.selectRow(s,true);this.grid.getView().focusRow(s)}}const r=this.grid.view.innerHd.querySelector(".x-grid3-hd-row .x-grid3-td-checker .x-grid3-hd-checker");if(r){const n=this.selections.length===0?null:this.grid.store.getCount()===this.selections.length?"on":"ind";r.classList.remove("x-grid3-hd-checker-on");r.classList.remove("x-grid3-hd-checker-ind");if(n){r.classList.add(`x-grid3-hd-checker-${n}`)}}}},onHdMouseDown:function(e,t){if(t.className=="x-grid3-hd-checker"){e.stopEvent();var i=Ext.fly(t.parentNode);var s=i.hasClass("x-grid3-hd-checker-on");var r=i.hasClass("x-grid3-hd-checker-ind");if(s||r){i.removeClass("x-grid3-hd-checker-on");i.removeClass("x-grid3-hd-checker-ind");this.clearSelections()}else{i.addClass("x-grid3-hd-checker-on");this.selectAll()}}}});const origGetBody=Ext.getBody;Ext.getBody=function(){return SM.contentEl||origGetBody()};Ext.LoadMask.prototype.onBeforeLoad=function(){if(!this.disabled){if(!this.store.smMaskDelay){this.smTask=new Ext.util.DelayedTask(function(){this.el.mask(this.msg,this.msgCls)},this);this.smTask.delay(this.store.smMaskDelay)}}};Ext.LoadMask.prototype.onLoad=function(){if(this.smTask){this.smTask.cancel()}this.el.unmask(this.removeMask)};Ext.dd.DragDropMgr.getZIndex=function(e){var t=document.body,i,s=-1;e=Ext.getDom(e);while(e&&e!==t){if(!isNaN(i=Number(Ext.fly(e).getStyle("zIndex")))){s=i}e=e.parentNode}return s};Ext.override(Ext.tree.TreeLoader,{requestData:function(e,t,i){if(this.fireEvent("beforeload",this,e,t)!==false){if(this.directFn){var s=this.getParams(e);s.push(this.processDirectResponse.createDelegate(this,[{callback:t,node:e,scope:i}],true));this.directFn.apply(e,s)}else{this.transId=Ext.Ajax.request({method:this.requestMethod,url:this.dataUrl||this.url,success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:t,node:e,scope:i},params:this.getParams(e)})}}else{this.runCallback(t,i||e,[])}}});Ext.override(Ext.form.Checkbox,{onClick:function(e,t){if(this.readOnly===true){e.preventDefault()}else{if(this.el.dom.checked!=this.checked){this.setValue(this.el.dom.checked)}}}});Object.defineProperty(Array.prototype,"remove",{enumerable:false});Ext.grid.Column.types.timestampcolumn=Ext.extend(Ext.grid.Column,{format:"Y-m-d H:i:s",constructor:function(e){Ext.grid.Column.types.timestampcolumn.superclass.constructor.call(this,e);this.renderer=e=>e?Ext.util.Format.date(new Date(e*1e3),this.format):"None"}});Ext.override(Ext.Window,{cls:"sm-round-panel",frame:false,resizable:false,shadow:false});Ext.override(Ext.form.BasicForm,{getFieldValues:function(t,i){var s={},r,n,a;this.items.each(function(e){if((!e.disabled||i)&&(t!==true||e.isDirty())){r=e.getName();n=s[r];a=e.getValue();if(Ext.isDefined(n)){if(Ext.isArray(n)){s[r].push(a)}else{s[r]=[n,a]}}else{s[r]=a}}});return s}});Ext.override(Ext.Ajax,{requestPromise:function(e){return new Promise((i,s)=>{this.request({...e,success:function(e,t){i({response:e,options:t})},failure:function(e,t){s({message:`${t.method} ${t.url}\n${e.responseText}`,response:e,options:t})}})})}});SM.confirmPromise=function(e,s){return new Promise((t,i)=>{callback=function(e){if(e!==undefined){t(e)}else{i(e)}};Ext.Msg.confirm(e,s,callback)})};Ext.apply(Ext.form.VTypes,{IPAddress:function(e){return/^(?=\d+\.\d+\.\d+\.\d+$)(?:(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.?){4}$/.test(e)},IPAddressText:"Must be an IP address (n.n.n.n)",IPAddressMask:/[\d\.]/i});Ext.override(Ext.layout.FormLayout,{getTemplateArgs:function(e){var t=!e.fieldLabel||e.hideLabel;var i=typeof e.labelSeparator=="undefined"?this.labelSeparator:e.labelSeparator;if(e.allowBlank===false)i+='<span style="color: rgb(255, 0, 0); padding-left: 2px;">*</span>';return{id:e.id,label:e.fieldLabel,labelStyle:e.labelStyle||this.labelStyle||"",elementStyle:this.elementStyle||"",labelSeparator:t?"":i,itemCls:(e.itemCls||this.container.itemCls||"")+(e.hideLabel?" x-hide-label":""),clearCls:e.clearCls||"x-form-clear-left"}}});Ext.override(Ext.TabPanel,{idDelimiter:"!!"});Ext.override(Ext.grid.GridView,{onLoad:function(){if(!this.holdPosition)this.scrollToTop()}});Ext.override(Ext.form.TextField,{enableKeyEvents:true,onKeyDown:function(e){if((this.readOnly==true||this.editable==false)&&e.getCharCode()==e.BACKSPACE){e.preventDefault()}this.fireEvent("keydown",this,e)}});Ext.override(Ext.form.TextArea,{enableKeyEvents:true,onKeyDown:function(e){if((this.readOnly==true||this.editable==false)&&e.getCharCode()==e.BACKSPACE){e.preventDefault()}this.fireEvent("keydown",this,e)}});Ext.override(Ext.form.BasicForm,{clearDirty:function(){var e,t=this.items.items,i=t.length,s;for(e=0;e<i;e++){s=t[e];s.originalValue=String(s.getValue());if(s.xtype=="compositefield"){var r,n=s.items.items,a=n.length,o;for(r=0;r<a;r++){o=n[r];o.originalValue=String(o.getValue())}}}}});if(!Ext.isDefined(Ext.webKitVersion)){Ext.webKitVersion=Ext.isWebKit?parseFloat(/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent)[1],10):NaN}if(Ext.isWebKit&&Ext.webKitVersion>=535.2){Ext.override(Ext.grid.ColumnModel,{getTotalWidth:function(e){if(!this.totalWidth){var t=2;this.totalWidth=0;for(var i=0,s=this.config.length;i<s;i++){if(e||!this.isHidden(i)){this.totalWidth+=this.getColumnWidth(i)+t}}}return this.totalWidth}});Ext.onReady(function(){Ext.get(document.body).addClass("ext-chrome-fixes");Ext.util.CSS.createStyleSheet("@media screen and (-webkit-min-device-pixel-ratio:0) {.x-grid3-cell{box-sizing: border-box !important;}}","chrome-fixes-box-sizing")})}Ext.override(Ext.layout.BorderLayout,{onLayout:function(e,t){var i;var s=t.getViewSize(),r=s.width,n=s.height;if(!this.rendered){t.position();t.addClass("x-border-layout-ct");i=[];var a=e.items.items;for(var o=0,l=a.length;o<l;o++){var d=a[o];var c=d.region;if(d.collapsed){i.push(d)}d.collapsed=false;var f=this[c]=c!="center"&&d.split?new Ext.layout.BorderLayout.SplitRegion(this,d.initialConfig,c):new Ext.layout.BorderLayout.Region(this,d.initialConfig,c);if(c=="north"||c=="south"){if(typeof d.height=="string"&&d.relHeight===undefined){var u=d.height.match(/(\d+)%/);if(u[1]){d.relHeight=parseInt(u[1],10)*.01}}if(d.relHeight!==undefined){if(typeof d.relHeight!="number"){d.relHeight=parseFloat(d.relHeight)}d.height=n*d.relHeight}f.minSize=f.minSize||f.minHeight;f.maxSize=f.maxSize||f.maxHeight}else if(c=="east"||c=="west"){if(typeof d.width=="string"&&d.relWidth===undefined){var u=d.width.match(/(\d+)%/);if(u[1]){d.relWidth=parseInt(u[1],10)*.01}}if(d.relWidth!==undefined){if(typeof d.relWidth!="number"){d.relWidth=parseFloat(d.relWidth)}d.width=r*d.relWidth}f.minSize=f.minSize||f.minWidth;f.maxSize=f.maxSize||f.maxWidth}if(!d.rendered){d.cls=d.cls?d.cls+" x-border-panel":"x-border-panel";d.render(t,o)}f.render(t,d)}this.rendered=true}if(r<20||n<20){if(i){this.restoreCollapsed=i}return}else if(this.restoreCollapsed){i=this.restoreCollapsed;delete this.restoreCollapsed}var h=r,p=n,m=0,g=0;var x=this.north,b=this.south,v=this.west,y=this.east,d=this.center;if(!d&&Ext.layout.BorderLayout.WARN!==false){throw"No center region defined in BorderLayout "+e.id}if(x&&x.isVisible()){var w=x.getSize();var S=x.getMargins();w.width=r-(S.left+S.right);if(x.panel.relHeight!==undefined){x.height=Math.round(n*x.panel.relHeight);w.height=x.minSize&&x.height<x.minSize?x.minSize:x.maxSize&&x.height>x.maxSize?x.maxSize:x.height}w.x=S.left;w.y=S.top;m=w.height+w.y+S.bottom;p-=m;x.applyLayout(w)}if(b&&b.isVisible()){var w=b.getSize();var S=b.getMargins();w.width=r-(S.left+S.right);if(b.panel.relHeight!==undefined){b.height=Math.round(n*b.panel.relHeight);w.height=b.minSize&&b.height<b.minSize?b.minSize:b.maxSize&&b.height>b.maxSize?b.maxSize:b.height}w.x=S.left;var E=w.height+S.top+S.bottom;w.y=n-E+S.top;p-=E;b.applyLayout(w)}if(v&&v.isVisible()){var w=v.getSize();var S=v.getMargins();w.height=p-(S.top+S.bottom);if(v.panel.relWidth!==undefined){v.width=Math.round(r*v.panel.relWidth);w.width=v.minSize&&v.width<v.minSize?v.minSize:v.maxSize&&v.width>v.maxSize?v.maxSize:v.width}w.x=S.left;w.y=m+S.top;var C=w.width+S.left+S.right;g+=C;h-=C;v.applyLayout(w)}if(y&&y.isVisible()){var w=y.getSize();var S=y.getMargins();w.height=p-(S.top+S.bottom);if(y.panel.relWidth!==undefined){y.width=Math.round(r*y.panel.relWidth);w.width=y.minSize&&y.width<y.minSize?y.minSize:y.maxSize&&y.width>y.maxSize?y.maxSize:y.width}var C=w.width+S.left+S.right;w.x=r-C+S.left;w.y=m+S.top;h-=C;y.applyLayout(w)}if(d){var S=d.getMargins();var I={x:g+S.left,y:m+S.top,width:h-(S.left+S.right),height:p-(S.top+S.bottom)};d.applyLayout(I)}if(i){for(var o=0,l=i.length;o<l;o++){i[o].collapse(false)}}if(Ext.isIE&&Ext.isStrict){t.repaint()}}});Ext.override(Ext.layout.BorderLayout.SplitRegion,{onSplitMove:function(e,t){var i=this.panel.getSize();this.lastSplitSize=t;if(this.position=="north"||this.position=="south"){this.panel.setSize(i.width,t);if(this.panel.relHeight!==undefined){this.state.relHeight=this.panel.relHeight*=t/this.height}else{this.state.height=t}}else{this.panel.setSize(t,i.height);if(this.panel.relWidth!==undefined){this.state.relWidth=this.panel.relWidth*=t/this.width}else{this.state.width=t}}this.layout.layout();this.panel.saveState();return false}});Ext.override(Ext.form.ComboBox,{setValue:function(e,t){var i=e;if(this.valueField){var s=this.findRecord(this.valueField,e);if(s){i=s.data[this.displayField];if(t){var r=this.store.indexOf(s);this.selectedIndex=r;this.fireEvent("select",this,s,r)}}else if(Ext.isDefined(this.valueNotFoundText)){i=this.valueNotFoundText}}this.lastSelectionText=i;if(this.hiddenField){this.hiddenField.value=e}Ext.form.ComboBox.superclass.setValue.call(this,i);this.value=e;return this}});Ext.override(Ext.grid.RowSelectionModel,{handleMouseDown:function(e,t,i){if(i.button!==0||this.isLocked()){return}var s=this.grid.getView();if(i.shiftKey&&!this.singleSelect&&this.last!==false){var r=this.last;this.selectRange(r,t,i.ctrlKey||i.shiftKey);this.last=r;s.focusRow(t)}else{var n=this.isSelected(t);if(i.ctrlKey&&n){this.deselectRow(t)}else if(!n||this.getCount()>1){this.selectRow(t,i.ctrlKey||i.shiftKey);s.focusRow(t)}}}});Ext.override(Ext.QuickTip,{tagConfig:{namespace:"ext",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor",dismissDelay:"qdmdelay"},onTargetOver:function(e){if(this.disabled){return}this.targetXY=e.getXY();var t=e.getTarget();if(!t||t.nodeType!==1||t==document||t==document.body){return}if(this.activeTarget&&(t==this.activeTarget.el||Ext.fly(this.activeTarget.el).contains(t))){this.clearTimer("hide");this.show();return}if(t&&this.targets[t.id]){this.activeTarget=this.targets[t.id];this.activeTarget.el=t;this.anchor=this.activeTarget.anchor;if(this.anchor){this.anchorTarget=t}this.delayShow();return}var i,s=Ext.fly(t),r=this.tagConfig,n=r.namespace;if(i=this.getTipCfg(e)){var a=s.getAttribute(r.hide,n);this.activeTarget={el:t,text:i,width:s.getAttribute(r.width,n),autoHide:a!="user"&&a!=="false",title:s.getAttribute(r.title,n),cls:s.getAttribute(r.cls,n),align:s.getAttribute(r.align,n),dismissDelay:parseInt(s.getAttribute(r.dismissDelay,n),10)};this.anchor=s.getAttribute(r.anchor,n);if(this.anchor){this.anchorTarget=t}this.delayShow()}}});SM.TabEnhancements=function(){let o;function e(e){e.preventDefault();const t=o.findTargets(e);const i=e.browserEvent.button;const s=e.browserEvent.which;const r=e.browserEvent.detail;const n=s===null||s===undefined?i==1:s==2;const a=s===null||s===undefined?i==0:s==1;if(t.item){if(!t.close&&t.item.sm_treePath){Ext.getCmp("app-nav-tree").selectPath(t.item.sm_treePath)}if(a&&r===2&&t.item.sm_tabMode==="ephemeral"){t.item.makePermanent()}if(n){if(t.item.closable){if(t.item.fireEvent("beforeclose",t.item)!==false){t.item.fireEvent("close",t.item);o.remove(t.item)}}else{e.stopPropagation()}}}}function t(){o.strip.on("mousedown",e)}this.init=function(e){o=e;o.on("render",t)}};Ext.override(Ext.grid.GridView,{masterTpl:new Ext.Template('<div class="x-grid3" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header">','<div class="x-grid3-header-inner">','<div class="x-grid3-header-offset" style="{ostyle}">{header}</div>',"</div>",'<div class="x-clear"></div>',"</div>",'<div class="x-grid3-scroller">','<div class="x-grid3-body" style="{bstyle}">{body}</div>','<a class="x-grid3-focus" tabIndex="-1"></a>',"</div>","</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>"),doRender:function(e,t,i,s,r,n){var a=this.templates,o=a.cell,l=a.row,d=r-1,c="width:"+this.getTotalWidth()+";",f=[],u=[],h={tstyle:c},p={},m=t.length,g,x,b,v,y,w;for(y=0;y<m;y++){b=t[y];u=[];w=y+s;for(v=0;v<r;v++){x=e[v];p.id=x.id;p.css=v===0?"x-grid3-cell-first ":v==d?"x-grid3-cell-last ":"";p.attr=p.cellAttr="";p.style=x.style;p.value=x.renderer.call(x.scope,typeof b.data[x.name]==="string"?SM.he(b.data[x.name]):b.data[x.name],p,b,w,v,i);if(Ext.isEmpty(p.value)){p.value="&#160;"}if(this.markDirty&&b.dirty&&typeof b.modified[x.name]!="undefined"){p.css+=" x-grid3-dirty-cell"}u[u.length]=o.apply(p)}g=[];if(n&&(w+1)%2===0){g[0]="x-grid3-row-alt"}if(b.dirty){g[1]=" x-grid3-dirty-row"}h.cols=r;if(this.getRowClass){g[2]=this.getRowClass(b,w,h,i)}h.alt=g.join(" ");h.cells=u.join("");f[f.length]=l.apply(h)}return f.join("")},refreshRow:function(e){var t=this.ds,i=this.cm.getColumnCount(),s=this.getColumnData(),r=i-1,n=["x-grid3-row"],a={tstyle:String.format("width: {0};",this.getTotalWidth())},o=[],l=this.templates.cell,d,c,f,u,h,p;if(Ext.isNumber(e)){d=e;e=t.getAt(d)}else{d=t.indexOf(e)}if(!e||d<0){return}for(p=0;p<i;p++){f=s[p];if(p==0){h="x-grid3-cell-first"}else{h=p==r?"x-grid3-cell-last ":""}u={id:f.id,style:f.style,css:h,attr:"",cellAttr:""};u.value=f.renderer.call(f.scope,typeof e.data[f.name]==="string"?SM.he(e.data[f.name]):e.data[f.name],u,e,d,p,t);if(Ext.isEmpty(u.value)){u.value="&#160;"}if(this.markDirty&&e.dirty&&typeof e.modified[f.name]!="undefined"){u.css+=" x-grid3-dirty-cell"}o[p]=l.apply(u)}c=this.getRow(d);c.className="";if(this.grid.stripeRows&&(d+1)%2===0){n.push("x-grid3-row-alt")}if(this.getRowClass){a.cols=i;n.push(this.getRowClass(e,d,a,t))}this.fly(c).addClass(n).setStyle(a.tstyle);a.cells=o.join("");c.innerHTML=this.templates.rowInner.apply(a);this.fireEvent("rowupdated",this,d,e)}});Ext.override(Ext.tree.TreeNodeUI,{renderElements:function(e,t,i,s){this.indentMarkup=e.parentNode?e.parentNode.ui.getChildIndent():"";var r=Ext.isBoolean(t.checked),n,a=this.getHref(t.href),o=['<li class="x-tree-node"><div ext:tree-node-id="',e.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',t.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img alt="" src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />',r?'<input class="x-tree-node-cb" type="checkbox" '+(t.checked?'checked="checked" />':"/>"):"",'<img alt="" src="',t.icon||this.emptyIcon,'" class="x-tree-node-icon',t.icon?" x-tree-node-inline-icon":"",t.iconCls?" "+t.iconCls:"",'" unselectable="on" />','<a hidefocus="on" class="x-tree-node-anchor" tabIndex="1" ',t.hrefTarget?' target="'+t.hrefTarget+'"':"",'><span unselectable="on">',e.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");if(s!==true&&e.nextSibling&&(n=e.nextSibling.ui.getEl())){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",n,o)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",i,o)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var l=this.elNode.childNodes;this.indentNode=l[0];this.ecNode=l[1];var d=3;if(r){this.iconNode=l[3];this.checkbox=l[2];this.checkbox.defaultChecked=this.checkbox.checked;d++}else{this.iconNode=l[2]}this.anchor=l[d];this.textNode=l[d].firstChild}});Ext.override(Ext.TabPanel,{itemTpl:new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close"></a>','<a class="x-tab-right"><em class="x-tab-left">','<span class="x-tab-strip-inner"><span class="x-tab-strip-text {iconCls}">{text}</span></span>',"</em></a></li>")});Ext.override(Ext.data.HttpProxy,{doRequest:function(e,t,i,s,r,n,a){var o={method:this.api[e]?this.api[e]["method"]:undefined,request:{callback:r,scope:n,arg:a},reader:s,callback:this.createCallback(e,t),scope:this};if(i.jsonData){let{jsonData:e,...t}=i;o.jsonData=e;o.params=t||{}}else if(i.xmlData){o.xmlData=i.xmlData}else{o.params=i||{}}this.conn.url=this.buildUrl(e,t);if(this.useAjax){Ext.applyIf(o,this.conn);if(e==Ext.data.Api.actions.read&&this.activeRequest[e]){Ext.Ajax.abort(this.activeRequest[e])}this.activeRequest[e]=Ext.Ajax.request(o)}else{this.conn.request(o)}this.conn.url=null}});Ext.override(Ext.data.JsonStore,{loadPromise:function(e){return new Promise((s,r)=>{this.load({params:e,callback:function(e,t,i){if(i){s({records:e,options:t})}else{r("Load failed")}}})})}});Ext.ns("Ext.ux.grid");Ext.ux.grid.RowEditor=Ext.extend(Ext.Panel,{floating:true,shadow:false,layout:"hbox",cls:"x-small-editor",buttonAlign:"center",baseCls:"x-row-editor",elements:"header,footer,body",frameWidth:5,buttonPad:3,clicksToEdit:"auto",monitorValid:true,focusDelay:250,errorSummary:true,saveText:"Save",cancelText:"Cancel",commitChangesText:"You need to commit or cancel your changes",errorText:"Errors",defaults:{normalWidth:true},initComponent:function(){Ext.ux.grid.RowEditor.superclass.initComponent.call(this);this.addEvents("beforeedit","canceledit","validateedit","afteredit")},init:function(e){this.grid=e;this.ownerCt=e;if(this.clicksToEdit===2){e.on("rowdblclick",this.onRowDblClick,this)}else{e.on("rowclick",this.onRowClick,this);if(Ext.isIE){e.on("rowdblclick",this.onRowDblClick,this)}}e.getStore().on("remove",function(){this.stopEditing(false)},this);e.on({scope:this,keydown:this.onGridKey,columnresize:this.verifyLayout,columnmove:this.refreshFields,reconfigure:this.refreshFields,beforedestroy:this.beforedestroy,destroy:this.destroy,bodyscroll:{buffer:250,fn:this.positionButtons}});e.getColumnModel().on("hiddenchange",this.verifyLayout,this,{delay:1});e.getView().on("refresh",this.stopEditing.createDelegate(this,[]))},beforedestroy:function(){this.stopMonitoring();this.grid.getStore().un("remove",this.onStoreRemove,this);this.stopEditing(false);Ext.destroy(this.btns,this.tooltip)},refreshFields:function(){this.initFields();this.verifyLayout()},isDirty:function(){var t;this.items.each(function(e){if(String(this.values[e.id])!==String(e.getValue())){t=true;return false}},this);return t},startEditing:function(e,t){if(this.editing&&this.isDirty()){this.showTooltip(this.commitChangesText);return}if(Ext.isObject(e)){e=this.grid.getStore().indexOf(e)}if(this.fireEvent("beforeedit",this,e)!==false){this.grid.getEl().mask();this.editing=true;var i=this.grid,s=i.getView(),r=s.getRow(e),n=i.store.getAt(e);this.record=n;this.rowIndex=e;this.values={};if(!this.rendered){this.render(s.getEditorParent())}var a=Ext.fly(r).getWidth();this.setSize(a);if(!this.initialized){this.initFields()}var o=i.getColumnModel(),l=this.items.items,d,c;for(var f=0,u=o.getColumnCount();f<u;f++){c=this.preEditValue(n,o.getDataIndex(f));d=l[f];d.setValue(c);this.values[d.id]=Ext.isEmpty(c)?"":c}this.verifyLayout(true);if(!this.isVisible()){this.setPagePosition(Ext.fly(r).getXY())}else{this.el.setXY(Ext.fly(r).getXY(),{duration:.15})}if(!this.isVisible()){this.show().doLayout()}if(t!==false){this.doFocus.defer(this.focusDelay,this)}}},stopEditing:function(e){this.editing=false;this.grid.getEl()?.unmask();if(!this.isVisible()){return}if(e===false||!this.isValid()){this.hide();this.fireEvent("canceledit",this,e===false);return}var t={},i=this.record,s=false,r=this.grid.colModel,n=this.items.items;for(var a=0,o=r.getColumnCount();a<o;a++){if(!r.isHidden(a)){var l=r.getDataIndex(a);if(!Ext.isEmpty(l)){var d=i.data[l],c=this.postEditValue(n[a].getValue(),d,i,l);if(String(d)!==String(c)){t[l]=c;s=true}}}}if(s&&this.fireEvent("validateedit",this,t,i,this.rowIndex)!==false){i.beginEdit();Ext.iterate(t,function(e,t){i.set(e,t)});i.endEdit();this.fireEvent("afteredit",this,t,i,this.rowIndex)}else{this.fireEvent("canceledit",this,false)}this.hide()},verifyLayout:function(e){if(this.el&&(this.isVisible()||e===true)){var t=this.grid.getView().getRow(this.rowIndex);this.setSize(Ext.fly(t).getWidth(),Ext.isIE?Ext.fly(t).getHeight()+9:undefined);var i=this.grid.colModel,s=this.items.items;for(var r=0,n=i.getColumnCount();r<n;r++){if(!i.isHidden(r)){var a=0;if(r===n-1){a+=3}else{a+=1}s[r].show();s[r].setWidth(i.getColumnWidth(r)-a)}else{s[r].hide()}}this.doLayout();this.positionButtons()}},slideHide:function(){this.hide()},initFields:function(){var e=this.grid.getColumnModel(),t=Ext.layout.ContainerLayout.prototype.parseMargins;this.removeAll(false);for(var i=0,s=e.getColumnCount();i<s;i++){var r=e.getColumnAt(i),n=r.getEditor();if(!n){n=r.displayEditor||new Ext.form.DisplayField}if(i==0){n.margins=t("0 1 2 1")}else if(i==s-1){n.margins=t("0 0 2 1")}else{if(Ext.isIE){n.margins=t("0 0 2 0")}else{n.margins=t("0 1 2 0")}}n.setWidth(e.getColumnWidth(i));n.column=r;if(n.ownerCt!==this){n.on("focus",this.ensureVisible,this);n.on("specialkey",this.onKey,this)}this.insert(i,n)}this.initialized=true},onKey:function(e,t){if(t.getKey()===t.ENTER){this.stopEditing(true);t.stopPropagation()}},onGridKey:function(e){if(e.getKey()===e.ENTER&&!this.isVisible()){var t=this.grid.getSelectionModel().getSelected();if(t){var i=this.grid.store.indexOf(t);this.startEditing(i);e.stopPropagation()}}},ensureVisible:function(e){if(this.isVisible()){this.grid.getView().ensureVisible(this.rowIndex,this.grid.colModel.getIndexById(e.column.id),true)}},onRowClick:function(e,t,i){if(this.clicksToEdit=="auto"){var s=this.lastClickIndex;this.lastClickIndex=t;if(s!=t&&!this.isVisible()){return}}this.startEditing(t,false);this.doFocus.defer(this.focusDelay,this,[i.getPoint()])},onRowDblClick:function(e,t,i){this.startEditing(t,false);this.doFocus.defer(this.focusDelay,this,[i.getPoint()])},onRender:function(){Ext.ux.grid.RowEditor.superclass.onRender.apply(this,arguments);this.el.swallowEvent(["keydown","keyup","keypress"]);this.btns=new Ext.Panel({baseCls:"x-plain",cls:"x-btns",elements:"body",layout:"table",width:this.minButtonWidth*2+this.frameWidth*2+this.buttonPad*4,items:[{ref:"saveBtn",itemId:"saveBtn",xtype:"button",text:this.saveText,width:this.minButtonWidth,handler:this.stopEditing.createDelegate(this,[true])},{xtype:"button",text:this.cancelText,width:this.minButtonWidth,handler:this.stopEditing.createDelegate(this,[false])}]});this.btns.render(this.bwrap)},afterRender:function(){Ext.ux.grid.RowEditor.superclass.afterRender.apply(this,arguments);this.positionButtons();if(this.monitorValid){this.startMonitoring()}},onShow:function(){if(this.monitorValid){this.startMonitoring()}Ext.ux.grid.RowEditor.superclass.onShow.apply(this,arguments)},onHide:function(){Ext.ux.grid.RowEditor.superclass.onHide.apply(this,arguments);this.stopMonitoring();this.grid.getView().focusRow(this.rowIndex)},positionButtons:function(){if(this.btns){var e=this.grid,t=this.el.dom.clientHeight,i=e.getView(),s=i.scroller.dom.scrollLeft,r=this.btns.getWidth(),n=Math.min(e.getWidth(),e.getColumnModel().getTotalWidth());this.btns.el.shift({left:n/2-r/2+s,top:t-2,stopFx:true,duration:.2})}},preEditValue:function(e,t){var i=e.data[t];return this.autoEncode&&typeof i==="string"?Ext.util.Format.htmlDecode(i):i},postEditValue:function(e,t,i,s){return this.autoEncode&&typeof e=="string"?SM.he(e):e},doFocus:function(e){if(this.isVisible()){var t=0,i=this.grid.getColumnModel(),s;if(e){t=this.getTargetColumnIndex(e)}for(var r=t||0,n=i.getColumnCount();r<n;r++){s=i.getColumnAt(r);if(!s.hidden&&s.getEditor()){s.getEditor().focus();break}}}},getTargetColumnIndex:function(e){var t=this.grid,i=t.view,s=e.left,r=t.colModel.config,n=0,a=false;for(var o=r.length,l;l=r[n];n++){if(!l.hidden){if(Ext.fly(i.getHeaderCell(n)).getRegion().right>=s){a=n;break}}}return a},startMonitoring:function(){if(!this.bound&&this.monitorValid){this.bound=true;Ext.TaskMgr.start({run:this.bindHandler,interval:this.monitorPoll||200,scope:this})}},stopMonitoring:function(){this.bound=false;if(this.tooltip){this.tooltip.hide()}},isValid:function(){var t=true;this.items.each(function(e){if(!e.isValid(true)){t=false;return false}});return t},bindHandler:function(){if(!this.bound){return false}var e=this.isValid();if(!e&&this.errorSummary){this.showTooltip(this.getErrorText().join(""))}this.btns.saveBtn.setDisabled(!e);this.fireEvent("validation",this,e)},lastVisibleColumn:function(){var e=this.items.getCount()-1,t;for(;e>=0;e--){t=this.items.items[e];if(!t.hidden){return t}}},showTooltip:function(e){var t=this.tooltip;if(!t){t=this.tooltip=new Ext.ToolTip({maxWidth:600,cls:"errorTip",width:300,title:this.errorText,autoHide:false,anchor:"left",anchorToTarget:true,mouseOffset:[40,0]})}var i=this.grid.getView(),s=parseInt(this.el.dom.style.top,10),r=i.scroller.dom.scrollTop,n=this.el.getHeight();if(s+n>=r){t.initTarget(this.lastVisibleColumn().getEl());if(!t.rendered){t.show();t.hide()}t.body.update(e);t.doAutoWidth(20);t.show()}else if(t.rendered){t.hide()}},getErrorText:function(){var t=["<ul>"];this.items.each(function(e){if(!e.isValid(true)){t.push("<li>",e.getActiveError(),"</li>")}});t.push("</ul>");return t}});Ext.preg("roweditor",Ext.ux.grid.RowEditor);Ext.ns("Ext.ux.grid");Ext.ux.grid.RowExpander=Ext.extend(Ext.util.Observable,{expandOnEnter:true,expandOnDblClick:false,header:"",width:20,sortable:false,fixed:true,hideable:false,menuDisabled:true,dataIndex:"",id:"expander",lazyRender:false,enableCaching:false,constructor:function(e){Ext.apply(this,e);this.addEvents({beforeexpand:true,expand:true,beforecollapse:true,collapse:true});Ext.ux.grid.RowExpander.superclass.constructor.call(this);if(this.tpl){if(typeof this.tpl=="string"){this.tpl=new Ext.Template(this.tpl)}this.tpl.compile()}this.state={};this.bodyContent={}},getRowClass:function(e,t,i,s){i.cols=i.cols-1;var r=this.bodyContent[e.id];if(!r&&!this.lazyRender){r=this.getBodyContent(e,t)}i.body=r;return this.state[e.id]?"x-grid3-row-expanded":"x-grid3-row-collapsed"},init:function(e){this.grid=e;var t=e.getView();t.getRowClass=this.getRowClass.createDelegate(this);t.enableRowBody=true;e.on("render",this.onRender,this);e.on("destroy",this.onDestroy,this)},onRender:function(){var e=this.grid;var t=e.getView().mainBody;t.on("mousedown",this.onMouseDown,this,{delegate:".x-grid3-row-expander"});if(this.expandOnEnter){this.keyNav=new Ext.KeyNav(this.grid.getGridEl(),{enter:this.onEnter,scope:this})}if(this.expandOnDblClick){e.on("rowdblclick",this.onRowDblClick,this)}},onDestroy:function(){if(this.keyNav){this.keyNav.disable();delete this.keyNav}var e=this.grid.getView().mainBody;if(e){e.un("mousedown",this.onMouseDown,this)}},onRowDblClick:function(e,t,i){this.toggleRow(t)},onEnter:function(e){var t=this.grid;var i=t.getSelectionModel();var s=i.getSelections();for(var r=0,n=s.length;r<n;r++){var a=t.getStore().indexOf(s[r]);this.toggleRow(a)}},getBodyContent:function(e,t){if(!this.enableCaching){return this.tpl.apply(e.data)}var i=this.bodyContent[e.id];if(!i){i=this.tpl.apply(e.data);this.bodyContent[e.id]=i}return i},onMouseDown:function(e,t){e.stopEvent();var i=e.getTarget(".x-grid3-row");this.toggleRow(i)},renderer:function(e,t,i){t.cellAttr='rowspan="2"';return'<div class="x-grid3-row-expander">&#160;</div>'},beforeExpand:function(e,t,i){if(this.fireEvent("beforeexpand",this,e,t,i)!==false){if(this.tpl&&this.lazyRender){t.innerHTML=this.getBodyContent(e,i)}return true}else{return false}},toggleRow:function(e){if(typeof e=="number"){e=this.grid.view.getRow(e)}this[Ext.fly(e).hasClass("x-grid3-row-collapsed")?"expandRow":"collapseRow"](e)},expandRow:function(e){if(typeof e=="number"){e=this.grid.view.getRow(e)}var t=this.grid.store.getAt(e.rowIndex);var i=Ext.DomQuery.selectNode("tr:nth(2) div.x-grid3-row-body",e);if(this.beforeExpand(t,i,e.rowIndex)){this.state[t.id]=true;Ext.fly(e).replaceClass("x-grid3-row-collapsed","x-grid3-row-expanded");this.fireEvent("expand",this,t,i,e.rowIndex)}},collapseRow:function(e){if(typeof e=="number"){e=this.grid.view.getRow(e)}var t=this.grid.store.getAt(e.rowIndex);var i=Ext.fly(e).child("tr:nth(1) div.x-grid3-row-body",true);if(this.fireEvent("beforecollapse",this,t,i,e.rowIndex)!==false){this.state[t.id]=false;Ext.fly(e).replaceClass("x-grid3-row-expanded","x-grid3-row-collapsed");this.fireEvent("collapse",this,t,i,e.rowIndex)}}});Ext.preg("rowexpander",Ext.ux.grid.RowExpander);Ext.grid.RowExpander=Ext.ux.grid.RowExpander;"use strict";Ext.ns("SM");SM.SelectingGridToolbar=Ext.extend(Ext.Toolbar,{initComponent:function(){this.filterField=new Ext.form.TriggerField({id:this.triggerId||undefined,toolbar:this,hidden:true,triggerClass:"x-form-clear-trigger",onTriggerClick:function(){this.triggerBlur();this.blur();this.setValue("");this.toolbar.filterFn.call(Ext.getCmp(this.toolbar.gridId),"",!this.toolbar.button.pressed)},width:200,submitValue:false,enableKeyEvents:true,emptyText:this.triggerEmptyText,listeners:{keyup:function(e,t){this.toolbar.filterFn.call(Ext.getCmp(this.toolbar.gridId),this.getValue(),this.toolbar.button.pressed);return false}}});this.separator=new Ext.Toolbar.Separator({hidden:true});this.button=new Ext.Button({id:this.btnId||undefined,icon:"img/tick_white.png",toolbar:this,text:this.btnText||"Select items",style:{marginRight:"10px"},tooltip:this.btnTooltipText||"Select items",toggleGroup:"record-selector",enableToggle:true,allowDepress:true,toggleHandler:function(e,t){if(t){this.toolbar.filterField.show();this.toolbar.separator.show()}else{this.toolbar.filterField.setValue("");this.toolbar.filterField.hide();this.toolbar.separator.hide()}this.toolbar.filterFn.call(Ext.getCmp(this.toolbar.gridId),this.toolbar.filterField.getValue(),this.pressed);Ext.getCmp(this.toolbar.gridId).onEditChange(t)}});let e=[{xtype:"tbfill"},this.filterField,{xtype:"tbseparator",hidden:true},this.button];this.appendItems=this.appendItems||[];this.prependItems=this.prependItems||[];let t=this.prependItems.concat(e).concat(this.appendItems);let i={items:t};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.SelectingGridToolbar.superclass.initComponent.call(this)}});Ext.reg("sm-sel-grid-toolbar",SM.SelectingGridToolbar);Ext.ns("SM");let doWoWindow;SM.NodeSorter=(e,t)=>{if(e.attributes.sortToTop){return-1}if(t.attributes.sortToTop){return 1}return e.text.toUpperCase()<t.text.toUpperCase()?-1:1};SM.CollectionNodeConfig=function(t){const e=async(i,s)=>{let r=s.stigs.map(e=>e.benchmarkId);let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s.collection.collectionId}`,method:"GET",params:{projection:"stigs"}});let t=JSON.parse(e.response.responseText).stigs;let n=t.map(e=>e.benchmarkId);let a=[];let o=[];for(let t of i.childNodes){if(n.includes(t.attributes.benchmarkId)){a.push(t.attributes.benchmarkId);if(t.isExpanded()){let e=t.findChild("assetId",s.assetId);stigIsMappedToAsset=r.includes(t.attributes.benchmarkId);if(stigIsMappedToAsset){if(e){if(e.attributes.text!==SM.he(s.name)){e.setText(SM.he(s.name));t.sort(SM.NodeSorter)}}else{t.appendChild(SM.StigAssetNodeConfig(t.attributes,s));t.sort(SM.NodeSorter)}}else{if(e){e.remove(true)}}}}else{o.push(t)}}for(let e of o){e.remove(true)}for(let e of t){if(!a.includes(e.benchmarkId)){i.appendChild(SM.StigNodeConfig(s.collection.collectionId,e));i.sort(SM.NodeSorter)}}};const i=async(e,i)=>{let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${i.collection.collectionId}`,method:"GET",params:{projection:"stigs"}});let s=JSON.parse(t.response.responseText).stigs;let r=s.map(e=>e.benchmarkId);let n=[];let a=[];for(let t of e.childNodes){if(r.includes(t.attributes.benchmarkId)){n.push(t.attributes.benchmarkId);if(t.isExpanded()){let e=t.findChild("assetId",i.assetId);if(e){e.remove(true)}}}else{a.push(t)}}for(let e of a){e.remove(true)}};let s=[];let r=[{id:`${t.collectionId}-findings-node`,text:"Findings",collectionId:t.collectionId,collectionName:t.name,iconCls:"sm-report-icon",action:"findings",leaf:true}];const n=curUser.collectionGrants.find(e=>e.collection.collectionId===t.collectionId);if(n&&n.accessLevel>=3){s.push({id:`${t.collectionId}-pkgconfig-node`,text:"Manage",collectionId:t.collectionId,collectionName:t.name,action:"collection-management",iconCls:"sm-setting-icon",leaf:true})}r.push({id:`${t.collectionId}-findings-status-node`,text:"Status",collectionId:t.collectionId,collectionName:t.name,action:"collection-status",iconCls:"sm-report-icon",leaf:true});s.push({id:`${t.collectionId}-stigs-node`,node:"stigs",text:"STIGs",iconCls:"sm-stig-icon",onAssetChanged:e,onAssetDeleted:i},{id:`${t.collectionId}-assets-node`,node:"assets",text:"Assets",iconCls:"sm-asset-icon"},{id:`${t.collectionId}-reports-node`,text:"Reports",collectionId:t.collectionId,collectionName:t.name,iconCls:"sm-report-icon",children:r});let a={id:`${t.collectionId}-collection-node`,node:"collection",text:SM.he(t.name),collectionId:t.collectionId,collectionName:t.name,iconCls:"sm-collection-icon",children:s};return a};SM.AssetNodeConfig=function(e,t){const i=(i,s)=>{let r=s.stigs.map(e=>e.benchmarkId);if(i.attributes.text!==SM.he(s.name)){i.setText(SM.he(s.name));i.parentNode.sort(SM.NodeSorter)}if(i.isExpanded()){let t=[];const n=[];for(let e of i.childNodes){if(!r.includes(e.attributes.benchmarkId)){n.push(e)}else{t.push(e.attributes.benchmarkId)}}for(let e of n){e.remove(true)}for(let e of s.stigs){if(!t.includes(e.benchmarkId)){i.appendChild(SM.AssetStigNodeConfig(s,e));i.sort(SM.NodeSorter)}}}};return{id:`${e}-${t.assetId}-assets-asset-node`,text:SM.he(t.name),name:t.name,report:"asset",collectionId:e,assetId:t.assetId,iconCls:"sm-asset-icon",qtip:SM.he(t.name),onAssetChanged:i}};SM.AssetStigNodeConfig=function(e,t){return{id:`${e.collection.collectionId}-${e.assetId}-${t.benchmarkId}-leaf`,text:SM.he(t.benchmarkId),leaf:true,report:"review",iconCls:"sm-stig-icon",stigName:t.benchmarkId,assetName:e.name,assetId:e.assetId,collectionId:e.collection.collectionId,workflow:e.collection.workflow,benchmarkId:t.benchmarkId,qtip:SM.he(t.title)}};SM.StigNodeConfig=function(e,t){return{collectionId:e,text:SM.he(t.benchmarkId),report:"stig",iconCls:"sm-stig-icon",id:`${e}-${t.benchmarkId}-stigs-stig-node`,benchmarkId:t.benchmarkId,qtip:SM.he(t.title)}};SM.StigAssetNodeConfig=function(e,t){return{id:`${t.collectionId}-${e.benchmarkId}-${t.assetId}-leaf`,text:SM.he(t.name),leaf:true,report:"review",iconCls:"sm-asset-icon",stigName:e.benchmarkId,assetName:t.name,assetId:t.assetId,collectionId:t.collectionId??t.collection?.collectionId,benchmarkId:e.benchmarkId,qtip:SM.he(t.name)}};SM.StigBatchNodeConfig=function(e,t){return{id:`${t}-batch-${e}-leaf`,sortToTop:true,text:"Collection review",collectionGrant:curUser.collectionGrants.find(e=>e.collection.collectionId===t).accessLevel,cls:"sm-tree-node-collection-review",leaf:true,report:"collection-review",iconCls:"sm-collection-icon",collectionId:t,benchmarkId:e,qtip:"Review multiple assets"}};SM.LibraryStigNodeConfig=function(e){return{id:`library-${e.benchmarkId}-leaf`,text:SM.he(e.benchmarkId),leaf:true,report:"library",iconCls:"sm-stig-icon",benchmarkId:e.benchmarkId,lastRevisionStr:e.lastRevisionStr,stigTitle:e.title,qtip:SM.he(e.title)}};SM.LibraryNodesConfig=function(e){const t=/^[a-e]/i;const i=/^[f-m]/i;const s=/^[n-v]/i;const r=/^[w-z]/i;const n=[{id:`library-a-e-folder`,text:"A-E",iconCls:"sm-folder-icon",children:e.filter(e=>t.test(e.benchmarkId)).map(e=>SM.LibraryStigNodeConfig(e))},{id:`library-f-m-folder`,text:"F-M",iconCls:"sm-folder-icon",children:e.filter(e=>i.test(e.benchmarkId)).map(e=>SM.LibraryStigNodeConfig(e))},{id:`library-n-v-folder`,text:"N-V",iconCls:"sm-folder-icon",children:e.filter(e=>s.test(e.benchmarkId)).map(e=>SM.LibraryStigNodeConfig(e))},{id:`library-w-z-folder`,text:"W-Z",iconCls:"sm-folder-icon",children:e.filter(e=>r.test(e.benchmarkId)).map(e=>SM.LibraryStigNodeConfig(e))}];return n};SM.AppNavTree=Ext.extend(Ext.tree.TreePanel,{initComponent:function(){let f=this;let e={autoScroll:true,split:true,collapsible:true,title:`<span onclick="window.oidcProvider.logout()">${curUser.display==="USER"?SM.he(curUser.username):SM.he(curUser.display)} - Logout</span>`,bodyStyle:"padding:5px;",width:f.width||300,minSize:220,root:{nodeType:"async",id:"stigman-root",expanded:true},rootVisible:false,loader:new Ext.tree.TreeLoader({directFn:f.loadTree}),loadMask:"Loading...",listeners:{click:f.treeClick,render:this.treeRender,collapsenode:function(e){e.loaded=false}}};this.onCollectionCreated=function(i,s){const e=curUser.collectionGrants.find(e=>e.collection.collectionId===i.collectionId);if(e){let e=f.getNodeById("collections-root");let t=e.appendChild(SM.CollectionNodeConfig(i));function r(e,t){if(e.attributes.id==="collection-create-leaf"){return-1}if(t.attributes.id==="collection-create-leaf"){return 1}if(e.text.toUpperCase()<t.text.toUpperCase()){return-1}if(e.text.toUpperCase()>t.text.toUpperCase()){return 1}return 0}e.sort(r);if(s.showManager){f.selectPath(`${t.getPath()}${f.pathSeparator}${t.attributes.children[0].id}`,undefined,(e,t)=>{if(e){t.getUI().elNode.click()}})}}};this.sortNodes=(e,t)=>e.text<t.text?-1:1;this.onAssetChanged=t=>{let i=f.getNodeById(`${t.collection.collectionId}-assets-node`);if(i&&i.isExpanded()){let e=i.findChild("assetId",t.assetId);if(e){e.attributes.onAssetChanged(e,t)}}let e=f.getNodeById(`${t.collection.collectionId}-stigs-node`);if(e&&e.isExpanded()){e.attributes.onAssetChanged(e,t)}};this.onAssetCreated=e=>{let t=f.getNodeById(`${e.collection.collectionId}-assets-node`,true);if(t&&t.isExpanded()){t.appendChild(SM.AssetNodeConfig(e.collection.collectionId,e));t.sort(SM.NodeSorter)}let i=f.getNodeById(`${e.collection.collectionId}-stigs-node`);if(i&&i.isExpanded()){i.attributes.onAssetChanged(i,e)}};this.onAssetDeleted=t=>{let i=f.getNodeById(`${t.collection.collectionId}-assets-node`,true);if(i&&i.isExpanded()){let e=i.findChild("assetId",t.assetId);if(e){e.remove(true)}}let e=f.getNodeById(`${t.collection.collectionId}-stigs-node`);if(e&&e.isExpanded()){e.attributes.onAssetDeleted(e,t)}};this.onCollectionChanged=function(i){if("name"in i){let e=f.getNodeById("collections-root");let t=e.findChild("id",`${i.collectionId}-collection-node`,true);if(t){t.setText(SM.he(i.name));t.collectionName=i.name;t.eachChild(e=>{if(e.attributes.collectionName){e.attributes.collectionName=i.name}})}function s(e,t){if(e.attributes.id==="collection-create-leaf"){return-1}if(t.attributes.id==="collection-create-leaf"){return 1}if(e.text.toUpperCase()<t.text.toUpperCase()){return-1}if(e.text.toUpperCase()>t.text.toUpperCase()){return 1}return 0}e.sort(s)}};this.onCollectionDeleted=function(e){let t=f.getNodeById("collections-root");let i=t.findChild("id",`${e}-collection-node`,true);if(i){i.remove()}};this.onStigAssetsChanged=async(i,s,r)=>{let n=r.map(e=>e.assetId);let a=await f.getApiStig(s);let e=f.getNodeById(`${i}-assets-node`);if(e&&e.isExpanded()){for(const l of e.childNodes){if(l.isExpanded()){let e=l.findChild("benchmarkId",s);if(n.includes(l.attributes.assetId)){if(!e){l.appendChild(SM.AssetStigNodeConfig({collection:{collectionId:l.attributes.collectionId},assetId:l.attributes.assetId,name:l.attributes.name},a));l.sort(SM.NodeSorter)}}else{if(e){e.remove(true)}}}}}let o=f.getNodeById(`${i}-stigs-node`);if(o&&o.isExpanded()){let t=f.getNodeById(`${i}-${s}-stigs-stig-node`);if(!t){o.appendChild(SM.StigNodeConfig(i,a));o.sort(SM.NodeSorter);return}if(n.length===0){if(t){t.remove(true);return}else{return}}if(t&&t.isExpanded()){const d=[];const c=[];for(const l of t.childNodes){if(!n.includes(l.attributes.assetId)){d.push(l)}else{c.push(l.attributes.assetId)}}for(let e of d){e.remove(true)}for(let e of r){if(!c.includes(e.assetId)){e.collection={collectionId:i};t.appendChild(SM.StigAssetNodeConfig(a,e))}}t.sort(SM.NodeSorter)}}};this.getApiStig=async t=>{try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${t}`,method:"GET"});return JSON.parse(e.response.responseText)}catch(e){alert(e.message)}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.AppNavTree.superclass.initComponent.call(this);SM.Dispatcher.addListener("collectioncreated",this.onCollectionCreated);SM.Dispatcher.addListener("collectionchanged",this.onCollectionChanged);SM.Dispatcher.addListener("collectiondeleted",this.onCollectionDeleted);SM.Dispatcher.addListener("assetchanged",this.onAssetChanged,f);SM.Dispatcher.addListener("assetcreated",this.onAssetCreated,f);SM.Dispatcher.addListener("assetdeleted",this.onAssetDeleted,f);SM.Dispatcher.addListener("stigassetschanged",this.onStigAssetsChanged,f)},loadTree:async function(t,a){try{let n,e;if(t=="stigman-root"){let e=[];if(curUser.privileges.canAdmin){e.push({id:`admin-root`,node:"admin",text:"Application Management",iconCls:"sm-setting-icon",expanded:true,children:[{id:"collection-admin",text:"Collections",leaf:true,iconCls:"sm-collection-icon"},{id:"user-admin",text:"User Grants",leaf:true,iconCls:"sm-users-icon"},{id:"stig-admin",text:"STIG and SCAP Benchmarks",leaf:true,iconCls:"sm-stig-icon"},{id:"appdata-admin",text:'Application Data <span class="sm-navtree-sprite">experimental</span>',leaf:true,iconCls:"sm-database-save-icon"}]})}e.push({id:`collections-root`,node:"collections",text:"Collections",iconCls:"sm-collection-icon",expanded:true});e.push({id:`library-root`,node:"library",text:"STIG Library",iconCls:"sm-library-icon",expanded:false});a(e,{status:true});return}if(t==="library-root"){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs`,method:"GET"});let t=JSON.parse(e.response.responseText);let i=SM.LibraryNodesConfig(t);a(i,{status:true});return}if(t==="collections-root"){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections`,method:"GET"});let t=JSON.parse(e.response.responseText);let i=t.map(e=>SM.CollectionNodeConfig(e));if(curUser.privileges.canCreateCollection){i.unshift({id:`collection-create-leaf`,action:"collection-create",text:"Create Collection...",cls:"sm-tree-node-create",iconCls:"sm-add-icon",qtip:"Create a new STIG Manager Collection",leaf:true})}a(i,{status:true});return}n=t.match(/^(\d+)-assets-node$/);if(n){let t=n[1];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${t}`,method:"GET",params:{projection:"assets"}});let i=JSON.parse(e.response.responseText);let s=i.assets.map(e=>SM.AssetNodeConfig(t,e));a(s,{status:true});return}n=t.match(/^(\d+)-(\d+)-assets-asset-node$/);if(n){let e=n[1];let t=n[2];let i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${t}`,method:"GET",params:{projection:"stigs"}});let s=JSON.parse(i.response.responseText);let r=s.stigs.map(e=>SM.AssetStigNodeConfig(s,e));a(r,{status:true});return}n=t.match(/^(\d+)-stigs-node$/);if(n){let t=n[1];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${t}`,method:"GET",params:{projection:"stigs"}});let i=JSON.parse(e.response.responseText);let s=i.stigs.map(e=>SM.StigNodeConfig(t,e));a(s,{status:true});return}n=t.match(/^(\d+)-(.*)-stigs-stig-node$/);if(n){let t=n[1];let i=n[2];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${t}/stigs/${i}/assets`,method:"GET"});let s=JSON.parse(e.response.responseText);let r=[];if(s.length>0){r.push(SM.StigBatchNodeConfig(i,t));let e=s.map(e=>SM.StigAssetNodeConfig({benchmarkId:i},e));r=r.concat(e)}a(r,{status:true});return}}catch(e){Ext.Msg.alert("Status","AJAX request failed in loadTree()")}},treeClick:function(s,e){let t;let i;if(!s.leaf){return}console.log(`in treeClick() with ${e.type}`);if(s.attributes.report=="library"){addLibraryStig({benchmarkId:s.attributes.benchmarkId,revisionStr:s.attributes.lastRevisionStr,stigTitle:s.attributes.stigTitle,treePath:s.getPath()})}if(s.attributes.report=="review"){t="-"+s.attributes.assetId+"-"+s.attributes.benchmarkId.replace(".","_");i=Ext.getCmp("main-tab-panel").getItem("reviewTab"+t);if(i){if(e.browserEvent.detail===2){i.makePermanent()}i.show()}else{addReview({leaf:s.attributes,treePath:s.getPath()})}}if(s.attributes.report=="collection-review"){t="-"+s.attributes.collectionId+"-"+s.attributes.benchmarkId.replace(".","_");i=Ext.getCmp("main-tab-panel").getItem("collection-review-tab"+t);if(i){if(e.browserEvent.detail===2){i.makePermanent()}i.show()}else{addCollectionReview({leaf:s.attributes,treePath:s.getPath()})}}if(s.attributes.action=="findings"){i=Ext.getCmp("main-tab-panel").getItem("findingsTab-"+s.attributes.collectionId);if(i){if(e.browserEvent.detail===2){i.makePermanent()}i.show()}else{addFindingsSummary({collectionId:s.attributes.collectionId,collectionName:s.attributes.collectionName,treePath:s.getPath()})}}if(s.attributes.action=="collection-create"){let e=s.parentNode;let t=new SM.Collection.CreateForm({btnText:"Create",btnHandler:async()=>{try{let e=t.getForm().getFieldValues();await addOrUpdateCollection(0,e,{elevate:false,showManager:true})}catch(e){alert(e.message)}finally{i.close()}}});t.getForm().setValues({grants:[{user:{userId:curUser.userId,username:curUser.username},accessLevel:4}]});let i=new Ext.Window({id:"window-project-info",cls:"sm-dialog-window sm-round-panel",title:"Create Collection",modal:true,width:460,height:560,layout:"fit",plain:false,buttonAlign:"right",items:t});i.show(document.body)}if(s.attributes.action=="collection-management"){addCollectionManager({collectionId:s.attributes.collectionId,collectionName:s.attributes.collectionName,treePath:s.getPath()})}if(s.attributes.action=="collection-status"){i=Ext.getCmp("main-tab-panel").getItem("completionTab-"+s.attributes.collectionId);if(i){if(e.browserEvent.detail===2){i.makePermanent()}i.show()}else{addCompletionStatus({collectionId:s.attributes.collectionId,collectionName:s.attributes.collectionName,treePath:s.getPath()})}}switch(s.id){case"collection-admin":addCollectionAdmin({treePath:s.getPath()});break;case"user-admin":addUserAdmin({treePath:s.getPath()});break;case"stig-admin":addStigAdmin({treePath:s.getPath()});break;case"appdata-admin":addAppDataAdmin({treePath:s.getPath()});break;case"wo-admin":r();break}function r(){let e=400;let t=400;let i=window.innerWidth/2-e/2;let s=window.innerHeight/2-t/2;doWoWindow=window.open(window.oidcProvider.createLoginUrl({scope:"stig-manager"}),"doWo",`top=${s},left=${i},width=${e},height=${t},resizeable,scrollbars,status`);let r=doWoWindow}},treeRender:function(e){new Ext.ToolTip({target:e.header,showDelay:2e3,dismissDelay:0,autoWidth:true,title:"OAuth2 token payload",listeners:{show:function(e){let t={...window.oidcProvider.tokenParsed};let i=new Date(t.exp*1e3);let s=new Date(t.iat*1e3);let r=new Date(t.auth_time*1e3);t.exp=`${t.exp} (${i.format("Y-m-d H:i:s")})`;t.iat=`${t.iat} (${s.format("Y-m-d H:i:s")})`;t.auth_time=`${t.auth_time} (${r.format("Y-m-d H:i:s")})`;e.update("<pre>"+JSON.stringify(t,null,2)+"</pre>")}}}).getId()}});"use strict";Ext.ns("SM");SM.RowEditorToolbar=Ext.extend(Ext.Toolbar,{initComponent:function(){this.newButton=new SM.RowEditorNewBtn({toolbar:this,itemString:this.itemString,title:this.newTitle,editor:this.editor,gridId:this.gridId,newRecord:this.newRecord});this.delButton=new SM.RowEditorDelBtn({itemString:this.itemString,title:this.deleteTitle,deleteProperty:this.deleteProperty,editor:this.editor,gridId:this.gridId,disabled:true});let e={newRecordValues:this.newRecordValues||{},items:[{xtype:"tbspacer"},this.newButton,"-",this.delButton]};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.RowEditorToolbar.superclass.initComponent.call(this)}});Ext.reg("sm-row-editor-toolbar",SM.RowEditorToolbar);SM.RowEditorNewBtn=Ext.extend(Ext.Button,{initComponent:function(){let e={iconCls:"icon-add",text:this.title??`New ${this.itemString}`,handler:this.btnHandler};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.RowEditorNewBtn.superclass.initComponent.call(this)},btnHandler:function(e,t){this.grid=Ext.getCmp(this.gridId);this.editor.stopEditing(false);this.grid.store.suspendEvents(false);let i=new this.newRecord({...this.toolbar.newRecordValues});i.editing=true;this.grid.store.insert(0,i);this.grid.store.resumeEvents();this.grid.getView().refresh();this.grid.getSelectionModel().selectRow(0);this.editor.startEditing(0)}});Ext.reg("sm-new-button",SM.RowEditorNewBtn);SM.RowEditorDelBtn=Ext.extend(Ext.Button,{initComponent:function(){let e={iconCls:"icon-del",text:this.title??`Delete ${this.itemString}`,itemString:this.itemString,deleteProperty:this.deleteProperty,handler:this.btnHandler};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.RowEditorDelBtn.superclass.initComponent.call(this)},btnHandler:function(e,t){this.grid=Ext.getCmp(this.gridId);this.editor.stopEditing();let i=this.grid.getSelectionModel().getSelections();let s=i[0].data[this.deleteProperty];Ext.Msg.show({title:`Delete ${this.itemString}?`,store:this.grid.store,record:i[0],msg:`You are about to delete ${this.itemString} "${SM.he(s)}". Do you wish to continue?`,buttons:Ext.Msg.YESNO,fn:function(e,t,i){if(e==="ok"||e==="yes"){i.store.remove(i.record)}},icon:Ext.MessageBox.QUESTION})}});Ext.reg("sm-del-button",SM.RowEditorDelBtn);"use strict";async function addOrUpdateCollection(n,a,o){try{let e,t;if(n){e=`${STIGMAN.Env.apiBase}/collections/${n}?elevate=${o.elevate}`;t="PUT"}else{e=`${STIGMAN.Env.apiBase}/collections?elevate=${o.elevate}`,t="POST"}let i=await Ext.Ajax.requestPromise({url:e,method:t,headers:{"Content-Type":"application/json;charset=utf-8"},params:{projection:["owners","statistics"]},jsonData:a});let s=JSON.parse(i.response.responseText);await SM.GetUserObject();let r=n?"collectionchanged":"collectioncreated";SM.Dispatcher.fireEvent(r,s,o)}catch(e){alert(e.message)}}"use strict";Ext.ns("SM");Ext.ns("SM.Collection");SM.WorkflowComboBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false};let t=this;let i=[["emass","RMF Package"],["continuous","Continuous"]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){t.setValue(t.value)});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.WorkflowComboBox.superclass.initComponent.call(this);this.store.loadData(i)}});Ext.reg("sm-workflow-combo",SM.WorkflowComboBox);SM.CollectionDescriptionTextArea=Ext.extend(Ext.form.TextArea,{initComponent:function(){const e=this;const t={cls:"sm-review-result-textarea",lastSavedData:"",allowBlank:true,fieldLabel:"Description",labelSeparator:"",autoScroll:"auto",enableKeyEvents:true};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.CollectionDescriptionTextArea.superclass.initComponent.call(this)}});SM.AccessLevelStrings=["Undefined","Restricted","Full","Manage","Owner"];SM.AccessLevelField=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let t=this;let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false,validator:e=>{if(t.grid.editor.editing==false){return true}if(e===""){return"Blank values no allowed"}}};let i=[[1,SM.AccessLevelStrings[1]],[2,SM.AccessLevelStrings[2]],[3,SM.AccessLevelStrings[3]],[4,SM.AccessLevelStrings[4]]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){t.setValue(e.getAt(0).get("value"))});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.AccessLevelField.superclass.initComponent.call(this);this.store.loadData(i)}});Ext.reg("sm-accesslevel-field",SM.AccessLevelField);SM.MetadataGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const i=this;let e=["key","value"];let t=["key","value"];let s=Ext.data.Record.create(e);this.newRecordConstructor=Ext.data.Record.create(t);this.editor=new Ext.ux.grid.RowEditor({saveText:"Save",grid:this,clicksToEdit:2,errorSummary:false,listeners:{canceledit:function(e,t){if(e.record.editing===true){this.grid.store.suspendEvents(false);this.grid.store.remove(e.record);this.grid.store.resumeEvents();this.grid.getView().refresh()}},afteredit:function(e,t,i,s){let r=i.store.data;let n=i.id;i.id=i.data.key;i.phantom=false;delete r.map[n];r.map[i.id]=i;for(let e=0,t=r.keys.length;e<t;e++){if(r.keys[e]===n){r.keys[e]=i.id}}e.grid.fireEvent("metadatachanged",e.grid)}}});this.totalTextCmp=new Ext.Toolbar.TextItem({text:"0 records",width:80});let r=new Ext.data.DataWriter;let n=new SM.RowEditorToolbar({itemString:"key",editor:this.editor,gridId:this.id,deleteProperty:"key",newRecord:this.newRecordConstructor});n.delButton.disable();let a={isFormField:true,ignoreKeys:i.ignoreKeys||[],allowBlank:true,layout:"fit",height:150,border:true,plugins:[this.editor],style:{},listeners:{},store:new Ext.data.ArrayStore({grid:this,writer:r,autoSave:false,fields:s,sortInfo:{field:"key",direction:"ASC"},root:"",restful:true,idProperty:"key",listeners:{remove:(e,t,i)=>{e.grid.fireEvent("metadatachanged",e.grid)}}}),view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true}),sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{selectionchange:function(e){n.delButton.setDisabled(!e.hasSelection())}}}),cm:new Ext.grid.ColumnModel({columns:[{header:"Key",dataIndex:"key",sortable:true,width:150,editor:new Ext.form.TextField({grid:this,submitValue:false,validator:function(e){if(this.grid.editor.editing==false){return true}if(e===""){return"Blank values no allowed"}let t=this.grid.store.findExact("key",e);let i=this.grid.selModel.isSelected(t);if(t==-1||i){return true}else{return"Duplicate keys not allowed"}}})},{header:"Value",dataIndex:"value",sortable:false,width:250,editor:new Ext.form.TextField({submitValue:false})}]}),tbar:n,getValue:function(){let t={};this.store.data.items.forEach(e=>{t[e.data.key]=e.data.value});return t},markInvalid:function(){},clearInvalid:function(){},isValid:function(){return true},disabled:false,getName:function(){return this.name},validate:function(){return true},setValue:function(e){const t=i.ignoreKeys.length?Object.entries(e).filter(e=>!i.ignoreKeys.includes(e[0])):Object.entries(e);this.store.loadData(t)}};Ext.apply(this,Ext.apply(this.initialConfig,a));SM.MetadataGrid.superclass.initComponent.call(this)}});Ext.reg("sm-metadata-grid",SM.MetadataGrid);SM.UserSelectionField=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let t=this;const e=new Ext.data.JsonStore({fields:[{name:"userId",type:"string"},{name:"username",type:"string"}],autoLoad:true,url:`${STIGMAN.Env.apiBase}/users`,root:"",sortInfo:{field:"username",direction:"ASC"},idProperty:"userId"});const i={store:e,filteringStore:this.filteringStore||null,displayField:"username",valueField:"userId",mode:"local",forceSelection:true,typeAhead:true,minChars:0,hideTrigger:false,triggerAction:"all",lastQuery:"",validator:e=>{if(t.grid.editor.editing==false){return true}if(e===""){return"Blank values no allowed"}},doQuery:function(e,t){e=Ext.isEmpty(e)?"":e;var i={query:e,forceAll:t,combo:this,cancel:false};if(this.fireEvent("beforequery",i)===false||i.cancel){return false}e=i.query;t=i.forceAll;if(t===true||e.length>=this.minChars){if(this.lastQuery!==e){this.lastQuery=e;if(this.mode=="local"){this.selectedIndex=-1;if(t){this.store.clearFilter()}else{this.store.filter(this.displayField,e,false,false)}this.onLoad()}else{this.store.baseParams[this.queryParam]=e;this.store.load({params:this.getParams(e)});this.expand()}}else{this.selectedIndex=-1;this.onLoad()}}},listeners:{afterrender:e=>{e.getEl().dom.setAttribute("spellcheck","false")},expand:i=>{if(i.filteringStore){i.store.filterBy(function(e,t){return i.filteringStore.indexOfId(t)===-1})}}}};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.UserSelectionField.superclass.initComponent.call(this)}});Ext.reg("sm-user-selection-field",SM.UserSelectionField);SM.UserGrantsGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const a=this;const e=[{name:"userId"},{name:"username"},{name:"accessLevel"}];this.newRecordConstructor=Ext.data.Record.create(e);const s=new Ext.Toolbar.TextItem({text:"0 records",width:80});this.proxy=new Ext.data.HttpProxy({restful:true,url:this.url,headers:{"Content-Type":"application/json;charset=utf-8"},listeners:{exception:function(e,t,i,s,r,n){let a;if(r.responseText){a=r.responseText}else{a="Unknown error"}Ext.Msg.alert("Error",a)}}});const i=new Ext.data.JsonStore({grid:this,proxy:this.proxy,baseParams:this.baseParams,root:"",fields:e,idProperty:"userId",sortInfo:{field:"username",direction:"ASC"},listeners:{load:function(e,t){s.setText(t.length+" records")},remove:function(e,t,i){s.setText(e.getCount()+" records");e.grid.fireEvent("grantschanged",e.grid)}}});const t=new SM.UserSelectionField({submitValue:false,grid:this,filteringStore:i});const r=new SM.AccessLevelField({submitValue:false,grid:this});const n=[{header:"Username",width:150,dataIndex:"username",sortable:true,editor:t},{header:"Access Level",width:100,dataIndex:"accessLevel",sortable:true,renderer:e=>SM.AccessLevelStrings[e],editor:r}];this.editor=new Ext.ux.grid.RowEditor({saveText:"Save",grid:this,userSelectionField:t,accessLevelField:r,clicksToEdit:2,errorSummary:false,listeners:{validateedit:function(i,s,e,t){if(s.hasOwnProperty("username")){let e=i.userSelectionField;let t=e.store.getAt(e.selectedIndex);s.username=t.data.username;s.userId=t.data.userId}},canceledit:function(e,t){if(e.record.editing===true){this.grid.store.suspendEvents(false);this.grid.store.remove(e.record);this.grid.store.resumeEvents();this.grid.getView().refresh()}},afteredit:function(e,t,i,s){let r=i.store.data;let n=i.id;i.id=i.data.userId;i.phantom=false;i.dirty=false;delete r.map[n];r.map[i.id]=i;for(let e=0,t=r.keys.length;e<t;e++){if(r.keys[e]===n){r.keys[e]=i.id}}if(a.showAccessBtn){a.accessBtn.setDisabled(i.data.accessLevel!=1)}e.grid.fireEvent("grantschanged",e.grid)}}});const o=new SM.RowEditorToolbar({itemString:"Grant",editor:this.editor,gridId:this.id,deleteProperty:"userId",newRecord:this.newRecordConstructor});if(this.showAccessBtn){o.addSeparator();this.accessBtn=o.addButton({iconCls:"sm-asset-icon",disabled:true,text:"User access...",handler:function(){var e=a.getSelectionModel().getSelected();Ext.getBody().mask("Getting access list for "+e.get("username")+"...");showUserAccess(a.collectionId,e.get("userId"))}})}const l={isFormField:true,name:"grants",allowBlank:false,layout:"fit",height:150,plugins:[this.editor],store:i,cm:new Ext.grid.ColumnModel({columns:n}),sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{rowselect:function(e,t,i){if(a.showAccessBtn){a.accessBtn.setDisabled(i.data.accessLevel!=1)}},selectionchange:function(e){o.delButton.setDisabled(!e.hasSelection())}}}),view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,markDirty:false}),listeners:{},tbar:o,getValue:function(){let t=[];i.data.items.forEach(e=>{t.push({userId:e.data.userId,accessLevel:e.data.accessLevel})});return t},setValue:function(e){const t=e.map(e=>({userId:e.user.userId,username:e.user.username,accessLevel:e.accessLevel}));i.loadData(t)},validator:function(e){let t=1},markInvalid:function(){let e=1},clearInvalid:function(){let e=1},isValid:function(){const e=a.getValue();const t=e.filter(e=>e.accessLevel===4);return t.length>0},getName:()=>this.name,validate:function(){let e=1}};Ext.apply(this,Ext.apply(this.initialConfig,l));SM.UserGrantsGrid.superclass.initComponent.call(this)}});Ext.reg("sm-user-grants-grid",SM.UserGrantsGrid);SM.Collection.CreateForm=Ext.extend(Ext.form.FormPanel,{initComponent:function(){const e=this;const r=new Ext.form.TextField({fieldLabel:"Name",labelStyle:"font-weight: 600;",name:"name",allowBlank:false,anchor:"100%",enableKeyEvents:true,keys:[{key:Ext.EventObject.ENTER,fn:(e,t,i)=>{let s=e;r.getEl().blur()}}],listeners:{specialkey:(e,t)=>{if(t.getKey()==t.ENTER){e.getEl().blur()}},change:async(e,t,i)=>{if(!t?.trim()){e.setValue(i);return}}}});const t=new Ext.form.TextArea({fieldLabel:"Description",labelStyle:"font-weight: 600;",name:"description",anchor:"100% 0"});const i=new SM.MetadataGrid({title:"Metadata",iconCls:"sm-database-save-icon",name:"metadata",ignoreKeys:["fieldSettings","statusSettings"],anchor:"100% 0",border:true});const s=new SM.Collection.FieldSettings.ReviewFields({iconCls:"sm-stig-icon",border:true,autoHeight:true});const n=new SM.Collection.StatusSettings.StatusFields({iconCls:"sm-star-icon-16",border:true,autoHeight:true});const a=new SM.UserGrantsGrid({iconCls:"sm-users-icon",showAccessBtn:false,title:"Grants",border:true});let o={baseCls:"x-plain",cls:"sm-collection-manage-layout sm-round-panel",bodyStyle:"padding: 9px;",border:false,labelWidth:100,monitorValid:true,setFieldValues:function(e){r.setValue(e.name);t.setValue(e.description);i.setValue(e.metadata);if(e.metadata.fieldSettings){s.setValues(JSON.parse(e.metadata.fieldSettings))}if(e.metadata.statusSettings){n.setValues(JSON.parse(e.metadata.statusSettings))}a.setValue(e.grants)},getFieldValues:function(t){let i={},s,r,n;this.items.each(function(e){if(e.submitValue!==false&&!e.disabled&&(t!==true||e.isDirty())){s=e.getName();r=i[s];n=e.getValue();if(Ext.isDefined(r)){if(Ext.isArray(r)){i[s].push(n)}else{i[s]=[r,n]}}else{i[s]=n}}});e.serializeFieldSettings(i);e.serializeStatusSettings(i);return i},items:[{layout:"border",anchor:"100% 0",hideLabels:true,border:false,baseCls:"x-plain",items:[{layoutConfig:{getLayoutTargetSize:function(){var e=this.container.getLayoutTarget(),t={};if(e){t=e.getViewSize();if(Ext.isIE9m&&Ext.isStrict&&t.width==0){t=e.getStyleSize()}t.width-=e.getPadding("lr");t.height-=e.getPadding("tb");t.height-=30}return t}},xtype:"fieldset",region:"north",height:180,split:false,title:"Information",items:[r,t]},{xtype:"hidden",name:"workflow",value:"emass"},{xtype:"tabpanel",style:{paddingTop:"10px"},region:"center",activeTab:0,border:false,items:[a,{xtype:"panel",title:"Settings",layout:"form",iconCls:"sm-setting-icon",border:true,padding:10,items:[s,n]},i]}]}],buttons:[{text:this.btnText||"Save",formBind:true,handler:this.btnHandler||function(){}}]};Ext.apply(this,Ext.apply(this.initialConfig,o));SM.Collection.CreateForm.superclass.initComponent.call(this)},serializeFieldSettings:function(e){const t=["commentEnabled","commentRequired","detailEnabled","detailRequired"];const i={};for(const s of t){i[s]=e[s];delete e[s]}if(e.metadata){e.metadata.fieldSettings=JSON.stringify(i)}else{e.metadata={fieldSettings:JSON.stringify(i)}}},serializeStatusSettings:function(e){const t=["canAccept","minGrant","resetCriteria"];const i={};for(const s of t){i[s]=e[s];delete e[s]}if(e.metadata){e.metadata.statusSettings=JSON.stringify(i)}else{e.metadata={statusSettings:JSON.stringify(i)}}}});SM.Collection.ManagePanel=Ext.extend(Ext.form.FormPanel,{initComponent:function(){let r=this;async function s(e,t){const i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.collectionId}/metadata/keys/${e}`,method:"PUT",jsonData:JSON.stringify(t)});return i.response.responseText?JSON.parse(i.response.responseText):""}async function n(e){const t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.collectionId}/metadata/keys/${e}`,method:"GET"});return t.response.responseText?JSON.parse(t.response.responseText):null}const a=new Ext.form.TextField({fieldLabel:"Name",labelStyle:"font-weight: 600;",value:r.apiCollection?.name,name:"name",allowBlank:false,anchor:"100%",enableKeyEvents:true,keys:[{key:Ext.EventObject.ENTER,fn:(e,t,i)=>{let s=e;a.getEl().blur()}}],listeners:{specialkey:(e,t)=>{if(t.getKey()==t.ENTER){e.getEl().blur()}},change:async(t,i,s)=>{if(!i?.trim()){t.setValue(s);return}try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.collectionId}`,method:"PATCH",jsonData:{name:i.trim()}});let t=JSON.parse(e.response.responseText);SM.Dispatcher.fireEvent("collectionchanged",t)}catch(e){alert("Name update failed");t.setValue(s)}}}});const e=new Ext.Button({iconCls:"sm-trash-icon",width:25,template:new Ext.Template('<table id="{4}" cellspacing="0" class="x-btn {3}"><tbody class="{1}">','<tr><td class="x-btn-tl" style="background-image:none;"><i>&#160;</i></td><td class="x-btn-tc" style="background-image:none;"></td><td class="x-btn-tr" style="background-image:none;"><i>&#160;</i></td></tr>','<tr><td class="x-btn-ml" style="background-image:none;"><i>&#160;</i></td><td class="x-btn-mc" style="background-image:none;"><em class="{2} x-unselectable" unselectable="on"><button type="{0}"></button></em></td><td class="x-btn-mr" style="background-image:none;"><i>&#160;</i></td></tr>','<tr><td class="x-btn-bl" style="background-image:none;"><i>&#160;</i></td><td class="x-btn-bc" style="background-image:none;"></td><td class="x-btn-br" style="background-image:none;"><i>&#160;</i></td></tr>',"</tbody></table>"),border:false,handler:async function(){try{var e="Deleting this Collection will <b>permanently remove</b> all data associated with the Collection. This includes all Assets and their associated assessments. The deleted data <b>cannot be recovered</b>.<br><br>Do you wish to delete the Collection?";Ext.Msg.confirm("Confirm",e,async function(e,t){if(e=="yes"){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.collectionId}`,method:"DELETE"});let t=JSON.parse(e.response.responseText);SM.Dispatcher.fireEvent("collectiondeleted",t.collectionId)}})}catch(e){alert(e.mes)}}});const t=new Ext.form.TextArea({fieldLabel:"Description",labelStyle:"font-weight: 600;",value:r.apiCollection?.description,name:"description",anchor:"100% 0",listeners:{change:async(t,e,i)=>{try{await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.collectionId}`,method:"PATCH",jsonData:{description:e.trim()}})}catch(e){alert("Description update failed");t.setValue(i)}}}});const i=new SM.MetadataGrid({title:"Metadata",iconCls:"sm-database-save-icon",name:"metadata",ignoreKeys:["fieldSettings","statusSettings"],anchor:"100% 0",border:true,listeners:{metadatachanged:async i=>{try{let e=i.getValue();let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.collectionId}/metadata`,method:"PATCH",jsonData:e});const s=i.store.getSortState();i.store.sort([s])}catch(e){alert("Metadata save failed")}}}});i.setValue(r.apiCollection.metadata);const o=new SM.Collection.FieldSettings.ReviewFields({iconCls:"sm-stig-icon",fieldSettings:JSON.parse(r.apiCollection?.metadata?.fieldSettings??null),border:true,autoHeight:true,onFieldSelect:async function(t){try{const e=t.serialize();await s("fieldSettings",JSON.stringify(e));SM.Dispatcher.fireEvent("fieldsettingschanged",r.apiCollection.collectionId,e)}catch(e){alert(e.message);try{const i=await n("fieldSettings");t.setValues(JSON.parse(i))}catch(e){alert(e.message)}}}});const l=new SM.Collection.StatusSettings.StatusFields({iconCls:"sm-star-icon-16",statusSettings:JSON.parse(r.apiCollection?.metadata?.statusSettings??null),border:true,autoHeight:true,onFieldsUpdate:async function(t){try{const e=t.serialize();await s("statusSettings",JSON.stringify(e));SM.Dispatcher.fireEvent("statussettingschanged",r.apiCollection.collectionId,e)}catch(e){alert(e.message);try{const i=await n("statusSettings");t.setValues(JSON.parse(i))}catch(e){alert(e.message)}}}});let d=a;if(this.allowDelete){a.flex=1;d={xtype:"compositefield",labelStyle:"font-weight: 600;",items:[a,e]}}const c=new SM.UserGrantsGrid({collectionId:r.apiCollection.collectionId,iconCls:"sm-users-icon",showAccessBtn:true,url:`${STIGMAN.Env.apiBase}/collections/${r.apiCollection.collectionId}`,baseParams:{projection:"grants"},title:"Grants",border:true,listeners:{grantschanged:async s=>{try{let e=s.getValue();let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r.apiCollection.collectionId}?projection=grants`,method:"PATCH",jsonData:{grants:e}});let i=JSON.parse(t.response.responseText);s.setValue(i.grants)}catch(e){alert("Grants save failed")}}}});c.getStore().loadData(r.apiCollection.grants.map(e=>({userId:e.user.userId,username:e.user.username,accessLevel:e.accessLevel})));let f={title:this.title||"Collection properties",layout:"form",cls:"sm-collection-manage-layout sm-round-panel",labelWidth:100,padding:15,getFieldValues:function(t){let i={},s,r,n;this.items.each(function(e){if(e.submitValue!==false&&!e.disabled&&(t!==true||e.isDirty())){s=e.getName();r=i[s];n=e.getValue();if(Ext.isDefined(r)){if(Ext.isArray(r)){i[s].push(n)}else{i[s]=[r,n]}}else{i[s]=n}}});return i},items:[{layout:"border",anchor:"100% 0",hideLabels:true,border:false,baseCls:"x-plain",items:[{layoutConfig:{getLayoutTargetSize:function(){var e=this.container.getLayoutTarget(),t={};if(e){t=e.getViewSize();if(Ext.isIE9m&&Ext.isStrict&&t.width==0){t=e.getStyleSize()}t.width-=e.getPadding("lr");t.height-=e.getPadding("tb");t.height-=30}return t}},xtype:"fieldset",region:"north",height:200,split:true,title:"Information",items:[d,t]},{xtype:"tabpanel",style:{paddingTop:"10px"},region:"center",activeTab:0,border:false,items:[c,{xtype:"panel",title:"Settings",layout:"form",iconCls:"sm-setting-icon",border:true,padding:10,items:[o,l]},i]}]}]};Ext.apply(this,Ext.apply(this.initialConfig,f));SM.Collection.ManagePanel.superclass.initComponent.call(this)}});Ext.reg("sm-collection-panel",SM.Collection.ManagePanel);Ext.ns("SM.Collection.FieldSettings");SM.Collection.FieldSettings.FieldActiveComboBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false};let t=this;let i=[["always","Always"],["findings","Findings only"]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){t.setValue(t.value)});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Collection.FieldSettings.FieldActiveComboBox.superclass.initComponent.call(this);this.store.loadData(i)}});Ext.reg("sm-field-active-combo",SM.Collection.FieldSettings.FieldActiveComboBox);SM.Collection.FieldSettings.FieldRequiredComboBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let i=this;let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false};let s=[["always","Always"],["findings","Findings only"],["optional","Optional"]];let r=[["findings","Findings only"],["optional","Optional"]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){i.setValue(i.value)});this.setListByEnabledValue=function(e){const t=i.value||"always";if(e==="findings"){i.store.loadData(r);if(t==="always"){i.setValue("findings")}else{i.setValue(t)}}else{i.store.loadData(s);i.setValue(t)}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Collection.FieldSettings.FieldRequiredComboBox.superclass.initComponent.call(this);this.setListByEnabledValue(this.enabledField?.value||"always")}});Ext.reg("sm-field-required-combo",SM.Collection.FieldSettings.FieldRequiredComboBox);SM.Collection.FieldSettings.ReviewFields=Ext.extend(Ext.form.FieldSet,{initComponent:function(){const s=this;s.fieldSettings=s.fieldSettings??{detailEnabled:"always",detailRequired:"always",commentEnabled:"findings",commentRequired:"findings"};const r=new SM.Collection.FieldSettings.FieldActiveComboBox({name:"detailEnabled",value:s.fieldSettings.detailEnabled,anchor:"-10",listeners:{select:e}});const n=new SM.Collection.FieldSettings.FieldRequiredComboBox({name:"detailRequired",enabledField:r,value:s.fieldSettings.detailRequired,anchor:"100%",listeners:{select:e}});r.requiredField=n;const a=new SM.Collection.FieldSettings.FieldActiveComboBox({name:"commentEnabled",value:s.fieldSettings.commentEnabled,anchor:"-10",listeners:{select:e}});const o=new SM.Collection.FieldSettings.FieldRequiredComboBox({name:"commentRequired",enabledField:a,value:s.fieldSettings.commentRequired,anchor:"100%",listeners:{select:e}});a.requiredField=o;s.serialize=function(){const e={};const t=[r,n,a,o];for(const i of t){e[i.name]=i.value}return e};s.setValues=function(e){r.setValue(e.detailEnabled);n.setValue(e.detailRequired);a.setValue(e.commentEnabled);o.setValue(e.commentRequired)};function e(e,t,i){if(e.name==="detailEnabled"||e.name==="commentEnabled"){e.requiredField.setListByEnabledValue(e.value)}s.onFieldSelect&&s.onFieldSelect(s,e,t,i)}let t={title:s.title||"Review fields",labelWidth:0,hideLabels:true,items:[{layout:"column",baseCls:"x-plain",items:[{columnWidth:.34,layout:"form",hideLabels:true,border:false,items:[{xtype:"displayfield",submitValue:false,value:'<span style="font-weight: 600;">Field</span>'},{xtype:"displayfield",submitValue:false,value:"Detail",height:22},{xtype:"displayfield",submitValue:false,value:"Comment",height:22}]},{columnWidth:.33,border:false,hideLabels:true,layout:"form",items:[{xtype:"displayfield",submitValue:false,value:'<span style="font-weight: 600;">Enabled</span>'},r,a]},{columnWidth:.33,layout:"form",hideLabels:true,border:false,items:[{xtype:"displayfield",submitValue:false,value:'<span style="font-weight: 600;">Required to submit</span>'},n,o]}]}]};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.Collection.FieldSettings.ReviewFields.superclass.initComponent.call(this)}});Ext.reg("sm-collection-settings-review-fields",SM.Collection.FieldSettings.ReviewFields);Ext.ns("SM.Collection.StatusSettings");SM.Collection.StatusSettings.AcceptCheckbox=Ext.extend(Ext.form.Checkbox,{initComponent:function(){const e=this;const t={boxLabel:this.boxLabel||"Accept or Reject reviews"};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.Collection.StatusSettings.AcceptCheckbox.superclass.initComponent.call(this)}});SM.Collection.StatusSettings.GrantComboBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false};let t=this;let i=[[3,"Manage or Owner"],[4,"Owner"]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){t.setValue(t.value)});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Collection.StatusSettings.GrantComboBox.superclass.initComponent.call(this);this.store.loadData(i)}});SM.Collection.StatusSettings.CriteriaComboBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false};let t=this;let i=[["result","Review result"],["any","any Review field"]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){t.setValue(t.value)});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Collection.StatusSettings.CriteriaComboBox.superclass.initComponent.call(this);this.store.loadData(i)}});SM.Collection.StatusSettings.StatusFields=Ext.extend(Ext.form.FieldSet,{initComponent:function(){const s=this;s.statusSettings=s.statusSettings??{canAccept:true,minGrant:3,resetCriteria:"result"};const r=new SM.Collection.StatusSettings.AcceptCheckbox({name:"canAccept",ctCls:"sm-cb",hideLabel:true,boxLabel:"Reviews can be Accepted or Rejected",checked:s.statusSettings.canAccept,listeners:{check:e}});const n=new SM.Collection.StatusSettings.GrantComboBox({name:"minGrant",fieldLabel:'<span style="padding-left: 18px;">Grant required to set Accept or Reject</span>',disabled:!s.statusSettings.canAccept,width:125,value:s.statusSettings.minGrant||3,listeners:{select:t}});const a=new SM.Collection.StatusSettings.CriteriaComboBox({name:"resetCriteria",fieldLabel:'Reset to <img src="img/disk-16.png" width=12 height=12 ext:qtip="Saved" style="padding: 1px 3px 0px 0px;vertical-align:text-top;"/>Saved upon change to',width:125,value:s.statusSettings.resetCriteria||"result",listeners:{select:t}});s.serialize=function(){const e={};const t=[a,r,n];for(const i of t){e[i.name]=i.getValue()}return e};s.setValues=function(e){a.setValue(e.resetCriteria||"result");r.setValue(e.canAccept||false);n.setValue(e.minGrant||3);n.setDisabled(!e.canAccept)};function e(e,t){n.setDisabled(!t);s.onFieldsUpdate&&s.onFieldsUpdate(s,e,t)}function t(e,t,i){s.onFieldsUpdate&&s.onFieldsUpdate(s,e,t)}let i={title:s.title||"Review status",labelWidth:220,items:[a,r,n]};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.Collection.StatusSettings.StatusFields.superclass.initComponent.call(this)}});"use strict";Ext.ns("SM");SM.CollectionAssetGrid=Ext.extend(Ext.grid.GridPanel,{onAssetChangedOrCreated:function(e){if(e.collection.collectionId===this.collectionId){this.store.loadData(e,true);const t=this.store.getSortState();this.store.sort(t.field,t.direction)}},initComponent:function(){const o=this;const e=Ext.id();const t=Ext.data.Record.create([{name:"assetId",type:"string"},{name:"name",type:"string"},{name:"fqdn",type:"string"},{name:"description",type:"string"},{name:"ip",type:"string"},{name:"mac",type:"string"},{name:"noncomputing",type:"boolean"},{name:"ruleCount",type:"integer",mapping:"statusStats.ruleCount"},{name:"stigCount",type:"integer",mapping:"statusStats.stigCount"},{name:"savedPct",convert:(e,t)=>t.statusStats.ruleCount?(t.statusStats.savedCount+t.statusStats.submittedCount+t.statusStats.acceptedCount+t.statusStats.rejectedCount)/t.statusStats.ruleCount*100:0},{name:"submittedPct",convert:(e,t)=>t.statusStats.ruleCount?(t.statusStats.submittedCount+t.statusStats.acceptedCount+t.statusStats.rejectedCount)/t.statusStats.ruleCount*100:0},{name:"acceptedPct",convert:(e,t)=>t.statusStats.ruleCount?t.statusStats.acceptedCount/t.statusStats.ruleCount*100:0},{name:"rejectedPct",convert:(e,t)=>t.statusStats.ruleCount?t.statusStats.rejectedCount/t.statusStats.ruleCount*100:0},{name:"stigUnassignedCount",type:"integer",convert:(e,t)=>t.statusStats.stigCount-t.statusStats.stigAssignedCount},{name:"minTs",type:"date",mapping:"statusStats.minTs"},{name:"maxTs",type:"date",mapping:"statusStats.maxTs"},{name:"metadata"}]);this.proxy=new Ext.data.HttpProxy({restful:true,url:this.url,headers:{"Content-Type":"application/json;charset=utf-8"},listeners:{exception:function(e,t,i,s,r,n){let a;if(r.responseText){a=r.responseText}else{a="Unknown error"}Ext.Msg.alert("Error",a)}}});const s=new Ext.data.JsonStore({grid:this,smMaskDelay:250,proxy:this.proxy,baseParams:{collectionId:this.collectionId,projection:["statusStats"]},root:"",fields:t,idProperty:"assetId",sortInfo:{field:"name",direction:"ASC"}});o.totalTextCmp=new SM.RowCountTextItem({store:s});const i=[{header:"Asset",width:100,dataIndex:"name",sortable:true,filter:{type:"string"}},{header:"FQDN",width:100,dataIndex:"fqdn",sortable:true,hidden:true,renderer:SM.styledEmptyRenderer,filter:{type:"string"}},{header:"IP",fixed:true,width:100,dataIndex:"ip",sortable:true,renderer:SM.styledEmptyRenderer},{header:"MAC",hidden:true,fixed:true,width:110,dataIndex:"mac",sortable:true,renderer:SM.styledEmptyRenderer,filter:{type:"string"}},{header:"STIGs",width:50,fixed:true,dataIndex:"stigCount",align:"center",tooltip:"Total STIGs Assigned",sortable:true},{header:"Checks",width:50,fixed:true,dataIndex:"ruleCount",align:"center",sortable:true},{header:"Oldest",width:50,fixed:true,dataIndex:"minTs",align:"center",sortable:true,renderer:renderDurationToNow},{header:"Newest",width:50,fixed:true,dataIndex:"maxTs",align:"center",sortable:true,renderer:renderDurationToNow},{header:"Reviewed",width:100,fixed:true,dataIndex:"savedPct",align:"center",sortable:true,renderer:renderPct},{header:"Submitted",width:100,fixed:true,dataIndex:"submittedPct",align:"center",sortable:true,renderer:renderPct},{header:"Accepted",width:100,fixed:true,dataIndex:"acceptedPct",align:"center",sortable:true,renderer:renderPct},{header:"Rejected",width:100,fixed:true,dataIndex:"rejectedPct",align:"center",sortable:true,renderer:renderPctAllHigh}];const n=new Ext.Button({iconCls:"sm-export-icon",text:"Export CKLs...",disabled:true,handler:function(){showExportCklFiles(o.collectionId,o.collectionName,"asset",o.getSelectionModel().getSelections().map(e=>e.data))}});const a=new Ext.Button({iconCls:"icon-del",text:"Delete...",disabled:true,handler:async function(){try{let s=o.getSelectionModel().getSelections();const i=s.length>1;var t=`Deleting ${i?"<b>multiple assets</b>":"this asset"} will <b>permanently remove</b> all data associated with the asset${i?"s":""}. This includes all the corresponding STIG assessments. The deleted data <b>cannot be recovered</b>.<br><br>Do you wish to continue?`;let e=await SM.confirmPromise("Confirm Delete",t);if(e=="yes"){const r=s.length;for(let i=0;i<r;i++){Ext.getBody().mask(`Deleting ${i+1}/${r} Assets`);const n=o.store.getById(s[i].id);let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${n.data.assetId}`,method:"DELETE"});let t=JSON.parse(e.response.responseText);o.store.remove(n);SM.Dispatcher.fireEvent("assetdeleted",t)}}}catch(e){alert(e.stack)}finally{Ext.getBody().unmask()}}});const l=new SM.TransferAssets.TransferBtn({iconCls:"sm-collection-icon",disabled:true,srcCollectionId:o.collectionId,text:"Transfer To",onItemClick:async function(s){try{const r=s.parentMenu.srcAssets;const t=r?.length>1;var e=`Transfering ${t?"these assets":"this asset"} to ${s.text} will <b>transfer all data</b> associated with the asset${t?"s":""}. This includes all the corresponding STIG assessments.<br><br>Do you wish to continue?`;const i=await SM.confirmPromise("Confirm transfer",e);if(i=="yes"){const n=r?.length||0;for(let i=0;i<n;i++){Ext.getBody().mask(`Transferring ${i+1}/${n} Assets`);const a=o.store.getById(r[i].assetId);let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${a.data.assetId}`,method:"PATCH",params:{projection:["stigs","statusStats"]},jsonData:{collectionId:s.collectionId}});let t=JSON.parse(e.response.responseText);o.store.remove(a);SM.Dispatcher.fireEvent("assetdeleted",{...t,...{collection:{collectionId:o.collectionId}}});SM.Dispatcher.fireEvent("assetcreated",t)}}}catch(e){alert(e.stack)}finally{Ext.getBody().unmask()}},handler:function(e){const t=o.getSelectionModel().getSelections();e.setSrcAssets(t.map(e=>e.data))}});const d=new Ext.Button({iconCls:"sm-asset-icon",disabled:true,text:"Properties...",handler:function(){var e=o.getSelectionModel().getSelected();Ext.getBody().mask("Getting properties...");showAssetProps(e.get("assetId"),o.collectionId)}});const r={layout:"fit",loadMask:true,store:s,cm:new Ext.grid.ColumnModel({columns:i}),sm:new Ext.grid.RowSelectionModel({singleSelect:false,listeners:{selectionchange:function(e){d.setDisabled(e.getCount()!==1);const t=e.hasSelection();let i=false;if(t){const s=e.getSelections();i=s.some(e=>e.data.stigCount>0)}for(const r of[a,l]){r.setDisabled(!t)}n.setDisabled(!(t&&i))}}}),view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,listeners:{filterschanged:function(e,t,i){s.filter(e.getFilterFns())}}}),listeners:{rowdblclick:function(e,t,i){var s=e.getStore().getAt(t);Ext.getBody().mask("Getting properties...");showAssetProps(s.get("assetId"),o.collectionId)},beforedestroy:function(e){SM.Dispatcher.removeListener("assetchanged",o.onAssetChangedOrCreated,o);SM.Dispatcher.removeListener("assetcreated",o.onAssetChangedOrCreated,o)}},tbar:new Ext.Toolbar({items:[{iconCls:"icon-add",text:"Create...",handler:function(){showAssetProps(null,o.collectionId)}},"-",{iconCls:"sm-import-icon",text:"Import CKL or SCAP...",handler:function(){showImportResultFiles(o.collectionId,{fieldSettings:o.apiFieldSettings})}},"-",n,"-",a,"-",l,"-",d]}),bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",grid:this,iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){const t=e.grid.store.smMaskDelay;e.grid.store.smMaskDelay=0;e.grid.store.reload();e.grid.store.smMaskDelay=t}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,gridBasename:"Assets (grid)",storeBasename:"Assets (store)",iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},this.totalTextCmp]})};Ext.apply(this,Ext.apply(this.initialConfig,r));SM.CollectionAssetGrid.superclass.initComponent.call(this);SM.Dispatcher.addListener("assetchanged",this.onAssetChangedOrCreated,this);SM.Dispatcher.addListener("assetcreated",this.onAssetChangedOrCreated,this)}});Ext.reg("sm-collection-asset-grid",SM.CollectionAssetGrid);SM.StigSelectionField=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let s=this;let e=new Ext.data.JsonStore({fields:[{name:"benchmarkId",type:"string"},{name:"title",type:"string"},{name:"lastRevisionStr",type:"string"},{name:"lastRevisionDate",type:"string"},{name:"ruleCount",type:"integer"}],autoLoad:this.autoLoad,url:this.url||`${STIGMAN.Env.apiBase}/stigs`,root:this.root||"",sortInfo:{field:"benchmarkId",direction:"ASC"},idProperty:"benchmarkId",listeners:{load:(t,e,i)=>{if(s.includeAllItem){t.suspendEvents();let e={benchmarkId:s.includeAllItem};t.loadData(s.root?{[s.root]:e}:{allRecord:e},true);t.sort("benchmarkId","ASC");t.resumeEvents()}}}});let t={store:e,filteringStore:this.filteringStore||null,displayField:"benchmarkId",valueField:"benchmarkId",mode:"local",forceSelection:true,typeAhead:true,minChars:0,triggerAction:this.triggerAction||"query",listeners:{afterrender:e=>{e.getEl().dom.setAttribute("spellcheck","false")}},doQuery:(t,e)=>{t=Ext.isEmpty(t)?"":t;var i={query:t,forceAll:e,combo:this,cancel:false};if(this.fireEvent("beforequery",i)===false||i.cancel){return false}t=i.query;e=i.forceAll;if(e===true||t.length>=this.minChars){if(this.mode=="local"){this.selectedIndex=-1;if(e){this.store.clearFilter()}else{let e=[];if(this.filteringStore){e.push({fn:e=>this.filteringStore.indexOfId(e.id)===-1,scope:this})}if(t){e.push({property:this.displayField,value:t})}this.store.filter(e)}this.onLoad()}else{this.store.baseParams[this.queryParam]=t;this.store.load({params:this.getParams(t)});this.expand()}}},validator:e=>{if(s.grid&&s.grid.editor&&!s.grid.editor.editing){return true}if(e===""){return"Blank values not allowed"}}};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.StigSelectionField.superclass.initComponent.call(this)}});Ext.reg("sm-stig-selection-field",SM.StigSelectionField);SM.AssetStigsGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const e=[{name:"benchmarkId",type:"string"},{name:"ruleCount",type:"integer"}];this.newRecordConstructor=Ext.data.Record.create(e);const s=new Ext.data.JsonStore({grid:this,root:"",fields:e,idProperty:"benchmarkId",sortInfo:{field:"benchmarkId",direction:"ASC"}});const t=new SM.StigSelectionField({submitValue:false,autoLoad:true,grid:this,filteringStore:s});const i=[{header:"BenchmarkId",width:375,dataIndex:"benchmarkId",sortable:true,editor:t,filter:{type:"string"}},{header:"Rules",width:125,dataIndex:"ruleCount",align:"center",sortable:true}];this.editor=new Ext.ux.grid.RowEditor({saveText:"OK",grid:this,stigSelectionField:t,clicksToEdit:2,onRowDblClick:Ext.emptyFn,errorSummary:false,listeners:{canceledit:function(e,t){if(e.record.editing===true){this.grid.store.suspendEvents(false);this.grid.store.remove(e.record);this.grid.store.resumeEvents();this.grid.getView().refresh()}},validateedit:function(e,t,i,s){let r=e.items.items[0];t.ruleCount=r.store.getAt(r.selectedIndex).data.ruleCount},afteredit:function(e,t,i,s){let r=i.store.data;let n=i.id;i.id=i.data.benchmarkId;i.phantom=false;i.dirty=false;delete r.map[n];r.map[i.id]=i;for(let e=0,t=r.keys.length;e<t;e++){if(r.keys[e]===n){r.keys[e]=i.id}}e.removeAll(false);e.initialized=false}}});let r=new SM.RowEditorToolbar({itemString:"STIG",newTitle:"Assign STIG",deleteTitle:"Unassign STIG",editor:this.editor,gridId:this.id,deleteProperty:"benchmarkId",newRecord:this.newRecordConstructor});r.delButton.disable();let n={isFormField:true,submitValue:true,allowBlank:false,forceSelection:true,layout:"fit",plugins:[this.editor],border:true,store:s,cm:new Ext.grid.ColumnModel({columns:i}),sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{selectionchange:function(e){r.delButton.setDisabled(!e.hasSelection())}}}),view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,markDirty:false,listeners:{filterschanged:function(e,t,i){s.filter(e.getFilterFns())}}}),listeners:{},tbar:r,getValue:function(){let t=[];s.data.items.forEach(e=>{t.push(e.data.benchmarkId)});return t},setValue:function(e){const t=e.map(e=>({benchmarkId:e.benchmarkId,ruleCount:e.ruleCount}));s.loadData(t)},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,isValid:()=>true,getName:()=>this.name,validate:()=>true};Ext.apply(this,Ext.apply(this.initialConfig,n));SM.AssetStigsGrid.superclass.initComponent.call(this)}});Ext.reg("sm-asset-stigs-grid",SM.AssetStigsGrid);SM.AssetProperties=Ext.extend(Ext.form.FormPanel,{initComponent:function(){this.stigGrid=new SM.AssetStigsGrid({name:"stigs"});if(!this.initialCollectionId){throw new Error("missing property initialCollectionId")}let e={baseCls:"x-plain",region:"south",labelWidth:70,monitorValid:true,trackResetOnLoad:true,items:[{xtype:"fieldset",title:"<b>Asset information</b>",items:[{layout:"column",baseCls:"x-plain",border:false,items:[{columnWidth:.4,layout:"form",padding:"0px 10px 0px 0px",border:false,items:[{xtype:"textfield",fieldLabel:"Name",anchor:"100%",emptyText:"Enter asset name...",allowBlank:false,name:"name"}]},{columnWidth:.6,layout:"form",border:false,items:[{xtype:"textfield",fieldLabel:"Description",anchor:"100%",emptyText:"Enter asset description...",allowBlank:true,name:"description"}]}]},{layout:"column",baseCls:"x-plain",border:false,items:[{columnWidth:.5,layout:"form",padding:"0px 10px 0px 0px",border:false,items:[{xtype:"textfield",anchor:"100%",fieldLabel:"FQDN",emptyText:"Enter FQDN",allowBlank:true,name:"fqdn"}]},{columnWidth:.25,layout:"form",border:false,padding:"0px 10px 0px 0px",labelWidth:20,items:[{xtype:"textfield",fieldLabel:"IP",anchor:"100%",emptyText:"Enter IP",allowBlank:true,name:"ip"}]},{columnWidth:.25,layout:"form",border:false,labelWidth:30,items:[{xtype:"textfield",fieldLabel:"MAC",anchor:"100%",emptyText:"Enter MAC",allowBlank:true,name:"mac"}]}]},{xtype:"checkbox",name:"noncomputing",hideLabel:false,checked:false,boxLabel:"Non-computing"},{xtype:"sm-metadata-grid",submitValue:true,fieldLabel:"Metadata",name:"metadata",anchor:"100%"},{xtype:"hidden",name:"collectionId",value:this.initialCollectionId}]},{xtype:"fieldset",title:"<b>STIG Assignments</b>",anchor:"100% -260",layout:"fit",items:[this.stigGrid]}],buttons:[{text:this.btnText||"Save",formBind:true,handler:this.btnHandler||Ext.emptyFn}]};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.AssetProperties.superclass.initComponent.call(this);this.getForm().getFieldValues=function(t,i){var s={},r,n,a;this.items.each(function(e){if(e.submitValue&&(!e.disabled||i)&&(t!==true||e.isDirty())){r=e.getName();n=s[r];a=e.getValue();if(Ext.isDefined(n)){if(Ext.isArray(n)){s[r].push(a)}else{s[r]=[n,a]}}else{s[r]=a}}});return s}}});async function showAssetProps(o,e){try{let a=new SM.AssetProperties({id:"dev-test",padding:"10px 15px 10px 15px",initialCollectionId:e,btnHandler:async function(){try{if(a.getForm().isValid()){let e=a.getForm().getFieldValues(false,true);delete e.undefined;let t=o?"PUT":"POST";let i=o?`${STIGMAN.Env.apiBase}/assets/${o}`:`${STIGMAN.Env.apiBase}/assets`;let s=await Ext.Ajax.requestPromise({url:i,method:t,params:{projection:["stigs","statusStats"]},headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:e});const r=JSON.parse(s.response.responseText);const n=o?"assetchanged":"assetcreated";SM.Dispatcher.fireEvent(n,r);l.close()}}catch(e){alert(e.message)}}});var l=new Ext.Window({id:"assetPropsWindow",cls:"sm-dialog-window sm-round-panel",title:o?"Asset Properties, ID "+o:"Create new Asset",modal:true,hidden:true,width:660,height:666,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"right",items:a});l.render(Ext.getBody());if(o){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${o}`,params:{projection:["stigs"]},method:"GET"});let t=JSON.parse(e.response.responseText);t.collectionId=t.collection.collectionId;delete t.collection;a.getForm().setValues(t)}Ext.getBody().unmask();l.show(document.body)}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}}"use strict";Ext.ns("SM");SM.CollectionStigsGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){let i=this;const e=Ext.id();let t=Ext.data.Record.create([{name:"benchmarkId",type:"string"},{name:"title",type:"string"},{name:"lastRevisionStr",type:"string"},{name:"lastRevisionDate",type:"string"},{name:"ruleCount",type:"integer"},{name:"assetCount",type:"integer"},{name:"minTs",type:"date"},{name:"maxTs",type:"date"},{name:"checkCount",type:"integer",convert:(e,t)=>t.ruleCount*t.assetCount},{name:"acceptedPct",type:"integer",convert:(e,t)=>t.acceptedCount/(t.ruleCount*t.assetCount)*100},{name:"rejectedPct",type:"integer",convert:(e,t)=>t.rejectedCount/(t.ruleCount*t.assetCount)*100},{name:"submittedPct",type:"integer",convert:(e,t)=>(t.rejectedCount+t.acceptedCount+t.submittedCount)/(t.ruleCount*t.assetCount)*100},{name:"savedPct",type:"integer",convert:(e,t)=>(t.rejectedCount+t.acceptedCount+t.submittedCount+t.savedCount)/(t.ruleCount*t.assetCount)*100}]);this.proxy=new Ext.data.HttpProxy({restful:true,url:this.url,headers:{"Content-Type":"application/json;charset=utf-8"},listeners:{exception:function(e,t,i,s,r,n){let a;if(r.responseText){a=r.responseText}else{a="Unknown error"}Ext.Msg.alert("Error",a)}}});let s=new Ext.data.JsonStore({grid:this,smMaskDelay:250,proxy:this.proxy,root:"",fields:t,idProperty:"benchmarkId",sortInfo:{field:"benchmarkId",direction:"ASC"}});i.totalTextCmp=new SM.RowCountTextItem({store:s});let r=[{header:"BenchmarkId",width:100,dataIndex:"benchmarkId",sortable:true,filter:{type:"string"}},{header:"Revision",width:50,dataIndex:"lastRevisionStr",align:"center",sortable:true},{header:"Date",width:50,dataIndex:"lastRevisionDate",align:"center",sortable:true},{header:"Rules",width:70,fixed:true,dataIndex:"ruleCount",align:"center",sortable:true},{header:"Assets",width:70,fixed:true,dataIndex:"assetCount",align:"center",sortable:true},{header:"Oldest",width:50,fixed:true,dataIndex:"minTs",align:"center",sortable:true,renderer:renderDurationToNow},{header:"Newest",width:50,fixed:true,dataIndex:"maxTs",align:"center",sortable:true,renderer:renderDurationToNow},{header:"Reviewed",width:100,fixed:true,dataIndex:"savedPct",align:"center",sortable:true,renderer:renderPct},{header:"Submitted",width:100,fixed:true,dataIndex:"submittedPct",align:"center",sortable:true,renderer:renderPct},{header:"Accepted",width:100,fixed:true,dataIndex:"acceptedPct",align:"center",sortable:true,renderer:renderPct},{header:"Rejected",width:100,fixed:true,dataIndex:"rejectedPct",align:"center",sortable:true,renderer:renderPctAllHigh}];const n=new Ext.Button({iconCls:"sm-export-icon",text:"Export CKLs...",disabled:true,handler:function(){showExportCklFiles(i.collectionId,i.collectionName,"stig",i.getSelectionModel().getSelections().map(e=>e.data))}});const a=new Ext.Button({iconCls:"sm-asset-icon",disabled:true,text:"Change STIG targets...",handler:function(){var e=i.getSelectionModel().getSelected();showCollectionStigProps(e.get("benchmarkId"),i)}});const o=new Ext.Button({iconCls:"icon-del",text:"Unassign STIG",disabled:true,handler:function(){try{var e="Removing this STIG will remove all related Asset assignments. If the STIG is added in the future, the assignments will need to be established again.";Ext.Msg.confirm("Confirm",e,async function(e,t){if(e=="yes"){let e=i.getSelectionModel().getSelected();await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${i.collectionId}/stigs/${e.data.benchmarkId}/assets`,method:"PUT",jsonData:[]});i.store.remove(e);SM.Dispatcher.fireEvent("stigassetschanged",i.collectionId,e.data.benchmarkId,[])}})}catch(e){alert("Error removing STIG mapping")}}});let l={layout:"fit",loadMask:true,store:s,cm:new Ext.grid.ColumnModel({columns:r}),sm:new Ext.grid.RowSelectionModel({singleSelect:false,listeners:{selectionchange:function(e){a.setDisabled(e.getCount()!==1);o.setDisabled(e.getCount()!==1);n.setDisabled(!e.hasSelection())}}}),view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,listeners:{filterschanged:function(e,t,i){s.filter(e.getFilterFns())}}}),listeners:{rowdblclick:{fn:function(e,t,i){var s=e.getStore().getAt(t);showCollectionStigProps(s.get("benchmarkId"),e)}}},tbar:new Ext.Toolbar({items:[{iconCls:"icon-add",text:"Assign STIG...",grid:i,handler:function(e){showCollectionStigProps(null,e.grid)}},"-",n,"-",o,"-",a]}),bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",grid:this,iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){const t=e.grid.store.smMaskDelay;e.grid.store.smMaskDelay=0;e.grid.store.reload();e.grid.store.smMaskDelay=t}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,gridBasename:"STIGs (grid)",storeBasename:"STIGs (store)",iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},this.totalTextCmp]})};Ext.apply(this,Ext.apply(this.initialConfig,l));SM.CollectionStigsGrid.superclass.initComponent.call(this)}});Ext.reg("sm-collection-stigs-grid",SM.CollectionStigsGrid);SM.StigAssetsGrid=Ext.extend(Ext.grid.GridPanel,{filterStore:function(){let e=!this.getTopToolbar().button.pressed;let t=this.getTopToolbar().filterField.getValue();let i=this.getSelectionModel();if(!t||t===""){if(e){this.store.filterBy(i.isSelected,i)}else{this.store.clearFilter()}}else{if(e){this.store.filter([{property:"name",value:t,anyMatch:true,caseSensitive:false},{fn:i.isSelected,scope:i}])}else{this.store.filter({property:"name",value:t,anyMatch:true,caseSensitive:false})}}},initComponent:function(){let e=new Ext.data.JsonReader({idProperty:"benchmarkId",root:"",fields:[{name:"assetId",type:"string"},{name:"name",type:"string"}]});let t=Ext.data.Record.create([{name:"assetId",type:"string"},{name:"name",type:"string"}]);let n=new Ext.data.JsonStore({url:`${STIGMAN.Env.apiBase}/assets`,baseParams:{elevate:curUser.privileges.canAdmin,collectionId:this.collectionId},grid:this,reader:e,autoLoad:false,restful:true,encode:false,idProperty:"assetId",sortInfo:{field:"name",direction:"ASC"},fields:t,listeners:{load:function(e,t){e.grid.filterStore.call(e.grid)}}});const i=new SM.RowCountTextItem({store:n});let s=new Ext.grid.CheckboxSelectionModel({checkOnly:true,listeners:{},onRefresh:function(){var e=this.grid.store,t;var i=this.getSelections();for(var s=0,r=i.length;s<r;s++){var n=i[s];if((t=e.indexOfId(n.id))!=-1){this.grid.view.addRowClass(t,this.grid.view.selectedRowClass)}}}});let r={isFormField:true,editingCls:"red-panel",editing:false,layout:"fit",store:n,listeners:{viewready:function(e){e.view.refresh()}},columns:[s,{header:"Asset",width:150,dataIndex:"name",sortable:true,renderer:function(e,t,i,s,r,n){return"<b>"+e+"</b>"}}],border:true,loadMask:true,stripeRows:true,sm:s,view:new SM.ColumnFilters.GridView({forceFit:true,emptyText:"No Assets to display",selectedRowClass:"x-grid3-row-selected-checkonly",listeners:{refresh:function(e){e.grid.getEl().unmask()}}}),onEditChange:function(e){this.view.selectedRowClass=e?"x-grid3-row-selected":"x-grid3-row-selected-checkonly";this.view.refresh();this.editing=e;this.fireEvent("mouseover")},tbar:new SM.SelectingGridToolbar({filterFn:this.filterStore,triggerEmptyText:"Name filter...",btnText:"Assign Assets",gridId:this.id}),bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",grid:this,iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){e.grid.store.reload()}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,gridBasename:"Assets (grid)",storeBasename:"Assets (store)",iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},i]}),getValue:function(){return JSON.parse(encodeSm(s,"assetId"))},setValue:function(e){let t=this.getSelectionModel();let i=e.map(e=>e.assetId);let s=[];for(let t=0;t<i.length;t++){let e=n.getById(i[t]);s.push(e)}this.store.clearFilter(true);let r=t.silent;t.silent=true;t.selectRecords(s);t.silent=r;this.filterStore.call(this)},markInvalid:function(){},clearInvalid:function(){},isValid:()=>{return this.getSelectionModel().getCount()>0},getName:()=>this.name,validate:()=>true};Ext.apply(this,Ext.apply(this.initialConfig,r));SM.StigAssetsGrid.superclass.initComponent.call(this)}});Ext.reg("sm-stig-assets-grid",SM.StigAssetsGrid);SM.CollectionStigProperties=Ext.extend(Ext.form.FormPanel,{initComponent:function(){let e=this;let t=Ext.id();this.stigAssetsGrid=new SM.StigAssetsGrid({name:"assets",benchmarkId:this.benchmarkId,collectionId:this.collectionId});if(!this.collectionId){throw"missing property collectionId"}let i;if(this.benchmarkId){i=new Ext.form.TextField({fieldLabel:"BenchmarkId",allowBlank:true,anchor:"100%",readOnly:true,name:"benchmarkId",value:this.benchmarkId})}else{i=new SM.StigSelectionField({name:"benchmarkId",submitValue:false,fieldLabel:"BenchmarkId",hideTrigger:false,anchor:"100%",autoLoad:true,allowBlank:false,filteringStore:this.stigFilteringStore})}let s={baseCls:"x-plain",labelWidth:80,monitorValid:true,trackResetOnLoad:true,items:[{xtype:"fieldset",title:"<b>STIG information</b>",items:[i]},{xtype:"fieldset",title:"<b>Asset Assignments</b>",anchor:"100% -70",layout:"fit",items:[this.stigAssetsGrid]}],buttons:[{text:this.btnText||"Save",collectionId:e.collectionId,formBind:true,handler:this.btnHandler||function(){}}]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.CollectionStigProperties.superclass.initComponent.call(this)},initPanel:async function(){try{await this.stigAssetsGrid.store.loadPromise()}catch(e){alert(e)}}});async function showCollectionStigProps(s,n){try{let t=n.collectionId;let r=new SM.CollectionStigProperties({collectionId:t,benchmarkId:s,stigFilteringStore:n.store,btnHandler:async function(s){try{if(r.getForm().isValid()){let e=r.getForm().getFieldValues(false,true);let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s.collectionId}/stigs/${e.benchmarkId}/assets`,method:"PUT",params:{elevate:curUser.privileges.canAdmin},headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:e.assets});const i=JSON.parse(t.response.responseText);n.getStore().reload();SM.Dispatcher.fireEvent("stigassetschanged",s.collectionId,e.benchmarkId,i);a.close()}}catch(e){alert(e.stack)}}});var a=new Ext.Window({title:"STIG Targets, Collection ID "+t,cls:"sm-dialog-window sm-round-panel",modal:true,hidden:true,width:510,height:660,layout:"fit",plain:true,bodyStyle:"padding:10px;",buttonAlign:"right",items:r});a.render(Ext.getBody());await r.initPanel();let i;if(s){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${t}/stigs/${s}/assets`,params:{elevate:curUser.privileges.canAdmin},method:"GET"});i=JSON.parse(e.response.responseText)}else{i=[]}r.getForm().setValues({benchmarkId:s,assets:i});a.show(document.body)}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}}"use strict";Ext.ns("SM");SM.CollectionSelectionField=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let t=this;this.proxy=new Ext.data.HttpProxy({restful:true,url:this.url||`${STIGMAN.Env.apiBase}/collections`,method:"GET",headers:{"Content-Type":"application/json;charset=utf-8"},listeners:{exception:function(e,t,i,s,r,n){let a;if(r.responseText){a=r.responseText}else{a="Unknown error"}Ext.Msg.alert("Error",a)}}});const e=new Ext.data.JsonStore({fields:[{name:"collectionId",type:"string"},{name:"name",type:"string"}],proxy:this.proxy,autoLoad:this.autoLoad,baseParams:{elevate:curUser.privileges.canAdmin},root:this.root||"",sortInfo:{field:"name",direction:"ASC"},idProperty:"collectionId"});const i={store:e,filteringStore:this.filteringStore||null,displayField:"name",valueField:"collectionId",mode:"local",forceSelection:true,allowBlank:true,typeAhead:true,minChars:0,hideTrigger:false,triggerAction:this.triggerAction||"query",lastQuery:"",validator:e=>{if(t.grid.editor.editing==false){return true}if(e===""){return"Blank values no allowed"}},doQuery:function(t,e){t=Ext.isEmpty(t)?"":t;var i={query:t,forceAll:e,combo:this,cancel:false};if(this.fireEvent("beforequery",i)===false||i.cancel){return false}t=i.query;e=i.forceAll;if(e===true||t.length>=this.minChars){if(this.mode=="local"){this.selectedIndex=-1;if(e){this.store.clearFilter()}else{let e=[];if(this.filteringStore){e.push({fn:e=>this.filteringStore.indexOfId(e.id)===-1,scope:this})}if(t){e.push({property:this.displayField,value:t})}this.store.filter(e)}this.onLoad()}else{this.store.baseParams[this.queryParam]=t;this.store.load({params:this.getParams(t)});this.expand()}}},listeners:{afterrender:e=>{e.getEl().dom.setAttribute("spellcheck","false")},expand:i=>{if(i.filteringStore){i.store.filterBy(function(e,t){return i.filteringStore.indexOfId(t)===-1})}}}};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.CollectionSelectionField.superclass.initComponent.call(this)}});Ext.reg("sm-collection-selection-field",SM.CollectionSelectionField);SM.CollectionGrantsGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const e=this;const t=[{name:"collectionId"},{name:"name"},{name:"accessLevel"}];this.newRecordConstructor=Ext.data.Record.create(t);const s=new Ext.Toolbar.TextItem({text:"0 records",width:80});this.proxy=new Ext.data.HttpProxy({restful:true,url:this.url,headers:{"Content-Type":"application/json;charset=utf-8"},listeners:{exception:function(e,t,i,s,r,n){let a;if(r.responseText){a=r.responseText}else{a="Unknown error"}Ext.Msg.alert("Error",a)}}});const i=new Ext.data.JsonStore({grid:this,proxy:this.proxy,baseParams:this.baseParams,root:"",fields:t,idProperty:"collectionId",sortInfo:{field:"name",direction:"ASC"},listeners:{load:function(e,t){s.setText(t.length+" records")},remove:function(e,t,i){s.setText(e.getCount()+" records");e.grid.fireEvent("grantschanged",e.grid)}}});const r=new SM.CollectionSelectionField({submitValue:false,grid:this,filteringStore:i,autoLoad:true});const n=new SM.AccessLevelField({submitValue:false,grid:this});const a=[{header:"Collection",width:150,dataIndex:"name",sortable:true,editor:r},{header:"Access Level",width:100,dataIndex:"accessLevel",sortable:true,renderer:e=>SM.AccessLevelStrings[e],editor:n}];this.editor=new Ext.ux.grid.RowEditor({saveText:"Save",grid:this,collectionSelectionField:r,accessLevelField:n,clicksToEdit:2,errorSummary:false,listeners:{validateedit:function(i,s,e,t){if(s.hasOwnProperty("name")){let e=i.collectionSelectionField;let t=e.store.getAt(e.selectedIndex);s.name=t.data.name;s.collectionId=t.data.collectionId}},canceledit:function(e,t){if(e.record.editing===true){this.grid.store.suspendEvents(false);this.grid.store.remove(e.record);this.grid.store.resumeEvents();this.grid.getView().refresh()}},afteredit:function(e,t,i,s){let r=i.store.data;let n=i.id;i.id=i.data.userId;i.phantom=false;i.dirty=false;delete r.map[n];r.map[i.id]=i;for(let e=0,t=r.keys.length;e<t;e++){if(r.keys[e]===n){r.keys[e]=i.id}}e.grid.fireEvent("grantschanged",e.grid)}}});const o={isFormField:true,submitValue:true,forceSelection:true,allowBlank:true,layout:"fit",height:150,plugins:[this.editor],store:i,cm:new Ext.grid.ColumnModel({columns:a}),sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{selectionchange:function(e){}}}),view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,markDirty:false}),listeners:{},tbar:new SM.RowEditorToolbar({itemString:"Grant",editor:this.editor,gridId:this.id,deleteProperty:"userId",newRecord:this.newRecordConstructor}),getValue:function(){let t=[];i.data.items.forEach(e=>{t.push({collectionId:e.data.collectionId,accessLevel:e.data.accessLevel})});return t},setValue:function(e){const t=e.map(e=>({collectionId:e.collection.collectionId,name:e.collection.name,accessLevel:e.accessLevel}));i.loadData(t)},markInvalid:function(){},clearInvalid:function(){},isValid:()=>true,getName:()=>this.name,validate:()=>true};Ext.apply(this,Ext.apply(this.initialConfig,o));SM.CollectionGrantsGrid.superclass.initComponent.call(this)}});Ext.reg("sm-collection-grants-grid",SM.CollectionGrantsGrid);SM.UserProperties=Ext.extend(Ext.form.FormPanel,{initComponent:function(){let e=this;this.colGrid=new SM.CollectionGrantsGrid({name:"collectionGrants"});const t=[{layout:"column",baseCls:"x-plain",border:false,items:[{columnWidth:.5,layout:"form",border:false,items:[{xtype:"textfield",fieldLabel:"Username",readOnly:true,anchor:"-20",name:"username"}]},{columnWidth:.5,layout:"form",border:false,items:[{xtype:"textfield",fieldLabel:"Name",readOnly:true,anchor:"100%",name:"name"}]}]},{xtype:"textfield",fieldLabel:"Email",anchor:"100%",readOnly:true,name:"email"},{fieldLabel:"Privileges",allowBlank:true,anchor:"100%",layout:"hbox",border:false,items:[{xtype:"checkbox",name:"canCreateCollection",boxLabel:"Create collection",flex:1,readOnly:true},{xtype:"checkbox",name:"canAdmin",checked:false,boxLabel:"Administrator",flex:1,readOnly:true}]},{xtype:"displayfield",allowBlank:true,style:"border: 1px solid #C1C1C1",fieldLabel:"Last Claims",autoScroll:true,border:true,name:"lastClaims",height:150,anchor:"100%",setValue:function(e){if(Object.keys(e).length===0&&e.constructor===Object){return}const t=JsonView.createTree(e);const i=this.getEl().dom;JsonView.render(t,i);JsonView.expandChildren(t)}}];const i=[{xtype:"textfield",fieldLabel:"Username",allowBlank:false,anchor:"100%",name:"username"}];let s={baseCls:"x-plain",region:"south",labelWidth:70,monitorValid:true,trackResetOnLoad:true,items:[{xtype:"fieldset",title:"<b>User information</b>",items:this.registeredUser?t:i},{xtype:"fieldset",title:"<b>Collection Grants</b>",height:270,layout:"fit",items:[this.colGrid]}],buttons:[{text:this.btnText||"Save",formBind:true,handler:this.btnHandler||function(){}}]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.UserProperties.superclass.initComponent.call(this);this.getForm().addListener("beforeadd",(e,t,i)=>{let s=t});this.getForm().getFieldValues=function(t,i){var s={},r,n,a;this.items.each(function(e){if(e.submitValue&&(!e.disabled||i)&&(t!==true||e.isDirty())){r=e.getName();n=s[r];a=e.getValue();if(Ext.isDefined(n)){if(Ext.isArray(n)){s[r].push(a)}else{s[r]=[n,a]}}else{s[r]=a}}});return s}}});async function showUserProps(l){try{let o=new SM.UserProperties({registeredUser:l,padding:"10px 15px 10px 15px",btnHandler:async function(){try{if(o.getForm().isValid()){let e=o.getForm().getFieldValues(false,true);let t={collectionGrants:e.collectionGrants};let i=l?"PATCH":"POST";let s=l?`${STIGMAN.Env.apiBase}/users/${l}`:`${STIGMAN.Env.apiBase}/users`;if(!l){t.username=e.username}let r=await Ext.Ajax.requestPromise({url:s,method:i,params:{elevate:curUser.privileges.canAdmin,projection:["collectionGrants","statistics"]},headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:t});const n=JSON.parse(r.response.responseText);const a=l?"userchanged":"usercreated";SM.Dispatcher.fireEvent(a,n);d.close()}}catch(e){alert(e.message)}}});var d=new Ext.Window({title:l?"User Grants, ID "+l:"Pre-register User Grants",cls:"sm-dialog-window sm-round-panel",modal:true,hidden:true,width:660,height:l?650:440,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"right",items:o});d.render(document.body);const s=new Function("obj","return obj?."+STIGMAN.Env.oauth.claims.privileges+" || [];");if(l){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/users/${l}`,params:{elevate:curUser.privileges.canAdmin,projection:["statistics","collectionGrants"]},method:"GET"});let t=JSON.parse(e.response.responseText);["iat","exp","auth_time"].forEach(e=>{if(t.statistics.lastClaims[e]){t.statistics.lastClaims[e]=new Date(t.statistics.lastClaims[e]*1e3)}});if(t.statistics.lastClaims.scope){t.statistics.lastClaims.scope=t.statistics.lastClaims.scope.split(" ")}let i={username:t.username,name:t.statistics.lastClaims?.[STIGMAN.Env.oauth.claims.name],email:t.statistics.lastClaims?.[STIGMAN.Env.oauth.claims.email],canCreateCollection:s(t.statistics.lastClaims).includes("create_collection"),canAdmin:s(t.statistics.lastClaims).includes("admin"),lastClaims:t.statistics.lastClaims,collectionGrants:t.collectionGrants||[]};o.getForm().setValues(i)}Ext.getBody().unmask();d.show(document.body)}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}}Ext.ns("SM.ColumnFilters");SM.ColumnFilters.GridView=Ext.extend(Ext.grid.GridView,{constructor:function(e){this.addEvents("filterschanged","columnfiltered","columnunfiltered");SM.ColumnFilters.GridView.superclass.constructor.call(this,e)},handleHdOver:function(e,t){var i=this.findHeaderCell(t);if(i&&!this.headersDisabled){var s=this.fly(i);this.activeHdRef=t;this.activeHdIndex=this.getCellIndex(i);this.activeHdRegion=s.getRegion();if(!this.isMenuDisabled(this.activeHdIndex,s)){s.addClass("x-grid3-hd-over");this.activeHdBtn=s.child(".x-grid3-hd-btn");if(this.activeHdBtn){this.activeHdBtn.dom.style.height=i.firstChild.offsetHeight-1+"px"}}}},handleHdDownOrig:function(e,t){if(Ext.fly(t).hasClass("x-grid3-hd-btn")){e.stopEvent();var i=this.cm,s=this.findHeaderCell(t),r=this.getCellIndex(s),n=i.isSortable(r),a=this.hmenu,o=a.items,l=this.headerMenuOpenCls,d;this.hdCtxIndex=r;Ext.fly(s).addClass(l);if(this.hideSortIcons){o.get("asc").setVisible(n);o.get("desc").setVisible(n);d=o.get("sortSep");if(d){d.setVisible(n)}}else{o.get("asc").setDisabled(!n);o.get("desc").setDisabled(!n)}a.on("hide",function(){Ext.fly(s).removeClass(l)},this,{single:true});a.show(t,"tl-bl?")}},handleHdDown:function(e,t){if(t.className=="x-grid3-hd-checker"){return}e.stopEvent();if(!this.lastHide||this.lastHide.getElapsed()>100){var i=this.cm,s=this.findHeaderCell(t),r=this.getCellIndex(s),n=i.isSortable(r),a=this.hmenu,o=a.items,l=this.headerMenuOpenCls,d;this.hdCtxIndex=r;Ext.fly(s).addClass(l);if(this.hideSortIcons){o.get("asc").setVisible(n);o.get("desc").setVisible(n);d=o.get("sortSep");if(d){d.setVisible(n)}}else{o.get("asc").setDisabled(!n);o.get("desc").setDisabled(!n)}a.on("hide",function(){Ext.fly(s).removeClass(l);this.lastHide=new Date},this,{single:true});a.showAt(e.xy)}},onDataChange:function(){SM.ColumnFilters.GridView.superclass.onDataChange.call(this);this.setColumnFilteredStyle()},setColumnFilteredStyle:function(){const t=this.cm.getColumnCount();for(let e=0;e<t;e++){const i=this.getHeaderCell(e);i.getElementsByTagName("a")[0].style.height=i.classList.contains("x-grid3-td-checker")?0:i.firstChild.offsetHeight-1+"px";if(this.cm.config[e].filtered){i.classList.add("sm-grid3-col-filtered")}else{i.classList.remove("sm-grid3-col-filtered")}}},getFilterFns:function(){const e=this.hmenu;const t=e.filterItems.stringItems;const i=e.filterItems.selectItems;const r={};const s=[];for(const n of t){const a=n.filter.dataIndex;const o=n.getValue();if(o){r[a]=o}}for(const l of i){if(!l.checked){const a=l.filter.dataIndex;r[a]=[];for(const d of l.valueItems){if(d.checked===true){r[a].push(d.filter.value)}}}}for(const a of Object.keys(r)){s.push({fn:function(e){const t=e.data[a];if(Array.isArray(r[a])){return r[a].includes(t)}else{const i=t.toLowerCase();const s=r[a].toLowerCase();return i.indexOf(s)>-1}}})}return s.length?s:null},onFilterChange:function(t,e){switch(t.filter.type){case"string":t.column.filtered=!!t.getValue();break;case"values":const i=this.hmenu.items.items;const s=i.filter(e=>e.filter?.type==="values"&&e.filter?.dataIndex===t.filter.dataIndex);const r=s.map(e=>e.checked);t.column.filtered=r.includes(false);break;case"selectall":t.column.filtered=!!!e;break}this.fireEvent("filterschanged",this,t,e)},afterRenderUI:function(){const h=this;const p=[];SM.ColumnFilters.GridView.superclass.afterRenderUI.call(this);const m=this.hmenu;m.filterItems={stringItems:[],selectItems:[]};m.keyNav=new Ext.KeyNav(document.body,{disabled:true});const n=m.addItem("-");const a=m.addItem({hideOnClick:false,activeClass:"",text:"FILTER",iconCls:"sm-menuitem-filter-icon",cls:"sm-menuitem-filter-label"});function r(e,t){const i={};for(const s of m.filterItems.selectItems){const r=s.filter.dataIndex;(i[r]=i[r]||[]).selectAllChecked=s.checked;for(const n of s.valueItems){if(n.checked&&!t){i[r].push(n.filter.value)}m.remove(n)}m.remove(s)}m.filterItems.selectItems=[];for(const a of p){if(t)a.filtered=false;const o=[];const l=new Set(e.map(e=>e.data[a.dataIndex]));const d=[...l].sort(a.filter.comparer);const c=i[a.dataIndex];for(const f of d){o.push({text:a.filter.renderer?a.filter.renderer(f):f?f:"<i>(No value)</i>",xtype:"menucheckitem",column:a,hideOnClick:false,checked:t?true:c?c.selectAllChecked||c.includes(f):false,filter:{dataIndex:a.dataIndex,type:"values",value:f},listeners:{checkchange:function(e,t){e.selectAllItem.onValueItemChanged();h.onFilterChange(e,t)}}})}const s=m.addItem({text:"<i>(Select All)</i>",xtype:"menucheckitem",column:a,hideOnClick:false,checked:t?true:c.selectAllChecked,filter:{dataIndex:a.dataIndex,type:"selectall"},valueItems:[],onValueItemChanged:function(){const e=this.valueItems.every(e=>e.checked);this.setChecked(e,true)},listeners:{checkchange:function(t,i){for(const e of t.valueItems){e.setChecked(i,true)}h.onFilterChange(t,i)}}});for(const u of o){u.selectAllItem=s;const n=m.addItem(u);s.valueItems.push(n)}m.filterItems.selectItems.push(s)}}this.grid.store.on("load",function(e,t,i){r(e.data.items,true);for(const s of m.filterItems.stringItems){s.setValue("");s.column.filtered=false}h.setColumnFilteredStyle()});this.grid.store.on("update",function(e,t){r(e.snapshot?e.snapshot.items:e.data.items,false)});m.on("beforeshow",function(e){const t=h.cm.config[h.hdCtxIndex].dataIndex;let i=false;for(const s of e.items.items){if(s.filter){const r=s.filter.dataIndex===t;if(r)i=true;s.setVisible(r)}}n.setVisible(i);a.setVisible(i)});for(const e of this.cm.config){switch(e.filter?.type){case"string":if(e.renderer){e.configRenderer=e.renderer;e.renderer=SM.ColumnFilters.Renderers.highlighterShim}const t=m.add(new SM.ColumnFilters.SearchTextField({emptyText:"Contains...",height:24,column:e,filter:{dataIndex:e.dataIndex,type:"string"},enableKeyEvents:true,hideParent:true,listeners:{input:function(e,t){h.onFilterChange(e,e.value)},keyup:function(e,t){const i=t.getKey();if(i==t.RETURN){t.stopEvent();m.hide(true)}}}}));m.filterItems.stringItems.push(t);break;case"values":console.log(`Column ${e.header} Type values `);p.push(e);break}}r(this.grid.store.data.items,true)}});SM.ColumnFilters.SearchTextField=Ext.extend(Ext.form.TextField,{initComponent:function(){const e={autoCreate:{tag:"input",type:"search",size:"20",autocomplete:"off"}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.ColumnFilters.SearchTextField.superclass.initComponent.call(this);this.addEvents("input")},initEvents:function(){SM.ColumnFilters.SearchTextField.superclass.initEvents.call(this);this.mon(this.el,{scope:this,input:this.onInput})},onInput:function(e){this.column.filter.value=this.getValue();this.fireEvent("input",this,e)}});SM.ColumnFilters.Scorers={severity:{low:2,medium:1,high:0}};SM.ColumnFilters.CompareFns={severity:(e,t)=>{return SM.ColumnFilters.Scorers.severity[e]-SM.ColumnFilters.Scorers.severity[t]}};SM.ColumnFilters.Renderers={result:function(e){if(!e)return"<i>(No value)</i>";return`<div class="sm-grid-result-sprite ${SM.RenderResult[e]?.css}">${SM.RenderResult[e]?.textDisa}</div>`},status:function(e){switch(e){case"saved":return'<img src="img/disk-16.png" width=12 height=12 class="sm-menuitem-status-icon">Saved';case"submitted":return'<img src="img/ready-16.png" width=12 height=12 class="sm-menuitem-status-icon">Submitted';case"rejected":return'<img src="img/rejected-16.png" width=12 height=12 class="sm-menuitem-status-icon">Rejected';case"accepted":return'<img src="img/star.svg" width=12 height=12 class="sm-menuitem-status-icon">Accepted';default:return"<i>(No value)</i>"}},severity:function(e){switch(e){case"high":return'<span class="sm-grid-sprite sm-severity-high">CAT 1</span>';case"medium":return'<span class="sm-grid-sprite sm-severity-medium">CAT 2</span>';case"low":return'<span class="sm-grid-sprite sm-severity-low">CAT 3</span>';case"mixed":return'<span class="sm-grid-sprite sm-severity-low">Mixed</span>';default:return'<span class="sm-grid-sprite sm-severity-low">U</span>'}},highlighterShim:function(e,t,i,s,r,n){if(this.filter?.type==="string"&&this.filter?.value){const a=new RegExp(SM.he(this.filter.value),"gi");e=e.replace(a,'<span class="sm-text-highlight">$&</span>')}return this.configRenderer?this.configRenderer.call(this,e,t,i,s,r,n):e}};Ext.ns("SM");SM.AggregatorCombo=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e=this;let t={width:70,forceSelection:true,editable:false,mode:"local",triggerAction:"all",displayField:"display",valueField:"aggregator",store:new Ext.data.SimpleStore({fields:["display","aggregator"],data:[["Group","groupId"],["Rule","ruleId"],["CCI","cci"]]})};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.AggregatorCombo.superclass.initComponent.call(this)}});Ext.reg("sm-aggregator-combo",SM.AggregatorCombo);SM.FindingsParentGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){let s=this;this.aggValue=this.aggValue||"groupId";this.stigAllValue="--- All Collection STIGs ---";this.stigValue=this.stigValue||this.stigAllValue;const i=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/collections/${this.panel.collectionId}/findings`,method:"GET"}),baseParams:{projection:"stigs"},sortInfo:{field:"assetCount",direction:"DESC"},root:"",fields:[{name:"severity",type:"string",sortType:sortSeverity},{name:"assetCount",type:"int"},{name:"stigs"},{name:"groupId",type:"string",sortType:sortGroupId},{name:"ruleId",type:"string"},{name:"title",type:"string"},{name:"cci",type:"string"},{name:"definition",type:"string"},{name:"apAcronym",type:"string"}],listeners:{load:function(e,t){c(s.aggValue)}}});const e=new SM.RowCountTextItem({store:i});const t=e=>{switch(e){case"high":return'<span class="sm-grid-sprite sm-severity-high">CAT 1</span>';case"medium":return'<span class="sm-grid-sprite sm-severity-medium">CAT 2</span>';case"low":return'<span class="sm-grid-sprite sm-severity-low">CAT 3</span>';case"mixed":return'<span class="sm-grid-sprite sm-severity-low">Mixed</span>';default:return'<span class="sm-grid-sprite sm-severity-low">U</span>'}};const r=new Ext.grid.ColumnModel([{header:"CAT",hidden:false,align:"center",width:60,dataIndex:"severity",sortable:true,renderer:t,filter:{type:"values",comparer:SM.ColumnFilters.CompareFns.severity,renderer:SM.ColumnFilters.Renderers.severity}},{header:"Group",hidden:false,width:80,dataIndex:"groupId",sortable:true,filter:{type:"string"}},{header:"Rule",hidden:true,width:80,dataIndex:"ruleId",sortable:true,filter:{type:"string"}},{header:"CCI",hidden:true,width:80,dataIndex:"cci",sortable:true,filter:{type:"string"}},{header:"AP Acronym",hidden:true,width:80,dataIndex:"apAcronym",sortable:true,filter:{type:"string"}},{header:"Title",hidden:false,width:270,dataIndex:"title",renderer:columnWrap,sortable:true,filter:{type:"string"}},{header:"Definition",hidden:true,width:135,dataIndex:"definition",renderer:columnWrap,sortable:true,filter:{type:"string"}},{header:"Assets",hidden:false,width:75,align:"center",dataIndex:"assetCount",sortable:true},{header:"STIGs",hidden:false,width:120,dataIndex:"stigs",renderer:e=>{return columnWrap(e.join("\n"))},sortable:true}]);const n=new SM.ColumnFilters.GridView({forceFit:true,emptyText:"No records found.",listeners:{filterschanged:function(e){i.filter(e.getFilterFns())}}});const a=new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{rowselect:(e,t,i)=>{s.panel.fireEvent("parentrowselect",e,t,i)}}});const o=new Ext.Toolbar({items:[{xtype:"tbtext",text:"Aggregator:"}," "," "," ",{xtype:"sm-aggregator-combo",value:this.aggValue,listeners:{select:function(e,t,i){s.aggValue=e.getValue();s.fireEvent("aggregatorchanged",s.aggValue)}}}," "," "," ",{xtype:"tbtext",text:"STIG:  "}," "," "," ",{xtype:"sm-stig-selection-field",url:`${STIGMAN.Env.apiBase}/collections/${this.panel.collectionId}?projection=stigs`,autoLoad:true,includeAllItem:this.stigAllValue,root:"stigs",width:250,triggerAction:"all",allowBlank:true,editable:false,forceSelection:true,value:this.stigValue,listeners:{select:function(e,t,i){s.stigValue=e.getValue();s.fireEvent("stigchanged",s.stigValue)}}}]});const l=new SM.GeneratePoamButton({parentGrid:s,iconCls:"icon-excel",text:"Generate POA&M..."});const d=new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){i.reload()}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,gridBasename:"Findings",gridSource:s,iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbseparator"},l,{xtype:"tbfill"},{xtype:"tbseparator"},e]});const c=e=>{const t={};for(const[i,s]of r.config.entries()){t[s.dataIndex]=i}switch(e){case"ruleId":r.setHidden(t.severity,false);r.setHidden(t.groupId,true);r.setHidden(t.ruleId,false);r.setHidden(t.cci,true);r.setHidden(t.apAcronym,true);r.setHidden(t.title,false);r.setHidden(t.definition,true);break;case"groupId":r.setHidden(t.severity,false);r.setHidden(t.groupId,false);r.setHidden(t.ruleId,true);r.setHidden(t.cci,true);r.setHidden(t.apAcronym,true);r.setHidden(t.title,false);r.setHidden(t.definition,true);break;case"cci":r.setHidden(t.severity,true);r.setHidden(t.groupId,true);r.setHidden(t.ruleId,true);r.setHidden(t.cci,false);r.setHidden(t.apAcronym,false);r.setHidden(t.title,true);r.setHidden(t.definition,false);break}};const f=e=>{const t={aggregator:e};if(s.stigValue!=s.stigAllValue){t.benchmarkId=s.stigValue}i.load({params:t});l.setDisabled(e==="cci")};const u=e=>{const t={aggregator:s.aggValue};if(e!=s.stigAllValue){t.benchmarkId=e}i.load({params:t})};const h={loadMask:true,stripeRows:true,store:i,colModel:r,view:n,sm:a,tbar:o,bbar:d,listeners:{aggregatorchanged:f,stigchanged:u}};Ext.apply(this,Ext.apply(this.initialConfig,h));SM.FindingsParentGrid.superclass.initComponent.call(this)}});SM.FindingsChildGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const e=this;const s=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/collections/${this.panel.collectionId}/reviews`,method:"GET"}),baseParams:{result:"fail",projection:"stigs"},sortInfo:{field:"assetName",direction:"ASC"},root:"",fields:[{name:"assetId",type:"string"},{name:"assetName",type:"string"},{name:"stigs"},{name:"ruleId",type:"string"},{name:"severity",type:"string"},{name:"result",type:"string"},{name:"detail",type:"string"},{name:"comment",type:"string"},{name:"autoResult",type:"boolean"},{name:"status",type:"string"},{name:"userId",type:"string"},{name:"username",type:"string"},{name:"ts",type:"string"},{name:"reviewComplete",type:"boolean"}]});const t=new SM.RowCountTextItem({store:s});const i=new Ext.ux.grid.RowExpander({tpl:new Ext.XTemplate("<b>Reviewer:</b> {username}</p>",'<tpl if="detail">',"<p><b>Detail:</b> {[SM.he(values.detail)]}</p>","</tpl>",'<tpl if="comment">',"<p><b>Comment:</b> {[SM.he(values.comment)]}</p>","</tpl>")});const r=[i,{header:"Asset",width:80,dataIndex:"assetName",sortable:true,filter:{type:"string"}},{header:"Rule",width:80,dataIndex:"ruleId",sortable:true,filter:{type:"string"}},{header:"Last changed",width:80,dataIndex:"ts",sortable:true},{header:"STIGs",width:130,dataIndex:"stigs",renderer:e=>{return columnWrap(e.join("\n"))},sortable:true}];const n=new SM.ColumnFilters.GridView({forceFit:true,emptyText:"Select a finding to the left.",listeners:{filterschanged:function(e,t,i){s.filter(e.getFilterFns())}}});const a=new Ext.grid.RowSelectionModel({singleSelect:true});const o=new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){s.reload()}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,gridBasename:"Finding Details",gridSource:e,iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},t]});const l={loadMask:true,stripeRows:true,plugins:i,store:s,columns:r,view:n,sm:a,bbar:o};Ext.apply(this,Ext.apply(this.initialConfig,l));SM.FindingsChildGrid.superclass.initComponent.call(this)}});SM.PoamStatusComboBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e={displayField:"display",valueField:"value",triggerAction:"all",mode:"local",editable:false};let t=this;let i=[["Ongoing","Ongoing"],["Completed","Completed"]];this.store=new Ext.data.SimpleStore({fields:["value","display"]});this.store.on("load",function(e){t.setValue(e.getAt(0).get("value"))});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.PoamStatusComboBox.superclass.initComponent.call(this);this.store.loadData(i)}});Ext.reg("sm-poam-status-combo",SM.PoamStatusComboBox);SM.PoamOptionsPanel=Ext.extend(Ext.FormPanel,{initComponent:function(){const e=this;const t=new Date;t.setDate(t.getDate()+30);const i=new Ext.form.DateField({name:"date",anchor:"100%",hideLabel:true,value:t});const s=[{xtype:"fieldset",title:"Scheduled Completion Date",items:[i]},{xtype:"fieldset",title:"Office/Org",items:[{xtype:"textfield",anchor:"100%",hideLabel:true,name:"office",value:"My office info"}]},{xtype:"fieldset",title:"Status",items:[{xtype:"sm-poam-status-combo",anchor:"100%",hideLabel:true,name:"status",value:"Ongoing"}]}];const r={baseCls:"x-plain",labelWidth:70,monitorValid:true,trackResetOnLoad:true,items:s,buttons:[{text:this.btnText||"Generate",iconCls:"icon-excel",height:30,width:120,parentPanel:e,formBind:true,handler:this.btnHandler||function(){}}]};Ext.apply(this,Ext.apply(this.initialConfig,r));SM.PoamOptionsPanel.superclass.initComponent.call(this)}});SM.RequestAndServePoam=async function(i,s){let r;try{r=Ext.MessageBox.wait("Generating POA&M");const a=new URLSearchParams(s).toString();let e=`${STIGMAN.Env.apiBase}/collections/${i}/poam?${a}`;await window.oidcProvider.updateToken(10);let t=await fetch(e,{method:"GET",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`})});const o=t.headers.get("content-disposition");const l=o.match(/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/)[1];const d=await t.blob();r.hide();n(d,l);function n(e,t){let i=document.createElement("a");i.style.display="none";let s=window.URL.createObjectURL(e);i.href=s;i.download=t;document.body.appendChild(i);i.click();document.body.removeChild(i);window.URL.revokeObjectURL(s)}}catch(e){r.hide();alert(e.message)}};SM.GeneratePoamButton=Ext.extend(Ext.Button,{initComponent:function(){const n=this;const e=function(e,t){const s=new SM.PoamOptionsPanel({btnText:"Generate POA&M",padding:10,btnHandler:(e,t)=>{const i=s.getForm().getFieldValues();if(i.date&&i.date instanceof Date){i.date=Ext.util.Format.date(i.date,"m/d/Y")}i.aggregator=n.parentGrid.aggValue;if(n.parentGrid.stigValue&&n.parentGrid.stigValue!==n.parentGrid.stigAllValue){i.benchmarkId=n.parentGrid.stigValue}r.close();SM.RequestAndServePoam(n.parentGrid.panel.collectionId,i)}});const r=new Ext.Window({title:"POA&M Defaults",cls:"sm-dialog-window sm-round-panel",modal:true,hidden:true,width:230,height:310,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"right",items:s});r.show(document.body)};const t={listeners:{click:e}};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.GeneratePoamButton.superclass.initComponent.call(this)}});Ext.reg("sm-generate-poam-button",SM.GeneratePoamButton);SM.FindingsPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const r=new SM.FindingsParentGrid({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.adjacent,bottom:SM.Margin.bottom,left:SM.Margin.edge},border:false,region:"center",panel:this,aggValue:e.aggregator||"groupId",title:"Aggregated Findings"});const n=new SM.FindingsChildGrid({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.adjacent},border:false,region:"east",width:"50%",split:true,panel:this,title:"Individual Findings"});r.child=n;n.parent=r;this.parent=r;this.child=n;onParentRowSelect=(e,t,i)=>{const s={};s[r.aggValue]=i.data[r.aggValue];if(r.stigValue!==r.stigAllValue){s.benchmarkId=r.stigValue}n.store.load({params:s})};const t={layout:"border",border:false,items:[r,n],listeners:{parentrowselect:onParentRowSelect}};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.FindingsPanel.superclass.initComponent.call(this)}});Ext.ns("SM");SM.AssignmentNavTree=Ext.extend(Ext.tree.TreePanel,{initComponent:function(){let t=this;let e=this.collectionId;let i={autoScroll:true,bodyStyle:"padding:5px;",minSize:220,root:{nodeType:"async",id:`${e}-assignment-root`,expanded:true},rootVisible:false,loader:new Ext.tree.TreeLoader({directFn:t.loadTree}),loadMask:"Loading...",listeners:{click:function(e){t.treeClick(t,e)},beforeexpandnode:function(e){e.loaded=false}}};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.AssignmentNavTree.superclass.initComponent.call(this)},loadTree:async function(e,a){try{let n;n=e.match(/^(\d+)-assignment-root$/);if(n){let e=n[1];let t=[];t.push({id:`${e}-assignment-stigs-node`,node:"stigs",text:"STIGs",iconCls:"sm-stig-icon"},{id:`${e}-assignment-assets-node`,node:"assets",text:"Assets",iconCls:"sm-asset-icon"});a(t,{status:true});return}n=e.match(/^(\d+)-assignment-assets-node$/);if(n){let t=n[1];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets`,method:"GET",params:{collectionId:t}});let i=JSON.parse(e.response.responseText);let s=i.map(e=>({id:`${t}-${e.assetId}-assignment-assets-asset-node`,text:SM.he(e.name),name:e.name,node:"asset",collectionId:t,assetId:e.assetId,iconCls:"sm-asset-icon",qtip:SM.he(e.name)}));a(s,{status:true});return}n=e.match(/^(\d+)-(\d+)-assignment-assets-asset-node$/);if(n){let t=n[1];let i=n[2];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${i}`,method:"GET",params:{projection:"stigs"}});let s=JSON.parse(e.response.responseText);let r=s.stigs.map(e=>({id:`${t}-${i}-${e.benchmarkId}-assignment-leaf`,text:SM.he(e.benchmarkId),leaf:true,node:"asset-stig",iconCls:"sm-stig-icon",stigName:e.benchmarkId,assetName:s.name,assetId:s.assetId,collectionId:t,benchmarkId:e.benchmarkId,qtip:SM.he(e.title)}));a(r,{status:true});return}n=e.match(/^(\d+)-assignment-stigs-node$/);if(n){let t=n[1];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${t}`,method:"GET",params:{projection:"stigs"}});let i=JSON.parse(e.response.responseText);let s=i.stigs.map(e=>({collectionId:t,text:SM.he(e.benchmarkId),node:"stig",iconCls:"sm-stig-icon",id:`${t}-${e.benchmarkId}-assignment-stigs-stig-node`,benchmarkId:e.benchmarkId,qtip:SM.he(e.title)}));a(s,{status:true});return}n=e.match(/^(\d+)-(.*)-assignment-stigs-stig-node$/);if(n){let t=n[1];let i=n[2];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${t}/stigs/${i}/assets`,method:"GET"});let s=JSON.parse(e.response.responseText);let r=s.map(e=>({id:`${t}-${i}-${e.assetId}-assignment-leaf`,text:SM.he(e.name),leaf:true,node:"stig-asset",iconCls:"sm-asset-icon",stigName:i,assetName:e.name,assetId:e.assetId,collectionId:t,benchmarkId:i,qtip:SM.he(e.name)}));a(r,{status:true});return}}catch(e){Ext.Msg.alert("Status","AJAX request failed in loadTree()")}},treeClick:function(e,t){switch(t.attributes.node){case"collection":case"stig":case"stig-asset":case"asset":case"asset-stig":e.panel.addButton.enable();break;default:e.panel.addButton.disable();break}},makeAssignments:async function(t,i){async function s(s){try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/`,method:"GET",params:{elevate:`${curUser.privileges.canAdmin}`,collectionId:s.attributes.collectionId,projection:"stigs"}});let t=Ext.util.JSON.decode(e.response.responseText);let i=[];t.forEach(t=>{t.stigs.forEach(e=>{i.push({benchmarkId:e.benchmarkId,assetName:t.name,assetId:t.assetId})})});return i}catch(e){alert(e.message)}}async function r(r){try{let e=r.id.match(/^\d+-(\d+)-assignment-assets-asset-node$/);let t=e[1];let i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${t}`,method:"GET",params:{elevate:`${curUser.privileges.canAdmin}`,projection:"stigs"}});let s=Ext.util.JSON.decode(i.response.responseText);return s.stigs.map(e=>({benchmarkId:e.benchmarkId,assetName:s.name,assetId:t}))}catch(e){alert(e.message)}}async function n(s){try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/`,method:"GET",params:{elevate:`${curUser.privileges.canAdmin}`,collectionId:s.attributes.collectionId,benchmarkId:s.attributes.benchmarkId,projection:"stigs"}});let t=Ext.util.JSON.decode(e.response.responseText);let i=[];t.forEach(t=>{t.stigs.forEach(e=>{i.push({benchmarkId:e.benchmarkId,assetName:t.name,assetId:t.assetId})})});return i}catch(e){alert(e.message)}}try{let e;switch(t.attributes.node){case"collection":e=await s(t);break;case"stig":e=await n(t);break;case"asset":e=await r(t);break;case"asset-stig":case"stig-asset":e={benchmarkId:t.attributes.benchmarkId,assetId:t.attributes.assetId,assetName:t.attributes.assetName};break}if(e){i.getStore().loadData(e,true)}}catch(e){alert(e.message)}}});SM.AssignmentAddBtn=Ext.extend(Ext.Button,{initComponent:function(){let t=this.tree;let i=this.grid;let e={disabled:true,height:30,width:150,margins:"10 10 10 10",icon:"img/right-arrow-16.png",iconAlign:"right",cls:"x-btn-text-icon",listeners:{click:function(){const e=t.getSelectionModel().getSelectedNode();t.makeAssignments(e,i)}}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.AssignmentAddBtn.superclass.initComponent.call(this)}});SM.AssignmentRemoveBtn=Ext.extend(Ext.Button,{initComponent:function(){let t=this.grid;let e={disabled:true,height:30,width:150,margins:"10 10 10 10",icon:"img/left-arrow-16.png",iconAlign:"left",cls:"x-btn-text-icon",listeners:{click:function(){const e=t.getSelectionModel().getSelections();t.getStore().remove(e)}}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.AssignmentRemoveBtn.superclass.initComponent.call(this)}});SM.AssignmentGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){let s=this;let i=new Ext.data.JsonStore({fields:[{name:"benchmarkId",type:"string"},{name:"assetId",type:"string"},{name:"assetName",type:"string"}],root:this.root||"",sortInfo:{field:"assetName",direction:"ASC"},idProperty:e=>`${e.benchmarkId}-${e.assetId}`,listeners:{add:function(){s.setTitle("Asset-STIG Assignments ("+i.getCount()+")")},remove:function(){s.setTitle("Asset-STIG Assignments ("+i.getCount()+")");s.panel.removeButton.disable()}}});let e=new Ext.grid.RowSelectionModel({singleSelect:false,listeners:{rowselect:function(e,t,i){s.panel.removeButton.enable()},rowdeselect:function(e,t,i){if(e.getCount()<1){s.panel.removeButton.disable()}}}});const t={name:"access",isFormField:true,setValue:function(e){let t=e.map(e=>({benchmarkId:e.benchmarkId,assetId:e.asset.assetId,assetName:e.asset.name}));i.loadData(t)},getValue:function(){let t=[];i.each(function(e){t.push({benchmarkId:e.data.benchmarkId,assetId:e.data.assetId})});return t},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,isValid:function(){return true},disabled:false,getName:function(){return this.name},validate:function(){return true},store:i,view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,markDirty:false}),stripeRows:true,sm:e,columns:[{header:`<img src="img/security_firewall_on.png" style="vertical-align: bottom;"> STIG`,dataIndex:"benchmarkId",sortable:true,width:350},{header:`<img src="img/mycomputer1-16.png" style="vertical-align: bottom;"> Asset`,dataIndex:"assetName",sortable:true,width:250}]};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.AssignmentGrid.superclass.initComponent.call(this)}});SM.AssignmentPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e=new SM.AssignmentNavTree({panel:this,title:"Collection Resources",width:300,collectionId:this.collectionId});const t=new SM.AssignmentGrid({panel:this,title:"Asset-STIG Assignments",flex:1});this.assignmentGrid=t;const i=new SM.AssignmentAddBtn({tree:e,text:"Add Assignment ",grid:t});this.addButton=i;const s=new SM.AssignmentRemoveBtn({tree:e,text:"Remove Assignment ",grid:t});this.removeButton=s;const r=new Ext.Panel({bodyStyle:"background-color:transparent;border:none",layout:{type:"vbox",pack:"center"},items:[i,s]});const n={bodyStyle:"background:transparent;border:none",assignmentGrid:t,layout:"hbox",anchor:"100% -130",layoutConfig:{align:"stretch"},items:[e,r,t]};Ext.apply(this,Ext.apply(this.initialConfig,n));SM.AssignmentPanel.superclass.initComponent.call(this)}});async function showUserAccess(r,n){try{let e;let s=new SM.AssignmentPanel({collectionId:r,userId:n});e=new Ext.Window({title:"Access Grants (ID: "+n+")",cls:"sm-dialog-window sm-round-panel",modal:true,hidden:true,width:900,height:600,layout:"fit",plain:true,bodyStyle:"padding:20px;",buttonAlign:"right",items:s,buttons:[{text:"Cancel",handler:function(){e.close()}},{text:"Save",formBind:true,id:"submit-button",handler:async function(){try{let e=s.assignmentGrid.getValue();let t,i;t=`${STIGMAN.Env.apiBase}/collections/${r}/grants/${n}/access`;i="PUT";await Ext.Ajax.requestPromise({url:t,method:i,headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:e})}catch(e){alert(e.message)}finally{e.close()}}}]});s.appwindow=e;e.render(document.body);let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${r}/grants/${n}/access`,method:"GET"});let i=JSON.parse(t.response.responseText);s.assignmentGrid.setValue(i);Ext.getBody().unmask();e.show()}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}}var asmCrypto=function(e){"use strict";var t=typeof atob==="undefined"?function(e){return Buffer.from(e,"base64").toString("binary")}:atob;var i=typeof btoa==="undefined"?function(e){return Buffer.from(e,"binary").toString("base64")}:btoa;function s(e,t){if(t===void 0){t=false}var i=e.length,s=new Uint8Array(t?4*i:i);for(var r=0,n=0;r<i;r++){var a=e.charCodeAt(r);if(t&&55296<=a&&a<=56319){if(++r>=i)throw new Error("Malformed string, low surrogate expected at position "+r);a=(a^55296)<<10|65536|e.charCodeAt(r)^56320}else if(!t&&a>>>8){throw new Error("Wide characters are not allowed.")}if(!t||a<=127){s[n++]=a}else if(a<=2047){s[n++]=192|a>>6;s[n++]=128|a&63}else if(a<=65535){s[n++]=224|a>>12;s[n++]=128|a>>6&63;s[n++]=128|a&63}else{s[n++]=240|a>>18;s[n++]=128|a>>12&63;s[n++]=128|a>>6&63;s[n++]=128|a&63}}return s.subarray(0,n)}function r(e){var t=e.length;if(t&1){e="0"+e;t++}var i=new Uint8Array(t>>1);for(var s=0;s<t;s+=2){i[s>>1]=parseInt(e.substr(s,2),16)}return i}function n(e){return s(t(e))}function a(e,t){if(t===void 0){t=false}var i=e.length,s=new Array(i);for(var r=0,n=0;r<i;r++){var a=e[r];if(!t||a<128){s[n++]=a}else if(a>=192&&a<224&&r+1<i){s[n++]=(a&31)<<6|e[++r]&63}else if(a>=224&&a<240&&r+2<i){s[n++]=(a&15)<<12|(e[++r]&63)<<6|e[++r]&63}else if(a>=240&&a<248&&r+3<i){var o=(a&7)<<18|(e[++r]&63)<<12|(e[++r]&63)<<6|e[++r]&63;if(o<=65535){s[n++]=o}else{o^=65536;s[n++]=55296|o>>10;s[n++]=56320|o&1023}}else{throw new Error("Malformed UTF8 character at byte offset "+r)}}var l="",d=16384;for(var r=0;r<n;r+=d){l+=String.fromCharCode.apply(String,s.slice(r,r+d<=n?r+d:n))}return l}function o(e){var t="";for(var i=0;i<e.length;i++){var s=(e[i]&255).toString(16);if(s.length<2)t+="0";t+=s}return t}function l(e){return i(a(e))}function p(e){return e instanceof Uint8Array}function d(e,t){var i=e?e.byteLength:t||65536;if(i&4095||i<=0)throw new Error("heap size must be a positive integer and a multiple of 4096");e=e||new Uint8Array(new ArrayBuffer(i));return e}function m(e,t,i,s,r){var n=e.length-t;var a=n<r?n:r;e.set(i.subarray(s,s+a),t);return a}function c(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=e.reduce(function(e,t){return e+t.length},0);var s=new Uint8Array(i);var r=0;for(var n=0;n<e.length;n++){s.set(e[n],r);r+=e[n].length}return s}var f=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var g=function(s){f(e,s);function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=s.apply(this,e)||this;return i}return e}(Error);var b=function(s){f(e,s);function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=s.apply(this,e)||this;return i}return e}(Error);var v=function(s){f(e,s);function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=s.apply(this,e)||this;return i}return e}(Error);var x=function(){var r=false;var s,n;function a(){s=[],n=[];var e=1,t,i;for(t=0;t<255;t++){s[t]=e;i=e&128,e<<=1,e&=255;if(i===128)e^=27;e^=s[t];n[s[t]]=t}s[255]=s[0];n[0]=0;r=true}function o(e,t){var i=s[(n[e]+n[t])%255];if(e===0||t===0)i=0;return i}function l(e){var t=s[255-n[e]];if(e===0)t=0;return t}var d=false;var b;var c;var f;var v;function u(){if(!r)a();function e(e){var t,i,s;i=s=l(e);for(t=0;t<4;t++){i=(i<<1|i>>>7)&255;s^=i}s^=99;return s}b=[],c=[],f=[[],[],[],[]],v=[[],[],[],[]];for(var t=0;t<256;t++){var i=e(t);b[t]=i;c[i]=t;f[0][t]=o(2,i)<<24|i<<16|i<<8|o(3,i);v[0][i]=o(14,t)<<24|o(9,t)<<16|o(13,t)<<8|o(11,t);for(var s=1;s<4;s++){f[s][t]=f[s-1][t]>>>8|f[s-1][t]<<24;v[s][i]=v[s-1][i]>>>8|v[s-1][i]<<24}}d=true}var e=function(e,t){if(!d)u();var g=new Uint32Array(t);g.set(b,2048>>2);g.set(c,3072>>2);for(var i=0;i<4;i++){g.set(f[i],4096+1024*i>>2);g.set(v[i],8192+1024*i>>2)}function s(e,t,i,s,r,n,a,o,l){var d=g.subarray(0,60),c=g.subarray(256,256+60);d.set([t,i,s,r,n,a,o,l]);for(var f=e,u=1;f<4*e+28;f++){var h=d[f-1];if(f%e===0||e===8&&f%e===4){h=b[h>>>24]<<24^b[h>>>16&255]<<16^b[h>>>8&255]<<8^b[h&255]}if(f%e===0){h=h<<8^h>>>24^u<<24;u=u<<1^(u&128?27:0)}d[f]=d[f-e]^h}for(var p=0;p<f;p+=4){for(var m=0;m<4;m++){var h=d[f-(4+p)+(4-m)%4];if(p<4||p>=f-4){c[p+m]=h}else{c[p+m]=v[0][b[h>>>24]]^v[1][b[h>>>16&255]]^v[2][b[h>>>8&255]]^v[3][b[h&255]]}}}x.set_rounds(e+5)}var r={Uint8Array:Uint8Array,Uint32Array:Uint32Array};var x=function(e,t,i){"use asm";var g=0,x=0,b=0,v=0,p=0,m=0,y=0,w=0,r=0,n=0,a=0,o=0,l=0,d=0,c=0,f=0,S=0,E=0,C=0,I=0,u=0;var T=new e.Uint32Array(i),h=new e.Uint8Array(i);function k(e,t,i,s,r,n,a,o){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;var l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0;l=i|0x400,d=i|0x800,c=i|0xc00;r=r^T[(e|0)>>2],n=n^T[(e|4)>>2],a=a^T[(e|8)>>2],o=o^T[(e|12)>>2];for(m=16;(m|0)<=s<<4;m=m+16|0){f=T[(i|r>>22&1020)>>2]^T[(l|n>>14&1020)>>2]^T[(d|a>>6&1020)>>2]^T[(c|o<<2&1020)>>2]^T[(e|m|0)>>2],u=T[(i|n>>22&1020)>>2]^T[(l|a>>14&1020)>>2]^T[(d|o>>6&1020)>>2]^T[(c|r<<2&1020)>>2]^T[(e|m|4)>>2],h=T[(i|a>>22&1020)>>2]^T[(l|o>>14&1020)>>2]^T[(d|r>>6&1020)>>2]^T[(c|n<<2&1020)>>2]^T[(e|m|8)>>2],p=T[(i|o>>22&1020)>>2]^T[(l|r>>14&1020)>>2]^T[(d|n>>6&1020)>>2]^T[(c|a<<2&1020)>>2]^T[(e|m|12)>>2];r=f,n=u,a=h,o=p}g=T[(t|r>>22&1020)>>2]<<24^T[(t|n>>14&1020)>>2]<<16^T[(t|a>>6&1020)>>2]<<8^T[(t|o<<2&1020)>>2]^T[(e|m|0)>>2],x=T[(t|n>>22&1020)>>2]<<24^T[(t|a>>14&1020)>>2]<<16^T[(t|o>>6&1020)>>2]<<8^T[(t|r<<2&1020)>>2]^T[(e|m|4)>>2],b=T[(t|a>>22&1020)>>2]<<24^T[(t|o>>14&1020)>>2]<<16^T[(t|r>>6&1020)>>2]<<8^T[(t|n<<2&1020)>>2]^T[(e|m|8)>>2],v=T[(t|o>>22&1020)>>2]<<24^T[(t|r>>14&1020)>>2]<<16^T[(t|n>>6&1020)>>2]<<8^T[(t|a<<2&1020)>>2]^T[(e|m|12)>>2]}function A(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;k(0x0000,0x0800,0x1000,u,e,t,i,s)}function M(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;var r=0;k(0x0400,0x0c00,0x2000,u,e,s,i,t);r=x,x=v,v=r}function _(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;k(0x0000,0x0800,0x1000,u,p^e,m^t,y^i,w^s);p=g,m=x,y=b,w=v}function R(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;var r=0;k(0x0400,0x0c00,0x2000,u,e,s,i,t);r=x,x=v,v=r;g=g^p,x=x^m,b=b^y,v=v^w;p=e,m=t,y=i,w=s}function N(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;k(0x0000,0x0800,0x1000,u,p,m,y,w);p=g=g^e,m=x=x^t,y=b=b^i,w=v=v^s}function P(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;k(0x0000,0x0800,0x1000,u,p,m,y,w);g=g^e,x=x^t,b=b^i,v=v^s;p=e,m=t,y=i,w=s}function D(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;k(0x0000,0x0800,0x1000,u,p,m,y,w);p=g,m=x,y=b,w=v;g=g^e,x=x^t,b=b^i,v=v^s}function F(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;k(0x0000,0x0800,0x1000,u,r,n,a,o);o=~f&o|f&o+1;a=~c&a|c&a+((o|0)==0);n=~d&n|d&n+((a|0)==0);r=~l&r|l&r+((n|0)==0);g=g^e;x=x^t;b=b^i;v=v^s}function B(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;var r=0,n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0;e=e^p,t=t^m,i=i^y,s=s^w;r=S|0,n=E|0,a=C|0,o=I|0;for(;(u|0)<128;u=u+1|0){if(r>>>31){l=l^e,d=d^t,c=c^i,f=f^s}r=r<<1|n>>>31,n=n<<1|a>>>31,a=a<<1|o>>>31,o=o<<1;h=s&1;s=s>>>1|i<<31,i=i>>>1|t<<31,t=t>>>1|e<<31,e=e>>>1;if(h)e=e^0xe1000000}p=l,m=d,y=c,w=f}function s(e){e=e|0;u=e}function G(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;g=e,x=t,b=i,v=s}function O(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;p=e,m=t,y=i,w=s}function L(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;r=e,n=t,a=i,o=s}function $(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;l=e,d=t,c=i,f=s}function j(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;o=~f&o|f&s,a=~c&a|c&i,n=~d&n|d&t,r=~l&r|l&e}function V(e){e=e|0;if(e&15)return-1;h[e|0]=g>>>24,h[e|1]=g>>>16&255,h[e|2]=g>>>8&255,h[e|3]=g&255,h[e|4]=x>>>24,h[e|5]=x>>>16&255,h[e|6]=x>>>8&255,h[e|7]=x&255,h[e|8]=b>>>24,h[e|9]=b>>>16&255,h[e|10]=b>>>8&255,h[e|11]=b&255,h[e|12]=v>>>24,h[e|13]=v>>>16&255,h[e|14]=v>>>8&255,h[e|15]=v&255;return 16}function U(e){e=e|0;if(e&15)return-1;h[e|0]=p>>>24,h[e|1]=p>>>16&255,h[e|2]=p>>>8&255,h[e|3]=p&255,h[e|4]=m>>>24,h[e|5]=m>>>16&255,h[e|6]=m>>>8&255,h[e|7]=m&255,h[e|8]=y>>>24,h[e|9]=y>>>16&255,h[e|10]=y>>>8&255,h[e|11]=y&255,h[e|12]=w>>>24,h[e|13]=w>>>16&255,h[e|14]=w>>>8&255,h[e|15]=w&255;return 16}function H(){A(0,0,0,0);S=g,E=x,C=b,I=v}function z(e,t,i){e=e|0;t=t|0;i=i|0;var s=0;if(t&15)return-1;while((i|0)>=16){q[e&7](h[t|0]<<24|h[t|1]<<16|h[t|2]<<8|h[t|3],h[t|4]<<24|h[t|5]<<16|h[t|6]<<8|h[t|7],h[t|8]<<24|h[t|9]<<16|h[t|10]<<8|h[t|11],h[t|12]<<24|h[t|13]<<16|h[t|14]<<8|h[t|15]);h[t|0]=g>>>24,h[t|1]=g>>>16&255,h[t|2]=g>>>8&255,h[t|3]=g&255,h[t|4]=x>>>24,h[t|5]=x>>>16&255,h[t|6]=x>>>8&255,h[t|7]=x&255,h[t|8]=b>>>24,h[t|9]=b>>>16&255,h[t|10]=b>>>8&255,h[t|11]=b&255,h[t|12]=v>>>24,h[t|13]=v>>>16&255,h[t|14]=v>>>8&255,h[t|15]=v&255;s=s+16|0,t=t+16|0,i=i-16|0}return s|0}function W(e,t,i){e=e|0;t=t|0;i=i|0;var s=0;if(t&15)return-1;while((i|0)>=16){J[e&1](h[t|0]<<24|h[t|1]<<16|h[t|2]<<8|h[t|3],h[t|4]<<24|h[t|5]<<16|h[t|6]<<8|h[t|7],h[t|8]<<24|h[t|9]<<16|h[t|10]<<8|h[t|11],h[t|12]<<24|h[t|13]<<16|h[t|14]<<8|h[t|15]);s=s+16|0,t=t+16|0,i=i-16|0}return s|0}var q=[A,M,_,R,N,P,D,F];var J=[_,B];return{set_rounds:s,set_state:G,set_iv:O,set_nonce:L,set_mask:$,set_counter:j,get_state:V,get_iv:U,gcm_init:H,cipher:z,mac:W}}(r,e,t);x.set_key=s;return x};e.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},e.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},e.MAC={CBC:0,GCM:1};e.HEAP_DATA=16384;return e}();var u=function(){function e(e,t,i,s,r,n){if(i===void 0){i=true}this.pos=0;this.len=0;this.mode=s;this.heap=r?r:d().subarray(x.HEAP_DATA);this.asm=n?n:new x(null,this.heap.buffer);this.pos=0;this.len=0;var a=e.length;if(a!==16&&a!==24&&a!==32)throw new b("illegal key size");var o=new DataView(e.buffer,e.byteOffset,e.byteLength);this.asm.set_key(a>>2,o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12),a>16?o.getUint32(16):0,a>16?o.getUint32(20):0,a>24?o.getUint32(24):0,a>24?o.getUint32(28):0);if(t!==undefined){if(t.length!==16)throw new b("illegal iv size");var l=new DataView(t.buffer,t.byteOffset,t.byteLength);this.asm.set_iv(l.getUint32(0),l.getUint32(4),l.getUint32(8),l.getUint32(12))}else{this.asm.set_iv(0,0,0,0)}this.padding=i}e.prototype.AES_Encrypt_process=function(e){if(!p(e))throw new TypeError("data isn't of expected type");var t=this.asm;var i=this.heap;var s=x.ENC[this.mode];var r=x.HEAP_DATA;var n=this.pos;var a=this.len;var o=0;var l=e.length||0;var d=0;var c=a+l&-16;var f=0;var u=new Uint8Array(c);while(l>0){f=m(i,n+a,e,o,l);a+=f;o+=f;l-=f;f=t.cipher(s,r+n,a);if(f)u.set(i.subarray(n,n+f),d);d+=f;if(f<a){n+=f;a-=f}else{n=0;a=0}}this.pos=n;this.len=a;return u};e.prototype.AES_Encrypt_finish=function(){var e=this.asm;var t=this.heap;var i=x.ENC[this.mode];var s=x.HEAP_DATA;var r=this.pos;var n=this.len;var a=16-n%16;var o=n;if(this.hasOwnProperty("padding")){if(this.padding){for(var l=0;l<a;++l){t[r+n+l]=a}n+=a;o=n}else if(n%16){throw new b("data length must be a multiple of the block size")}}else{n+=a}var d=new Uint8Array(o);if(n)e.cipher(i,s+r,n);if(o)d.set(t.subarray(r,r+o));this.pos=0;this.len=0;return d};e.prototype.AES_Decrypt_process=function(e){if(!p(e))throw new TypeError("data isn't of expected type");var t=this.asm;var i=this.heap;var s=x.DEC[this.mode];var r=x.HEAP_DATA;var n=this.pos;var a=this.len;var o=0;var l=e.length||0;var d=0;var c=a+l&-16;var f=0;var u=0;if(this.padding){f=a+l-c||16;c-=f}var h=new Uint8Array(c);while(l>0){u=m(i,n+a,e,o,l);a+=u;o+=u;l-=u;u=t.cipher(s,r+n,a-(!l?f:0));if(u)h.set(i.subarray(n,n+u),d);d+=u;if(u<a){n+=u;a-=u}else{n=0;a=0}}this.pos=n;this.len=a;return h};e.prototype.AES_Decrypt_finish=function(){var e=this.asm;var t=this.heap;var i=x.DEC[this.mode];var s=x.HEAP_DATA;var r=this.pos;var n=this.len;var a=n;if(n>0){if(n%16){if(this.hasOwnProperty("padding")){throw new b("data length must be a multiple of the block size")}else{n+=16-n%16}}e.cipher(i,s+r,n);if(this.hasOwnProperty("padding")&&this.padding){var o=t[r+a-1];if(o<1||o>16||o>a)throw new v("bad padding");var l=0;for(var d=o;d>1;d--)l|=o^t[r+a-d];if(l)throw new v("bad padding");a-=o}}var c=new Uint8Array(a);if(a>0){c.set(t.subarray(r,r+a))}this.pos=0;this.len=0;return c};return e}();var h=function(){function r(e,t,i,s){if(i===void 0){i=true}this.aes=s?s:new u(e,t,i,"CBC")}r.encrypt=function(e,t,i,s){if(i===void 0){i=true}return new r(t,s,i).encrypt(e)};r.decrypt=function(e,t,i,s){if(i===void 0){i=true}return new r(t,s,i).decrypt(e)};r.prototype.encrypt=function(e){var t=this.aes.AES_Encrypt_process(e);var i=this.aes.AES_Encrypt_finish();return c(t,i)};r.prototype.decrypt=function(e){var t=this.aes.AES_Decrypt_process(e);var i=this.aes.AES_Decrypt_finish();return c(t,i)};return r}();var y=65279;var w=0xffffffffffff0;var S=function(){function n(e,t,i,s,r,n){if(s===void 0){s=16}this.counter=1;this.dataLength=-1;this.aes=n?n:new u(e,undefined,undefined,"CCM");if(s<4||s>16||s&1)throw new b("illegal tagSize value");this.tagSize=s;this.nonce=t;if(t.length<8||t.length>13)throw new b("illegal nonce length");this.lengthSize=15-t.length;t=new Uint8Array(t.length+1);t[0]=this.lengthSize-1;t.set(this.nonce,1);if(r<0||r>w||r>Math.pow(2,8*this.lengthSize)-16)throw new b("illegal dataLength value");if(i!==undefined){if(i.length>y)throw new b("illegal adata length");this.adata=i.length?i:undefined}this.dataLength=r;this.counter=1;this.AES_CCM_calculate_iv();this.AES_CTR_set_options(t,this.counter,8*this.lengthSize)}n.encrypt=function(e,t,i,s,r){if(r===void 0){r=16}return new n(t,i,s,r,e.length).encrypt(e)};n.decrypt=function(e,t,i,s,r){if(r===void 0){r=16}return new n(t,i,s,r,e.length-r).decrypt(e)};n.prototype.encrypt=function(e){this.dataLength=e.length||0;var t=this.AES_CCM_Encrypt_process(e);var i=this.AES_CCM_Encrypt_finish();var s=new Uint8Array(t.length+i.length);if(t.length)s.set(t);if(i.length)s.set(i,t.length);return s};n.prototype.decrypt=function(e){this.dataLength=e.length||0;var t=this.AES_CCM_Decrypt_process(e);var i=this.AES_CCM_Decrypt_finish();var s=new Uint8Array(t.length+i.length);if(t.length)s.set(t);if(i.length)s.set(i,t.length);return s};n.prototype.AES_CCM_calculate_iv=function(){var e=this.nonce;var t=this.adata;var i=this.tagSize;var s=this.lengthSize;var r=this.dataLength;var n=new Uint8Array(16+(t?2+t.length:0));n[0]=(t?64:0)|i-2<<2|s-1;n.set(e,1);if(s>6)n[9]=r/4294967296>>>16&15;if(s>5)n[10]=r/4294967296>>>8&255;if(s>4)n[11]=r/4294967296&255;if(s>3)n[12]=r>>>24;if(s>2)n[13]=r>>>16&255;n[14]=r>>>8&255;n[15]=r&255;if(t){n[16]=t.length>>>8&255;n[17]=t.length&255;n.set(t,18)}this._cbc_mac_process(n);this.aes.asm.get_state(x.HEAP_DATA);var a=new Uint8Array(this.aes.heap.subarray(0,16));var o=new DataView(a.buffer,a.byteOffset,a.byteLength);this.aes.asm.set_iv(o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12))};n.prototype._cbc_mac_process=function(e){var t=this.aes.heap;var i=this.aes.asm;var s=0;var r=e.length||0;var n=0;while(r>0){n=m(t,0,e,s,r);while(n&15)t[n++]=0;s+=n;r-=n;i.mac(x.MAC.CBC,x.HEAP_DATA,n)}};n.prototype.AES_CCM_Encrypt_process=function(e){var t=this.aes.asm;var i=this.aes.heap;var s=0;var r=e.length||0;var n=this.counter;var a=this.aes.pos;var o=this.aes.len;var l=o+r&-16;var d=0;var c=0;if((n-1<<4)+o+r>w)throw new RangeError("counter overflow");var f=new Uint8Array(l);while(r>0){c=m(i,a+o,e,s,r);o+=c;s+=c;r-=c;c=t.mac(x.MAC.CBC,x.HEAP_DATA+a,o);c=t.cipher(x.ENC.CTR,x.HEAP_DATA+a,c);if(c)f.set(i.subarray(a,a+c),d);n+=c>>>4;d+=c;if(c<o){a+=c;o-=c}else{a=0;o=0}}this.counter=n;this.aes.pos=a;this.aes.len=o;return f};n.prototype.AES_CCM_Encrypt_finish=function(){var e=this.aes.asm;var t=this.aes.heap;var i=this.tagSize;var s=this.aes.pos;var r=this.aes.len;var n=new Uint8Array(r+i);var a=r;for(;a&15;a++)t[s+a]=0;e.mac(x.MAC.CBC,x.HEAP_DATA+s,a);e.cipher(x.ENC.CTR,x.HEAP_DATA+s,a);if(r)n.set(t.subarray(s,s+r));e.set_counter(0,0,0,0);e.get_iv(x.HEAP_DATA);e.cipher(x.ENC.CTR,x.HEAP_DATA,16);n.set(t.subarray(0,i),r);this.counter=1;this.aes.pos=0;this.aes.len=0;return n};n.prototype.AES_CCM_Decrypt_process=function(e){var t=0;var i=e.length||0;var s=this.aes.asm;var r=this.aes.heap;var n=this.counter;var a=this.tagSize;var o=this.aes.pos;var l=this.aes.len;var d=0;var c=l+i>a?l+i-a&-16:0;var f=l+i-c;var u=0;if((n-1<<4)+l+i>w)throw new RangeError("counter overflow");var h=new Uint8Array(c);while(i>f){u=m(r,o+l,e,t,i-f);l+=u;t+=u;i-=u;u=s.cipher(x.DEC.CTR,x.HEAP_DATA+o,u);u=s.mac(x.MAC.CBC,x.HEAP_DATA+o,u);if(u)h.set(r.subarray(o,o+u),d);n+=u>>>4;d+=u;o=0;l=0}if(i>0){l+=m(r,0,e,t,i)}this.counter=n;this.aes.pos=o;this.aes.len=l;return h};n.prototype.AES_CCM_Decrypt_finish=function(){var e=this.aes.asm;var t=this.aes.heap;var i=this.tagSize;var s=this.aes.pos;var r=this.aes.len;var n=r-i;if(r<i)throw new g("authentication tag not found");var a=new Uint8Array(n);var o=new Uint8Array(t.subarray(s+n,s+r));e.cipher(x.DEC.CTR,x.HEAP_DATA+s,n+15&-16);a.set(t.subarray(s,s+n));var l=n;for(;l&15;l++)t[s+l]=0;e.mac(x.MAC.CBC,x.HEAP_DATA+s,l);e.set_counter(0,0,0,0);e.get_iv(x.HEAP_DATA);e.cipher(x.ENC.CTR,x.HEAP_DATA,16);var d=0;for(var c=0;c<i;++c)d|=o[c]^t[c];if(d)throw new v("data integrity check failed");this.counter=1;this.aes.pos=0;this.aes.len=0;return a};n.prototype.AES_CTR_set_options=function(e,t,i){if(i<8||i>48)throw new b("illegal counter size");var s=Math.pow(2,i)-1;this.aes.asm.set_mask(0,0,s/4294967296|0,s|0);var r=e.length;if(!r||r>16)throw new b("illegal nonce size");this.nonce=e;var n=new DataView(new ArrayBuffer(16));new Uint8Array(n.buffer).set(e);this.aes.asm.set_nonce(n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12));if(t<0||t>=Math.pow(2,i))throw new b("illegal counter value");this.counter=t;this.aes.asm.set_counter(0,0,t/4294967296|0,t|0)};return n}();var E=function(){function s(e,t,i){this.aes=i?i:new u(e,t,true,"CFB");delete this.aes.padding}s.encrypt=function(e,t,i){return new s(t,i).encrypt(e)};s.decrypt=function(e,t,i){return new s(t,i).decrypt(e)};s.prototype.encrypt=function(e){var t=this.aes.AES_Encrypt_process(e);var i=this.aes.AES_Encrypt_finish();return c(t,i)};s.prototype.decrypt=function(e){var t=this.aes.AES_Decrypt_process(e);var i=this.aes.AES_Decrypt_finish();return c(t,i)};return s}();var C=function(){function s(e,t,i){if(t===void 0){t=false}this.aes=i?i:new u(e,undefined,t,"ECB")}s.encrypt=function(e,t,i){if(i===void 0){i=false}return new s(t,i).encrypt(e)};s.decrypt=function(e,t,i){if(i===void 0){i=false}return new s(t,i).decrypt(e)};s.prototype.encrypt=function(e){var t=this.aes.AES_Encrypt_process(e);var i=this.aes.AES_Encrypt_finish();return c(t,i)};s.prototype.decrypt=function(e){var t=this.aes.AES_Decrypt_process(e);var i=this.aes.AES_Decrypt_finish();return c(t,i)};return s}();function I(e){var t=e[0]&128;for(var i=0;i<15;i++){e[i]=e[i]<<1^(e[i+1]&128?1:0)}e[15]=e[15]<<1^(t?135:0)}var T=function(){function i(e){this.bufferLength=0;this.k=new C(e).encrypt(new Uint8Array(16));I(this.k);this.cbc=new h(e,new Uint8Array(16),false);this.buffer=new Uint8Array(16);this.result=null}i.bytes=function(e,t){return new i(t).process(e).finish().result};i.prototype.process=function(e){if(this.bufferLength+e.length>16){this.cbc.encrypt(this.buffer.subarray(0,this.bufferLength));var t=(this.bufferLength+e.length-1&~15)-this.bufferLength;this.cbc.encrypt(e.subarray(0,t));this.buffer.set(e.subarray(t));this.bufferLength=e.length-t}else{this.buffer.set(e,this.bufferLength);this.bufferLength+=e.length}return this};i.prototype.finish=function(){if(this.bufferLength!==16){this.buffer[this.bufferLength]=128;for(var e=this.bufferLength+1;e<16;e++){this.buffer[e]=0}I(this.k)}for(var e=0;e<16;e++){this.buffer[e]^=this.k[e]}this.result=this.cbc.encrypt(this.buffer);return this};return i}();var k=function(){function s(e,t,i){this.aes=i?i:new u(e,undefined,false,"CTR");delete this.aes.padding;this.AES_CTR_set_options(t)}s.encrypt=function(e,t,i){return new s(t,i).encrypt(e)};s.decrypt=function(e,t,i){return new s(t,i).encrypt(e)};s.prototype.encrypt=function(e){var t=this.aes.AES_Encrypt_process(e);var i=this.aes.AES_Encrypt_finish();return c(t,i)};s.prototype.decrypt=function(e){var t=this.aes.AES_Encrypt_process(e);var i=this.aes.AES_Encrypt_finish();return c(t,i)};s.prototype.AES_CTR_set_options=function(e,t,i){if(i!==undefined){if(i<8||i>48)throw new b("illegal counter size");var s=Math.pow(2,i)-1;this.aes.asm.set_mask(0,0,s/4294967296|0,s|0)}else{i=48;this.aes.asm.set_mask(0,0,65535,4294967295)}if(e!==undefined){var r=e.length;if(!r||r>16)throw new b("illegal nonce size");var n=new DataView(new ArrayBuffer(16));new Uint8Array(n.buffer).set(e);this.aes.asm.set_nonce(n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12))}else{throw new Error("nonce is required")}if(t!==undefined){if(t<0||t>=Math.pow(2,i))throw new b("illegal counter value");this.aes.asm.set_counter(0,0,t/4294967296|0,t|0)}};return s}();var A=68719476704;var M=function(){function n(e,t,i,s,r){if(s===void 0){s=16}this.tagSize=s;this.gamma0=0;this.counter=1;this.aes=r?r:new u(e,undefined,false,"CTR");this.aes.asm.gcm_init();if(this.tagSize<4||this.tagSize>16)throw new b("illegal tagSize value");var n=t.length||0;var a=new Uint8Array(16);if(n!==12){this._gcm_mac_process(t);this.aes.heap[0]=0;this.aes.heap[1]=0;this.aes.heap[2]=0;this.aes.heap[3]=0;this.aes.heap[4]=0;this.aes.heap[5]=0;this.aes.heap[6]=0;this.aes.heap[7]=0;this.aes.heap[8]=0;this.aes.heap[9]=0;this.aes.heap[10]=0;this.aes.heap[11]=n>>>29;this.aes.heap[12]=n>>>21&255;this.aes.heap[13]=n>>>13&255;this.aes.heap[14]=n>>>5&255;this.aes.heap[15]=n<<3&255;this.aes.asm.mac(x.MAC.GCM,x.HEAP_DATA,16);this.aes.asm.get_iv(x.HEAP_DATA);this.aes.asm.set_iv(0,0,0,0);a.set(this.aes.heap.subarray(0,16))}else{a.set(t);a[15]=1}var o=new DataView(a.buffer);this.gamma0=o.getUint32(12);this.aes.asm.set_nonce(o.getUint32(0),o.getUint32(4),o.getUint32(8),0);this.aes.asm.set_mask(0,0,0,4294967295);if(i!==undefined){if(i.length>A)throw new b("illegal adata length");if(i.length){this.adata=i;this._gcm_mac_process(i)}else{this.adata=undefined}}else{this.adata=undefined}if(this.counter<1||this.counter>4294967295)throw new RangeError("counter must be a positive 32-bit integer");this.aes.asm.set_counter(0,0,0,this.gamma0+this.counter|0)}n.encrypt=function(e,t,i,s,r){return new n(t,i,s,r).encrypt(e)};n.decrypt=function(e,t,i,s,r){return new n(t,i,s,r).decrypt(e)};n.prototype.encrypt=function(e){return this.AES_GCM_encrypt(e)};n.prototype.decrypt=function(e){return this.AES_GCM_decrypt(e)};n.prototype.AES_GCM_Encrypt_process=function(e){var t=0;var i=e.length||0;var s=this.aes.asm;var r=this.aes.heap;var n=this.counter;var a=this.aes.pos;var o=this.aes.len;var l=0;var d=o+i&-16;var c=0;if((n-1<<4)+o+i>A)throw new RangeError("counter overflow");var f=new Uint8Array(d);while(i>0){c=m(r,a+o,e,t,i);o+=c;t+=c;i-=c;c=s.cipher(x.ENC.CTR,x.HEAP_DATA+a,o);c=s.mac(x.MAC.GCM,x.HEAP_DATA+a,c);if(c)f.set(r.subarray(a,a+c),l);n+=c>>>4;l+=c;if(c<o){a+=c;o-=c}else{a=0;o=0}}this.counter=n;this.aes.pos=a;this.aes.len=o;return f};n.prototype.AES_GCM_Encrypt_finish=function(){var e=this.aes.asm;var t=this.aes.heap;var i=this.counter;var s=this.tagSize;var r=this.adata;var n=this.aes.pos;var a=this.aes.len;var o=new Uint8Array(a+s);e.cipher(x.ENC.CTR,x.HEAP_DATA+n,a+15&-16);if(a)o.set(t.subarray(n,n+a));var l=a;for(;l&15;l++)t[n+l]=0;e.mac(x.MAC.GCM,x.HEAP_DATA+n,l);var d=r!==undefined?r.length:0;var c=(i-1<<4)+a;t[0]=0;t[1]=0;t[2]=0;t[3]=d>>>29;t[4]=d>>>21;t[5]=d>>>13&255;t[6]=d>>>5&255;t[7]=d<<3&255;t[8]=t[9]=t[10]=0;t[11]=c>>>29;t[12]=c>>>21&255;t[13]=c>>>13&255;t[14]=c>>>5&255;t[15]=c<<3&255;e.mac(x.MAC.GCM,x.HEAP_DATA,16);e.get_iv(x.HEAP_DATA);e.set_counter(0,0,0,this.gamma0);e.cipher(x.ENC.CTR,x.HEAP_DATA,16);o.set(t.subarray(0,s),a);this.counter=1;this.aes.pos=0;this.aes.len=0;return o};n.prototype.AES_GCM_Decrypt_process=function(e){var t=0;var i=e.length||0;var s=this.aes.asm;var r=this.aes.heap;var n=this.counter;var a=this.tagSize;var o=this.aes.pos;var l=this.aes.len;var d=0;var c=l+i>a?l+i-a&-16:0;var f=l+i-c;var u=0;if((n-1<<4)+l+i>A)throw new RangeError("counter overflow");var h=new Uint8Array(c);while(i>f){u=m(r,o+l,e,t,i-f);l+=u;t+=u;i-=u;u=s.mac(x.MAC.GCM,x.HEAP_DATA+o,u);u=s.cipher(x.DEC.CTR,x.HEAP_DATA+o,u);if(u)h.set(r.subarray(o,o+u),d);n+=u>>>4;d+=u;o=0;l=0}if(i>0){l+=m(r,0,e,t,i)}this.counter=n;this.aes.pos=o;this.aes.len=l;return h};n.prototype.AES_GCM_Decrypt_finish=function(){var e=this.aes.asm;var t=this.aes.heap;var i=this.tagSize;var s=this.adata;var r=this.counter;var n=this.aes.pos;var a=this.aes.len;var o=a-i;if(a<i)throw new g("authentication tag not found");var l=new Uint8Array(o);var d=new Uint8Array(t.subarray(n+o,n+a));var c=o;for(;c&15;c++)t[n+c]=0;e.mac(x.MAC.GCM,x.HEAP_DATA+n,c);e.cipher(x.DEC.CTR,x.HEAP_DATA+n,c);if(o)l.set(t.subarray(n,n+o));var f=s!==undefined?s.length:0;var u=(r-1<<4)+a-i;t[0]=0;t[1]=0;t[2]=0;t[3]=f>>>29;t[4]=f>>>21;t[5]=f>>>13&255;t[6]=f>>>5&255;t[7]=f<<3&255;t[8]=t[9]=t[10]=0;t[11]=u>>>29;t[12]=u>>>21&255;t[13]=u>>>13&255;t[14]=u>>>5&255;t[15]=u<<3&255;e.mac(x.MAC.GCM,x.HEAP_DATA,16);e.get_iv(x.HEAP_DATA);e.set_counter(0,0,0,this.gamma0);e.cipher(x.ENC.CTR,x.HEAP_DATA,16);var h=0;for(var p=0;p<i;++p)h|=d[p]^t[p];if(h)throw new v("data integrity check failed");this.counter=1;this.aes.pos=0;this.aes.len=0;return l};n.prototype.AES_GCM_decrypt=function(e){var t=this.AES_GCM_Decrypt_process(e);var i=this.AES_GCM_Decrypt_finish();var s=new Uint8Array(t.length+i.length);if(t.length)s.set(t);if(i.length)s.set(i,t.length);return s};n.prototype.AES_GCM_encrypt=function(e){var t=this.AES_GCM_Encrypt_process(e);var i=this.AES_GCM_Encrypt_finish();var s=new Uint8Array(t.length+i.length);if(t.length)s.set(t);if(i.length)s.set(i,t.length);return s};n.prototype._gcm_mac_process=function(e){var t=this.aes.heap;var i=this.aes.asm;var s=0;var r=e.length||0;var n=0;while(r>0){n=m(t,0,e,s,r);s+=n;r-=n;while(n&15)t[n++]=0;i.mac(x.MAC.GCM,x.HEAP_DATA,n)}};return n}();var _=function(){function s(e,t,i){this.aes=i?i:new u(e,t,false,"OFB")}s.encrypt=function(e,t,i){return new s(t,i).encrypt(e)};s.decrypt=function(e,t,i){return new s(t,i).decrypt(e)};s.prototype.encrypt=function(e){var t=this.aes.AES_Encrypt_process(e);var i=this.aes.AES_Encrypt_finish();return c(t,i)};s.prototype.decrypt=function(e){var t=this.aes.AES_Decrypt_process(e);var i=this.aes.AES_Decrypt_finish();return c(t,i)};return s}();var R=function(e,t,i){"use asm";var s=0;var he=new e.Uint32Array(i);var pe=e.Math.imul;function r(e){e=e|0;s=e=e+31&-32;return e|0}function y(e){e=e|0;var t=0;t=s;s=t+(e+31&-32)|0;return t|0}function w(e){e=e|0;s=s-(e+31&-32)|0}function S(e,t,i){e=e|0;t=t|0;i=i|0;var s=0;if((t|0)>(i|0)){for(;(s|0)<(e|0);s=s+4|0){he[i+s>>2]=he[t+s>>2]}}else{for(s=e-4|0;(s|0)>=0;s=s-4|0){he[i+s>>2]=he[t+s>>2]}}}function E(e,t,i){e=e|0;t=t|0;i=i|0;var s=0;for(;(s|0)<(e|0);s=s+4|0){he[i+s>>2]=t}}function d(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;var r=0,n=0,a=0,o=0,l=0;if((s|0)<=0)s=t;if((s|0)<(t|0))t=s;n=1;for(;(l|0)<(t|0);l=l+4|0){r=~he[e+l>>2];a=(r&0xffff)+n|0;o=(r>>>16)+(a>>>16)|0;he[i+l>>2]=o<<16|a&0xffff;n=o>>>16}for(;(l|0)<(s|0);l=l+4|0){he[i+l>>2]=n-1|0}return n|0}function C(e,t,i,s){e=e|0;t=t|0;i=i|0;s=s|0;var r=0,n=0,a=0;if((t|0)>(s|0)){for(a=t-4|0;(a|0)>=(s|0);a=a-4|0){if(he[e+a>>2]|0)return 1}}else{for(a=s-4|0;(a|0)>=(t|0);a=a-4|0){if(he[i+a>>2]|0)return-1}}for(;(a|0)>=0;a=a-4|0){r=he[e+a>>2]|0,n=he[i+a>>2]|0;if(r>>>0<n>>>0)return-1;if(r>>>0>n>>>0)return 1}return 0}function n(e,t){e=e|0;t=t|0;var i=0;for(i=t-4|0;(i|0)>=0;i=i-4|0){if(he[e+i>>2]|0)return i+4|0}return 0}function u(e,t,i,s,r,n){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;var a=0,o=0,l=0,d=0,c=0,f=0;if((t|0)<(s|0)){d=e,e=i,i=d;d=t,t=s,s=d}if((n|0)<=0)n=t+4|0;if((n|0)<(s|0))t=s=n;for(;(f|0)<(s|0);f=f+4|0){a=he[e+f>>2]|0;o=he[i+f>>2]|0;d=((a&0xffff)+(o&0xffff)|0)+l|0;c=((a>>>16)+(o>>>16)|0)+(d>>>16)|0;he[r+f>>2]=d&0xffff|c<<16;l=c>>>16}for(;(f|0)<(t|0);f=f+4|0){a=he[e+f>>2]|0;d=(a&0xffff)+l|0;c=(a>>>16)+(d>>>16)|0;he[r+f>>2]=d&0xffff|c<<16;l=c>>>16}for(;(f|0)<(n|0);f=f+4|0){he[r+f>>2]=l|0;l=0}return l|0}function I(e,t,i,s,r,n){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;var a=0,o=0,l=0,d=0,c=0,f=0;if((n|0)<=0)n=(t|0)>(s|0)?t+4|0:s+4|0;if((n|0)<(t|0))t=n;if((n|0)<(s|0))s=n;if((t|0)<(s|0)){for(;(f|0)<(t|0);f=f+4|0){a=he[e+f>>2]|0;o=he[i+f>>2]|0;d=((a&0xffff)-(o&0xffff)|0)+l|0;c=((a>>>16)-(o>>>16)|0)+(d>>16)|0;he[r+f>>2]=d&0xffff|c<<16;l=c>>16}for(;(f|0)<(s|0);f=f+4|0){o=he[i+f>>2]|0;d=l-(o&0xffff)|0;c=(d>>16)-(o>>>16)|0;he[r+f>>2]=d&0xffff|c<<16;l=c>>16}}else{for(;(f|0)<(s|0);f=f+4|0){a=he[e+f>>2]|0;o=he[i+f>>2]|0;d=((a&0xffff)-(o&0xffff)|0)+l|0;c=((a>>>16)-(o>>>16)|0)+(d>>16)|0;he[r+f>>2]=d&0xffff|c<<16;l=c>>16}for(;(f|0)<(t|0);f=f+4|0){a=he[e+f>>2]|0;d=(a&0xffff)+l|0;c=(a>>>16)+(d>>16)|0;he[r+f>>2]=d&0xffff|c<<16;l=c>>16}}for(;(f|0)<(n|0);f=f+4|0){he[r+f>>2]=l|0}return l|0}function de(e,t,i,s,r,n){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;var a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0,y=0,w=0,S=0,E=0,C=0,I=0,T=0,k=0,A=0,M=0,_=0,R=0,N=0,P=0,D=0,F=0,B=0,G=0,O=0,L=0,$=0,j=0,V=0,U=0,H=0,z=0,W=0,q=0,J=0,Z=0,K=0,X=0,Y=0,Q=0,ee=0,te=0,ie=0,se=0,re=0,ne=0,ae=0,oe=0,le=0;if((t|0)>(s|0)){ee=e,te=t;e=i,t=s;i=ee,s=te}se=t+s|0;if((n|0)>(se|0)|(n|0)<=0)n=se;if((n|0)<(t|0))t=n;if((n|0)<(s|0))s=n;for(;(re|0)<(t|0);re=re+32|0){ne=e+re|0;p=he[(ne|0)>>2]|0,m=he[(ne|4)>>2]|0,g=he[(ne|8)>>2]|0,x=he[(ne|12)>>2]|0,b=he[(ne|16)>>2]|0,v=he[(ne|20)>>2]|0,y=he[(ne|24)>>2]|0,w=he[(ne|28)>>2]|0,a=p&0xffff,o=m&0xffff,l=g&0xffff,d=x&0xffff,c=b&0xffff,f=v&0xffff,u=y&0xffff,h=w&0xffff,p=p>>>16,m=m>>>16,g=g>>>16,x=x>>>16,b=b>>>16,v=v>>>16,y=y>>>16,w=w>>>16;W=q=J=Z=K=X=Y=Q=0;for(ae=0;(ae|0)<(s|0);ae=ae+32|0){oe=i+ae|0;le=r+(re+ae|0)|0;_=he[(oe|0)>>2]|0,R=he[(oe|4)>>2]|0,N=he[(oe|8)>>2]|0,P=he[(oe|12)>>2]|0,D=he[(oe|16)>>2]|0,F=he[(oe|20)>>2]|0,B=he[(oe|24)>>2]|0,G=he[(oe|28)>>2]|0,S=_&0xffff,E=R&0xffff,C=N&0xffff,I=P&0xffff,T=D&0xffff,k=F&0xffff,A=B&0xffff,M=G&0xffff,_=_>>>16,R=R>>>16,N=N>>>16,P=P>>>16,D=D>>>16,F=F>>>16,B=B>>>16,G=G>>>16;O=he[(le|0)>>2]|0,L=he[(le|4)>>2]|0,$=he[(le|8)>>2]|0,j=he[(le|12)>>2]|0,V=he[(le|16)>>2]|0,U=he[(le|20)>>2]|0,H=he[(le|24)>>2]|0,z=he[(le|28)>>2]|0;ee=((pe(a,S)|0)+(W&0xffff)|0)+(O&0xffff)|0;te=((pe(p,S)|0)+(W>>>16)|0)+(O>>>16)|0;ie=((pe(a,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,_)|0)+(te>>>16)|0)+(ie>>>16)|0;O=ie<<16|ee&0xffff;ee=((pe(a,E)|0)+(se&0xffff)|0)+(L&0xffff)|0;te=((pe(p,E)|0)+(se>>>16)|0)+(L>>>16)|0;ie=((pe(a,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,R)|0)+(te>>>16)|0)+(ie>>>16)|0;L=ie<<16|ee&0xffff;ee=((pe(a,C)|0)+(se&0xffff)|0)+($&0xffff)|0;te=((pe(p,C)|0)+(se>>>16)|0)+($>>>16)|0;ie=((pe(a,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,N)|0)+(te>>>16)|0)+(ie>>>16)|0;$=ie<<16|ee&0xffff;ee=((pe(a,I)|0)+(se&0xffff)|0)+(j&0xffff)|0;te=((pe(p,I)|0)+(se>>>16)|0)+(j>>>16)|0;ie=((pe(a,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,P)|0)+(te>>>16)|0)+(ie>>>16)|0;j=ie<<16|ee&0xffff;ee=((pe(a,T)|0)+(se&0xffff)|0)+(V&0xffff)|0;te=((pe(p,T)|0)+(se>>>16)|0)+(V>>>16)|0;ie=((pe(a,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,D)|0)+(te>>>16)|0)+(ie>>>16)|0;V=ie<<16|ee&0xffff;ee=((pe(a,k)|0)+(se&0xffff)|0)+(U&0xffff)|0;te=((pe(p,k)|0)+(se>>>16)|0)+(U>>>16)|0;ie=((pe(a,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,F)|0)+(te>>>16)|0)+(ie>>>16)|0;U=ie<<16|ee&0xffff;ee=((pe(a,A)|0)+(se&0xffff)|0)+(H&0xffff)|0;te=((pe(p,A)|0)+(se>>>16)|0)+(H>>>16)|0;ie=((pe(a,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,B)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(a,M)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(p,M)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(a,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(p,G)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;W=se;ee=((pe(o,S)|0)+(q&0xffff)|0)+(L&0xffff)|0;te=((pe(m,S)|0)+(q>>>16)|0)+(L>>>16)|0;ie=((pe(o,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,_)|0)+(te>>>16)|0)+(ie>>>16)|0;L=ie<<16|ee&0xffff;ee=((pe(o,E)|0)+(se&0xffff)|0)+($&0xffff)|0;te=((pe(m,E)|0)+(se>>>16)|0)+($>>>16)|0;ie=((pe(o,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,R)|0)+(te>>>16)|0)+(ie>>>16)|0;$=ie<<16|ee&0xffff;ee=((pe(o,C)|0)+(se&0xffff)|0)+(j&0xffff)|0;te=((pe(m,C)|0)+(se>>>16)|0)+(j>>>16)|0;ie=((pe(o,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,N)|0)+(te>>>16)|0)+(ie>>>16)|0;j=ie<<16|ee&0xffff;ee=((pe(o,I)|0)+(se&0xffff)|0)+(V&0xffff)|0;te=((pe(m,I)|0)+(se>>>16)|0)+(V>>>16)|0;ie=((pe(o,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,P)|0)+(te>>>16)|0)+(ie>>>16)|0;V=ie<<16|ee&0xffff;ee=((pe(o,T)|0)+(se&0xffff)|0)+(U&0xffff)|0;te=((pe(m,T)|0)+(se>>>16)|0)+(U>>>16)|0;ie=((pe(o,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,D)|0)+(te>>>16)|0)+(ie>>>16)|0;U=ie<<16|ee&0xffff;ee=((pe(o,k)|0)+(se&0xffff)|0)+(H&0xffff)|0;te=((pe(m,k)|0)+(se>>>16)|0)+(H>>>16)|0;ie=((pe(o,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,F)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(o,A)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(m,A)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(o,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,B)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(o,M)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(m,M)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(o,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(m,G)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;q=se;ee=((pe(l,S)|0)+(J&0xffff)|0)+($&0xffff)|0;te=((pe(g,S)|0)+(J>>>16)|0)+($>>>16)|0;ie=((pe(l,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,_)|0)+(te>>>16)|0)+(ie>>>16)|0;$=ie<<16|ee&0xffff;ee=((pe(l,E)|0)+(se&0xffff)|0)+(j&0xffff)|0;te=((pe(g,E)|0)+(se>>>16)|0)+(j>>>16)|0;ie=((pe(l,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,R)|0)+(te>>>16)|0)+(ie>>>16)|0;j=ie<<16|ee&0xffff;ee=((pe(l,C)|0)+(se&0xffff)|0)+(V&0xffff)|0;te=((pe(g,C)|0)+(se>>>16)|0)+(V>>>16)|0;ie=((pe(l,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,N)|0)+(te>>>16)|0)+(ie>>>16)|0;V=ie<<16|ee&0xffff;ee=((pe(l,I)|0)+(se&0xffff)|0)+(U&0xffff)|0;te=((pe(g,I)|0)+(se>>>16)|0)+(U>>>16)|0;ie=((pe(l,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,P)|0)+(te>>>16)|0)+(ie>>>16)|0;U=ie<<16|ee&0xffff;ee=((pe(l,T)|0)+(se&0xffff)|0)+(H&0xffff)|0;te=((pe(g,T)|0)+(se>>>16)|0)+(H>>>16)|0;ie=((pe(l,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,D)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(l,k)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(g,k)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(l,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,F)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(l,A)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(g,A)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(l,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,B)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;ee=((pe(l,M)|0)+(se&0xffff)|0)+(q&0xffff)|0;te=((pe(g,M)|0)+(se>>>16)|0)+(q>>>16)|0;ie=((pe(l,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(g,G)|0)+(te>>>16)|0)+(ie>>>16)|0;q=ie<<16|ee&0xffff;J=se;ee=((pe(d,S)|0)+(Z&0xffff)|0)+(j&0xffff)|0;te=((pe(x,S)|0)+(Z>>>16)|0)+(j>>>16)|0;ie=((pe(d,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,_)|0)+(te>>>16)|0)+(ie>>>16)|0;j=ie<<16|ee&0xffff;ee=((pe(d,E)|0)+(se&0xffff)|0)+(V&0xffff)|0;te=((pe(x,E)|0)+(se>>>16)|0)+(V>>>16)|0;ie=((pe(d,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,R)|0)+(te>>>16)|0)+(ie>>>16)|0;V=ie<<16|ee&0xffff;ee=((pe(d,C)|0)+(se&0xffff)|0)+(U&0xffff)|0;te=((pe(x,C)|0)+(se>>>16)|0)+(U>>>16)|0;ie=((pe(d,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,N)|0)+(te>>>16)|0)+(ie>>>16)|0;U=ie<<16|ee&0xffff;ee=((pe(d,I)|0)+(se&0xffff)|0)+(H&0xffff)|0;te=((pe(x,I)|0)+(se>>>16)|0)+(H>>>16)|0;ie=((pe(d,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,P)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(d,T)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(x,T)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(d,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,D)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(d,k)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(x,k)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(d,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,F)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;ee=((pe(d,A)|0)+(se&0xffff)|0)+(q&0xffff)|0;te=((pe(x,A)|0)+(se>>>16)|0)+(q>>>16)|0;ie=((pe(d,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,B)|0)+(te>>>16)|0)+(ie>>>16)|0;q=ie<<16|ee&0xffff;ee=((pe(d,M)|0)+(se&0xffff)|0)+(J&0xffff)|0;te=((pe(x,M)|0)+(se>>>16)|0)+(J>>>16)|0;ie=((pe(d,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(x,G)|0)+(te>>>16)|0)+(ie>>>16)|0;J=ie<<16|ee&0xffff;Z=se;ee=((pe(c,S)|0)+(K&0xffff)|0)+(V&0xffff)|0;te=((pe(b,S)|0)+(K>>>16)|0)+(V>>>16)|0;ie=((pe(c,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,_)|0)+(te>>>16)|0)+(ie>>>16)|0;V=ie<<16|ee&0xffff;ee=((pe(c,E)|0)+(se&0xffff)|0)+(U&0xffff)|0;te=((pe(b,E)|0)+(se>>>16)|0)+(U>>>16)|0;ie=((pe(c,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,R)|0)+(te>>>16)|0)+(ie>>>16)|0;U=ie<<16|ee&0xffff;ee=((pe(c,C)|0)+(se&0xffff)|0)+(H&0xffff)|0;te=((pe(b,C)|0)+(se>>>16)|0)+(H>>>16)|0;ie=((pe(c,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,N)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(c,I)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(b,I)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(c,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,P)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(c,T)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(b,T)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(c,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,D)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;ee=((pe(c,k)|0)+(se&0xffff)|0)+(q&0xffff)|0;te=((pe(b,k)|0)+(se>>>16)|0)+(q>>>16)|0;ie=((pe(c,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,F)|0)+(te>>>16)|0)+(ie>>>16)|0;q=ie<<16|ee&0xffff;ee=((pe(c,A)|0)+(se&0xffff)|0)+(J&0xffff)|0;te=((pe(b,A)|0)+(se>>>16)|0)+(J>>>16)|0;ie=((pe(c,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,B)|0)+(te>>>16)|0)+(ie>>>16)|0;J=ie<<16|ee&0xffff;ee=((pe(c,M)|0)+(se&0xffff)|0)+(Z&0xffff)|0;te=((pe(b,M)|0)+(se>>>16)|0)+(Z>>>16)|0;ie=((pe(c,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(b,G)|0)+(te>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ee&0xffff;K=se;ee=((pe(f,S)|0)+(X&0xffff)|0)+(U&0xffff)|0;te=((pe(v,S)|0)+(X>>>16)|0)+(U>>>16)|0;ie=((pe(f,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,_)|0)+(te>>>16)|0)+(ie>>>16)|0;U=ie<<16|ee&0xffff;ee=((pe(f,E)|0)+(se&0xffff)|0)+(H&0xffff)|0;te=((pe(v,E)|0)+(se>>>16)|0)+(H>>>16)|0;ie=((pe(f,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,R)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(f,C)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(v,C)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(f,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,N)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(f,I)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(v,I)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(f,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,P)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;ee=((pe(f,T)|0)+(se&0xffff)|0)+(q&0xffff)|0;te=((pe(v,T)|0)+(se>>>16)|0)+(q>>>16)|0;ie=((pe(f,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,D)|0)+(te>>>16)|0)+(ie>>>16)|0;q=ie<<16|ee&0xffff;ee=((pe(f,k)|0)+(se&0xffff)|0)+(J&0xffff)|0;te=((pe(v,k)|0)+(se>>>16)|0)+(J>>>16)|0;ie=((pe(f,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,F)|0)+(te>>>16)|0)+(ie>>>16)|0;J=ie<<16|ee&0xffff;ee=((pe(f,A)|0)+(se&0xffff)|0)+(Z&0xffff)|0;te=((pe(v,A)|0)+(se>>>16)|0)+(Z>>>16)|0;ie=((pe(f,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,B)|0)+(te>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ee&0xffff;ee=((pe(f,M)|0)+(se&0xffff)|0)+(K&0xffff)|0;te=((pe(v,M)|0)+(se>>>16)|0)+(K>>>16)|0;ie=((pe(f,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(v,G)|0)+(te>>>16)|0)+(ie>>>16)|0;K=ie<<16|ee&0xffff;X=se;ee=((pe(u,S)|0)+(Y&0xffff)|0)+(H&0xffff)|0;te=((pe(y,S)|0)+(Y>>>16)|0)+(H>>>16)|0;ie=((pe(u,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,_)|0)+(te>>>16)|0)+(ie>>>16)|0;H=ie<<16|ee&0xffff;ee=((pe(u,E)|0)+(se&0xffff)|0)+(z&0xffff)|0;te=((pe(y,E)|0)+(se>>>16)|0)+(z>>>16)|0;ie=((pe(u,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,R)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(u,C)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(y,C)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(u,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,N)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;ee=((pe(u,I)|0)+(se&0xffff)|0)+(q&0xffff)|0;te=((pe(y,I)|0)+(se>>>16)|0)+(q>>>16)|0;ie=((pe(u,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,P)|0)+(te>>>16)|0)+(ie>>>16)|0;q=ie<<16|ee&0xffff;ee=((pe(u,T)|0)+(se&0xffff)|0)+(J&0xffff)|0;te=((pe(y,T)|0)+(se>>>16)|0)+(J>>>16)|0;ie=((pe(u,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,D)|0)+(te>>>16)|0)+(ie>>>16)|0;J=ie<<16|ee&0xffff;ee=((pe(u,k)|0)+(se&0xffff)|0)+(Z&0xffff)|0;te=((pe(y,k)|0)+(se>>>16)|0)+(Z>>>16)|0;ie=((pe(u,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,F)|0)+(te>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ee&0xffff;ee=((pe(u,A)|0)+(se&0xffff)|0)+(K&0xffff)|0;te=((pe(y,A)|0)+(se>>>16)|0)+(K>>>16)|0;ie=((pe(u,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,B)|0)+(te>>>16)|0)+(ie>>>16)|0;K=ie<<16|ee&0xffff;ee=((pe(u,M)|0)+(se&0xffff)|0)+(X&0xffff)|0;te=((pe(y,M)|0)+(se>>>16)|0)+(X>>>16)|0;ie=((pe(u,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(y,G)|0)+(te>>>16)|0)+(ie>>>16)|0;X=ie<<16|ee&0xffff;Y=se;ee=((pe(h,S)|0)+(Q&0xffff)|0)+(z&0xffff)|0;te=((pe(w,S)|0)+(Q>>>16)|0)+(z>>>16)|0;ie=((pe(h,_)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,_)|0)+(te>>>16)|0)+(ie>>>16)|0;z=ie<<16|ee&0xffff;ee=((pe(h,E)|0)+(se&0xffff)|0)+(W&0xffff)|0;te=((pe(w,E)|0)+(se>>>16)|0)+(W>>>16)|0;ie=((pe(h,R)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,R)|0)+(te>>>16)|0)+(ie>>>16)|0;W=ie<<16|ee&0xffff;ee=((pe(h,C)|0)+(se&0xffff)|0)+(q&0xffff)|0;te=((pe(w,C)|0)+(se>>>16)|0)+(q>>>16)|0;ie=((pe(h,N)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,N)|0)+(te>>>16)|0)+(ie>>>16)|0;q=ie<<16|ee&0xffff;ee=((pe(h,I)|0)+(se&0xffff)|0)+(J&0xffff)|0;te=((pe(w,I)|0)+(se>>>16)|0)+(J>>>16)|0;ie=((pe(h,P)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,P)|0)+(te>>>16)|0)+(ie>>>16)|0;J=ie<<16|ee&0xffff;ee=((pe(h,T)|0)+(se&0xffff)|0)+(Z&0xffff)|0;te=((pe(w,T)|0)+(se>>>16)|0)+(Z>>>16)|0;ie=((pe(h,D)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,D)|0)+(te>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ee&0xffff;ee=((pe(h,k)|0)+(se&0xffff)|0)+(K&0xffff)|0;te=((pe(w,k)|0)+(se>>>16)|0)+(K>>>16)|0;ie=((pe(h,F)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,F)|0)+(te>>>16)|0)+(ie>>>16)|0;K=ie<<16|ee&0xffff;ee=((pe(h,A)|0)+(se&0xffff)|0)+(X&0xffff)|0;te=((pe(w,A)|0)+(se>>>16)|0)+(X>>>16)|0;ie=((pe(h,B)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,B)|0)+(te>>>16)|0)+(ie>>>16)|0;X=ie<<16|ee&0xffff;ee=((pe(h,M)|0)+(se&0xffff)|0)+(Y&0xffff)|0;te=((pe(w,M)|0)+(se>>>16)|0)+(Y>>>16)|0;ie=((pe(h,G)|0)+(te&0xffff)|0)+(ee>>>16)|0;se=((pe(w,G)|0)+(te>>>16)|0)+(ie>>>16)|0;Y=ie<<16|ee&0xffff;Q=se;he[(le|0)>>2]=O,he[(le|4)>>2]=L,he[(le|8)>>2]=$,he[(le|12)>>2]=j,he[(le|16)>>2]=V,he[(le|20)>>2]=U,he[(le|24)>>2]=H,he[(le|28)>>2]=z}le=r+(re+ae|0)|0;he[(le|0)>>2]=W,he[(le|4)>>2]=q,he[(le|8)>>2]=J,he[(le|12)>>2]=Z,he[(le|16)>>2]=K,he[(le|20)>>2]=X,he[(le|24)>>2]=Y,he[(le|28)>>2]=Q}}function me(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0,n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0,y=0,w=0,S=0,E=0,C=0,I=0,T=0,k=0,A=0,M=0,_=0,R=0,N=0,P=0,D=0,F=0,B=0,G=0,O=0,L=0,$=0,j=0,V=0,U=0,H=0,z=0,W=0,q=0,J=0,Z=0,K=0,X=0,Y=0,Q=0,ee=0,te=0,ie=0,se=0,re=0,ne=0,ae=0,oe=0,le=0,de=0,ce=0,fe=0,ue=0;for(;(oe|0)<(t|0);oe=oe+4|0){ue=i+(oe<<1)|0;f=he[e+oe>>2]|0,s=f&0xffff,f=f>>>16;X=pe(s,s)|0;Y=(pe(s,f)|0)+(X>>>17)|0;Q=(pe(f,f)|0)+(Y>>>15)|0;he[ue>>2]=Y<<17|X&0x1ffff;he[(ue|4)>>2]=Q}for(ae=0;(ae|0)<(t|0);ae=ae+8|0){ce=e+ae|0,ue=i+(ae<<1)|0;f=he[ce>>2]|0,s=f&0xffff,f=f>>>16;k=he[(ce|4)>>2]|0,v=k&0xffff,k=k>>>16;X=pe(s,v)|0;Y=(pe(s,k)|0)+(X>>>16)|0;Q=(pe(f,v)|0)+(Y&0xffff)|0;ie=((pe(f,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;se=he[(ue|4)>>2]|0;X=(se&0xffff)+((X&0xffff)<<1)|0;Q=((se>>>16)+((Q&0xffff)<<1)|0)+(X>>>16)|0;he[(ue|4)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|8)>>2]|0;X=((se&0xffff)+((ie&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(ie>>>16<<1)|0)+(X>>>16)|0;he[(ue|8)>>2]=Q<<16|X&0xffff;ee=Q>>>16;if(ee){se=he[(ue|12)>>2]|0;X=(se&0xffff)+ee|0;Q=(se>>>16)+(X>>>16)|0;he[(ue|12)>>2]=Q<<16|X&0xffff}}for(ae=0;(ae|0)<(t|0);ae=ae+16|0){ce=e+ae|0,ue=i+(ae<<1)|0;f=he[ce>>2]|0,s=f&0xffff,f=f>>>16,u=he[(ce|4)>>2]|0,r=u&0xffff,u=u>>>16;k=he[(ce|8)>>2]|0,v=k&0xffff,k=k>>>16,A=he[(ce|12)>>2]|0,y=A&0xffff,A=A>>>16;X=pe(s,v)|0;Y=pe(f,v)|0;Q=((pe(s,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;F=Q<<16|X&0xffff;X=(pe(s,y)|0)+(ie&0xffff)|0;Y=(pe(f,y)|0)+(ie>>>16)|0;Q=((pe(s,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;B=Q<<16|X&0xffff;G=ie;X=(pe(r,v)|0)+(B&0xffff)|0;Y=(pe(u,v)|0)+(B>>>16)|0;Q=((pe(r,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;B=Q<<16|X&0xffff;X=((pe(r,y)|0)+(G&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,y)|0)+(G>>>16)|0)+(ie>>>16)|0;Q=((pe(r,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;O=ie;se=he[(ue|8)>>2]|0;X=(se&0xffff)+((F&0xffff)<<1)|0;Q=((se>>>16)+(F>>>16<<1)|0)+(X>>>16)|0;he[(ue|8)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|12)>>2]|0;X=((se&0xffff)+((B&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(B>>>16<<1)|0)+(X>>>16)|0;he[(ue|12)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|16)>>2]|0;X=((se&0xffff)+((G&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(G>>>16<<1)|0)+(X>>>16)|0;he[(ue|16)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|20)>>2]|0;X=((se&0xffff)+((O&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(O>>>16<<1)|0)+(X>>>16)|0;he[(ue|20)>>2]=Q<<16|X&0xffff;ee=Q>>>16;for(de=24;!!ee&(de|0)<32;de=de+4|0){se=he[(ue|de)>>2]|0;X=(se&0xffff)+ee|0;Q=(se>>>16)+(X>>>16)|0;he[(ue|de)>>2]=Q<<16|X&0xffff;ee=Q>>>16}}for(ae=0;(ae|0)<(t|0);ae=ae+32|0){ce=e+ae|0,ue=i+(ae<<1)|0;f=he[ce>>2]|0,s=f&0xffff,f=f>>>16,u=he[(ce|4)>>2]|0,r=u&0xffff,u=u>>>16,h=he[(ce|8)>>2]|0,n=h&0xffff,h=h>>>16,p=he[(ce|12)>>2]|0,a=p&0xffff,p=p>>>16;k=he[(ce|16)>>2]|0,v=k&0xffff,k=k>>>16,A=he[(ce|20)>>2]|0,y=A&0xffff,A=A>>>16,M=he[(ce|24)>>2]|0,w=M&0xffff,M=M>>>16,_=he[(ce|28)>>2]|0,S=_&0xffff,_=_>>>16;X=pe(s,v)|0;Y=pe(f,v)|0;Q=((pe(s,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;F=Q<<16|X&0xffff;X=(pe(s,y)|0)+(ie&0xffff)|0;Y=(pe(f,y)|0)+(ie>>>16)|0;Q=((pe(s,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;B=Q<<16|X&0xffff;X=(pe(s,w)|0)+(ie&0xffff)|0;Y=(pe(f,w)|0)+(ie>>>16)|0;Q=((pe(s,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;X=(pe(s,S)|0)+(ie&0xffff)|0;Y=(pe(f,S)|0)+(ie>>>16)|0;Q=((pe(s,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;L=ie;X=(pe(r,v)|0)+(B&0xffff)|0;Y=(pe(u,v)|0)+(B>>>16)|0;Q=((pe(r,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;B=Q<<16|X&0xffff;X=((pe(r,y)|0)+(G&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,y)|0)+(G>>>16)|0)+(ie>>>16)|0;Q=((pe(r,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;X=((pe(r,w)|0)+(O&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,w)|0)+(O>>>16)|0)+(ie>>>16)|0;Q=((pe(r,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(r,S)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,S)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(r,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;$=ie;X=(pe(n,v)|0)+(G&0xffff)|0;Y=(pe(h,v)|0)+(G>>>16)|0;Q=((pe(n,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;X=((pe(n,y)|0)+(O&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,y)|0)+(O>>>16)|0)+(ie>>>16)|0;Q=((pe(n,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(n,w)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,w)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(n,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(n,S)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,S)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(n,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;j=ie;X=(pe(a,v)|0)+(O&0xffff)|0;Y=(pe(p,v)|0)+(O>>>16)|0;Q=((pe(a,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(a,y)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,y)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(a,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(a,w)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,w)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(a,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(a,S)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,S)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(a,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;V=ie;se=he[(ue|16)>>2]|0;X=(se&0xffff)+((F&0xffff)<<1)|0;Q=((se>>>16)+(F>>>16<<1)|0)+(X>>>16)|0;he[(ue|16)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|20)>>2]|0;X=((se&0xffff)+((B&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(B>>>16<<1)|0)+(X>>>16)|0;he[(ue|20)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|24)>>2]|0;X=((se&0xffff)+((G&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(G>>>16<<1)|0)+(X>>>16)|0;he[(ue|24)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[(ue|28)>>2]|0;X=((se&0xffff)+((O&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(O>>>16<<1)|0)+(X>>>16)|0;he[(ue|28)>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[ue+32>>2]|0;X=((se&0xffff)+((L&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(L>>>16<<1)|0)+(X>>>16)|0;he[ue+32>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[ue+36>>2]|0;X=((se&0xffff)+(($&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+($>>>16<<1)|0)+(X>>>16)|0;he[ue+36>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[ue+40>>2]|0;X=((se&0xffff)+((j&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(j>>>16<<1)|0)+(X>>>16)|0;he[ue+40>>2]=Q<<16|X&0xffff;ee=Q>>>16;se=he[ue+44>>2]|0;X=((se&0xffff)+((V&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(V>>>16<<1)|0)+(X>>>16)|0;he[ue+44>>2]=Q<<16|X&0xffff;ee=Q>>>16;for(de=48;!!ee&(de|0)<64;de=de+4|0){se=he[ue+de>>2]|0;X=(se&0xffff)+ee|0;Q=(se>>>16)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16}}for(re=32;(re|0)<(t|0);re=re<<1){ne=re<<1;for(ae=0;(ae|0)<(t|0);ae=ae+ne|0){ue=i+(ae<<1)|0;te=0;for(oe=0;(oe|0)<(re|0);oe=oe+32|0){ce=(e+ae|0)+oe|0;f=he[ce>>2]|0,s=f&0xffff,f=f>>>16,u=he[(ce|4)>>2]|0,r=u&0xffff,u=u>>>16,h=he[(ce|8)>>2]|0,n=h&0xffff,h=h>>>16,p=he[(ce|12)>>2]|0,a=p&0xffff,p=p>>>16,m=he[(ce|16)>>2]|0,o=m&0xffff,m=m>>>16,g=he[(ce|20)>>2]|0,l=g&0xffff,g=g>>>16,x=he[(ce|24)>>2]|0,d=x&0xffff,x=x>>>16,b=he[(ce|28)>>2]|0,c=b&0xffff,b=b>>>16;U=H=z=W=q=J=Z=K=ee=0;for(le=0;(le|0)<(re|0);le=le+32|0){fe=((e+ae|0)+re|0)+le|0;k=he[fe>>2]|0,v=k&0xffff,k=k>>>16,A=he[(fe|4)>>2]|0,y=A&0xffff,A=A>>>16,M=he[(fe|8)>>2]|0,w=M&0xffff,M=M>>>16,_=he[(fe|12)>>2]|0,S=_&0xffff,_=_>>>16,R=he[(fe|16)>>2]|0,E=R&0xffff,R=R>>>16,N=he[(fe|20)>>2]|0,C=N&0xffff,N=N>>>16,P=he[(fe|24)>>2]|0,I=P&0xffff,P=P>>>16,D=he[(fe|28)>>2]|0,T=D&0xffff,D=D>>>16;F=B=G=O=L=$=j=V=0;X=((pe(s,v)|0)+(F&0xffff)|0)+(U&0xffff)|0;Y=((pe(f,v)|0)+(F>>>16)|0)+(U>>>16)|0;Q=((pe(s,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;F=Q<<16|X&0xffff;X=((pe(s,y)|0)+(B&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,y)|0)+(B>>>16)|0)+(ie>>>16)|0;Q=((pe(s,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;B=Q<<16|X&0xffff;X=((pe(s,w)|0)+(G&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,w)|0)+(G>>>16)|0)+(ie>>>16)|0;Q=((pe(s,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;X=((pe(s,S)|0)+(O&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,S)|0)+(O>>>16)|0)+(ie>>>16)|0;Q=((pe(s,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(s,E)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,E)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(s,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(s,C)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,C)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(s,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(s,I)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,I)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(s,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(s,T)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(f,T)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(s,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(f,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;U=ie;X=((pe(r,v)|0)+(B&0xffff)|0)+(H&0xffff)|0;Y=((pe(u,v)|0)+(B>>>16)|0)+(H>>>16)|0;Q=((pe(r,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;B=Q<<16|X&0xffff;X=((pe(r,y)|0)+(G&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,y)|0)+(G>>>16)|0)+(ie>>>16)|0;Q=((pe(r,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;X=((pe(r,w)|0)+(O&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,w)|0)+(O>>>16)|0)+(ie>>>16)|0;Q=((pe(r,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(r,S)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,S)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(r,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(r,E)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,E)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(r,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(r,C)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,C)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(r,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(r,I)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,I)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(r,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(r,T)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(u,T)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(r,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(u,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;H=ie;X=((pe(n,v)|0)+(G&0xffff)|0)+(z&0xffff)|0;Y=((pe(h,v)|0)+(G>>>16)|0)+(z>>>16)|0;Q=((pe(n,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;G=Q<<16|X&0xffff;X=((pe(n,y)|0)+(O&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,y)|0)+(O>>>16)|0)+(ie>>>16)|0;Q=((pe(n,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(n,w)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,w)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(n,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(n,S)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,S)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(n,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(n,E)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,E)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(n,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(n,C)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,C)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(n,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(n,I)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,I)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(n,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;X=((pe(n,T)|0)+(H&0xffff)|0)+(ie&0xffff)|0;Y=((pe(h,T)|0)+(H>>>16)|0)+(ie>>>16)|0;Q=((pe(n,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(h,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;H=Q<<16|X&0xffff;z=ie;X=((pe(a,v)|0)+(O&0xffff)|0)+(W&0xffff)|0;Y=((pe(p,v)|0)+(O>>>16)|0)+(W>>>16)|0;Q=((pe(a,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;O=Q<<16|X&0xffff;X=((pe(a,y)|0)+(L&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,y)|0)+(L>>>16)|0)+(ie>>>16)|0;Q=((pe(a,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(a,w)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,w)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(a,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(a,S)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,S)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(a,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(a,E)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,E)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(a,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(a,C)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,C)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(a,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;X=((pe(a,I)|0)+(H&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,I)|0)+(H>>>16)|0)+(ie>>>16)|0;Q=((pe(a,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;H=Q<<16|X&0xffff;X=((pe(a,T)|0)+(z&0xffff)|0)+(ie&0xffff)|0;Y=((pe(p,T)|0)+(z>>>16)|0)+(ie>>>16)|0;Q=((pe(a,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(p,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;z=Q<<16|X&0xffff;W=ie;X=((pe(o,v)|0)+(L&0xffff)|0)+(q&0xffff)|0;Y=((pe(m,v)|0)+(L>>>16)|0)+(q>>>16)|0;Q=((pe(o,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;L=Q<<16|X&0xffff;X=((pe(o,y)|0)+($&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,y)|0)+($>>>16)|0)+(ie>>>16)|0;Q=((pe(o,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(o,w)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,w)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(o,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(o,S)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,S)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(o,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(o,E)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,E)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(o,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;X=((pe(o,C)|0)+(H&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,C)|0)+(H>>>16)|0)+(ie>>>16)|0;Q=((pe(o,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;H=Q<<16|X&0xffff;X=((pe(o,I)|0)+(z&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,I)|0)+(z>>>16)|0)+(ie>>>16)|0;Q=((pe(o,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;z=Q<<16|X&0xffff;X=((pe(o,T)|0)+(W&0xffff)|0)+(ie&0xffff)|0;Y=((pe(m,T)|0)+(W>>>16)|0)+(ie>>>16)|0;Q=((pe(o,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(m,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;W=Q<<16|X&0xffff;q=ie;X=((pe(l,v)|0)+($&0xffff)|0)+(J&0xffff)|0;Y=((pe(g,v)|0)+($>>>16)|0)+(J>>>16)|0;Q=((pe(l,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;$=Q<<16|X&0xffff;X=((pe(l,y)|0)+(j&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,y)|0)+(j>>>16)|0)+(ie>>>16)|0;Q=((pe(l,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(l,w)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,w)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(l,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(l,S)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,S)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(l,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;X=((pe(l,E)|0)+(H&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,E)|0)+(H>>>16)|0)+(ie>>>16)|0;Q=((pe(l,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;H=Q<<16|X&0xffff;X=((pe(l,C)|0)+(z&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,C)|0)+(z>>>16)|0)+(ie>>>16)|0;Q=((pe(l,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;z=Q<<16|X&0xffff;X=((pe(l,I)|0)+(W&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,I)|0)+(W>>>16)|0)+(ie>>>16)|0;Q=((pe(l,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;W=Q<<16|X&0xffff;X=((pe(l,T)|0)+(q&0xffff)|0)+(ie&0xffff)|0;Y=((pe(g,T)|0)+(q>>>16)|0)+(ie>>>16)|0;Q=((pe(l,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(g,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;q=Q<<16|X&0xffff;J=ie;X=((pe(d,v)|0)+(j&0xffff)|0)+(Z&0xffff)|0;Y=((pe(x,v)|0)+(j>>>16)|0)+(Z>>>16)|0;Q=((pe(d,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;j=Q<<16|X&0xffff;X=((pe(d,y)|0)+(V&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,y)|0)+(V>>>16)|0)+(ie>>>16)|0;Q=((pe(d,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(d,w)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,w)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(d,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;X=((pe(d,S)|0)+(H&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,S)|0)+(H>>>16)|0)+(ie>>>16)|0;Q=((pe(d,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;H=Q<<16|X&0xffff;X=((pe(d,E)|0)+(z&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,E)|0)+(z>>>16)|0)+(ie>>>16)|0;Q=((pe(d,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;z=Q<<16|X&0xffff;X=((pe(d,C)|0)+(W&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,C)|0)+(W>>>16)|0)+(ie>>>16)|0;Q=((pe(d,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;W=Q<<16|X&0xffff;X=((pe(d,I)|0)+(q&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,I)|0)+(q>>>16)|0)+(ie>>>16)|0;Q=((pe(d,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;q=Q<<16|X&0xffff;X=((pe(d,T)|0)+(J&0xffff)|0)+(ie&0xffff)|0;Y=((pe(x,T)|0)+(J>>>16)|0)+(ie>>>16)|0;Q=((pe(d,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(x,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;J=Q<<16|X&0xffff;Z=ie;X=((pe(c,v)|0)+(V&0xffff)|0)+(K&0xffff)|0;Y=((pe(b,v)|0)+(V>>>16)|0)+(K>>>16)|0;Q=((pe(c,k)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,k)|0)+(Y>>>16)|0)+(Q>>>16)|0;V=Q<<16|X&0xffff;X=((pe(c,y)|0)+(U&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,y)|0)+(U>>>16)|0)+(ie>>>16)|0;Q=((pe(c,A)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,A)|0)+(Y>>>16)|0)+(Q>>>16)|0;U=Q<<16|X&0xffff;X=((pe(c,w)|0)+(H&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,w)|0)+(H>>>16)|0)+(ie>>>16)|0;Q=((pe(c,M)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,M)|0)+(Y>>>16)|0)+(Q>>>16)|0;H=Q<<16|X&0xffff;X=((pe(c,S)|0)+(z&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,S)|0)+(z>>>16)|0)+(ie>>>16)|0;Q=((pe(c,_)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,_)|0)+(Y>>>16)|0)+(Q>>>16)|0;z=Q<<16|X&0xffff;X=((pe(c,E)|0)+(W&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,E)|0)+(W>>>16)|0)+(ie>>>16)|0;Q=((pe(c,R)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,R)|0)+(Y>>>16)|0)+(Q>>>16)|0;W=Q<<16|X&0xffff;X=((pe(c,C)|0)+(q&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,C)|0)+(q>>>16)|0)+(ie>>>16)|0;Q=((pe(c,N)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,N)|0)+(Y>>>16)|0)+(Q>>>16)|0;q=Q<<16|X&0xffff;X=((pe(c,I)|0)+(J&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,I)|0)+(J>>>16)|0)+(ie>>>16)|0;Q=((pe(c,P)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,P)|0)+(Y>>>16)|0)+(Q>>>16)|0;J=Q<<16|X&0xffff;X=((pe(c,T)|0)+(Z&0xffff)|0)+(ie&0xffff)|0;Y=((pe(b,T)|0)+(Z>>>16)|0)+(ie>>>16)|0;Q=((pe(c,D)|0)+(Y&0xffff)|0)+(X>>>16)|0;ie=((pe(b,D)|0)+(Y>>>16)|0)+(Q>>>16)|0;Z=Q<<16|X&0xffff;K=ie;de=re+(oe+le|0)|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((F&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(F>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((B&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(B>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((G&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(G>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((O&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(O>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((L&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(L>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+(($&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+($>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((j&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(j>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((V&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(V>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16}de=re+(oe+le|0)|0;se=he[ue+de>>2]|0;X=(((se&0xffff)+((U&0xffff)<<1)|0)+ee|0)+te|0;Q=((se>>>16)+(U>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((H&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(H>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((z&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(z>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((W&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(W>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((q&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(q>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((J&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(J>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((Z&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(Z>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;ee=Q>>>16;de=de+4|0;se=he[ue+de>>2]|0;X=((se&0xffff)+((K&0xffff)<<1)|0)+ee|0;Q=((se>>>16)+(K>>>16<<1)|0)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;te=Q>>>16}for(de=de+4|0;!!te&(de|0)<ne<<1;de=de+4|0){se=he[ue+de>>2]|0;X=(se&0xffff)+te|0;Q=(se>>>16)+(X>>>16)|0;he[ue+de>>2]=Q<<16|X&0xffff;te=Q>>>16}}}}function T(e,t,i,s,r){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;var n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0,y=0,w=0,S=0,E=0;for(w=t-1&-4;(w|0)>=0;w=w-4|0){n=he[e+w>>2]|0;if(n){t=w;break}}for(w=s-1&-4;(w|0)>=0;w=w-4|0){a=he[i+w>>2]|0;if(a){s=w;break}}while((a&0x80000000)==0){a=a<<1;o=o+1|0}d=he[e+t>>2]|0;if(o){l=d>>>(32-o|0);for(w=t-4|0;(w|0)>=0;w=w-4|0){n=he[e+w>>2]|0;he[e+w+4>>2]=d<<o|(o?n>>>(32-o|0):0);d=n}he[e>>2]=d<<o}if(o){c=he[i+s>>2]|0;for(w=s-4|0;(w|0)>=0;w=w-4|0){a=he[i+w>>2]|0;he[i+w+4>>2]=c<<o|a>>>(32-o|0);c=a}he[i>>2]=c<<o}c=he[i+s>>2]|0;f=c>>>16,u=c&0xffff;for(w=t;(w|0)>=(s|0);w=w-4|0){S=w-s|0;d=he[e+w>>2]|0;h=(l>>>0)/(f>>>0)|0,m=(l>>>0)%(f>>>0)|0,x=pe(h,u)|0;while((h|0)==0x10000|x>>>0>(m<<16|d>>>16)>>>0){h=h-1|0,m=m+f|0,x=x-u|0;if((m|0)>=0x10000)break}v=0,y=0;for(E=0;(E|0)<=(s|0);E=E+4|0){a=he[i+E>>2]|0;x=(pe(h,a&0xffff)|0)+(v>>>16)|0;b=(pe(h,a>>>16)|0)+(x>>>16)|0;a=v&0xffff|x<<16;v=b;n=he[e+S+E>>2]|0;x=((n&0xffff)-(a&0xffff)|0)+y|0;b=((n>>>16)-(a>>>16)|0)+(x>>16)|0;he[e+S+E>>2]=b<<16|x&0xffff;y=b>>16}x=((l&0xffff)-(v&0xffff)|0)+y|0;b=((l>>>16)-(v>>>16)|0)+(x>>16)|0;l=b<<16|x&0xffff;y=b>>16;if(y){h=h-1|0;y=0;for(E=0;(E|0)<=(s|0);E=E+4|0){a=he[i+E>>2]|0;n=he[e+S+E>>2]|0;x=(n&0xffff)+y|0;b=(n>>>16)+a+(x>>>16)|0;he[e+S+E>>2]=b<<16|x&0xffff;y=b>>>16}l=l+y|0}d=he[e+w>>2]|0;n=l<<16|d>>>16;p=(n>>>0)/(f>>>0)|0,g=(n>>>0)%(f>>>0)|0,x=pe(p,u)|0;while((p|0)==0x10000|x>>>0>(g<<16|d&0xffff)>>>0){p=p-1|0,g=g+f|0,x=x-u|0;if((g|0)>=0x10000)break}v=0,y=0;for(E=0;(E|0)<=(s|0);E=E+4|0){a=he[i+E>>2]|0;x=(pe(p,a&0xffff)|0)+(v&0xffff)|0;b=((pe(p,a>>>16)|0)+(x>>>16)|0)+(v>>>16)|0;a=x&0xffff|b<<16;v=b>>>16;n=he[e+S+E>>2]|0;x=((n&0xffff)-(a&0xffff)|0)+y|0;b=((n>>>16)-(a>>>16)|0)+(x>>16)|0;y=b>>16;he[e+S+E>>2]=b<<16|x&0xffff}x=((l&0xffff)-(v&0xffff)|0)+y|0;b=((l>>>16)-(v>>>16)|0)+(x>>16)|0;y=b>>16;if(y){p=p-1|0;y=0;for(E=0;(E|0)<=(s|0);E=E+4|0){a=he[i+E>>2]|0;n=he[e+S+E>>2]|0;x=((n&0xffff)+(a&0xffff)|0)+y|0;b=((n>>>16)+(a>>>16)|0)+(x>>>16)|0;y=b>>>16;he[e+S+E>>2]=x&0xffff|b<<16}}he[r+S>>2]=h<<16|p;l=he[e+w>>2]|0}if(o){d=he[e>>2]|0;for(w=4;(w|0)<=(s|0);w=w+4|0){n=he[e+w>>2]|0;he[e+w-4>>2]=n<<(32-o|0)|d>>>o;d=n}he[e+s>>2]=d>>>o}}function k(e,t,i,s,r,n){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;var a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0;a=y(s<<1)|0;E(s<<1,0,a);S(t,e,a);for(x=0;(x|0)<(s|0);x=x+4|0){l=he[a+x>>2]|0,d=l&0xffff,l=l>>>16;f=r>>>16,c=r&0xffff;u=pe(d,c)|0,h=((pe(d,f)|0)+(pe(l,c)|0)|0)+(u>>>16)|0;d=u&0xffff,l=h&0xffff;g=0;for(b=0;(b|0)<(s|0);b=b+4|0){v=x+b|0;f=he[i+b>>2]|0,c=f&0xffff,f=f>>>16;m=he[a+v>>2]|0;u=((pe(d,c)|0)+(g&0xffff)|0)+(m&0xffff)|0;h=((pe(d,f)|0)+(g>>>16)|0)+(m>>>16)|0;p=((pe(l,c)|0)+(h&0xffff)|0)+(u>>>16)|0;g=((pe(l,f)|0)+(p>>>16)|0)+(h>>>16)|0;m=p<<16|u&0xffff;he[a+v>>2]=m}v=x+b|0;m=he[a+v>>2]|0;u=((m&0xffff)+(g&0xffff)|0)+o|0;h=((m>>>16)+(g>>>16)|0)+(u>>>16)|0;he[a+v>>2]=h<<16|u&0xffff;o=h>>>16}S(s,a+s|0,n);w(s<<1);if(o|(C(i,s,n,s)|0)<=0){I(n,s,i,s,n,s)|0}}return{sreset:r,salloc:y,sfree:w,z:E,tst:n,neg:d,cmp:C,add:u,sub:I,mul:de,sqr:me,div:T,mredc:k}};function N(e,t){var i=e<0?-1:1,s=t<0?-1:1,r=1,n=0,a=0,o=1,l,d,c,f;e*=i;t*=s;f=e<t;if(f){c=e;e=t,t=c;c=i;i=s;s=c}d=Math.floor(e/t),l=e-d*t;while(l){c=r-d*n,r=n,n=c;c=a-d*o,a=o,o=c;e=t,t=l;d=Math.floor(e/t),l=e-d*t}n*=i;o*=s;if(f){c=n;n=o,o=c}return{gcd:t,x:n,y:o}}function P(e,t){var i=e.sign;var s=t.sign;if(i<0)e=e.negate();if(s<0)t=t.negate();var r=e.compare(t);if(r<0){var n=e;e=t,t=n;var a=i;i=s;s=a}var o=j.ONE,l=j.ZERO,d=t.bitLength,c=j.ZERO,f=j.ONE,u=e.bitLength,h,p,m;h=e.divide(t);while((p=h.remainder)!==j.ZERO){m=h.quotient;h=o.subtract(m.multiply(l).clamp(d)).clamp(d),o=l,l=h;h=c.subtract(m.multiply(f).clamp(u)).clamp(u),c=f,f=h;e=t,t=p;h=e.divide(t)}if(i<0)l=l.negate();if(s<0)f=f.negate();if(r<0){var n=l;l=f,f=n}return{gcd:t,x:l,y:f}}function D(e){if(typeof process!=="undefined"){var t=require("crypto");var i=t.randomBytes(e.length);e.set(i);return}if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(e);return}if(self.crypto&&self.crypto.getRandomValues){self.crypto.getRandomValues(e);return}if(window.msCrypto&&window.msCrypto.getRandomValues){window.msCrypto.getRandomValues(e);return}throw new Error("No secure random number generator available.")}var F=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var B={Uint32Array:Uint32Array,Math:Math};var G=new Uint32Array(1048576);var O;function L(e,t){return e*t|0}if(B.Math.imul===undefined){B.Math.imul=L;O=R(B,null,G.buffer);delete B.Math.imul}else{O=R(B,null,G.buffer)}var $=new Uint32Array(0);var j=function(){function x(e){var t=$;var i=0;var s=0;if(e===undefined);else{for(var r=0;!e[r];r++);i=(e.length-r)*8;if(!i)return x.ZERO;t=new Uint32Array(i+31>>5);for(var n=e.length-4;n>=r;n-=4){t[e.length-4-n>>2]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]}if(r-n===3){t[t.length-1]=e[r]}else if(r-n===2){t[t.length-1]=e[r]<<8|e[r+1]}else if(r-n===1){t[t.length-1]=e[r]<<16|e[r+1]<<8|e[r+2]}s=1}this.limbs=t;this.bitLength=i;this.sign=s}x.fromString=function(e){var t=s(e);return new x(t)};x.fromNumber=function(e){var t=$;var i=0;var s=0;var r=Math.abs(e);if(r>4294967295){t=new Uint32Array(2);t[0]=r|0;t[1]=r/4294967296|0;i=52}else if(r>0){t=new Uint32Array(1);t[0]=r;i=32}else{t=$;i=0}s=e<0?-1:1;return x.fromConfig({limbs:t,bitLength:i,sign:s})};x.fromArrayBuffer=function(e){return new x(new Uint8Array(e))};x.fromConfig=function(e){var t=new x;t.limbs=new Uint32Array(e.limbs);t.bitLength=e.bitLength;t.sign=e.sign;return t};x.prototype.toString=function(e){e=e||16;var t=this.limbs;var i=this.bitLength;var s="";if(e===16){for(var r=(i+31>>5)-1;r>=0;r--){var n=t[r].toString(16);s+="00000000".substr(n.length);s+=n}s=s.replace(/^0+/,"");if(!s.length)s="0"}else{throw new b("bad radix")}if(this.sign<0)s="-"+s;return s};x.prototype.toBytes=function(){var e=this.bitLength;var t=this.limbs;if(e===0)return new Uint8Array(0);var i=e+7>>3;var s=new Uint8Array(i);for(var r=0;r<i;r++){var n=i-r-1;s[r]=t[n>>2]>>((n&3)<<3)}return s};x.prototype.valueOf=function(){var e=this.limbs;var t=this.bitLength;var i=this.sign;if(!i)return 0;if(t<=32)return i*(e[0]>>>0);if(t<=52)return i*(4294967296*(e[1]>>>0)+(e[0]>>>0));var s,r,n=0;for(s=e.length-1;s>=0;s--){if((r=e[s])===0)continue;while((r<<n&2147483648)===0)n++;break}if(s===0)return i*(e[0]>>>0);return i*(1048576*((e[s]<<n|(n?e[s-1]>>>32-n:0))>>>0)+((e[s-1]<<n|(n&&s>1?e[s-2]>>>32-n:0))>>>12))*Math.pow(2,32*s-n-52)};x.prototype.clamp=function(e){var t=this.limbs;var i=this.bitLength;if(e>=i)return this;var s=new x;var r=e+31>>5;var n=e%32;s.limbs=new Uint32Array(t.subarray(0,r));s.bitLength=e;s.sign=this.sign;if(n)s.limbs[r-1]&=-1>>>32-n;return s};x.prototype.slice=function(e,t){var i=this.limbs;var s=this.bitLength;if(e<0)throw new RangeError("TODO");if(e>=s)return x.ZERO;if(t===undefined||t>s-e)t=s-e;var r=new x;var n=e>>5;var a=e+t+31>>5;var o=t+31>>5;var l=e%32;var d=t%32;var c=new Uint32Array(o);if(l){for(var f=0;f<a-n-1;f++){c[f]=i[n+f]>>>l|i[n+f+1]<<32-l}c[f]=i[n+f]>>>l}else{c.set(i.subarray(n,a))}if(d){c[o-1]&=-1>>>32-d}r.limbs=c;r.bitLength=t;r.sign=this.sign;return r};x.prototype.negate=function(){var e=new x;e.limbs=this.limbs;e.bitLength=this.bitLength;e.sign=-1*this.sign;return e};x.prototype.compare=function(e){var t=this.limbs,i=t.length,s=e.limbs,r=s.length,n=0;if(this.sign<e.sign)return-1;if(this.sign>e.sign)return 1;G.set(t,0);G.set(s,i);n=O.cmp(0,i<<2,i<<2,r<<2);return n*this.sign};x.prototype.add=function(e){if(!this.sign)return e;if(!e.sign)return this;var t=this.bitLength,i=this.limbs,s=i.length,r=this.sign,n=e.bitLength,a=e.limbs,o=a.length,l=e.sign,d,c,f,u,h=new x;d=(t>n?t:n)+(r*l>0?1:0);c=d+31>>5;O.sreset();var p=O.salloc(s<<2),m=O.salloc(o<<2),g=O.salloc(c<<2);O.z(g-p+(c<<2),0,p);G.set(i,p>>2);G.set(a,m>>2);if(r*l>0){O.add(p,s<<2,m,o<<2,g,c<<2);f=r}else if(r>l){u=O.sub(p,s<<2,m,o<<2,g,c<<2);f=u?l:r}else{u=O.sub(m,o<<2,p,s<<2,g,c<<2);f=u?r:l}if(u)O.neg(g,c<<2,g,c<<2);if(O.tst(g,c<<2)===0)return x.ZERO;h.limbs=new Uint32Array(G.subarray(g>>2,(g>>2)+c));h.bitLength=d;h.sign=f;return h};x.prototype.subtract=function(e){return this.add(e.negate())};x.prototype.square=function(){if(!this.sign)return x.ZERO;var e=this.bitLength,t=this.limbs,i=t.length,s,r,n=new x;s=e<<1;r=s+31>>5;O.sreset();var a=O.salloc(i<<2),o=O.salloc(r<<2);O.z(o-a+(r<<2),0,a);G.set(t,a>>2);O.sqr(a,i<<2,o);n.limbs=new Uint32Array(G.subarray(o>>2,(o>>2)+r));n.bitLength=s;n.sign=1;return n};x.prototype.divide=function(e){var t=this.bitLength,i=this.limbs,s=i.length,r=e.bitLength,n=e.limbs,a=n.length,o,l,d=x.ZERO,c=x.ZERO;O.sreset();var f=O.salloc(s<<2),u=O.salloc(a<<2),h=O.salloc(s<<2);O.z(h-f+(s<<2),0,f);G.set(i,f>>2);G.set(n,u>>2);O.div(f,s<<2,u,a<<2,h);o=O.tst(h,s<<2)>>2;if(o){d=new x;d.limbs=new Uint32Array(G.subarray(h>>2,(h>>2)+o));d.bitLength=t<o<<5?t:o<<5;d.sign=this.sign*e.sign}l=O.tst(f,a<<2)>>2;if(l){c=new x;c.limbs=new Uint32Array(G.subarray(f>>2,(f>>2)+l));c.bitLength=r<l<<5?r:l<<5;c.sign=this.sign}return{quotient:d,remainder:c}};x.prototype.multiply=function(e){if(!this.sign||!e.sign)return x.ZERO;var t=this.bitLength,i=this.limbs,s=i.length,r=e.bitLength,n=e.limbs,a=n.length,o,l,d=new x;o=t+r;l=o+31>>5;O.sreset();var c=O.salloc(s<<2),f=O.salloc(a<<2),u=O.salloc(l<<2);O.z(u-c+(l<<2),0,c);G.set(i,c>>2);G.set(n,f>>2);O.mul(c,s<<2,f,a<<2,u,l<<2);d.limbs=new Uint32Array(G.subarray(u>>2,(u>>2)+l));d.sign=this.sign*e.sign;d.bitLength=o;return d};x.prototype.isMillerRabinProbablePrime=function(e){var t=x.fromConfig(this),i=0;t.limbs[0]-=1;while(t.limbs[i>>5]===0)i+=32;while((t.limbs[i>>5]>>(i&31)&1)===0)i++;t=t.slice(i);var s=new V(this),r=this.subtract(x.ONE),n=x.fromConfig(this),a=this.limbs.length-1;while(n.limbs[a]===0)a--;while(--e>=0){D(n.limbs);if(n.limbs[0]<2)n.limbs[0]+=2;while(n.compare(r)>=0)n.limbs[a]>>>=1;var o=s.power(n,t);if(o.compare(x.ONE)===0)continue;if(o.compare(r)===0)continue;var l=i;while(--l>0){o=o.square().divide(s).remainder;if(o.compare(x.ONE)===0)return false;if(o.compare(r)===0)break}if(l===0)return false}return true};x.prototype.isProbablePrime=function(e){if(e===void 0){e=80}var t=this.limbs;var i=0;if((t[0]&1)===0)return false;if(e<=1)return true;var s=0,r=0,n=0;for(i=0;i<t.length;i++){var a=t[i];while(a){s+=a&3;a>>>=2}var o=t[i];while(o){r+=o&3;o>>>=2;r-=o&3;o>>>=2}var l=t[i];while(l){n+=l&15;l>>>=4;n-=l&15;l>>>=4}}if(!(s%3)||!(r%5)||!(n%17))return false;if(e<=2)return true;return this.isMillerRabinProbablePrime(e>>>1)};x.extGCD=P;x.ZERO=x.fromNumber(0);x.ONE=x.fromNumber(1);return x}();var V=function(a){F(p,a);function p(e){var t=a.call(this)||this;t.limbs=e.limbs;t.bitLength=e.bitLength;t.sign=e.sign;if(t.valueOf()<1)throw new RangeError;if(t.bitLength<=32)return t;var i;if(t.limbs[0]&1){var s=(t.bitLength+31&-32)+1;var r=new Uint32Array(s+31>>5);r[r.length-1]=1;i=new j;i.sign=1;i.bitLength=s;i.limbs=r;var n=N(4294967296,t.limbs[0]).y;t.coefficient=n<0?-n:4294967296-n}else{return t}t.comodulus=i;t.comodulusRemainder=i.divide(t).remainder;t.comodulusRemainderSquare=i.square().divide(t).remainder;return t}p.prototype.reduce=function(e){if(e.bitLength<=32&&this.bitLength<=32)return j.fromNumber(e.valueOf()%this.valueOf());if(e.compare(this)<0)return e;return e.divide(this).remainder};p.prototype.inverse=function(e){e=this.reduce(e);var t=P(this,e);if(t.gcd.valueOf()!==1)throw new Error("GCD is not 1");if(t.y.sign<0)return t.y.add(this).clamp(this.bitLength);return t.y};p.prototype.power=function(e,t){var i=0;for(var s=0;s<t.limbs.length;s++){var r=t.limbs[s];while(r){if(r&1)i++;r>>>=1}}var n=8;if(t.bitLength<=4536)n=7;if(t.bitLength<=1736)n=6;if(t.bitLength<=630)n=5;if(t.bitLength<=210)n=4;if(t.bitLength<=60)n=3;if(t.bitLength<=12)n=2;if(i<=1<<n-1)n=1;e=p._Montgomery_reduce(this.reduce(e).multiply(this.comodulusRemainderSquare),this);var a=p._Montgomery_reduce(e.square(),this),o=new Array(1<<n-1);o[0]=e;o[1]=p._Montgomery_reduce(e.multiply(a),this);for(var s=2;s<1<<n-1;s++){o[s]=p._Montgomery_reduce(o[s-1].multiply(a),this)}var l=this.comodulusRemainder;var d=l;for(var s=t.limbs.length-1;s>=0;s--){var r=t.limbs[s];for(var c=32;c>0;){if(r&2147483648){var f=r>>>32-n,u=n;while((f&1)===0){f>>>=1;u--}var h=o[f>>>1];while(f){f>>>=1;if(d!==l)d=p._Montgomery_reduce(d.square(),this)}d=d!==l?p._Montgomery_reduce(d.multiply(h),this):h;r<<=u,c-=u}else{if(d!==l)d=p._Montgomery_reduce(d.square(),this);r<<=1,c--}}}return p._Montgomery_reduce(d,this)};p._Montgomery_reduce=function(e,t){var i=e.limbs;var s=i.length;var r=t.limbs;var n=r.length;var a=t.coefficient;O.sreset();var o=O.salloc(s<<2),l=O.salloc(n<<2),d=O.salloc(n<<2);O.z(d-o+(n<<2),0,o);G.set(i,o>>2);G.set(r,l>>2);O.mredc(o,s<<2,l,n<<2,a,d);var c=new j;c.limbs=new Uint32Array(G.subarray(d>>2,(d>>2)+n));c.bitLength=t.bitLength;c.sign=1;return c};return p}(j);var U=function(e,t,i){"use asm";var Pe=0,De=0,Fe=0,Be=0,Ge=0,g=0,x=0;var b=0,v=0,y=0,w=0,S=0,E=0,C=0,I=0,T=0,k=0;var m=new e.Uint8Array(i);function Oe(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;var g=0,x=0,b=0,v=0,y=0,w=0,S=0,E=0,C=0,I=0,T=0,k=0,A=0,M=0,_=0,R=0,N=0,P=0,D=0,F=0,B=0,G=0,O=0,L=0,$=0,j=0,V=0,U=0,H=0,z=0,W=0,q=0,J=0,Z=0,K=0,X=0,Y=0,Q=0,ee=0,te=0,ie=0,se=0,re=0,ne=0,ae=0,oe=0,le=0,de=0,ce=0,fe=0,ue=0,he=0,pe=0,me=0,ge=0,xe=0,be=0,ve=0,ye=0,we=0,Se=0,Ee=0,Ce=0,Ie=0,Te=0,ke=0,Ae=0,Me=0,_e=0,Re=0,Ne=0;g=Pe;x=De;b=Fe;v=Be;y=Ge;S=e+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=t+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=i+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=s+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=r+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=n+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=a+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=o+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=l+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=d+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=c+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=f+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=u+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=h+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=p+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;S=m+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=h^l^i^e;E=w<<1|w>>>31;S=E+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=p^d^s^t;C=w<<1|w>>>31;S=C+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=m^c^r^i;I=w<<1|w>>>31;S=I+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=E^f^n^s;T=w<<1|w>>>31;S=T+(g<<5|g>>>27)+y+(x&b|~x&v)+0x5a827999|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=C^u^a^r;k=w<<1|w>>>31;S=k+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=I^h^o^n;A=w<<1|w>>>31;S=A+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=T^p^l^a;M=w<<1|w>>>31;S=M+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=k^m^d^o;_=w<<1|w>>>31;S=_+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=A^E^c^l;R=w<<1|w>>>31;S=R+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=M^C^f^d;N=w<<1|w>>>31;S=N+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=_^I^u^c;P=w<<1|w>>>31;S=P+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=R^T^h^f;D=w<<1|w>>>31;S=D+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=N^k^p^u;F=w<<1|w>>>31;S=F+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=P^A^m^h;B=w<<1|w>>>31;S=B+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=D^M^E^p;G=w<<1|w>>>31;S=G+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=F^_^C^m;O=w<<1|w>>>31;S=O+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=B^R^I^E;L=w<<1|w>>>31;S=L+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=G^N^T^C;$=w<<1|w>>>31;S=$+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=O^P^k^I;j=w<<1|w>>>31;S=j+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=L^D^A^T;V=w<<1|w>>>31;S=V+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=$^F^M^k;U=w<<1|w>>>31;S=U+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=j^B^_^A;H=w<<1|w>>>31;S=H+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=V^G^R^M;z=w<<1|w>>>31;S=z+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=U^O^N^_;W=w<<1|w>>>31;S=W+(g<<5|g>>>27)+y+(x^b^v)+0x6ed9eba1|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=H^L^P^R;q=w<<1|w>>>31;S=q+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=z^$^D^N;J=w<<1|w>>>31;S=J+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=W^j^F^P;Z=w<<1|w>>>31;S=Z+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=q^V^B^D;K=w<<1|w>>>31;S=K+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=J^U^G^F;X=w<<1|w>>>31;S=X+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Z^H^O^B;Y=w<<1|w>>>31;S=Y+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=K^z^L^G;Q=w<<1|w>>>31;S=Q+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=X^W^$^O;ee=w<<1|w>>>31;S=ee+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Y^q^j^L;te=w<<1|w>>>31;S=te+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Q^J^V^$;ie=w<<1|w>>>31;S=ie+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ee^Z^U^j;se=w<<1|w>>>31;S=se+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=te^K^H^V;re=w<<1|w>>>31;S=re+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ie^X^z^U;ne=w<<1|w>>>31;S=ne+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=se^Y^W^H;ae=w<<1|w>>>31;S=ae+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=re^Q^q^z;oe=w<<1|w>>>31;S=oe+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ne^ee^J^W;le=w<<1|w>>>31;S=le+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ae^te^Z^q;de=w<<1|w>>>31;S=de+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=oe^ie^K^J;ce=w<<1|w>>>31;S=ce+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=le^se^X^Z;fe=w<<1|w>>>31;S=fe+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=de^re^Y^K;ue=w<<1|w>>>31;S=ue+(g<<5|g>>>27)+y+(x&b|x&v|b&v)-0x70e44324|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ce^ne^Q^X;he=w<<1|w>>>31;S=he+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=fe^ae^ee^Y;pe=w<<1|w>>>31;S=pe+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ue^oe^te^Q;me=w<<1|w>>>31;S=me+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=he^le^ie^ee;ge=w<<1|w>>>31;S=ge+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=pe^de^se^te;xe=w<<1|w>>>31;S=xe+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=me^ce^re^ie;be=w<<1|w>>>31;S=be+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ge^fe^ne^se;ve=w<<1|w>>>31;S=ve+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=xe^ue^ae^re;ye=w<<1|w>>>31;S=ye+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=be^he^oe^ne;we=w<<1|w>>>31;S=we+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ve^pe^le^ae;Se=w<<1|w>>>31;S=Se+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ye^me^de^oe;Ee=w<<1|w>>>31;S=Ee+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=we^ge^ce^le;Ce=w<<1|w>>>31;S=Ce+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Se^xe^fe^de;Ie=w<<1|w>>>31;S=Ie+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Ee^be^ue^ce;Te=w<<1|w>>>31;S=Te+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Ce^ve^he^fe;ke=w<<1|w>>>31;S=ke+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Ie^ye^pe^ue;Ae=w<<1|w>>>31;S=Ae+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Te^we^me^he;Me=w<<1|w>>>31;S=Me+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=ke^Se^ge^pe;_e=w<<1|w>>>31;S=_e+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Ae^Ee^xe^me;Re=w<<1|w>>>31;S=Re+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;w=Me^Ce^be^ge;Ne=w<<1|w>>>31;S=Ne+(g<<5|g>>>27)+y+(x^b^v)-0x359d3e2a|0;y=v;v=b;b=x<<30|x>>>2;x=g;g=S;Pe=Pe+g|0;De=De+x|0;Fe=Fe+b|0;Be=Be+v|0;Ge=Ge+y|0}function n(e){e=e|0;Oe(m[e|0]<<24|m[e|1]<<16|m[e|2]<<8|m[e|3],m[e|4]<<24|m[e|5]<<16|m[e|6]<<8|m[e|7],m[e|8]<<24|m[e|9]<<16|m[e|10]<<8|m[e|11],m[e|12]<<24|m[e|13]<<16|m[e|14]<<8|m[e|15],m[e|16]<<24|m[e|17]<<16|m[e|18]<<8|m[e|19],m[e|20]<<24|m[e|21]<<16|m[e|22]<<8|m[e|23],m[e|24]<<24|m[e|25]<<16|m[e|26]<<8|m[e|27],m[e|28]<<24|m[e|29]<<16|m[e|30]<<8|m[e|31],m[e|32]<<24|m[e|33]<<16|m[e|34]<<8|m[e|35],m[e|36]<<24|m[e|37]<<16|m[e|38]<<8|m[e|39],m[e|40]<<24|m[e|41]<<16|m[e|42]<<8|m[e|43],m[e|44]<<24|m[e|45]<<16|m[e|46]<<8|m[e|47],m[e|48]<<24|m[e|49]<<16|m[e|50]<<8|m[e|51],m[e|52]<<24|m[e|53]<<16|m[e|54]<<8|m[e|55],m[e|56]<<24|m[e|57]<<16|m[e|58]<<8|m[e|59],m[e|60]<<24|m[e|61]<<16|m[e|62]<<8|m[e|63])}function A(e){e=e|0;m[e|0]=Pe>>>24;m[e|1]=Pe>>>16&255;m[e|2]=Pe>>>8&255;m[e|3]=Pe&255;m[e|4]=De>>>24;m[e|5]=De>>>16&255;m[e|6]=De>>>8&255;m[e|7]=De&255;m[e|8]=Fe>>>24;m[e|9]=Fe>>>16&255;m[e|10]=Fe>>>8&255;m[e|11]=Fe&255;m[e|12]=Be>>>24;m[e|13]=Be>>>16&255;m[e|14]=Be>>>8&255;m[e|15]=Be&255;m[e|16]=Ge>>>24;m[e|17]=Ge>>>16&255;m[e|18]=Ge>>>8&255;m[e|19]=Ge&255}function M(){Pe=0x67452301;De=0xefcdab89;Fe=0x98badcfe;Be=0x10325476;Ge=0xc3d2e1f0;g=x=0}function o(e,t,i,s,r,n,a){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;Pe=e;De=t;Fe=i;Be=s;Ge=r;g=n;x=a}function a(e,t){e=e|0;t=t|0;var i=0;if(e&63)return-1;while((t|0)>=64){n(e);e=e+64|0;t=t-64|0;i=i+64|0}g=g+i|0;if(g>>>0<i>>>0)x=x+1|0;return i|0}function d(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0;if(e&63)return-1;if(~i)if(i&31)return-1;if((t|0)>=64){s=a(e,t)|0;if((s|0)==-1)return-1;e=e+s|0;t=t-s|0}s=s+t|0;g=g+t|0;if(g>>>0<t>>>0)x=x+1|0;m[e|t]=0x80;if((t|0)>=56){for(r=t+1|0;(r|0)<64;r=r+1|0)m[e|r]=0x00;n(e);t=0;m[e|0]=0}for(r=t+1|0;(r|0)<59;r=r+1|0)m[e|r]=0;m[e|56]=x>>>21&255;m[e|57]=x>>>13&255;m[e|58]=x>>>5&255;m[e|59]=x<<3&255|g>>>29;m[e|60]=g>>>21&255;m[e|61]=g>>>13&255;m[e|62]=g>>>5&255;m[e|63]=g<<3&255;n(e);if(~i)A(i);return s|0}function _(){Pe=b;De=v;Fe=y;Be=w;Ge=S;g=64;x=0}function R(){Pe=E;De=C;Fe=I;Be=T;Ge=k;g=64;x=0}function N(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;M();Oe(e^0x5c5c5c5c,t^0x5c5c5c5c,i^0x5c5c5c5c,s^0x5c5c5c5c,r^0x5c5c5c5c,n^0x5c5c5c5c,a^0x5c5c5c5c,o^0x5c5c5c5c,l^0x5c5c5c5c,d^0x5c5c5c5c,c^0x5c5c5c5c,f^0x5c5c5c5c,u^0x5c5c5c5c,h^0x5c5c5c5c,p^0x5c5c5c5c,m^0x5c5c5c5c);E=Pe;C=De;I=Fe;T=Be;k=Ge;M();Oe(e^0x36363636,t^0x36363636,i^0x36363636,s^0x36363636,r^0x36363636,n^0x36363636,a^0x36363636,o^0x36363636,l^0x36363636,d^0x36363636,c^0x36363636,f^0x36363636,u^0x36363636,h^0x36363636,p^0x36363636,m^0x36363636);b=Pe;v=De;y=Fe;w=Be;S=Ge;g=64;x=0}function P(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0,n=0,a=0,o=0,l=0;if(e&63)return-1;if(~i)if(i&31)return-1;l=d(e,t,-1)|0;s=Pe,r=De,n=Fe,a=Be,o=Ge;R();Oe(s,r,n,a,o,0x80000000,0,0,0,0,0,0,0,0,0,672);if(~i)A(i);return l|0}function D(e,t,i,s,r){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;var n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0;if(e&63)return-1;if(~r)if(r&31)return-1;m[e+t|0]=i>>>24;m[e+t+1|0]=i>>>16&255;m[e+t+2|0]=i>>>8&255;m[e+t+3|0]=i&255;P(e,t+4|0,-1)|0;n=c=Pe,a=f=De,o=u=Fe,l=h=Be,d=p=Ge;s=s-1|0;while((s|0)>0){_();Oe(c,f,u,h,p,0x80000000,0,0,0,0,0,0,0,0,0,672);c=Pe,f=De,u=Fe,h=Be,p=Ge;R();Oe(c,f,u,h,p,0x80000000,0,0,0,0,0,0,0,0,0,672);c=Pe,f=De,u=Fe,h=Be,p=Ge;n=n^Pe;a=a^De;o=o^Fe;l=l^Be;d=d^Ge;s=s-1|0}Pe=n;De=a;Fe=o;Be=l;Ge=d;if(~r)A(r);return 0}return{reset:M,init:o,process:a,finish:d,hmac_reset:_,hmac_init:N,hmac_finish:P,pbkdf2_generate_block:D}};var H=function(){function e(){this.pos=0;this.len=0}e.prototype.reset=function(){this.result=null;this.pos=0;this.len=0;this.asm.reset();return this};e.prototype.process=function(e){if(this.result!==null)throw new g("state must be reset before processing new data");var t=this.asm;var i=this.heap;var s=this.pos;var r=this.len;var n=0;var a=e.length;var o=0;while(a>0){o=m(i,s+r,e,n,a);r+=o;n+=o;a-=o;o=t.process(s,r);s+=o;r-=o;if(!r)s=0}this.pos=s;this.len=r;return this};e.prototype.finish=function(){if(this.result!==null)throw new g("state must be reset before processing new data");this.asm.finish(this.pos,this.len,0);this.result=new Uint8Array(this.HASH_SIZE);this.result.set(this.heap.subarray(0,this.HASH_SIZE));this.pos=0;this.len=0;return this};return e}();var z=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var W=64;var q=20;var J=function(t){z(e,t);function e(){var e=t.call(this)||this;e.NAME="sha1";e.BLOCK_SIZE=W;e.HASH_SIZE=q;e.heap=d();e.asm=U({Uint8Array:Uint8Array},null,e.heap.buffer);e.reset();return e}e.NAME="sha1";return e}(H);var Z=function(e,t,i){"use asm";var C=0,I=0,T=0,k=0,A=0,M=0,_=0,R=0,g=0,x=0;var b=0,v=0,y=0,w=0,S=0,E=0,N=0,P=0,D=0,F=0,B=0,G=0,O=0,L=0,$=0,j=0;var V=new e.Uint8Array(i);function U(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;var g=0,x=0,b=0,v=0,y=0,w=0,S=0,E=0;g=C;x=I;b=T;v=k;y=A;w=M;S=_;E=R;E=e+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0x428a2f98|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;S=t+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0x71374491|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;w=i+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0xb5c0fbcf|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;y=s+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0xe9b5dba5|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;v=r+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0x3956c25b|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;b=n+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0x59f111f1|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;x=a+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0x923f82a4|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;g=o+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0xab1c5ed5|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;E=l+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0xd807aa98|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;S=d+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0x12835b01|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;w=c+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0x243185be|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;y=f+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0x550c7dc3|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;v=u+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0x72be5d74|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;b=h+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0x80deb1fe|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;x=p+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0x9bdc06a7|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;g=m+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0xc19bf174|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;e=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+e+d|0;E=e+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0xe49b69c1|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;t=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+t+c|0;S=t+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0xefbe4786|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;i=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+i+f|0;w=i+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0x0fc19dc6|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;s=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+s+u|0;y=s+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0x240ca1cc|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;r=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+r+h|0;v=r+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0x2de92c6f|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;n=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+n+p|0;b=n+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0x4a7484aa|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;a=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+a+m|0;x=a+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0x5cb0a9dc|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;o=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+o+e|0;g=o+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0x76f988da|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;l=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+l+t|0;E=l+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0x983e5152|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;d=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+d+i|0;S=d+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0xa831c66d|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;c=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+c+s|0;w=c+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0xb00327c8|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;f=(u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+f+r|0;y=f+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0xbf597fc7|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;u=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+u+n|0;v=u+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0xc6e00bf3|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;h=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+h+a|0;b=h+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0xd5a79147|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;p=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(u>>>17^u>>>19^u>>>10^u<<15^u<<13)+p+o|0;x=p+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0x06ca6351|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;m=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+m+l|0;g=m+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0x14292967|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;e=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+e+d|0;E=e+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0x27b70a85|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;t=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+t+c|0;S=t+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0x2e1b2138|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;i=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+i+f|0;w=i+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0x4d2c6dfc|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;s=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+s+u|0;y=s+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0x53380d13|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;r=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+r+h|0;v=r+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0x650a7354|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;n=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+n+p|0;b=n+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0x766a0abb|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;a=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+a+m|0;x=a+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0x81c2c92e|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;o=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+o+e|0;g=o+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0x92722c85|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;l=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+l+t|0;E=l+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0xa2bfe8a1|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;d=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+d+i|0;S=d+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0xa81a664b|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;c=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+c+s|0;w=c+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0xc24b8b70|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;f=(u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+f+r|0;y=f+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0xc76c51a3|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;u=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+u+n|0;v=u+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0xd192e819|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;h=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+h+a|0;b=h+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0xd6990624|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;p=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(u>>>17^u>>>19^u>>>10^u<<15^u<<13)+p+o|0;x=p+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0xf40e3585|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;m=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+m+l|0;g=m+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0x106aa070|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;e=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+e+d|0;E=e+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0x19a4c116|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;t=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+t+c|0;S=t+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0x1e376c08|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;i=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+i+f|0;w=i+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0x2748774c|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;s=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+s+u|0;y=s+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0x34b0bcb5|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;r=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+r+h|0;v=r+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0x391c0cb3|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;n=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+n+p|0;b=n+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0x4ed8aa4a|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;a=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+a+m|0;x=a+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0x5b9cca4f|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;o=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+o+e|0;g=o+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0x682e6ff3|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;l=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+l+t|0;E=l+E+(y>>>6^y>>>11^y>>>25^y<<26^y<<21^y<<7)+(S^y&(w^S))+0x748f82ee|0;v=v+E|0;E=E+(g&x^b&(g^x))+(g>>>2^g>>>13^g>>>22^g<<30^g<<19^g<<10)|0;d=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+d+i|0;S=d+S+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(w^v&(y^w))+0x78a5636f|0;b=b+S|0;S=S+(E&g^x&(E^g))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0;c=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+c+s|0;w=c+w+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(y^b&(v^y))+0x84c87814|0;x=x+w|0;w=w+(S&E^g&(S^E))+(S>>>2^S>>>13^S>>>22^S<<30^S<<19^S<<10)|0;f=(u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+f+r|0;y=f+y+(x>>>6^x>>>11^x>>>25^x<<26^x<<21^x<<7)+(v^x&(b^v))+0x8cc70208|0;g=g+y|0;y=y+(w&S^E&(w^S))+(w>>>2^w>>>13^w>>>22^w<<30^w<<19^w<<10)|0;u=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+u+n|0;v=u+v+(g>>>6^g>>>11^g>>>25^g<<26^g<<21^g<<7)+(b^g&(x^b))+0x90befffa|0;E=E+v|0;v=v+(y&w^S&(y^w))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;h=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+h+a|0;b=h+b+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(x^E&(g^x))+0xa4506ceb|0;S=S+b|0;b=b+(v&y^w&(v^y))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0;p=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(u>>>17^u>>>19^u>>>10^u<<15^u<<13)+p+o|0;x=p+x+(S>>>6^S>>>11^S>>>25^S<<26^S<<21^S<<7)+(g^S&(E^g))+0xbef9a3f7|0;w=w+x|0;x=x+(b&v^y&(b^v))+(b>>>2^b>>>13^b>>>22^b<<30^b<<19^b<<10)|0;m=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+m+l|0;g=m+g+(w>>>6^w>>>11^w>>>25^w<<26^w<<21^w<<7)+(E^w&(S^E))+0xc67178f2|0;y=y+g|0;g=g+(x&b^v&(x^b))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0;C=C+g|0;I=I+x|0;T=T+b|0;k=k+v|0;A=A+y|0;M=M+w|0;_=_+S|0;R=R+E|0}function n(e){e=e|0;U(V[e|0]<<24|V[e|1]<<16|V[e|2]<<8|V[e|3],V[e|4]<<24|V[e|5]<<16|V[e|6]<<8|V[e|7],V[e|8]<<24|V[e|9]<<16|V[e|10]<<8|V[e|11],V[e|12]<<24|V[e|13]<<16|V[e|14]<<8|V[e|15],V[e|16]<<24|V[e|17]<<16|V[e|18]<<8|V[e|19],V[e|20]<<24|V[e|21]<<16|V[e|22]<<8|V[e|23],V[e|24]<<24|V[e|25]<<16|V[e|26]<<8|V[e|27],V[e|28]<<24|V[e|29]<<16|V[e|30]<<8|V[e|31],V[e|32]<<24|V[e|33]<<16|V[e|34]<<8|V[e|35],V[e|36]<<24|V[e|37]<<16|V[e|38]<<8|V[e|39],V[e|40]<<24|V[e|41]<<16|V[e|42]<<8|V[e|43],V[e|44]<<24|V[e|45]<<16|V[e|46]<<8|V[e|47],V[e|48]<<24|V[e|49]<<16|V[e|50]<<8|V[e|51],V[e|52]<<24|V[e|53]<<16|V[e|54]<<8|V[e|55],V[e|56]<<24|V[e|57]<<16|V[e|58]<<8|V[e|59],V[e|60]<<24|V[e|61]<<16|V[e|62]<<8|V[e|63])}function H(e){e=e|0;V[e|0]=C>>>24;V[e|1]=C>>>16&255;V[e|2]=C>>>8&255;V[e|3]=C&255;V[e|4]=I>>>24;V[e|5]=I>>>16&255;V[e|6]=I>>>8&255;V[e|7]=I&255;V[e|8]=T>>>24;V[e|9]=T>>>16&255;V[e|10]=T>>>8&255;V[e|11]=T&255;V[e|12]=k>>>24;V[e|13]=k>>>16&255;V[e|14]=k>>>8&255;V[e|15]=k&255;V[e|16]=A>>>24;V[e|17]=A>>>16&255;V[e|18]=A>>>8&255;V[e|19]=A&255;V[e|20]=M>>>24;V[e|21]=M>>>16&255;V[e|22]=M>>>8&255;V[e|23]=M&255;V[e|24]=_>>>24;V[e|25]=_>>>16&255;V[e|26]=_>>>8&255;V[e|27]=_&255;V[e|28]=R>>>24;V[e|29]=R>>>16&255;V[e|30]=R>>>8&255;V[e|31]=R&255}function z(){C=0x6a09e667;I=0xbb67ae85;T=0x3c6ef372;k=0xa54ff53a;A=0x510e527f;M=0x9b05688c;_=0x1f83d9ab;R=0x5be0cd19;g=x=0}function c(e,t,i,s,r,n,a,o,l,d){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;C=e;I=t;T=i;k=s;A=r;M=n;_=a;R=o;g=l;x=d}function a(e,t){e=e|0;t=t|0;var i=0;if(e&63)return-1;while((t|0)>=64){n(e);e=e+64|0;t=t-64|0;i=i+64|0}g=g+i|0;if(g>>>0<i>>>0)x=x+1|0;return i|0}function u(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0;if(e&63)return-1;if(~i)if(i&31)return-1;if((t|0)>=64){s=a(e,t)|0;if((s|0)==-1)return-1;e=e+s|0;t=t-s|0}s=s+t|0;g=g+t|0;if(g>>>0<t>>>0)x=x+1|0;V[e|t]=0x80;if((t|0)>=56){for(r=t+1|0;(r|0)<64;r=r+1|0)V[e|r]=0x00;n(e);t=0;V[e|0]=0}for(r=t+1|0;(r|0)<59;r=r+1|0)V[e|r]=0;V[e|56]=x>>>21&255;V[e|57]=x>>>13&255;V[e|58]=x>>>5&255;V[e|59]=x<<3&255|g>>>29;V[e|60]=g>>>21&255;V[e|61]=g>>>13&255;V[e|62]=g>>>5&255;V[e|63]=g<<3&255;n(e);if(~i)H(i);return s|0}function W(){C=b;I=v;T=y;k=w;A=S;M=E;_=N;R=P;g=64;x=0}function q(){C=D;I=F;T=B;k=G;A=O;M=L;_=$;R=j;g=64;x=0}function J(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;z();U(e^0x5c5c5c5c,t^0x5c5c5c5c,i^0x5c5c5c5c,s^0x5c5c5c5c,r^0x5c5c5c5c,n^0x5c5c5c5c,a^0x5c5c5c5c,o^0x5c5c5c5c,l^0x5c5c5c5c,d^0x5c5c5c5c,c^0x5c5c5c5c,f^0x5c5c5c5c,u^0x5c5c5c5c,h^0x5c5c5c5c,p^0x5c5c5c5c,m^0x5c5c5c5c);D=C;F=I;B=T;G=k;O=A;L=M;$=_;j=R;z();U(e^0x36363636,t^0x36363636,i^0x36363636,s^0x36363636,r^0x36363636,n^0x36363636,a^0x36363636,o^0x36363636,l^0x36363636,d^0x36363636,c^0x36363636,f^0x36363636,u^0x36363636,h^0x36363636,p^0x36363636,m^0x36363636);b=C;v=I;y=T;w=k;S=A;E=M;N=_;P=R;g=64;x=0}function Z(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0,n=0,a=0,o=0,l=0,d=0,c=0,f=0;if(e&63)return-1;if(~i)if(i&31)return-1;f=u(e,t,-1)|0;s=C,r=I,n=T,a=k,o=A,l=M,d=_,c=R;q();U(s,r,n,a,o,l,d,c,0x80000000,0,0,0,0,0,0,768);if(~i)H(i);return f|0}function K(e,t,i,s,r){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;var n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0,y=0;if(e&63)return-1;if(~r)if(r&31)return-1;V[e+t|0]=i>>>24;V[e+t+1|0]=i>>>16&255;V[e+t+2|0]=i>>>8&255;V[e+t+3|0]=i&255;Z(e,t+4|0,-1)|0;n=h=C,a=p=I,o=m=T,l=g=k,d=x=A,c=b=M,f=v=_,u=y=R;s=s-1|0;while((s|0)>0){W();U(h,p,m,g,x,b,v,y,0x80000000,0,0,0,0,0,0,768);h=C,p=I,m=T,g=k,x=A,b=M,v=_,y=R;q();U(h,p,m,g,x,b,v,y,0x80000000,0,0,0,0,0,0,768);h=C,p=I,m=T,g=k,x=A,b=M,v=_,y=R;n=n^C;a=a^I;o=o^T;l=l^k;d=d^A;c=c^M;f=f^_;u=u^R;s=s-1|0}C=n;I=a;T=o;k=l;A=d;M=c;_=f;R=u;if(~r)H(r);return 0}return{reset:z,init:c,process:a,finish:u,hmac_reset:W,hmac_init:J,hmac_finish:Z,pbkdf2_generate_block:K}};var K=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var X=64;var Y=32;var Q=function(t){K(e,t);function e(){var e=t.call(this)||this;e.NAME="sha256";e.BLOCK_SIZE=X;e.HASH_SIZE=Y;e.heap=d();e.asm=Z({Uint8Array:Uint8Array},null,e.heap.buffer);e.reset();return e}e.NAME="sha256";return e}(H);var ee=function(e,t,i){"use asm";var X=0,Y=0,Q=0,ee=0,te=0,ie=0,se=0,re=0,ne=0,ae=0,oe=0,le=0,de=0,ce=0,fe=0,ue=0,N=0,P=0;var D=0,F=0,B=0,G=0,O=0,L=0,$=0,j=0,V=0,U=0,H=0,z=0,W=0,q=0,J=0,Z=0,K=0,he=0,pe=0,me=0,ge=0,xe=0,be=0,ve=0,ye=0,we=0,Se=0,Ee=0,Ce=0,Ie=0,Te=0,ke=0;var Ae=new e.Uint8Array(i);function Me(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m,g,x,b,v,y,w,S,E,C,I,T,k,A,M,_,R){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;g=g|0;x=x|0;b=b|0;v=v|0;y=y|0;w=w|0;S=S|0;E=E|0;C=C|0;I=I|0;T=T|0;k=k|0;A=A|0;M=M|0;_=_|0;R=R|0;var N=0,P=0,D=0,F=0,B=0,G=0,O=0,L=0,$=0,j=0,V=0,U=0,H=0,z=0,W=0,q=0,J=0,Z=0,K=0;N=X;P=Y;D=Q;F=ee;B=te;G=ie;O=se;L=re;$=ne;j=ae;V=oe;U=le;H=de;z=ce;W=fe;q=ue;Z=0xd728ae22+t|0;J=0x428a2f98+e+(Z>>>0<t>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0x23ef65cd+s|0;J=0x71374491+i+(Z>>>0<s>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xec4d3b2f+n|0;J=0xb5c0fbcf+r+(Z>>>0<n>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0x8189dbbc+o|0;J=0xe9b5dba5+a+(Z>>>0<o>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xf348b538+d|0;J=0x3956c25b+l+(Z>>>0<d>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xb605d019+f|0;J=0x59f111f1+c+(Z>>>0<f>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xaf194f9b+h|0;J=0x923f82a4+u+(Z>>>0<h>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xda6d8118+m|0;J=0xab1c5ed5+p+(Z>>>0<m>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xa3030242+x|0;J=0xd807aa98+g+(Z>>>0<x>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0x45706fbe+v|0;J=0x12835b01+b+(Z>>>0<v>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0x4ee4b28c+w|0;J=0x243185be+y+(Z>>>0<w>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xd5ffb4e2+E|0;J=0x550c7dc3+S+(Z>>>0<E>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xf27b896f+I|0;J=0x72be5d74+C+(Z>>>0<I>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0x3b1696b1+k|0;J=0x80deb1fe+T+(Z>>>0<k>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0x25c71235+M|0;J=0x9bdc06a7+A+(Z>>>0<M>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Z=0xcf692694+R|0;J=0xc19bf174+_+(Z>>>0<R>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;t=t+v|0;e=e+b+(t>>>0<v>>>0?1:0)|0;K=(s>>>1|i<<31)^(s>>>8|i<<24)^(s>>>7|i<<25)|0;t=t+K|0;e=e+((i>>>1|s<<31)^(i>>>8|s<<24)^i>>>7)+(t>>>0<K>>>0?1:0)|0;K=(M>>>19|A<<13)^(M<<3|A>>>29)^(M>>>6|A<<26)|0;t=t+K|0;e=e+((A>>>19|M<<13)^(A<<3|M>>>29)^A>>>6)+(t>>>0<K>>>0?1:0)|0;Z=0x9ef14ad2+t|0;J=0xe49b69c1+e+(Z>>>0<t>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;s=s+w|0;i=i+y+(s>>>0<w>>>0?1:0)|0;K=(n>>>1|r<<31)^(n>>>8|r<<24)^(n>>>7|r<<25)|0;s=s+K|0;i=i+((r>>>1|n<<31)^(r>>>8|n<<24)^r>>>7)+(s>>>0<K>>>0?1:0)|0;K=(R>>>19|_<<13)^(R<<3|_>>>29)^(R>>>6|_<<26)|0;s=s+K|0;i=i+((_>>>19|R<<13)^(_<<3|R>>>29)^_>>>6)+(s>>>0<K>>>0?1:0)|0;Z=0x384f25e3+s|0;J=0xefbe4786+i+(Z>>>0<s>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;n=n+E|0;r=r+S+(n>>>0<E>>>0?1:0)|0;K=(o>>>1|a<<31)^(o>>>8|a<<24)^(o>>>7|a<<25)|0;n=n+K|0;r=r+((a>>>1|o<<31)^(a>>>8|o<<24)^a>>>7)+(n>>>0<K>>>0?1:0)|0;K=(t>>>19|e<<13)^(t<<3|e>>>29)^(t>>>6|e<<26)|0;n=n+K|0;r=r+((e>>>19|t<<13)^(e<<3|t>>>29)^e>>>6)+(n>>>0<K>>>0?1:0)|0;Z=0x8b8cd5b5+n|0;J=0xfc19dc6+r+(Z>>>0<n>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;o=o+I|0;a=a+C+(o>>>0<I>>>0?1:0)|0;K=(d>>>1|l<<31)^(d>>>8|l<<24)^(d>>>7|l<<25)|0;o=o+K|0;a=a+((l>>>1|d<<31)^(l>>>8|d<<24)^l>>>7)+(o>>>0<K>>>0?1:0)|0;K=(s>>>19|i<<13)^(s<<3|i>>>29)^(s>>>6|i<<26)|0;o=o+K|0;a=a+((i>>>19|s<<13)^(i<<3|s>>>29)^i>>>6)+(o>>>0<K>>>0?1:0)|0;Z=0x77ac9c65+o|0;J=0x240ca1cc+a+(Z>>>0<o>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;d=d+k|0;l=l+T+(d>>>0<k>>>0?1:0)|0;K=(f>>>1|c<<31)^(f>>>8|c<<24)^(f>>>7|c<<25)|0;d=d+K|0;l=l+((c>>>1|f<<31)^(c>>>8|f<<24)^c>>>7)+(d>>>0<K>>>0?1:0)|0;K=(n>>>19|r<<13)^(n<<3|r>>>29)^(n>>>6|r<<26)|0;d=d+K|0;l=l+((r>>>19|n<<13)^(r<<3|n>>>29)^r>>>6)+(d>>>0<K>>>0?1:0)|0;Z=0x592b0275+d|0;J=0x2de92c6f+l+(Z>>>0<d>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;f=f+M|0;c=c+A+(f>>>0<M>>>0?1:0)|0;K=(h>>>1|u<<31)^(h>>>8|u<<24)^(h>>>7|u<<25)|0;f=f+K|0;c=c+((u>>>1|h<<31)^(u>>>8|h<<24)^u>>>7)+(f>>>0<K>>>0?1:0)|0;K=(o>>>19|a<<13)^(o<<3|a>>>29)^(o>>>6|a<<26)|0;f=f+K|0;c=c+((a>>>19|o<<13)^(a<<3|o>>>29)^a>>>6)+(f>>>0<K>>>0?1:0)|0;Z=0x6ea6e483+f|0;J=0x4a7484aa+c+(Z>>>0<f>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;h=h+R|0;u=u+_+(h>>>0<R>>>0?1:0)|0;K=(m>>>1|p<<31)^(m>>>8|p<<24)^(m>>>7|p<<25)|0;h=h+K|0;u=u+((p>>>1|m<<31)^(p>>>8|m<<24)^p>>>7)+(h>>>0<K>>>0?1:0)|0;K=(d>>>19|l<<13)^(d<<3|l>>>29)^(d>>>6|l<<26)|0;h=h+K|0;u=u+((l>>>19|d<<13)^(l<<3|d>>>29)^l>>>6)+(h>>>0<K>>>0?1:0)|0;Z=0xbd41fbd4+h|0;J=0x5cb0a9dc+u+(Z>>>0<h>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;m=m+t|0;p=p+e+(m>>>0<t>>>0?1:0)|0;K=(x>>>1|g<<31)^(x>>>8|g<<24)^(x>>>7|g<<25)|0;m=m+K|0;p=p+((g>>>1|x<<31)^(g>>>8|x<<24)^g>>>7)+(m>>>0<K>>>0?1:0)|0;K=(f>>>19|c<<13)^(f<<3|c>>>29)^(f>>>6|c<<26)|0;m=m+K|0;p=p+((c>>>19|f<<13)^(c<<3|f>>>29)^c>>>6)+(m>>>0<K>>>0?1:0)|0;Z=0x831153b5+m|0;J=0x76f988da+p+(Z>>>0<m>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;x=x+s|0;g=g+i+(x>>>0<s>>>0?1:0)|0;K=(v>>>1|b<<31)^(v>>>8|b<<24)^(v>>>7|b<<25)|0;x=x+K|0;g=g+((b>>>1|v<<31)^(b>>>8|v<<24)^b>>>7)+(x>>>0<K>>>0?1:0)|0;K=(h>>>19|u<<13)^(h<<3|u>>>29)^(h>>>6|u<<26)|0;x=x+K|0;g=g+((u>>>19|h<<13)^(u<<3|h>>>29)^u>>>6)+(x>>>0<K>>>0?1:0)|0;Z=0xee66dfab+x|0;J=0x983e5152+g+(Z>>>0<x>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;v=v+n|0;b=b+r+(v>>>0<n>>>0?1:0)|0;K=(w>>>1|y<<31)^(w>>>8|y<<24)^(w>>>7|y<<25)|0;v=v+K|0;b=b+((y>>>1|w<<31)^(y>>>8|w<<24)^y>>>7)+(v>>>0<K>>>0?1:0)|0;K=(m>>>19|p<<13)^(m<<3|p>>>29)^(m>>>6|p<<26)|0;v=v+K|0;b=b+((p>>>19|m<<13)^(p<<3|m>>>29)^p>>>6)+(v>>>0<K>>>0?1:0)|0;Z=0x2db43210+v|0;J=0xa831c66d+b+(Z>>>0<v>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;w=w+o|0;y=y+a+(w>>>0<o>>>0?1:0)|0;K=(E>>>1|S<<31)^(E>>>8|S<<24)^(E>>>7|S<<25)|0;w=w+K|0;y=y+((S>>>1|E<<31)^(S>>>8|E<<24)^S>>>7)+(w>>>0<K>>>0?1:0)|0;K=(x>>>19|g<<13)^(x<<3|g>>>29)^(x>>>6|g<<26)|0;w=w+K|0;y=y+((g>>>19|x<<13)^(g<<3|x>>>29)^g>>>6)+(w>>>0<K>>>0?1:0)|0;Z=0x98fb213f+w|0;J=0xb00327c8+y+(Z>>>0<w>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;E=E+d|0;S=S+l+(E>>>0<d>>>0?1:0)|0;K=(I>>>1|C<<31)^(I>>>8|C<<24)^(I>>>7|C<<25)|0;E=E+K|0;S=S+((C>>>1|I<<31)^(C>>>8|I<<24)^C>>>7)+(E>>>0<K>>>0?1:0)|0;K=(v>>>19|b<<13)^(v<<3|b>>>29)^(v>>>6|b<<26)|0;E=E+K|0;S=S+((b>>>19|v<<13)^(b<<3|v>>>29)^b>>>6)+(E>>>0<K>>>0?1:0)|0;Z=0xbeef0ee4+E|0;J=0xbf597fc7+S+(Z>>>0<E>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;I=I+f|0;C=C+c+(I>>>0<f>>>0?1:0)|0;K=(k>>>1|T<<31)^(k>>>8|T<<24)^(k>>>7|T<<25)|0;I=I+K|0;C=C+((T>>>1|k<<31)^(T>>>8|k<<24)^T>>>7)+(I>>>0<K>>>0?1:0)|0;K=(w>>>19|y<<13)^(w<<3|y>>>29)^(w>>>6|y<<26)|0;I=I+K|0;C=C+((y>>>19|w<<13)^(y<<3|w>>>29)^y>>>6)+(I>>>0<K>>>0?1:0)|0;Z=0x3da88fc2+I|0;J=0xc6e00bf3+C+(Z>>>0<I>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;k=k+h|0;T=T+u+(k>>>0<h>>>0?1:0)|0;K=(M>>>1|A<<31)^(M>>>8|A<<24)^(M>>>7|A<<25)|0;k=k+K|0;T=T+((A>>>1|M<<31)^(A>>>8|M<<24)^A>>>7)+(k>>>0<K>>>0?1:0)|0;K=(E>>>19|S<<13)^(E<<3|S>>>29)^(E>>>6|S<<26)|0;k=k+K|0;T=T+((S>>>19|E<<13)^(S<<3|E>>>29)^S>>>6)+(k>>>0<K>>>0?1:0)|0;Z=0x930aa725+k|0;J=0xd5a79147+T+(Z>>>0<k>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;M=M+m|0;A=A+p+(M>>>0<m>>>0?1:0)|0;K=(R>>>1|_<<31)^(R>>>8|_<<24)^(R>>>7|_<<25)|0;M=M+K|0;A=A+((_>>>1|R<<31)^(_>>>8|R<<24)^_>>>7)+(M>>>0<K>>>0?1:0)|0;K=(I>>>19|C<<13)^(I<<3|C>>>29)^(I>>>6|C<<26)|0;M=M+K|0;A=A+((C>>>19|I<<13)^(C<<3|I>>>29)^C>>>6)+(M>>>0<K>>>0?1:0)|0;Z=0xe003826f+M|0;J=0x6ca6351+A+(Z>>>0<M>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;R=R+x|0;_=_+g+(R>>>0<x>>>0?1:0)|0;K=(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)|0;R=R+K|0;_=_+((e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7)+(R>>>0<K>>>0?1:0)|0;K=(k>>>19|T<<13)^(k<<3|T>>>29)^(k>>>6|T<<26)|0;R=R+K|0;_=_+((T>>>19|k<<13)^(T<<3|k>>>29)^T>>>6)+(R>>>0<K>>>0?1:0)|0;Z=0xa0e6e70+R|0;J=0x14292967+_+(Z>>>0<R>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;t=t+v|0;e=e+b+(t>>>0<v>>>0?1:0)|0;K=(s>>>1|i<<31)^(s>>>8|i<<24)^(s>>>7|i<<25)|0;t=t+K|0;e=e+((i>>>1|s<<31)^(i>>>8|s<<24)^i>>>7)+(t>>>0<K>>>0?1:0)|0;K=(M>>>19|A<<13)^(M<<3|A>>>29)^(M>>>6|A<<26)|0;t=t+K|0;e=e+((A>>>19|M<<13)^(A<<3|M>>>29)^A>>>6)+(t>>>0<K>>>0?1:0)|0;Z=0x46d22ffc+t|0;J=0x27b70a85+e+(Z>>>0<t>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;s=s+w|0;i=i+y+(s>>>0<w>>>0?1:0)|0;K=(n>>>1|r<<31)^(n>>>8|r<<24)^(n>>>7|r<<25)|0;s=s+K|0;i=i+((r>>>1|n<<31)^(r>>>8|n<<24)^r>>>7)+(s>>>0<K>>>0?1:0)|0;K=(R>>>19|_<<13)^(R<<3|_>>>29)^(R>>>6|_<<26)|0;s=s+K|0;i=i+((_>>>19|R<<13)^(_<<3|R>>>29)^_>>>6)+(s>>>0<K>>>0?1:0)|0;Z=0x5c26c926+s|0;J=0x2e1b2138+i+(Z>>>0<s>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;n=n+E|0;r=r+S+(n>>>0<E>>>0?1:0)|0;K=(o>>>1|a<<31)^(o>>>8|a<<24)^(o>>>7|a<<25)|0;n=n+K|0;r=r+((a>>>1|o<<31)^(a>>>8|o<<24)^a>>>7)+(n>>>0<K>>>0?1:0)|0;K=(t>>>19|e<<13)^(t<<3|e>>>29)^(t>>>6|e<<26)|0;n=n+K|0;r=r+((e>>>19|t<<13)^(e<<3|t>>>29)^e>>>6)+(n>>>0<K>>>0?1:0)|0;Z=0x5ac42aed+n|0;J=0x4d2c6dfc+r+(Z>>>0<n>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;o=o+I|0;a=a+C+(o>>>0<I>>>0?1:0)|0;K=(d>>>1|l<<31)^(d>>>8|l<<24)^(d>>>7|l<<25)|0;o=o+K|0;a=a+((l>>>1|d<<31)^(l>>>8|d<<24)^l>>>7)+(o>>>0<K>>>0?1:0)|0;K=(s>>>19|i<<13)^(s<<3|i>>>29)^(s>>>6|i<<26)|0;o=o+K|0;a=a+((i>>>19|s<<13)^(i<<3|s>>>29)^i>>>6)+(o>>>0<K>>>0?1:0)|0;Z=0x9d95b3df+o|0;J=0x53380d13+a+(Z>>>0<o>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;d=d+k|0;l=l+T+(d>>>0<k>>>0?1:0)|0;K=(f>>>1|c<<31)^(f>>>8|c<<24)^(f>>>7|c<<25)|0;d=d+K|0;l=l+((c>>>1|f<<31)^(c>>>8|f<<24)^c>>>7)+(d>>>0<K>>>0?1:0)|0;K=(n>>>19|r<<13)^(n<<3|r>>>29)^(n>>>6|r<<26)|0;d=d+K|0;l=l+((r>>>19|n<<13)^(r<<3|n>>>29)^r>>>6)+(d>>>0<K>>>0?1:0)|0;Z=0x8baf63de+d|0;J=0x650a7354+l+(Z>>>0<d>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;f=f+M|0;c=c+A+(f>>>0<M>>>0?1:0)|0;K=(h>>>1|u<<31)^(h>>>8|u<<24)^(h>>>7|u<<25)|0;f=f+K|0;c=c+((u>>>1|h<<31)^(u>>>8|h<<24)^u>>>7)+(f>>>0<K>>>0?1:0)|0;K=(o>>>19|a<<13)^(o<<3|a>>>29)^(o>>>6|a<<26)|0;f=f+K|0;c=c+((a>>>19|o<<13)^(a<<3|o>>>29)^a>>>6)+(f>>>0<K>>>0?1:0)|0;Z=0x3c77b2a8+f|0;J=0x766a0abb+c+(Z>>>0<f>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;h=h+R|0;u=u+_+(h>>>0<R>>>0?1:0)|0;K=(m>>>1|p<<31)^(m>>>8|p<<24)^(m>>>7|p<<25)|0;h=h+K|0;u=u+((p>>>1|m<<31)^(p>>>8|m<<24)^p>>>7)+(h>>>0<K>>>0?1:0)|0;K=(d>>>19|l<<13)^(d<<3|l>>>29)^(d>>>6|l<<26)|0;h=h+K|0;u=u+((l>>>19|d<<13)^(l<<3|d>>>29)^l>>>6)+(h>>>0<K>>>0?1:0)|0;Z=0x47edaee6+h|0;J=0x81c2c92e+u+(Z>>>0<h>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;m=m+t|0;p=p+e+(m>>>0<t>>>0?1:0)|0;K=(x>>>1|g<<31)^(x>>>8|g<<24)^(x>>>7|g<<25)|0;m=m+K|0;p=p+((g>>>1|x<<31)^(g>>>8|x<<24)^g>>>7)+(m>>>0<K>>>0?1:0)|0;K=(f>>>19|c<<13)^(f<<3|c>>>29)^(f>>>6|c<<26)|0;m=m+K|0;p=p+((c>>>19|f<<13)^(c<<3|f>>>29)^c>>>6)+(m>>>0<K>>>0?1:0)|0;Z=0x1482353b+m|0;J=0x92722c85+p+(Z>>>0<m>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;x=x+s|0;g=g+i+(x>>>0<s>>>0?1:0)|0;K=(v>>>1|b<<31)^(v>>>8|b<<24)^(v>>>7|b<<25)|0;x=x+K|0;g=g+((b>>>1|v<<31)^(b>>>8|v<<24)^b>>>7)+(x>>>0<K>>>0?1:0)|0;K=(h>>>19|u<<13)^(h<<3|u>>>29)^(h>>>6|u<<26)|0;x=x+K|0;g=g+((u>>>19|h<<13)^(u<<3|h>>>29)^u>>>6)+(x>>>0<K>>>0?1:0)|0;Z=0x4cf10364+x|0;J=0xa2bfe8a1+g+(Z>>>0<x>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;v=v+n|0;b=b+r+(v>>>0<n>>>0?1:0)|0;K=(w>>>1|y<<31)^(w>>>8|y<<24)^(w>>>7|y<<25)|0;v=v+K|0;b=b+((y>>>1|w<<31)^(y>>>8|w<<24)^y>>>7)+(v>>>0<K>>>0?1:0)|0;K=(m>>>19|p<<13)^(m<<3|p>>>29)^(m>>>6|p<<26)|0;v=v+K|0;b=b+((p>>>19|m<<13)^(p<<3|m>>>29)^p>>>6)+(v>>>0<K>>>0?1:0)|0;Z=0xbc423001+v|0;J=0xa81a664b+b+(Z>>>0<v>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;w=w+o|0;y=y+a+(w>>>0<o>>>0?1:0)|0;K=(E>>>1|S<<31)^(E>>>8|S<<24)^(E>>>7|S<<25)|0;w=w+K|0;y=y+((S>>>1|E<<31)^(S>>>8|E<<24)^S>>>7)+(w>>>0<K>>>0?1:0)|0;K=(x>>>19|g<<13)^(x<<3|g>>>29)^(x>>>6|g<<26)|0;w=w+K|0;y=y+((g>>>19|x<<13)^(g<<3|x>>>29)^g>>>6)+(w>>>0<K>>>0?1:0)|0;Z=0xd0f89791+w|0;J=0xc24b8b70+y+(Z>>>0<w>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;E=E+d|0;S=S+l+(E>>>0<d>>>0?1:0)|0;K=(I>>>1|C<<31)^(I>>>8|C<<24)^(I>>>7|C<<25)|0;E=E+K|0;S=S+((C>>>1|I<<31)^(C>>>8|I<<24)^C>>>7)+(E>>>0<K>>>0?1:0)|0;K=(v>>>19|b<<13)^(v<<3|b>>>29)^(v>>>6|b<<26)|0;E=E+K|0;S=S+((b>>>19|v<<13)^(b<<3|v>>>29)^b>>>6)+(E>>>0<K>>>0?1:0)|0;Z=0x654be30+E|0;J=0xc76c51a3+S+(Z>>>0<E>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;I=I+f|0;C=C+c+(I>>>0<f>>>0?1:0)|0;K=(k>>>1|T<<31)^(k>>>8|T<<24)^(k>>>7|T<<25)|0;I=I+K|0;C=C+((T>>>1|k<<31)^(T>>>8|k<<24)^T>>>7)+(I>>>0<K>>>0?1:0)|0;K=(w>>>19|y<<13)^(w<<3|y>>>29)^(w>>>6|y<<26)|0;I=I+K|0;C=C+((y>>>19|w<<13)^(y<<3|w>>>29)^y>>>6)+(I>>>0<K>>>0?1:0)|0;Z=0xd6ef5218+I|0;J=0xd192e819+C+(Z>>>0<I>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;k=k+h|0;T=T+u+(k>>>0<h>>>0?1:0)|0;K=(M>>>1|A<<31)^(M>>>8|A<<24)^(M>>>7|A<<25)|0;k=k+K|0;T=T+((A>>>1|M<<31)^(A>>>8|M<<24)^A>>>7)+(k>>>0<K>>>0?1:0)|0;K=(E>>>19|S<<13)^(E<<3|S>>>29)^(E>>>6|S<<26)|0;k=k+K|0;T=T+((S>>>19|E<<13)^(S<<3|E>>>29)^S>>>6)+(k>>>0<K>>>0?1:0)|0;Z=0x5565a910+k|0;J=0xd6990624+T+(Z>>>0<k>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;M=M+m|0;A=A+p+(M>>>0<m>>>0?1:0)|0;K=(R>>>1|_<<31)^(R>>>8|_<<24)^(R>>>7|_<<25)|0;M=M+K|0;A=A+((_>>>1|R<<31)^(_>>>8|R<<24)^_>>>7)+(M>>>0<K>>>0?1:0)|0;K=(I>>>19|C<<13)^(I<<3|C>>>29)^(I>>>6|C<<26)|0;M=M+K|0;A=A+((C>>>19|I<<13)^(C<<3|I>>>29)^C>>>6)+(M>>>0<K>>>0?1:0)|0;Z=0x5771202a+M|0;J=0xf40e3585+A+(Z>>>0<M>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;R=R+x|0;_=_+g+(R>>>0<x>>>0?1:0)|0;K=(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)|0;R=R+K|0;_=_+((e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7)+(R>>>0<K>>>0?1:0)|0;K=(k>>>19|T<<13)^(k<<3|T>>>29)^(k>>>6|T<<26)|0;R=R+K|0;_=_+((T>>>19|k<<13)^(T<<3|k>>>29)^T>>>6)+(R>>>0<K>>>0?1:0)|0;Z=0x32bbd1b8+R|0;J=0x106aa070+_+(Z>>>0<R>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;t=t+v|0;e=e+b+(t>>>0<v>>>0?1:0)|0;K=(s>>>1|i<<31)^(s>>>8|i<<24)^(s>>>7|i<<25)|0;t=t+K|0;e=e+((i>>>1|s<<31)^(i>>>8|s<<24)^i>>>7)+(t>>>0<K>>>0?1:0)|0;K=(M>>>19|A<<13)^(M<<3|A>>>29)^(M>>>6|A<<26)|0;t=t+K|0;e=e+((A>>>19|M<<13)^(A<<3|M>>>29)^A>>>6)+(t>>>0<K>>>0?1:0)|0;Z=0xb8d2d0c8+t|0;J=0x19a4c116+e+(Z>>>0<t>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;s=s+w|0;i=i+y+(s>>>0<w>>>0?1:0)|0;K=(n>>>1|r<<31)^(n>>>8|r<<24)^(n>>>7|r<<25)|0;s=s+K|0;i=i+((r>>>1|n<<31)^(r>>>8|n<<24)^r>>>7)+(s>>>0<K>>>0?1:0)|0;K=(R>>>19|_<<13)^(R<<3|_>>>29)^(R>>>6|_<<26)|0;s=s+K|0;i=i+((_>>>19|R<<13)^(_<<3|R>>>29)^_>>>6)+(s>>>0<K>>>0?1:0)|0;Z=0x5141ab53+s|0;J=0x1e376c08+i+(Z>>>0<s>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;n=n+E|0;r=r+S+(n>>>0<E>>>0?1:0)|0;K=(o>>>1|a<<31)^(o>>>8|a<<24)^(o>>>7|a<<25)|0;n=n+K|0;r=r+((a>>>1|o<<31)^(a>>>8|o<<24)^a>>>7)+(n>>>0<K>>>0?1:0)|0;K=(t>>>19|e<<13)^(t<<3|e>>>29)^(t>>>6|e<<26)|0;n=n+K|0;r=r+((e>>>19|t<<13)^(e<<3|t>>>29)^e>>>6)+(n>>>0<K>>>0?1:0)|0;Z=0xdf8eeb99+n|0;J=0x2748774c+r+(Z>>>0<n>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;o=o+I|0;a=a+C+(o>>>0<I>>>0?1:0)|0;K=(d>>>1|l<<31)^(d>>>8|l<<24)^(d>>>7|l<<25)|0;o=o+K|0;a=a+((l>>>1|d<<31)^(l>>>8|d<<24)^l>>>7)+(o>>>0<K>>>0?1:0)|0;K=(s>>>19|i<<13)^(s<<3|i>>>29)^(s>>>6|i<<26)|0;o=o+K|0;a=a+((i>>>19|s<<13)^(i<<3|s>>>29)^i>>>6)+(o>>>0<K>>>0?1:0)|0;Z=0xe19b48a8+o|0;J=0x34b0bcb5+a+(Z>>>0<o>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;d=d+k|0;l=l+T+(d>>>0<k>>>0?1:0)|0;K=(f>>>1|c<<31)^(f>>>8|c<<24)^(f>>>7|c<<25)|0;d=d+K|0;l=l+((c>>>1|f<<31)^(c>>>8|f<<24)^c>>>7)+(d>>>0<K>>>0?1:0)|0;K=(n>>>19|r<<13)^(n<<3|r>>>29)^(n>>>6|r<<26)|0;d=d+K|0;l=l+((r>>>19|n<<13)^(r<<3|n>>>29)^r>>>6)+(d>>>0<K>>>0?1:0)|0;Z=0xc5c95a63+d|0;J=0x391c0cb3+l+(Z>>>0<d>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;f=f+M|0;c=c+A+(f>>>0<M>>>0?1:0)|0;K=(h>>>1|u<<31)^(h>>>8|u<<24)^(h>>>7|u<<25)|0;f=f+K|0;c=c+((u>>>1|h<<31)^(u>>>8|h<<24)^u>>>7)+(f>>>0<K>>>0?1:0)|0;K=(o>>>19|a<<13)^(o<<3|a>>>29)^(o>>>6|a<<26)|0;f=f+K|0;c=c+((a>>>19|o<<13)^(a<<3|o>>>29)^a>>>6)+(f>>>0<K>>>0?1:0)|0;Z=0xe3418acb+f|0;J=0x4ed8aa4a+c+(Z>>>0<f>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;h=h+R|0;u=u+_+(h>>>0<R>>>0?1:0)|0;K=(m>>>1|p<<31)^(m>>>8|p<<24)^(m>>>7|p<<25)|0;h=h+K|0;u=u+((p>>>1|m<<31)^(p>>>8|m<<24)^p>>>7)+(h>>>0<K>>>0?1:0)|0;K=(d>>>19|l<<13)^(d<<3|l>>>29)^(d>>>6|l<<26)|0;h=h+K|0;u=u+((l>>>19|d<<13)^(l<<3|d>>>29)^l>>>6)+(h>>>0<K>>>0?1:0)|0;Z=0x7763e373+h|0;J=0x5b9cca4f+u+(Z>>>0<h>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;m=m+t|0;p=p+e+(m>>>0<t>>>0?1:0)|0;K=(x>>>1|g<<31)^(x>>>8|g<<24)^(x>>>7|g<<25)|0;m=m+K|0;p=p+((g>>>1|x<<31)^(g>>>8|x<<24)^g>>>7)+(m>>>0<K>>>0?1:0)|0;K=(f>>>19|c<<13)^(f<<3|c>>>29)^(f>>>6|c<<26)|0;m=m+K|0;p=p+((c>>>19|f<<13)^(c<<3|f>>>29)^c>>>6)+(m>>>0<K>>>0?1:0)|0;Z=0xd6b2b8a3+m|0;J=0x682e6ff3+p+(Z>>>0<m>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;x=x+s|0;g=g+i+(x>>>0<s>>>0?1:0)|0;K=(v>>>1|b<<31)^(v>>>8|b<<24)^(v>>>7|b<<25)|0;x=x+K|0;g=g+((b>>>1|v<<31)^(b>>>8|v<<24)^b>>>7)+(x>>>0<K>>>0?1:0)|0;K=(h>>>19|u<<13)^(h<<3|u>>>29)^(h>>>6|u<<26)|0;x=x+K|0;g=g+((u>>>19|h<<13)^(u<<3|h>>>29)^u>>>6)+(x>>>0<K>>>0?1:0)|0;Z=0x5defb2fc+x|0;J=0x748f82ee+g+(Z>>>0<x>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;v=v+n|0;b=b+r+(v>>>0<n>>>0?1:0)|0;K=(w>>>1|y<<31)^(w>>>8|y<<24)^(w>>>7|y<<25)|0;v=v+K|0;b=b+((y>>>1|w<<31)^(y>>>8|w<<24)^y>>>7)+(v>>>0<K>>>0?1:0)|0;K=(m>>>19|p<<13)^(m<<3|p>>>29)^(m>>>6|p<<26)|0;v=v+K|0;b=b+((p>>>19|m<<13)^(p<<3|m>>>29)^p>>>6)+(v>>>0<K>>>0?1:0)|0;Z=0x43172f60+v|0;J=0x78a5636f+b+(Z>>>0<v>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;w=w+o|0;y=y+a+(w>>>0<o>>>0?1:0)|0;K=(E>>>1|S<<31)^(E>>>8|S<<24)^(E>>>7|S<<25)|0;w=w+K|0;y=y+((S>>>1|E<<31)^(S>>>8|E<<24)^S>>>7)+(w>>>0<K>>>0?1:0)|0;K=(x>>>19|g<<13)^(x<<3|g>>>29)^(x>>>6|g<<26)|0;w=w+K|0;y=y+((g>>>19|x<<13)^(g<<3|x>>>29)^g>>>6)+(w>>>0<K>>>0?1:0)|0;Z=0xa1f0ab72+w|0;J=0x84c87814+y+(Z>>>0<w>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;E=E+d|0;S=S+l+(E>>>0<d>>>0?1:0)|0;K=(I>>>1|C<<31)^(I>>>8|C<<24)^(I>>>7|C<<25)|0;E=E+K|0;S=S+((C>>>1|I<<31)^(C>>>8|I<<24)^C>>>7)+(E>>>0<K>>>0?1:0)|0;K=(v>>>19|b<<13)^(v<<3|b>>>29)^(v>>>6|b<<26)|0;E=E+K|0;S=S+((b>>>19|v<<13)^(b<<3|v>>>29)^b>>>6)+(E>>>0<K>>>0?1:0)|0;Z=0x1a6439ec+E|0;J=0x8cc70208+S+(Z>>>0<E>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;I=I+f|0;C=C+c+(I>>>0<f>>>0?1:0)|0;K=(k>>>1|T<<31)^(k>>>8|T<<24)^(k>>>7|T<<25)|0;I=I+K|0;C=C+((T>>>1|k<<31)^(T>>>8|k<<24)^T>>>7)+(I>>>0<K>>>0?1:0)|0;K=(w>>>19|y<<13)^(w<<3|y>>>29)^(w>>>6|y<<26)|0;I=I+K|0;C=C+((y>>>19|w<<13)^(y<<3|w>>>29)^y>>>6)+(I>>>0<K>>>0?1:0)|0;Z=0x23631e28+I|0;J=0x90befffa+C+(Z>>>0<I>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;k=k+h|0;T=T+u+(k>>>0<h>>>0?1:0)|0;K=(M>>>1|A<<31)^(M>>>8|A<<24)^(M>>>7|A<<25)|0;k=k+K|0;T=T+((A>>>1|M<<31)^(A>>>8|M<<24)^A>>>7)+(k>>>0<K>>>0?1:0)|0;K=(E>>>19|S<<13)^(E<<3|S>>>29)^(E>>>6|S<<26)|0;k=k+K|0;T=T+((S>>>19|E<<13)^(S<<3|E>>>29)^S>>>6)+(k>>>0<K>>>0?1:0)|0;Z=0xde82bde9+k|0;J=0xa4506ceb+T+(Z>>>0<k>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;M=M+m|0;A=A+p+(M>>>0<m>>>0?1:0)|0;K=(R>>>1|_<<31)^(R>>>8|_<<24)^(R>>>7|_<<25)|0;M=M+K|0;A=A+((_>>>1|R<<31)^(_>>>8|R<<24)^_>>>7)+(M>>>0<K>>>0?1:0)|0;K=(I>>>19|C<<13)^(I<<3|C>>>29)^(I>>>6|C<<26)|0;M=M+K|0;A=A+((C>>>19|I<<13)^(C<<3|I>>>29)^C>>>6)+(M>>>0<K>>>0?1:0)|0;Z=0xb2c67915+M|0;J=0xbef9a3f7+A+(Z>>>0<M>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;R=R+x|0;_=_+g+(R>>>0<x>>>0?1:0)|0;K=(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)|0;R=R+K|0;_=_+((e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7)+(R>>>0<K>>>0?1:0)|0;K=(k>>>19|T<<13)^(k<<3|T>>>29)^(k>>>6|T<<26)|0;R=R+K|0;_=_+((T>>>19|k<<13)^(T<<3|k>>>29)^T>>>6)+(R>>>0<K>>>0?1:0)|0;Z=0xe372532b+R|0;J=0xc67178f2+_+(Z>>>0<R>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;t=t+v|0;e=e+b+(t>>>0<v>>>0?1:0)|0;K=(s>>>1|i<<31)^(s>>>8|i<<24)^(s>>>7|i<<25)|0;t=t+K|0;e=e+((i>>>1|s<<31)^(i>>>8|s<<24)^i>>>7)+(t>>>0<K>>>0?1:0)|0;K=(M>>>19|A<<13)^(M<<3|A>>>29)^(M>>>6|A<<26)|0;t=t+K|0;e=e+((A>>>19|M<<13)^(A<<3|M>>>29)^A>>>6)+(t>>>0<K>>>0?1:0)|0;Z=0xea26619c+t|0;J=0xca273ece+e+(Z>>>0<t>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;s=s+w|0;i=i+y+(s>>>0<w>>>0?1:0)|0;K=(n>>>1|r<<31)^(n>>>8|r<<24)^(n>>>7|r<<25)|0;s=s+K|0;i=i+((r>>>1|n<<31)^(r>>>8|n<<24)^r>>>7)+(s>>>0<K>>>0?1:0)|0;K=(R>>>19|_<<13)^(R<<3|_>>>29)^(R>>>6|_<<26)|0;s=s+K|0;i=i+((_>>>19|R<<13)^(_<<3|R>>>29)^_>>>6)+(s>>>0<K>>>0?1:0)|0;Z=0x21c0c207+s|0;J=0xd186b8c7+i+(Z>>>0<s>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;n=n+E|0;r=r+S+(n>>>0<E>>>0?1:0)|0;K=(o>>>1|a<<31)^(o>>>8|a<<24)^(o>>>7|a<<25)|0;n=n+K|0;r=r+((a>>>1|o<<31)^(a>>>8|o<<24)^a>>>7)+(n>>>0<K>>>0?1:0)|0;K=(t>>>19|e<<13)^(t<<3|e>>>29)^(t>>>6|e<<26)|0;n=n+K|0;r=r+((e>>>19|t<<13)^(e<<3|t>>>29)^e>>>6)+(n>>>0<K>>>0?1:0)|0;Z=0xcde0eb1e+n|0;J=0xeada7dd6+r+(Z>>>0<n>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;o=o+I|0;a=a+C+(o>>>0<I>>>0?1:0)|0;K=(d>>>1|l<<31)^(d>>>8|l<<24)^(d>>>7|l<<25)|0;o=o+K|0;a=a+((l>>>1|d<<31)^(l>>>8|d<<24)^l>>>7)+(o>>>0<K>>>0?1:0)|0;K=(s>>>19|i<<13)^(s<<3|i>>>29)^(s>>>6|i<<26)|0;o=o+K|0;a=a+((i>>>19|s<<13)^(i<<3|s>>>29)^i>>>6)+(o>>>0<K>>>0?1:0)|0;Z=0xee6ed178+o|0;J=0xf57d4f7f+a+(Z>>>0<o>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;d=d+k|0;l=l+T+(d>>>0<k>>>0?1:0)|0;K=(f>>>1|c<<31)^(f>>>8|c<<24)^(f>>>7|c<<25)|0;d=d+K|0;l=l+((c>>>1|f<<31)^(c>>>8|f<<24)^c>>>7)+(d>>>0<K>>>0?1:0)|0;K=(n>>>19|r<<13)^(n<<3|r>>>29)^(n>>>6|r<<26)|0;d=d+K|0;l=l+((r>>>19|n<<13)^(r<<3|n>>>29)^r>>>6)+(d>>>0<K>>>0?1:0)|0;Z=0x72176fba+d|0;J=0x6f067aa+l+(Z>>>0<d>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;f=f+M|0;c=c+A+(f>>>0<M>>>0?1:0)|0;K=(h>>>1|u<<31)^(h>>>8|u<<24)^(h>>>7|u<<25)|0;f=f+K|0;c=c+((u>>>1|h<<31)^(u>>>8|h<<24)^u>>>7)+(f>>>0<K>>>0?1:0)|0;K=(o>>>19|a<<13)^(o<<3|a>>>29)^(o>>>6|a<<26)|0;f=f+K|0;c=c+((a>>>19|o<<13)^(a<<3|o>>>29)^a>>>6)+(f>>>0<K>>>0?1:0)|0;Z=0xa2c898a6+f|0;J=0xa637dc5+c+(Z>>>0<f>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;h=h+R|0;u=u+_+(h>>>0<R>>>0?1:0)|0;K=(m>>>1|p<<31)^(m>>>8|p<<24)^(m>>>7|p<<25)|0;h=h+K|0;u=u+((p>>>1|m<<31)^(p>>>8|m<<24)^p>>>7)+(h>>>0<K>>>0?1:0)|0;K=(d>>>19|l<<13)^(d<<3|l>>>29)^(d>>>6|l<<26)|0;h=h+K|0;u=u+((l>>>19|d<<13)^(l<<3|d>>>29)^l>>>6)+(h>>>0<K>>>0?1:0)|0;Z=0xbef90dae+h|0;J=0x113f9804+u+(Z>>>0<h>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;m=m+t|0;p=p+e+(m>>>0<t>>>0?1:0)|0;K=(x>>>1|g<<31)^(x>>>8|g<<24)^(x>>>7|g<<25)|0;m=m+K|0;p=p+((g>>>1|x<<31)^(g>>>8|x<<24)^g>>>7)+(m>>>0<K>>>0?1:0)|0;K=(f>>>19|c<<13)^(f<<3|c>>>29)^(f>>>6|c<<26)|0;m=m+K|0;p=p+((c>>>19|f<<13)^(c<<3|f>>>29)^c>>>6)+(m>>>0<K>>>0?1:0)|0;Z=0x131c471b+m|0;J=0x1b710b35+p+(Z>>>0<m>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;x=x+s|0;g=g+i+(x>>>0<s>>>0?1:0)|0;K=(v>>>1|b<<31)^(v>>>8|b<<24)^(v>>>7|b<<25)|0;x=x+K|0;g=g+((b>>>1|v<<31)^(b>>>8|v<<24)^b>>>7)+(x>>>0<K>>>0?1:0)|0;K=(h>>>19|u<<13)^(h<<3|u>>>29)^(h>>>6|u<<26)|0;x=x+K|0;g=g+((u>>>19|h<<13)^(u<<3|h>>>29)^u>>>6)+(x>>>0<K>>>0?1:0)|0;Z=0x23047d84+x|0;J=0x28db77f5+g+(Z>>>0<x>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;v=v+n|0;b=b+r+(v>>>0<n>>>0?1:0)|0;K=(w>>>1|y<<31)^(w>>>8|y<<24)^(w>>>7|y<<25)|0;v=v+K|0;b=b+((y>>>1|w<<31)^(y>>>8|w<<24)^y>>>7)+(v>>>0<K>>>0?1:0)|0;K=(m>>>19|p<<13)^(m<<3|p>>>29)^(m>>>6|p<<26)|0;v=v+K|0;b=b+((p>>>19|m<<13)^(p<<3|m>>>29)^p>>>6)+(v>>>0<K>>>0?1:0)|0;Z=0x40c72493+v|0;J=0x32caab7b+b+(Z>>>0<v>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;w=w+o|0;y=y+a+(w>>>0<o>>>0?1:0)|0;K=(E>>>1|S<<31)^(E>>>8|S<<24)^(E>>>7|S<<25)|0;w=w+K|0;y=y+((S>>>1|E<<31)^(S>>>8|E<<24)^S>>>7)+(w>>>0<K>>>0?1:0)|0;K=(x>>>19|g<<13)^(x<<3|g>>>29)^(x>>>6|g<<26)|0;w=w+K|0;y=y+((g>>>19|x<<13)^(g<<3|x>>>29)^g>>>6)+(w>>>0<K>>>0?1:0)|0;Z=0x15c9bebc+w|0;J=0x3c9ebe0a+y+(Z>>>0<w>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;E=E+d|0;S=S+l+(E>>>0<d>>>0?1:0)|0;K=(I>>>1|C<<31)^(I>>>8|C<<24)^(I>>>7|C<<25)|0;E=E+K|0;S=S+((C>>>1|I<<31)^(C>>>8|I<<24)^C>>>7)+(E>>>0<K>>>0?1:0)|0;K=(v>>>19|b<<13)^(v<<3|b>>>29)^(v>>>6|b<<26)|0;E=E+K|0;S=S+((b>>>19|v<<13)^(b<<3|v>>>29)^b>>>6)+(E>>>0<K>>>0?1:0)|0;Z=0x9c100d4c+E|0;J=0x431d67c4+S+(Z>>>0<E>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;I=I+f|0;C=C+c+(I>>>0<f>>>0?1:0)|0;K=(k>>>1|T<<31)^(k>>>8|T<<24)^(k>>>7|T<<25)|0;I=I+K|0;C=C+((T>>>1|k<<31)^(T>>>8|k<<24)^T>>>7)+(I>>>0<K>>>0?1:0)|0;K=(w>>>19|y<<13)^(w<<3|y>>>29)^(w>>>6|y<<26)|0;I=I+K|0;C=C+((y>>>19|w<<13)^(y<<3|w>>>29)^y>>>6)+(I>>>0<K>>>0?1:0)|0;Z=0xcb3e42b6+I|0;J=0x4cc5d4be+C+(Z>>>0<I>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;k=k+h|0;T=T+u+(k>>>0<h>>>0?1:0)|0;K=(M>>>1|A<<31)^(M>>>8|A<<24)^(M>>>7|A<<25)|0;k=k+K|0;T=T+((A>>>1|M<<31)^(A>>>8|M<<24)^A>>>7)+(k>>>0<K>>>0?1:0)|0;K=(E>>>19|S<<13)^(E<<3|S>>>29)^(E>>>6|S<<26)|0;k=k+K|0;T=T+((S>>>19|E<<13)^(S<<3|E>>>29)^S>>>6)+(k>>>0<K>>>0?1:0)|0;Z=0xfc657e2a+k|0;J=0x597f299c+T+(Z>>>0<k>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;M=M+m|0;A=A+p+(M>>>0<m>>>0?1:0)|0;K=(R>>>1|_<<31)^(R>>>8|_<<24)^(R>>>7|_<<25)|0;M=M+K|0;A=A+((_>>>1|R<<31)^(_>>>8|R<<24)^_>>>7)+(M>>>0<K>>>0?1:0)|0;K=(I>>>19|C<<13)^(I<<3|C>>>29)^(I>>>6|C<<26)|0;M=M+K|0;A=A+((C>>>19|I<<13)^(C<<3|I>>>29)^C>>>6)+(M>>>0<K>>>0?1:0)|0;Z=0x3ad6faec+M|0;J=0x5fcb6fab+A+(Z>>>0<M>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;R=R+x|0;_=_+g+(R>>>0<x>>>0?1:0)|0;K=(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)|0;R=R+K|0;_=_+((e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7)+(R>>>0<K>>>0?1:0)|0;K=(k>>>19|T<<13)^(k<<3|T>>>29)^(k>>>6|T<<26)|0;R=R+K|0;_=_+((T>>>19|k<<13)^(T<<3|k>>>29)^T>>>6)+(R>>>0<K>>>0?1:0)|0;Z=0x4a475817+R|0;J=0x6c44198c+_+(Z>>>0<R>>>0?1:0)|0;Z=Z+q|0;J=J+W+(Z>>>0<q>>>0?1:0)|0;K=(j>>>14|$<<18)^(j>>>18|$<<14)^(j<<23|$>>>9)|0;Z=Z+K|0;J=J+(($>>>14|j<<18)^($>>>18|j<<14)^($<<23|j>>>9))+(Z>>>0<K>>>0?1:0)|0;K=z^j&(U^z)|0;Z=Z+K|0;J=J+(H^$&(V^H))+(Z>>>0<K>>>0?1:0)|0;q=z;W=H;z=U;H=V;U=j;V=$;j=L+Z|0;$=O+J+(j>>>0<L>>>0?1:0)|0;L=G;O=B;G=F;B=D;F=P;D=N;P=Z+(F&G^L&(F^G))|0;N=J+(D&B^O&(D^B))+(P>>>0<Z>>>0?1:0)|0;K=(F>>>28|D<<4)^(F<<30|D>>>2)^(F<<25|D>>>7)|0;P=P+K|0;N=N+((D>>>28|F<<4)^(D<<30|F>>>2)^(D<<25|F>>>7))+(P>>>0<K>>>0?1:0)|0;Y=Y+P|0;X=X+N+(Y>>>0<P>>>0?1:0)|0;ee=ee+F|0;Q=Q+D+(ee>>>0<F>>>0?1:0)|0;ie=ie+G|0;te=te+B+(ie>>>0<G>>>0?1:0)|0;re=re+L|0;se=se+O+(re>>>0<L>>>0?1:0)|0;ae=ae+j|0;ne=ne+$+(ae>>>0<j>>>0?1:0)|0;le=le+U|0;oe=oe+V+(le>>>0<U>>>0?1:0)|0;ce=ce+z|0;de=de+H+(ce>>>0<z>>>0?1:0)|0;ue=ue+q|0;fe=fe+W+(ue>>>0<q>>>0?1:0)|0}function n(e){e=e|0;Me(Ae[e|0]<<24|Ae[e|1]<<16|Ae[e|2]<<8|Ae[e|3],Ae[e|4]<<24|Ae[e|5]<<16|Ae[e|6]<<8|Ae[e|7],Ae[e|8]<<24|Ae[e|9]<<16|Ae[e|10]<<8|Ae[e|11],Ae[e|12]<<24|Ae[e|13]<<16|Ae[e|14]<<8|Ae[e|15],Ae[e|16]<<24|Ae[e|17]<<16|Ae[e|18]<<8|Ae[e|19],Ae[e|20]<<24|Ae[e|21]<<16|Ae[e|22]<<8|Ae[e|23],Ae[e|24]<<24|Ae[e|25]<<16|Ae[e|26]<<8|Ae[e|27],Ae[e|28]<<24|Ae[e|29]<<16|Ae[e|30]<<8|Ae[e|31],Ae[e|32]<<24|Ae[e|33]<<16|Ae[e|34]<<8|Ae[e|35],Ae[e|36]<<24|Ae[e|37]<<16|Ae[e|38]<<8|Ae[e|39],Ae[e|40]<<24|Ae[e|41]<<16|Ae[e|42]<<8|Ae[e|43],Ae[e|44]<<24|Ae[e|45]<<16|Ae[e|46]<<8|Ae[e|47],Ae[e|48]<<24|Ae[e|49]<<16|Ae[e|50]<<8|Ae[e|51],Ae[e|52]<<24|Ae[e|53]<<16|Ae[e|54]<<8|Ae[e|55],Ae[e|56]<<24|Ae[e|57]<<16|Ae[e|58]<<8|Ae[e|59],Ae[e|60]<<24|Ae[e|61]<<16|Ae[e|62]<<8|Ae[e|63],Ae[e|64]<<24|Ae[e|65]<<16|Ae[e|66]<<8|Ae[e|67],Ae[e|68]<<24|Ae[e|69]<<16|Ae[e|70]<<8|Ae[e|71],Ae[e|72]<<24|Ae[e|73]<<16|Ae[e|74]<<8|Ae[e|75],Ae[e|76]<<24|Ae[e|77]<<16|Ae[e|78]<<8|Ae[e|79],Ae[e|80]<<24|Ae[e|81]<<16|Ae[e|82]<<8|Ae[e|83],Ae[e|84]<<24|Ae[e|85]<<16|Ae[e|86]<<8|Ae[e|87],Ae[e|88]<<24|Ae[e|89]<<16|Ae[e|90]<<8|Ae[e|91],Ae[e|92]<<24|Ae[e|93]<<16|Ae[e|94]<<8|Ae[e|95],Ae[e|96]<<24|Ae[e|97]<<16|Ae[e|98]<<8|Ae[e|99],Ae[e|100]<<24|Ae[e|101]<<16|Ae[e|102]<<8|Ae[e|103],Ae[e|104]<<24|Ae[e|105]<<16|Ae[e|106]<<8|Ae[e|107],Ae[e|108]<<24|Ae[e|109]<<16|Ae[e|110]<<8|Ae[e|111],Ae[e|112]<<24|Ae[e|113]<<16|Ae[e|114]<<8|Ae[e|115],Ae[e|116]<<24|Ae[e|117]<<16|Ae[e|118]<<8|Ae[e|119],Ae[e|120]<<24|Ae[e|121]<<16|Ae[e|122]<<8|Ae[e|123],Ae[e|124]<<24|Ae[e|125]<<16|Ae[e|126]<<8|Ae[e|127])}function _e(e){e=e|0;Ae[e|0]=X>>>24;Ae[e|1]=X>>>16&255;Ae[e|2]=X>>>8&255;Ae[e|3]=X&255;Ae[e|4]=Y>>>24;Ae[e|5]=Y>>>16&255;Ae[e|6]=Y>>>8&255;Ae[e|7]=Y&255;Ae[e|8]=Q>>>24;Ae[e|9]=Q>>>16&255;Ae[e|10]=Q>>>8&255;Ae[e|11]=Q&255;Ae[e|12]=ee>>>24;Ae[e|13]=ee>>>16&255;Ae[e|14]=ee>>>8&255;Ae[e|15]=ee&255;Ae[e|16]=te>>>24;Ae[e|17]=te>>>16&255;Ae[e|18]=te>>>8&255;Ae[e|19]=te&255;Ae[e|20]=ie>>>24;Ae[e|21]=ie>>>16&255;Ae[e|22]=ie>>>8&255;Ae[e|23]=ie&255;Ae[e|24]=se>>>24;Ae[e|25]=se>>>16&255;Ae[e|26]=se>>>8&255;Ae[e|27]=se&255;Ae[e|28]=re>>>24;Ae[e|29]=re>>>16&255;Ae[e|30]=re>>>8&255;Ae[e|31]=re&255;Ae[e|32]=ne>>>24;Ae[e|33]=ne>>>16&255;Ae[e|34]=ne>>>8&255;Ae[e|35]=ne&255;Ae[e|36]=ae>>>24;Ae[e|37]=ae>>>16&255;Ae[e|38]=ae>>>8&255;Ae[e|39]=ae&255;Ae[e|40]=oe>>>24;Ae[e|41]=oe>>>16&255;Ae[e|42]=oe>>>8&255;Ae[e|43]=oe&255;Ae[e|44]=le>>>24;Ae[e|45]=le>>>16&255;Ae[e|46]=le>>>8&255;Ae[e|47]=le&255;Ae[e|48]=de>>>24;Ae[e|49]=de>>>16&255;Ae[e|50]=de>>>8&255;Ae[e|51]=de&255;Ae[e|52]=ce>>>24;Ae[e|53]=ce>>>16&255;Ae[e|54]=ce>>>8&255;Ae[e|55]=ce&255;Ae[e|56]=fe>>>24;Ae[e|57]=fe>>>16&255;Ae[e|58]=fe>>>8&255;Ae[e|59]=fe&255;Ae[e|60]=ue>>>24;Ae[e|61]=ue>>>16&255;Ae[e|62]=ue>>>8&255;Ae[e|63]=ue&255}function Re(){X=0x6a09e667;Y=0xf3bcc908;Q=0xbb67ae85;ee=0x84caa73b;te=0x3c6ef372;ie=0xfe94f82b;se=0xa54ff53a;re=0x5f1d36f1;ne=0x510e527f;ae=0xade682d1;oe=0x9b05688c;le=0x2b3e6c1f;de=0x1f83d9ab;ce=0xfb41bd6b;fe=0x5be0cd19;ue=0x137e2179;N=P=0}function b(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m,g,x){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;g=g|0;x=x|0;X=e;Y=t;Q=i;ee=s;te=r;ie=n;se=a;re=o;ne=l;ae=d;oe=c;le=f;de=u;ce=h;fe=p;ue=m;N=g;P=x}function a(e,t){e=e|0;t=t|0;var i=0;if(e&127)return-1;while((t|0)>=128){n(e);e=e+128|0;t=t-128|0;i=i+128|0}N=N+i|0;if(N>>>0<i>>>0)P=P+1|0;return i|0}function y(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0;if(e&127)return-1;if(~i)if(i&63)return-1;if((t|0)>=128){s=a(e,t)|0;if((s|0)==-1)return-1;e=e+s|0;t=t-s|0}s=s+t|0;N=N+t|0;if(N>>>0<t>>>0)P=P+1|0;Ae[e|t]=0x80;if((t|0)>=112){for(r=t+1|0;(r|0)<128;r=r+1|0)Ae[e|r]=0x00;n(e);t=0;Ae[e|0]=0}for(r=t+1|0;(r|0)<123;r=r+1|0)Ae[e|r]=0;Ae[e|120]=P>>>21&255;Ae[e|121]=P>>>13&255;Ae[e|122]=P>>>5&255;Ae[e|123]=P<<3&255|N>>>29;Ae[e|124]=N>>>21&255;Ae[e|125]=N>>>13&255;Ae[e|126]=N>>>5&255;Ae[e|127]=N<<3&255;n(e);if(~i)_e(i);return s|0}function Ne(){X=D;Y=F;Q=B;ee=G;te=O;ie=L;se=$;re=j;ne=V;ae=U;oe=H;le=z;de=W;ce=q;fe=J;ue=Z;N=128;P=0}function Pe(){X=K;Y=he;Q=pe;ee=me;te=ge;ie=xe;se=be;re=ve;ne=ye;ae=we;oe=Se;le=Ee;de=Ce;ce=Ie;fe=Te;ue=ke;N=128;P=0}function De(e,t,i,s,r,n,a,o,l,d,c,f,u,h,p,m,g,x,b,v,y,w,S,E,C,I,T,k,A,M,_,R){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;n=n|0;a=a|0;o=o|0;l=l|0;d=d|0;c=c|0;f=f|0;u=u|0;h=h|0;p=p|0;m=m|0;g=g|0;x=x|0;b=b|0;v=v|0;y=y|0;w=w|0;S=S|0;E=E|0;C=C|0;I=I|0;T=T|0;k=k|0;A=A|0;M=M|0;_=_|0;R=R|0;Re();Me(e^0x5c5c5c5c,t^0x5c5c5c5c,i^0x5c5c5c5c,s^0x5c5c5c5c,r^0x5c5c5c5c,n^0x5c5c5c5c,a^0x5c5c5c5c,o^0x5c5c5c5c,l^0x5c5c5c5c,d^0x5c5c5c5c,c^0x5c5c5c5c,f^0x5c5c5c5c,u^0x5c5c5c5c,h^0x5c5c5c5c,p^0x5c5c5c5c,m^0x5c5c5c5c,g^0x5c5c5c5c,x^0x5c5c5c5c,b^0x5c5c5c5c,v^0x5c5c5c5c,y^0x5c5c5c5c,w^0x5c5c5c5c,S^0x5c5c5c5c,E^0x5c5c5c5c,C^0x5c5c5c5c,I^0x5c5c5c5c,T^0x5c5c5c5c,k^0x5c5c5c5c,A^0x5c5c5c5c,M^0x5c5c5c5c,_^0x5c5c5c5c,R^0x5c5c5c5c);K=X;he=Y;pe=Q;me=ee;ge=te;xe=ie;be=se;ve=re;ye=ne;we=ae;Se=oe;Ee=le;Ce=de;Ie=ce;Te=fe;ke=ue;Re();Me(e^0x36363636,t^0x36363636,i^0x36363636,s^0x36363636,r^0x36363636,n^0x36363636,a^0x36363636,o^0x36363636,l^0x36363636,d^0x36363636,c^0x36363636,f^0x36363636,u^0x36363636,h^0x36363636,p^0x36363636,m^0x36363636,g^0x36363636,x^0x36363636,b^0x36363636,v^0x36363636,y^0x36363636,w^0x36363636,S^0x36363636,E^0x36363636,C^0x36363636,I^0x36363636,T^0x36363636,k^0x36363636,A^0x36363636,M^0x36363636,_^0x36363636,R^0x36363636);D=X;F=Y;B=Q;G=ee;O=te;L=ie;$=se;j=re;V=ne;U=ae;H=oe;z=le;W=de;q=ce;J=fe;Z=ue;N=128;P=0}function Fe(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0,n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0;if(e&127)return-1;if(~i)if(i&63)return-1;v=y(e,t,-1)|0;s=X;r=Y;n=Q;a=ee;o=te;l=ie;d=se;c=re;f=ne;u=ae;h=oe;p=le;m=de;g=ce;x=fe;b=ue;Pe();Me(s,r,n,a,o,l,d,c,f,u,h,p,m,g,x,b,0x80000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1536);if(~i)_e(i);return v|0}function Be(e,t,i,s,r){e=e|0;t=t|0;i=i|0;s=s|0;r=r|0;var n=0,a=0,o=0,l=0,d=0,c=0,f=0,u=0,h=0,p=0,m=0,g=0,x=0,b=0,v=0,y=0,w=0,S=0,E=0,C=0,I=0,T=0,k=0,A=0,M=0,_=0,R=0,N=0,P=0,D=0,F=0,B=0;if(e&127)return-1;if(~r)if(r&63)return-1;Ae[e+t|0]=i>>>24;Ae[e+t+1|0]=i>>>16&255;Ae[e+t+2|0]=i>>>8&255;Ae[e+t+3|0]=i&255;Fe(e,t+4|0,-1)|0;n=w=X;a=S=Y;o=E=Q;l=C=ee;d=I=te;c=T=ie;f=k=se;u=A=re;h=M=ne;p=_=ae;m=R=oe;g=N=le;x=P=de;b=D=ce;v=F=fe;y=B=ue;s=s-1|0;while((s|0)>0){Ne();Me(w,S,E,C,I,T,k,A,M,_,R,N,P,D,F,B,0x80000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1536);w=X;S=Y;E=Q;C=ee;I=te;T=ie;k=se;A=re;M=ne;_=ae;R=oe;N=le;P=de;D=ce;F=fe;B=ue;Pe();Me(w,S,E,C,I,T,k,A,M,_,R,N,P,D,F,B,0x80000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1536);w=X;S=Y;E=Q;C=ee;I=te;T=ie;k=se;A=re;M=ne;_=ae;R=oe;N=le;P=de;D=ce;F=fe;B=ue;n=n^X;a=a^Y;o=o^Q;l=l^ee;d=d^te;c=c^ie;f=f^se;u=u^re;h=h^ne;p=p^ae;m=m^oe;g=g^le;x=x^de;b=b^ce;v=v^fe;y=y^ue;s=s-1|0}X=n;Y=a;Q=o;ee=l;te=d;ie=c;se=f;re=u;ne=h;ae=p;oe=m;le=g;de=x;ce=b;fe=v;ue=y;if(~r)_e(r);return 0}return{reset:Re,init:b,process:a,finish:y,hmac_reset:Ne,hmac_init:De,hmac_finish:Fe,pbkdf2_generate_block:Be}};var te=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var ie=128;var se=64;var re=function(t){te(e,t);function e(){var e=t.call(this)||this;e.NAME="sha512";e.BLOCK_SIZE=ie;e.HASH_SIZE=se;e.heap=d();e.asm=ee({Uint8Array:Uint8Array},null,e.heap.buffer);e.reset();return e}e.NAME="sha512";return e}(H);var ne=function(){function e(e,t,i){if(!e.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");this.hash=e;this.BLOCK_SIZE=this.hash.BLOCK_SIZE;this.HMAC_SIZE=this.hash.HASH_SIZE;this.result=null;this.key=ae(this.hash,t);var s=new Uint8Array(this.key);for(var r=0;r<s.length;++r)s[r]^=54;this.hash.reset().process(s);if(i!==undefined){this._hmac_init_verify(i)}else{this.verify=null}}e.prototype.process=function(e){if(this.result!==null)throw new g("state must be reset before processing new data");this.hash.process(e);return this};e.prototype.finish=function(){if(this.result!==null)throw new g("state must be reset before processing new data");var e=this.hash.finish().result;var t=new Uint8Array(this.key);for(var i=0;i<t.length;++i)t[i]^=92;var s=this.verify;var r=this.hash.reset().process(t).process(e).finish().result;if(s){if(s.length===r.length){var n=0;for(var i=0;i<s.length;i++){n|=s[i]^r[i]}if(n!==0)throw new Error("HMAC verification failed, hash value doesn't match")}else{throw new Error("HMAC verification failed, lengths doesn't match")}}this.result=r;return this};e.prototype._hmac_init_verify=function(e){if(e.length!==this.HMAC_SIZE)throw new b("illegal verification tag size");this.verify=e};return e}();function ae(e,t){var i=new Uint8Array(e.BLOCK_SIZE);if(t.length>e.BLOCK_SIZE){i.set(e.reset().process(t).finish().result)}else{i.set(t)}return i}var oe=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var le=function(r){oe(e,r);function e(e,t){var i=this;var s=new J;i=r.call(this,s,e,t)||this;i.reset();if(t!==undefined){i._hmac_init_verify(t)}else{i.verify=null}return i}e.prototype.reset=function(){this.result=null;var e=this.key;this.hash.reset().asm.hmac_init(e[0]<<24|e[1]<<16|e[2]<<8|e[3],e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[8]<<24|e[9]<<16|e[10]<<8|e[11],e[12]<<24|e[13]<<16|e[14]<<8|e[15],e[16]<<24|e[17]<<16|e[18]<<8|e[19],e[20]<<24|e[21]<<16|e[22]<<8|e[23],e[24]<<24|e[25]<<16|e[26]<<8|e[27],e[28]<<24|e[29]<<16|e[30]<<8|e[31],e[32]<<24|e[33]<<16|e[34]<<8|e[35],e[36]<<24|e[37]<<16|e[38]<<8|e[39],e[40]<<24|e[41]<<16|e[42]<<8|e[43],e[44]<<24|e[45]<<16|e[46]<<8|e[47],e[48]<<24|e[49]<<16|e[50]<<8|e[51],e[52]<<24|e[53]<<16|e[54]<<8|e[55],e[56]<<24|e[57]<<16|e[58]<<8|e[59],e[60]<<24|e[61]<<16|e[62]<<8|e[63]);return this};e.prototype.finish=function(){if(this.result!==null)throw new g("state must be reset before processing new data");var e=this.hash;var t=this.hash.asm;var i=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var s=this.verify;var r=new Uint8Array(q);r.set(i.subarray(0,q));if(s){if(s.length===r.length){var n=0;for(var a=0;a<s.length;a++){n|=s[a]^r[a]}if(n!==0)throw new Error("HMAC verification failed, hash value doesn't match")}else{throw new Error("HMAC verification failed, lengths doesn't match")}}else{this.result=r}return this};return e}(ne);var de=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var ce=function(r){de(e,r);function e(e,t){var i=this;var s=new Q;i=r.call(this,s,e,t)||this;i.reset();if(t!==undefined){i._hmac_init_verify(t)}else{i.verify=null}return i}e.prototype.reset=function(){var e=this.key;this.hash.reset().asm.hmac_init(e[0]<<24|e[1]<<16|e[2]<<8|e[3],e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[8]<<24|e[9]<<16|e[10]<<8|e[11],e[12]<<24|e[13]<<16|e[14]<<8|e[15],e[16]<<24|e[17]<<16|e[18]<<8|e[19],e[20]<<24|e[21]<<16|e[22]<<8|e[23],e[24]<<24|e[25]<<16|e[26]<<8|e[27],e[28]<<24|e[29]<<16|e[30]<<8|e[31],e[32]<<24|e[33]<<16|e[34]<<8|e[35],e[36]<<24|e[37]<<16|e[38]<<8|e[39],e[40]<<24|e[41]<<16|e[42]<<8|e[43],e[44]<<24|e[45]<<16|e[46]<<8|e[47],e[48]<<24|e[49]<<16|e[50]<<8|e[51],e[52]<<24|e[53]<<16|e[54]<<8|e[55],e[56]<<24|e[57]<<16|e[58]<<8|e[59],e[60]<<24|e[61]<<16|e[62]<<8|e[63]);return this};e.prototype.finish=function(){if(this.key===null)throw new g("no key is associated with the instance");if(this.result!==null)throw new g("state must be reset before processing new data");var e=this.hash;var t=this.hash.asm;var i=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var s=this.verify;var r=new Uint8Array(Y);r.set(i.subarray(0,Y));if(s){if(s.length===r.length){var n=0;for(var a=0;a<s.length;a++){n|=s[a]^r[a]}if(n!==0)throw new Error("HMAC verification failed, hash value doesn't match")}else{throw new Error("HMAC verification failed, lengths doesn't match")}}else{this.result=r}return this};return e}(ne);var fe=undefined&&undefined.__extends||function(){var s=function(e,t){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return s(e,t)};return function(e,t){s(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var ue=function(r){fe(e,r);function e(e,t){var i=this;var s=new re;i=r.call(this,s,e,t)||this;i.reset();if(t!==undefined){i._hmac_init_verify(t)}else{i.verify=null}return i}e.prototype.reset=function(){var e=this.key;this.hash.reset().asm.hmac_init(e[0]<<24|e[1]<<16|e[2]<<8|e[3],e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[8]<<24|e[9]<<16|e[10]<<8|e[11],e[12]<<24|e[13]<<16|e[14]<<8|e[15],e[16]<<24|e[17]<<16|e[18]<<8|e[19],e[20]<<24|e[21]<<16|e[22]<<8|e[23],e[24]<<24|e[25]<<16|e[26]<<8|e[27],e[28]<<24|e[29]<<16|e[30]<<8|e[31],e[32]<<24|e[33]<<16|e[34]<<8|e[35],e[36]<<24|e[37]<<16|e[38]<<8|e[39],e[40]<<24|e[41]<<16|e[42]<<8|e[43],e[44]<<24|e[45]<<16|e[46]<<8|e[47],e[48]<<24|e[49]<<16|e[50]<<8|e[51],e[52]<<24|e[53]<<16|e[54]<<8|e[55],e[56]<<24|e[57]<<16|e[58]<<8|e[59],e[60]<<24|e[61]<<16|e[62]<<8|e[63],e[64]<<24|e[65]<<16|e[66]<<8|e[67],e[68]<<24|e[69]<<16|e[70]<<8|e[71],e[72]<<24|e[73]<<16|e[74]<<8|e[75],e[76]<<24|e[77]<<16|e[78]<<8|e[79],e[80]<<24|e[81]<<16|e[82]<<8|e[83],e[84]<<24|e[85]<<16|e[86]<<8|e[87],e[88]<<24|e[89]<<16|e[90]<<8|e[91],e[92]<<24|e[93]<<16|e[94]<<8|e[95],e[96]<<24|e[97]<<16|e[98]<<8|e[99],e[100]<<24|e[101]<<16|e[102]<<8|e[103],e[104]<<24|e[105]<<16|e[106]<<8|e[107],e[108]<<24|e[109]<<16|e[110]<<8|e[111],e[112]<<24|e[113]<<16|e[114]<<8|e[115],e[116]<<24|e[117]<<16|e[118]<<8|e[119],e[120]<<24|e[121]<<16|e[122]<<8|e[123],e[124]<<24|e[125]<<16|e[126]<<8|e[127]);return this};e.prototype.finish=function(){if(this.key===null)throw new g("no key is associated with the instance");if(this.result!==null)throw new g("state must be reset before processing new data");var e=this.hash;var t=this.hash.asm;var i=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var s=this.verify;var r=new Uint8Array(se);r.set(i.subarray(0,se));if(s){if(s.length===r.length){var n=0;for(var a=0;a<s.length;a++){n|=s[a]^r[a]}if(n!==0)throw new Error("HMAC verification failed, hash value doesn't match")}else{throw new Error("HMAC verification failed, lengths doesn't match")}}else{this.result=r}return this};return e}(ne);function he(e,t,i,s){var r=new Uint8Array(i);var n=Math.ceil(i/e.HMAC_SIZE);for(var a=1;a<=n;++a){var o=(a-1)*e.HMAC_SIZE;var l=(a<n?0:i%e.HMAC_SIZE)||e.HMAC_SIZE;e.reset().process(t);e.hash.asm.pbkdf2_generate_block(e.hash.pos,e.hash.len,a,s,0);r.set(e.hash.heap.subarray(0,l),o)}return r}function pe(e,t,i,s){var r=new le(e);return he(r,t,s,i)}function me(e,t,i,s){var r=new ce(e);return he(r,t,s,i)}function ge(e,t,i,s){var r=new ue(e);return he(r,t,s,i)}var xe=function(){function e(e){var t=e.length;if(t!==2&&t!==3&&t!==8)throw new SyntaxError("unexpected key type");var i=new V(new j(e[0]));var s=new j(e[1]);this.key={0:i,1:s};if(t>2){this.key[2]=new j(e[2])}if(t>3){this.key[3]=new V(new j(e[3]));this.key[4]=new V(new j(e[4]));this.key[5]=new j(e[5]);this.key[6]=new j(e[6]);this.key[7]=new j(e[7])}}e.prototype.encrypt=function(e){if(!this.key)throw new g("no key is associated with the instance");if(this.key[0].compare(e)<=0)throw new RangeError("data too large");var t=this.key[0];var i=this.key[1];var s=t.power(e,i).toBytes();var r=t.bitLength+7>>3;if(s.length<r){var n=new Uint8Array(r);n.set(s,r-s.length);s=n}this.result=s;return this};e.prototype.decrypt=function(e){if(this.key[0].compare(e)<=0)throw new RangeError("data too large");var t;var i;if(this.key[3]!==undefined){i=this.key[0];var s=this.key[3];var r=this.key[4];var n=this.key[5];var a=this.key[6];var o=this.key[7];var l=s.power(e,n);var d=r.power(e,a);var c=l.subtract(d);while(c.sign<0)c=c.add(s);var f=s.reduce(o.multiply(c));t=f.multiply(r).add(d).clamp(i.bitLength).toBytes()}else{i=this.key[0];var u=this.key[2];t=i.power(e,u).toBytes()}var h=i.bitLength+7>>3;if(t.length<h){var p=new Uint8Array(h);p.set(t,h-t.length);t=p}this.result=t;return this};return e}();var be=function(){function e(e,t,i){this.rsa=new xe(e);this.hash=t;if(i!==undefined){this.label=i.length>0?i:null}else{this.label=null}}e.prototype.encrypt=function(e,t){var i=Math.ceil(this.rsa.key[0].bitLength/8);var s=this.hash.HASH_SIZE;var r=e.byteLength||e.length||0;var n=i-r-2*s-2;if(r>i-2*this.hash.HASH_SIZE-2)throw new b("data too large");var a=new Uint8Array(i);var o=a.subarray(1,s+1);var l=a.subarray(s+1);l.set(e,s+n+1);l.set(this.hash.process(this.label||new Uint8Array(0)).finish().result,0);l[s+n]=1;if(t!==undefined){if(o.length!==t.length)throw new b("random size must equal the hash size");o.set(t)}else{D(o)}var d=this.RSA_MGF1_generate(o,l.length);for(var c=0;c<l.length;c++)l[c]^=d[c];var f=this.RSA_MGF1_generate(l,o.length);for(var c=0;c<o.length;c++)o[c]^=f[c];this.rsa.encrypt(new j(a));return new Uint8Array(this.rsa.result)};e.prototype.decrypt=function(e){if(!this.rsa.key)throw new g("no key is associated with the instance");var t=Math.ceil(this.rsa.key[0].bitLength/8);var i=this.hash.HASH_SIZE;var s=e.byteLength||e.length||0;if(s!==t)throw new b("bad data");this.rsa.decrypt(new j(e));var r=this.rsa.result[0];var n=this.rsa.result.subarray(1,i+1);var a=this.rsa.result.subarray(i+1);if(r!==0)throw new v("decryption failed");var o=this.RSA_MGF1_generate(a,n.length);for(var l=0;l<n.length;l++)n[l]^=o[l];var d=this.RSA_MGF1_generate(n,a.length);for(var l=0;l<a.length;l++)a[l]^=d[l];var c=this.hash.reset().process(this.label||new Uint8Array(0)).finish().result;for(var l=0;l<i;l++){if(c[l]!==a[l])throw new v("decryption failed")}var f=i;for(;f<a.length;f++){var u=a[f];if(u===1)break;if(u!==0)throw new v("decryption failed")}if(f===a.length)throw new v("decryption failed");this.rsa.result=a.subarray(f+1);return new Uint8Array(this.rsa.result)};e.prototype.RSA_MGF1_generate=function(e,t){if(t===void 0){t=0}var i=this.hash.HASH_SIZE;var s=new Uint8Array(t);var r=new Uint8Array(4);var n=Math.ceil(t/i);for(var a=0;a<n;a++){r[0]=a>>>24,r[1]=a>>>16&255,r[2]=a>>>8&255,r[3]=a&255;var o=s.subarray(a*i);var l=this.hash.reset().process(e).process(r).finish().result;if(l.length>o.length)l=l.subarray(0,o.length);o.set(l)}return s};return e}();var ve=function(){function e(e,t,i){if(i===void 0){i=4}this.rsa=new xe(e);this.hash=t;this.saltLength=i;if(this.saltLength<0)throw new TypeError("saltLength should be a non-negative number");if(this.rsa.key!==null&&Math.ceil((this.rsa.key[0].bitLength-1)/8)<this.hash.HASH_SIZE+this.saltLength+2)throw new SyntaxError("saltLength is too large")}e.prototype.sign=function(e,t){var i=this.rsa.key[0].bitLength;var s=this.hash.HASH_SIZE;var r=Math.ceil((i-1)/8);var n=this.saltLength;var a=r-n-s-2;var o=new Uint8Array(r);var l=o.subarray(r-s-1,r-1);var d=o.subarray(0,r-s-1);var c=d.subarray(a+1);var f=new Uint8Array(8+s+n);var u=f.subarray(8,8+s);var h=f.subarray(8+s);u.set(this.hash.process(e).finish().result);if(n>0){if(t!==undefined){if(h.length!==t.length)throw new b("random size must equal the salt size");h.set(t)}else{D(h)}}d[a]=1;c.set(h);l.set(this.hash.reset().process(f).finish().result);var p=this.RSA_MGF1_generate(l,d.length);for(var m=0;m<d.length;m++)d[m]^=p[m];o[r-1]=188;var g=8*r-i+1;if(g%8)o[0]&=255>>>g;this.rsa.decrypt(new j(o));return this.rsa.result};e.prototype.verify=function(e,t){var i=this.rsa.key[0].bitLength;var s=this.hash.HASH_SIZE;var r=Math.ceil((i-1)/8);var n=this.saltLength;var a=r-n-s-2;this.rsa.encrypt(new j(e));var o=this.rsa.result;if(o[r-1]!==188)throw new v("bad signature");var l=o.subarray(r-s-1,r-1);var d=o.subarray(0,r-s-1);var c=d.subarray(a+1);var f=8*r-i+1;if(f%8&&o[0]>>>8-f)throw new v("bad signature");var u=this.RSA_MGF1_generate(l,d.length);for(var h=0;h<d.length;h++)d[h]^=u[h];if(f%8)o[0]&=255>>>f;for(var h=0;h<a;h++){if(d[h]!==0)throw new v("bad signature")}if(d[a]!==1)throw new v("bad signature");var p=new Uint8Array(8+s+n);var m=p.subarray(8,8+s);var g=p.subarray(8+s);m.set(this.hash.reset().process(t).finish().result);g.set(c);var x=this.hash.reset().process(p).finish().result;for(var h=0;h<s;h++){if(l[h]!==x[h])throw new v("bad signature")}};e.prototype.RSA_MGF1_generate=function(e,t){if(t===void 0){t=0}var i=this.hash.HASH_SIZE;var s=new Uint8Array(t);var r=new Uint8Array(4);var n=Math.ceil(t/i);for(var a=0;a<n;a++){r[0]=a>>>24,r[1]=a>>>16&255,r[2]=a>>>8&255,r[3]=a&255;var o=s.subarray(a*i);var l=this.hash.reset().process(e).process(r).finish().result;if(l.length>o.length)l=l.subarray(0,o.length);o.set(l)}return s};return e}();var ye=function(){function e(e,t){this.rsa=new xe(e);this.hash=t}e.prototype.sign=function(e){if(!this.rsa.key){throw new g("no key is associated with the instance")}var t=Se(this.hash);var i=this.hash.HASH_SIZE;var s=t.length+i;var r=this.rsa.key[0].bitLength+7>>3;if(r<s+11){throw new Error("Message too long")}var n=new Uint8Array(i);n.set(this.hash.process(e).finish().result);var a=new Uint8Array(r);var o=0;a[o++]=0;a[o++]=1;for(o;o<r-s-1;o++){a[o]=255}a[o++]=0;a.set(t,o);a.set(n,a.length-i);this.rsa.decrypt(new j(a));return this.rsa.result};e.prototype.verify=function(e,t){var i=Se(this.hash);var s=this.hash.HASH_SIZE;var r=i.length+s;var n=this.rsa.key[0].bitLength+7>>3;if(n<r+11){throw new v("Bad signature")}this.rsa.encrypt(new j(e));var a=new Uint8Array(s);a.set(this.hash.process(t).finish().result);var o=1;var l=this.rsa.result;var d=0;o&=l[d++]===0?1:0;o&=l[d++]===1?1:0;for(d;d<n-r-1;d++){o&=l[d]===255?1:0}o&=l[d++]===0?1:0;var c=0;var f=d+i.length;for(d;d<f;d++){o&=l[d]===i[c++]?1:0}c=0;f=d+a.length;for(d;d<f;d++){o&=l[d]===a[c++]?1:0}if(!o){throw new v("Bad signature")}};return e}();var we={sha1:new Uint8Array([48,33,48,9,6,5,43,14,3,2,26,5,0,4,20]),sha256:new Uint8Array([48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32]),sha384:new Uint8Array([48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48]),sha512:new Uint8Array([48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64])};function Se(e){var t=we[e.NAME];if(!t){throw new Error("Cannot get hash prefix for hash algorithm '"+e.NAME+"'")}return t}e.AES_CBC=h;e.AES_CCM=S;e.AES_CFB=E;e.AES_CMAC=T;e.AES_CTR=k;e.AES_ECB=C;e.AES_GCM=M;e.AES_OFB=_;e.BigNumber=j;e.HmacSha1=le;e.HmacSha256=ce;e.HmacSha512=ue;e.IllegalArgumentError=b;e.IllegalStateError=g;e.Modulus=V;e.Pbkdf2HmacSha1=pe;e.Pbkdf2HmacSha256=me;e.Pbkdf2HmacSha512=ge;e.RSA=xe;e.RSA_OAEP=be;e.RSA_PKCS1_v1_5=ye;e.RSA_PSS=ve;e.SecurityError=v;e.Sha1=J;e.Sha256=Q;e.Sha512=re;e.base64_to_bytes=n;e.bytes_to_base64=l;e.bytes_to_hex=o;e.bytes_to_string=a;e.hex_to_bytes=r;e.string_to_bytes=s;return e}({});Ext.ns("SM.Attachments");SM.Attachments.Grid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const s=this;const e=Ext.id();const t=["name","size","type","description","digest","user",{name:"date",type:"date",dateFormat:"c"}];const r=new Ext.data.JsonStore({grid:this,root:"",fields:t,idProperty:"digest"});const i=[{header:"Artifact",id:`name-${e}`,width:100,dataIndex:"name",sortable:true,align:"left",renderer:function(e,t,i){var s='<img src="'+getFileIcon(e)+'" class="sm-artifact-file-icon">';s+="<b>"+e+"</b>";s+="<br><b>Type:</b> "+i.data.type+" <b>Size:</b> "+i.data.size;s+=`<br><i>Attached ${i.data.date.format("Y-m-d")} by ${i.data.user.name}</i>`;return s}},{width:25,header:"download",fixed:true,dataIndex:"none",renderer:function(e,t,i){t.css="artifact-view";t.attr='ext:qtip="View artifact"';return""}},{width:25,header:"delete",fixed:true,dataIndex:"none",renderer:function(e,t,i){t.css="artifact-delete";t.attr='ext:qtip="Unattach the artifact from this review"';return""}}];const n=async function(){try{r.removeAll();const e=await o("artifacts");r.loadData(JSON.parse(e));return true}catch(e){return false}};const o=async function(e){const t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s.collectionId}/reviews/${s.assetId}/${s.ruleId}/metadata/keys/${e}`,method:"GET"});return JSON.parse(t.response.responseText)};const a=async function(t){try{let e=t.fileInput.dom;const i=[...e.files];await l(i[0]);t.reset()}catch(e){t.reset();alert(e.message)}};const l=async function(e){let t;try{t=await d(e);await c(t.attachment.digest,t.data)}catch(e){Ext.Msg.alert("Error",`Failed to save file data: ${e.message}`);return}try{r.loadData([t.attachment],true);const i=r.getRange().map(e=>e.data);await c("artifacts",JSON.stringify(i))}catch(e){try{await u(t.attachment.digest)}catch(e){console.log(e);Ext.Msg.alert("Error",`Failed to save metadata: ${e.message}`)}}};const d=async function(e){const t=new asmCrypto.Sha256;const i=await readArrayBufferAsync(e);const s=new Uint8Array(i);const r=asmCrypto.bytes_to_base64(s);t.process(s);t.finish();const n=asmCrypto.bytes_to_hex(t.result);return{attachment:{name:e.name,date:new Date,size:e.size,type:e.type,user:{userId:curUser.userId,name:curUser.display},digest:n},data:r}};const c=async function(e,t){const i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s.collectionId}/reviews/${s.assetId}/${s.ruleId}/metadata/keys/${e}`,method:"PUT",jsonData:JSON.stringify(t)});return i.response.responseText?JSON.parse(i.response.responseText):""};const f=async function(e){const t=await SM.confirmPromise("Confirm",`Remove ${e.data.name}?`);if(t==="yes"){try{await u(e.data.digest)}catch(e){Ext.Msg.alert("Error",`Failed to delete metadata key: ${e.message}`);return}try{r.remove(e);const i=r.getRange().map(e=>e.data);await c("artifacts",JSON.stringify(i))}catch(e){Ext.Msg.alert("Error",`Failed to update metadata: ${e.message}`)}}};const u=async function(e){let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s.collectionId}/reviews/${s.assetId}/${s.ruleId}/metadata/keys/${e}`,method:"DELETE"});return t.response.responseText?JSON.parse(t.response.responseText):""};const h=async function(e){const t=new Ext.Panel({bodyStyle:"background-color: #333;"});const i=Ext.getBody().getViewSize();let s=i.height*.75;let r=i.width*.75<=1024?i.width*.75:1024;const n=new Ext.Window({title:`Image`,modal:true,resizable:true,width:r,height:s,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:t});n.show();try{const a=await o(e.digest);t.update(`<img style='height: 100%; width: 100%; object-fit: contain' src='data:${e.type};base64,${encodeURI(a)}'></img>`)}catch(e){Ext.Msg.alert("Error","File data not available")}};const p=new Ext.ux.form.FileUploadField({buttonOnly:true,accept:".gif,.jpg,.jpeg,.svg,.png,.bmp",webkitdirectory:false,multiple:false,style:"width: 95px;",buttonText:`Attach image...`,buttonCfg:{icon:"img/attach-16.png"},listeners:{fileselected:a}});const m={loadArtifacts:n,fileUploadField:p,disableSelection:true,layout:"fit",cls:"custom-artifacts",hideHeaders:true,border:false,store:r,columns:i,stripeRows:true,view:new SM.ColumnFilters.GridView({forceFit:true,emptyText:"No attachments to display.",deferEmptyText:false}),tbar:new Ext.Toolbar({items:[p]}),loadMask:true,autoExpandColumn:`name-${e}`,emptyText:"No attachments to display",listeners:{cellclick:function(e,t,i,s){var r=e.getStore().getAt(t);var n=e.getColumnModel().getColumnHeader(i);switch(n){case"download":h(r.data);break;case"delete":f(r);break}}}};Ext.apply(this,Ext.apply(this.initialConfig,m));SM.Attachments.Grid.superclass.initComponent.call(this)}});function readBinaryStringAsync(s){return new Promise((e,t)=>{let i=new FileReader;i.onload=()=>{e(i.result)};i.onerror=t;i.readAsBinaryString(s)})}function readArrayBufferAsync(s){return new Promise((e,t)=>{let i=new FileReader;i.onload=()=>{e(i.result)};i.onerror=t;i.readAsArrayBuffer(s)})}SM.ExportsAssetTree=Ext.extend(Ext.tree.TreePanel,{initComponent:function(){let e=this;let t=this.collectionId;let i={layout:"fit",autoScroll:true,bodyStyle:"padding:5px;",minSize:220,root:{nodeType:"async",id:`${t}-assignment-root`,checked:false,expanded:true},rootVisible:false,loader:new Ext.tree.TreeLoader({directFn:e.loadTree}),loadMask:"Loading...",listeners:{checkchange:e.onCheckChange}};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.ExportsAssetTree.superclass.initComponent.call(this)},loadTree:async function(e,a){try{let n;n=e.match(/^(\d+)-assignment-root$/);if(n){let e=n[1];let t=[{id:`${e}-assignment-assets-node`,node:"assets",text:'<span style="font-weight: 600;">All Assets</span>',checked:true,expanded:true,iconCls:"sm-asset-icon"}];a(t,{status:true});return}n=e.match(/^(\d+)-assignment-assets-node$/);if(n){let s=n[1];const t=this.ownerTree.data.filter(e=>e.stigCount>0);let e=t.map(e=>{const t=Math.round(e.acceptedPct);const i=t===100?"sm-export-sprite-low":t>=50?"sm-export-sprite-medium":"sm-export-sprite-high";return{id:`${s}-${e.assetId}-assignment-assets-asset-node`,text:`${SM.he(e.name)} <span class="sm-export-sprite ${i}">${t}%</span>`,node:"asset",collectionId:s,assetId:e.assetId,assetName:e.name,stigCount:e.stigCount,iconCls:"sm-asset-icon",checked:!!this.ui.checkbox.checked,qtip:SM.he(e.name)}});this.getOwnerTree().assetsNode=this;a(e,{status:true});return}n=e.match(/^(\d+)-(\d+)-assignment-assets-asset-node$/);if(n){let s=n[1];let r=n[2];let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s}/status`,method:"GET",params:{assetId:r}});let t=JSON.parse(e.response.responseText);let i=t.map(e=>{const t=Math.round(e.status.accepted.total/e.rules.total*100);const i=t===100?"sm-export-sprite-low":t>=50?"sm-export-sprite-medium":"sm-export-sprite-high";return{id:`${s}-${r}-${e.benchmarkId}-assignment-leaf`,text:`${SM.he(e.benchmarkId)} <span class="sm-export-sprite ${i}">${t}%</span>`,leaf:true,node:"asset-stig",iconCls:"sm-stig-icon",stigName:e.benchmarkId,assetName:e.assetName,assetId:e.assetId,collectionId:s,benchmarkId:e.benchmarkId,checked:!!this.ui.checkbox.checked}});a(i,{status:true});return}}catch(e){Ext.Msg.alert("Status","AJAX request failed in loadTree()")}},onCheckChange:function(e,i){const s=function(e){for(const t of e.childNodes){t.ui.checkbox.checked=i;t.attributes.checked=i;t.ui.checkbox.indeterminate=false;s(t)}};s(e);let r=e;while(r){const n=r.parentNode;if(n?.ui?.checkbox){const a=[];let t=r;while(t){let e=t.ui.checkbox.indeterminate?"indeterminate":t.ui.checkbox.checked?"checked":"unchecked";a.push(e);t=t.nextSibling}t=r;do{t=t.previousSibling;if(t){let e=t.ui.checkbox.indeterminate?"indeterminate":t.ui.checkbox.checked?"checked":"unchecked";a.push(e)}}while(t);const o=a.every(e=>e==="checked");const l=a.some(e=>e==="checked");const d=a.some(e=>e==="unchecked");const c=a.some(e=>e==="indeterminate");n.ui.checkbox.checked=o;n.attributes.checked=o;n.ui.checkbox.indeterminate=c||l&&d}r=n}this.fireEvent("checkstateschanged")},getChecked:function(e){e=e||this.assetsNode||this.root;var t={};var i=function(){if(this===e){return true}if(this.ui?.checkbox?.checked&&!this.ui?.checkbox?.indeterminate){if(!t[this.attributes.assetId]){t[this.attributes.assetId]={assetName:this.attributes.assetName,benchmarkIds:[]}}if(this.attributes.benchmarkId){t[this.attributes.assetId].benchmarkIds.push(this.attributes.benchmarkId);return true}else{return false}}else if(!this.ui?.checkbox?.checked&&!this.ui?.checkbox?.indeterminate){return false}};e.cascade(i);return t}});SM.ExportsStigTree=Ext.extend(Ext.tree.TreePanel,{initComponent:function(){let e=this;let t=this.collectionId;let i={layout:"fit",autoScroll:true,bodyStyle:"padding:5px;",minSize:220,root:{nodeType:"async",id:`${t}-assignment-root`,checked:false,expanded:true},rootVisible:false,loader:new Ext.tree.TreeLoader({directFn:e.loadTree,preloadChildren:true}),loadMask:"Loading...",listeners:{checkchange:e.onCheckChange}};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.ExportsAssetTree.superclass.initComponent.call(this)},loadTree:async function(t,a){try{let n,e;n=t.match(/^(\d+)-assignment-root$/);if(n){let e=n[1];let t=[{id:`${e}-assignment-stigs-node`,node:"stigs",text:'<span style="font-weight: 600;">All STIGs</span>',checked:true,expanded:true,iconCls:"sm-stig-icon"}];a(t,{status:true});return}n=t.match(/^(\d+)-assignment-stigs-node$/);if(n){let i=n[1];const o=this.getOwnerTree().data;const l=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${i}/status`,method:"GET",params:{benchmarkId:o.map(e=>e.benchmarkId)}});let e=JSON.parse(l.response.responseText);let s={};for(const c of e){if(!s[c.benchmarkId]){s[c.benchmarkId]=[]}s[c.benchmarkId].push(c)}let r=[];for(const f of o){const u=Math.round(f.acceptedPct);const h=u===100?"sm-export-sprite-low":u>=50?"sm-export-sprite-medium":"sm-export-sprite-high";let e={id:`${i}-${f.benchmarkId}-assignment-stigs-stig-node`,text:`${f.benchmarkId} <span class="sm-export-sprite ${h}">${u}%</span>`,node:"stig",collectionId:i,benchmarkId:f.benchmarkId,iconCls:"sm-stig-icon",checked:!!this.ui.checkbox.checked,qtip:SM.he(f.title)};let t=[];for(const c of s[f.benchmarkId]){const u=Math.round(c.status.accepted.total/c.rules.total*100);const h=u===100?"sm-export-sprite-low":u>=50?"sm-export-sprite-medium":"sm-export-sprite-high";t.push({id:`${i}-${c.benchmarkId}-${c.assetId}-assignment-leaf`,text:`${SM.he(c.assetName)} <span class="sm-export-sprite ${h}">${u}%</span>`,leaf:true,node:"stig-asset",iconCls:"sm-asset-icon",stigName:c.benchmarkId,assetName:c.assetName,assetId:c.assetId,collectionId:i,benchmarkId:c.benchmarkId,checked:!!this.ui.checkbox.checked})}e.children=t;r.push(e)}this.getOwnerTree().stigsNode=this;a(r,{status:true});const d=function(){this.getOwnerTree().loader.doPreload(this);this.renderChildren()};this.cascade(d);return}}catch(e){Ext.Msg.alert("Status","AJAX request failed in loadTree()")}},onCheckChange:function(e,i){const s=function(e){for(const t of e.childNodes){t.ui.checkbox.checked=i;t.attributes.checked=i;t.ui.checkbox.indeterminate=false;s(t)}};s(e);let r=e;while(r){const n=r.parentNode;if(n?.ui?.checkbox){const a=[];let t=r;while(t){let e=t.ui.checkbox.indeterminate?"indeterminate":t.ui.checkbox.checked?"checked":"unchecked";a.push(e);t=t.nextSibling}t=r;do{t=t.previousSibling;if(t){let e=t.ui.checkbox.indeterminate?"indeterminate":t.ui.checkbox.checked?"checked":"unchecked";a.push(e)}}while(t);const o=a.every(e=>e==="checked");const l=a.some(e=>e==="checked");const d=a.some(e=>e==="unchecked");const c=a.some(e=>e==="indeterminate");n.ui.checkbox.checked=o;n.attributes.checked=o;n.ui.checkbox.indeterminate=c||l&&d}r=n}this.fireEvent("checkstateschanged")},getChecked:function(e){e=e||this.stigsNode||this.root;var t={};var i=function(){if(this===e){return true}if(!this.attributes.assetId){return true}if(this.ui?.checkbox?.checked&&!this.ui?.checkbox?.indeterminate){if(!t[this.attributes.assetId]){t[this.attributes.assetId]={assetName:this.attributes.assetName,benchmarkIds:[]}}if(this.attributes.benchmarkId){t[this.attributes.assetId].benchmarkIds.push(this.attributes.benchmarkId);return true}else{return false}}else if(!this.ui?.checkbox?.checked&&!this.ui?.checkbox?.indeterminate){return false}};e.cascade(i);return t}});async function showExportCklFiles(e,s,t="asset",r){try{let i;const a=new Ext.Button({text:"Export",iconCls:"sm-export-icon",disabled:false,handler:function(){let e=l.getChecked();let t=d.checked;i.close();exportCklArchive(s,e,t)}});function n(){const e=Object.keys(l.getChecked()).length;a.setDisabled(e===0)}const o={panel:this,width:400,flex:1,collectionId:e,data:r,listeners:{checkstateschanged:n}};const l=t==="asset"?new SM.ExportsAssetTree(o):new SM.ExportsStigTree(o);i=new Ext.Window({title:"Export CKL archive",cls:"sm-dialog-window sm-round-panel",modal:true,hidden:true,width:450,height:600,layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 10 10 10"},plain:true,bodyStyle:"padding:5px 5px 0 5px;",buttonAlign:"left",items:[{html:`<div class="sm-dialog-panel-title">Select ZIP members</div>
          <div class="sm-dialog-panel-text">Badges: 
            <span class="sm-export-sprite sm-export-sprite-high">Accepted: &lt; 100%</span>
            <span class="sm-export-sprite sm-export-sprite-low">Accepted: 100%</span>
          </div>`,border:false},l],fbar:[{xtype:"panel",border:false,html:`<div class="sm-dialog-panel-text" style="padding:12px;">
          <input type="checkbox" name="multi-ckl" id="multi-ckl" style="vertical-align: -2px;"/>
          <label for="multi-ckl">Export multi-STIG CKLs (one file per Asset).</label>
          </div>`},"->",a]});i.show(document.body);const d=i.getEl().dom.querySelector("#multi-ckl")}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}}async function exportCklArchive(e,t,i){async function s(e,i){const t=Object.entries(e);let s=0;let r=t.length;for(const[n,{assetName:a,benchmarkIds:o}]of t){let e="";if(o.length!==0){e=`?${o.map(e=>"benchmarkId="+e).join("&")}`}updateProgress(s/r,`Fetching CKL for ${a}`);updateStatusText(`Fetching checklist for ${a}: `,true);await window.oidcProvider.updateToken(10);const l=`${STIGMAN.Env.apiBase}/assets/${n}/checklists${e}`;let t=await fetch(l,{method:"GET",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`})});const d=t.headers.get("content-disposition");const c=d.match(/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/)[1];console.log(c);const f=await t.blob();updateStatusText(`[OK]`);s++;i.file(c,f)}}async function r(e,t){const i=Object.entries(e);let s=0;let r=i.length;for(const[n,{assetName:a,benchmarkIds:o=[]}]of i){if(o.length===0){const l=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${n}/stigs`,method:"GET"});const d=JSON.parse(l.response.responseText);o.push(...d.map(e=>e.benchmarkId))}r+=o.length}for(const[n,{assetName:a,benchmarkIds:o=[]}]of i){for(const c of o){updateProgress(s/r,`Fetching CKL for ${a}/${c}`);updateStatusText(`Fetching checklist for ${a}/${c}: `,true);await window.oidcProvider.updateToken(10);const f=`${STIGMAN.Env.apiBase}/assets/${n}/checklists/${c}/latest?format=ckl`;let e=await fetch(f,{method:"GET",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`})});const u=e.headers.get("content-disposition");if(u){const h=u.match(/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/)[1];console.log(h);const p=await e.blob();updateStatusText(`[OK]`);s++;t.file(h,p)}else{updateStatusText(`Error: missing 'Content-Disposition'`)}}}}try{const n=new JSZip;initProgress("Exporting checklists","Initializing...");const a=i?s:r;await a(t,n);updateProgress(1,"Generating Zip archive...");updateStatusText("Generating Zip archive...");const o=await n.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},e=>{updateProgress(e.percent/100,`Compressing ${e.currentFile}`)});updateProgress(1,"Done");updateStatusText("Done");saveAs(o,`${e}.zip`)}catch(e){alert(`${e.message}\n${e.stack}`)}}const reviewsFromCkl=function e(t,a={},o){function i(e){var t=document.createElement("textarea");t.innerHTML=e;return t.value}a.ignoreNr=!!a.ignoreNr;const s={attributeNamePrefix:"",ignoreAttributes:false,ignoreNameSpace:true,allowBooleanAttributes:false,parseNodeValue:false,parseAttributeValue:false,trimValues:true,cdataTagName:"__cdata",cdataPositionChar:"\\c",localeRange:"",parseTrueNumberOnly:false,arrayMode:true,tagValueProcessor:e=>i(e)};let r=parser.parse(t,s);if(!r.CHECKLIST)throw new Error("No CHECKLIST element");if(!r.CHECKLIST[0].ASSET)throw new Error("No ASSET element");if(!r.CHECKLIST[0].STIGS)throw new Error("No STIGS element");let n={};n.target=l(r.CHECKLIST[0].ASSET[0]);if(!n.target.name){throw new Error("No host_name in ASSET")}n.checklists=d(r.CHECKLIST[0].STIGS[0].iSTIG);if(n.checklists.length===0){throw new Error("STIG_INFO element has no SI_DATA for SID_NAME == stigId")}return n;function l(e){let t={name:e.HOST_NAME,description:null,ip:e.HOST_IP||null,fqdn:e.HOST_FQDN||null,mac:e.HOST_MAC||null,noncomputing:e.ASSET_TYPE==="Non-Computing"};const i={};if(e.ROLE){i.cklRole=e.ROLE}if(e.TECH_AREA){i.cklTechArea=e.TECH_AREA}if(e.WEB_OR_DATABASE==="true"){i.cklWebOrDatabase="true";i.cklHostName=e.HOST_NAME;if(e.WEB_DB_SITE){i.cklWebDbSite=e.WEB_DB_SITE}if(e.WEB_DB_INSTANCE){i.cklWebDbInstance=e.WEB_DB_INSTANCE}}t.metadata=i;return t}function d(e){let o=[];e.forEach(t=>{let i={};let e=t.STIG_INFO[0].SI_DATA.filter(e=>e.SID_NAME==="stigid")[0];i.benchmarkId=e.SID_DATA.replace("xccdf_mil.disa.stig_benchmark_","");const s=t.STIG_INFO[0].SI_DATA.filter(e=>e.SID_NAME==="version")[0].SID_DATA;let r=t.STIG_INFO[0].SI_DATA.filter(e=>e.SID_NAME==="releaseinfo")[0].SID_DATA;const n=r.match(/Release:\s*(.+?)\s/)[1];const a=`V${s}R${n}`;i.revisionStr=a;if(i.benchmarkId){let e=c(t.VULN);i.reviews=e.reviews;i.stats=e.stats;o.push(i)}});return o}function c(e){const t={NotAFinding:"pass",Open:"fail",Not_Applicable:"notapplicable",Not_Reviewed:"notchecked"};const r={pass:0,fail:0,notapplicable:0,notchecked:0,notselected:0,informational:0,error:0,fixed:0,unknown:0};let n=[];e?.forEach(i=>{let s=t[i.STATUS];if(s){if(s==="notchecked"&&(i.FINDING_DETAILS||i.COMMENTS))s="informational";r[s]++;if(s==="notchecked"&&a.ignoreNr)return;let t;i.STIG_DATA.some(e=>{if(e.VULN_ATTRIBUTE=="Rule_ID"){t=e.ATTRIBUTE_DATA;return true}});if(!t)return;let e=f(s,i.FINDING_DETAILS,i.COMMENTS,o);n.push({ruleId:t,result:s,detail:a.replaceText?i.FINDING_DETAILS:i.FINDING_DETAILS||null,comment:a.replaceText?i.COMMENTS:i.COMMENTS||null,autoResult:false})}});return{reviews:n,stats:r}}function f(e,t,i,s){let r=false;switch(s.detailRequired){case"optional":r=true;break;case"findings":if(e!=="fail"||e==="fail"&&t){r=true}break;case"always":if(t){r=true}break}let n=false;switch(s.commentRequired){case"optional":n=true;break;case"findings":if(e!=="fail"||e==="fail"&&i){n=true}break;case"always":if(i){n=true}break}return r&&n?"submitted":"saved"}};const reviewsFromScc=function(r,n={}){try{n.ignoreNotChecked=!!n.ignoreNotChecked;const l={attributeNamePrefix:"",ignoreAttributes:false,ignoreNameSpace:true,allowBooleanAttributes:false,parseNodeValue:true,parseAttributeValue:true,trimValues:true,cdataTagName:"__cdata",cdataPositionChar:"\\c",localeRange:"",parseTrueNumberOnly:false,arrayMode:false};let e=parser.parse(r,l);if(!e.Benchmark)throw new Error("No Benchmark element");if(!e.Benchmark.TestResult)throw new Error("No TestResult element");if(!e.Benchmark.TestResult["target-facts"])throw new Error("No target-facts element");if(!e.Benchmark.TestResult["rule-result"])throw new Error("No rule-result element");let t=e.Benchmark.id.replace("xccdf_mil.disa.stig_benchmark_","");if(n.scapBenchmarkMap&&n.scapBenchmarkMap.has(t)){t=n.scapBenchmarkMap.get(t)}let i=o(e.Benchmark.TestResult["target-facts"].fact);if(!i.name){throw new Error("No host_name fact")}let s=a(e.Benchmark.TestResult["rule-result"]);return{target:i,checklists:[{benchmarkId:t,revisionStr:null,reviews:s.reviews,stats:s.stats}]}}finally{}function a(e){const t={pass:0,fail:0,notapplicable:0,notchecked:0,notselected:0,informational:0,error:0,fixed:0,unknown:0};let i=[];e.forEach(e=>{t[e.result]++;if(e.result){if(e.result==="notchecked"&&n.ignoreNotChecked)return;i.push({ruleId:e.idref.replace("xccdf_mil.disa.stig_rule_",""),result:e.result,detail:`SCC Reviewed at ${e.time}`,autoResult:true,status:"saved"})}});return{reviews:i,stats:t}}function o(e){let i={};e.forEach(t=>{if(t["#text"]){let e=t.name.replace("urn:scap:fact:asset:identifier:","");e=e==="ipv4"?"ip":e;i[e]=t["#text"]}});const{ip:t,host_name:s,fqdn:r,mac:n,...a}=i;return{name:s,description:"",ip:t,mac:n,fqdn:r,noncomputing:false,metadata:a}}};function readTextFileAsync(s){return new Promise((e,t)=>{let i=new FileReader;i.onload=()=>{e(i.result)};i.onerror=t;i.readAsText(s)})}Ext.ns("SM.Review.Form");SM.Review.Form.ResultCombo=Ext.extend(Ext.form.ComboBox,{initComponent:function(){const e=this;const t={triggerClass:"sm-review-trigger",disabledClass:"sm-review-item-disabled",width:100,lastSavedData:"",cls:"sm-review-combo-input",changed:false,fieldLabel:'Result<i class= "fa fa-question-circle sm-question-circle"></i>',labelSeparator:"",emptyText:"Your result...",name:"result",hiddenName:"result",mode:"local",triggerAction:"all",editable:false,store:new Ext.data.SimpleStore({fields:["result","resultStr"],data:[["pass","Not a Finding"],["notapplicable","Not Applicable"],["fail","Open"]]}),valueField:"result",displayField:"resultStr",listeners:{render:function(e){new Ext.ToolTip({target:e.label.dom.getElementsByClassName("fa")[0],showDelay:0,dismissDelay:0,autoWidth:true,html:SM.ResultTipText}).getId()}}};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.Review.Form.ResultCombo.superclass.initComponent.call(this)}});SM.Review.Form.DetailTextArea=Ext.extend(Ext.form.TextArea,{initComponent:function(){const t=this;const e={cls:"sm-review-result-textarea",lastSavedData:"",allowBlank:true,fieldLabel:'Detail<i class= "fa fa-question-circle sm-question-circle"></i>',labelSeparator:"",autoScroll:"auto",name:"detail",enableKeyEvents:true,listeners:{render:function(e){e.mon(e.el,"input",t.onInput);t.infoTip=new Ext.ToolTip({target:e.label.dom.getElementsByClassName("fa")[0],showDelay:0,dismissDelay:0,autoWidth:true,tpl:SM.DetailTipTpl,data:t.fieldSettings})}}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Review.Form.DetailTextArea.superclass.initComponent.call(this)}});SM.Review.Form.CommentTextArea=Ext.extend(Ext.form.TextArea,{initComponent:function(){const t=this;const e={cls:"sm-review-action-textarea",lastSavedData:"",allowBlank:true,fieldLabel:'Comment<i class= "fa fa-question-circle sm-question-circle"></i>',labelSeparator:"",autoScroll:"auto",name:"comment",listeners:{render:function(e){e.mon(e.el,"input",t.onInput);t.infoTip=new Ext.ToolTip({target:e.label.dom.getElementsByClassName("fa")[0],showDelay:0,dismissDelay:0,autoWidth:true,tpl:SM.CommentTipTpl,data:t.fieldSettings})}}};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Review.Form.CommentTextArea.superclass.initComponent.call(this)}});SM.Review.Form.AutoSprite=Ext.extend(Ext.form.DisplayField,{autoCreate:{tag:"span",class:"sm-review-auto-sprite"},setRawValue:function(e){let t=e?"Automated":"Manual";this.value=!!e;if(this.rendered){this.el.dom.innerHTML=t}return!!this.value},getRawValue:function(){return!!this.value},initComponent:function(){const e=this;const t={name:"autoResult",hideLabel:true};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.Review.Form.AutoSprite.superclass.initComponent.call(this)}});SM.Review.Form.Button=Ext.extend(Ext.Button,{initComponent:function(){const e=this;const t={text:"Loading...",disabled:true};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.Review.Form.Button.superclass.initComponent.call(this)}});SM.Review.Form.Panel=Ext.extend(Ext.form.FormPanel,{initComponent:function(){const d=this;const c=new SM.Review.Form.AutoSprite({style:{marginLeft:"10px"}});const f=new SM.Review.Form.ResultCombo({listeners:{select:function(){if(c.lastSavedData){if(this.value!==this.lastSavedData){c.setValue(false)}else{c.setValue(true)}}a()}}});const u=new SM.Review.Form.DetailTextArea({anchor:"100%, 50%",fieldSettings:d.fieldSettings,onInput:function(e){d.setReviewFormItemStates()},listeners:{focus:function(e){e.addClass("sm-field-focus")},blur:function(e){e.removeClass("sm-field-focus")}}});const h=new SM.Review.Form.CommentTextArea({anchor:"100%, 50%",fieldSettings:d.fieldSettings,onInput:function(e){d.setReviewFormItemStates()},listeners:{focus:function(e){e.addClass("sm-field-focus")},blur:function(e){e.removeClass("sm-field-focus")}}});const i=new Ext.form.DisplayField({fieldLabel:"Reviewed",hideLabel:true,allowBlank:true,name:"editStr",formatValue:function(e){this.setValue(`<span class="sm-review-sprite sm-review-sprite-reviewed"></span>
        <span class="sm-review-sprite sm-review-sprite-date">${new Date(e.ts).format("Y-m-d H:i T")}</span>
        <span class="sm-review-sprite sm-review-sprite-user">${e.username}</span>`)}});const s=new Ext.form.DisplayField({fieldLabel:"Status",hideLabel:true,allowBlank:true,name:"status",formatValue:function(e){this.setValue(`<span class="sm-review-sprite sm-review-sprite-${e.label}"></span>
        <span class="sm-review-sprite sm-review-sprite-date">${new Date(e.ts).format("Y-m-d H:i T")}</span>
        <span class="sm-review-sprite sm-review-sprite-user">${e.user.username}<span>`)}});const p=new SM.Review.Form.Button({handler:d.btnHandler});const m=new SM.Review.Form.Button({handler:d.btnHandler});let g="";function e(){return f.lastSavedData!=f.value||c.lastSavedData!=c.getValue()||u.lastSavedData!=u.getValue()||h.lastSavedData!=h.getValue()}function t(e){const t=d.getForm();t.setValues.call(t,e);g=e.status?.label??"";if(e.ts&&e.username){i.formatValue(e)}else{i.setValue("--")}if(e.status){s.formatValue(e.status)}else{s.setValue("--")}r()}function r(){if(f.value===null){f.value=""}c.lastSavedData=c.value;f.lastSavedData=f.value;u.lastSavedData=u.value===null?"":u.value;h.lastSavedData=h.value===null?"":h.value}function x(){if(!f.value)return false;if(d.fieldSettings.detailRequired==="always"&&!u.getValue())return false;if(d.fieldSettings.detailRequired==="findings"&&f.value==="fail"&&!u.getValue())return false;if(d.fieldSettings.commentRequired==="always"&&!h.getValue())return false;if(d.fieldSettings.commentRequired==="findings"&&f.value==="fail"&&!h.getValue())return false;return true}function n(){const e=[u,h];for(const t of e){t.fieldSettings=d.fieldSettings;if(t.infoTip.body){t.infoTip.update(d.fieldSettings)}else{t.infoTip.data=t.fieldSettings}}}function a(){const e=f;const t=u;const i=h;const s=c;const r=p;const n=m;const a=d;const o=d.fieldSettings;const l=g===""||g==="saved"||g==="rejected";e.setDisabled(!l);t.setDisabled(!l);i.setDisabled(!l);p.setDisabled(!l);m.setDisabled(!l);if(l){if(o.detailEnabled==="always"){t.enable()}else if(o.detailEnabled==="findings"){if(e.value==="fail"){t.enable()}else{t.disable()}}if(o.commentEnabled==="always"){i.enable()}else if(o.commentEnabled==="findings"){if(e.value==="fail"){i.enable()}else{i.disable()}}if(e.value===""||e.value===undefined||e.value===null){t.disable();i.disable()}}if(x()){if(a.reviewChanged()){switch(g){case"":case"saved":r.enable();r.setText("Save without submitting");r.setIconClass("sm-disk-icon");r.actionType="save";r.setTooltip("");n.enable();n.setText("Save and Submit");n.setIconClass("sm-ready-icon");n.actionType="save and submit";n.setTooltip("");break;case"submitted":break;case"rejected":r.enable();r.setText("Save without submitting");r.setIconClass("sm-disk-icon");r.actionType="save";r.setTooltip("");n.enable();n.setText("Save and Resubmit");n.setIconClass("sm-ready-icon");n.actionType="save and submit";n.setTooltip("");break;case"accepted":break}}else{switch(g){case"":case"saved":r.disable();r.setText("Save without submitting");r.setIconClass("sm-disk-icon");r.actionType="";r.setTooltip("This button is disabled because the review has not been modified.");n.enable();n.setText("Submit");n.setIconClass("sm-ready-icon");n.actionType="submit";n.setTooltip("");break;case"accepted":case"submitted":r.enable();r.setText("Unsubmit");r.setIconClass("sm-disk-icon");r.actionType="unsubmit";r.setTooltip("");n.disable();n.setText("Submit");n.setIconClass("sm-ready-icon");n.actionType="";n.setTooltip("This button is disabled because the review has already been submitted.");break;case"rejected":r.disable();r.setText("Save without submitting");r.setIconClass("sm-disk-icon");r.actionType="";r.setTooltip("This button is disabled because the review has not been modified.");n.disable();n.setText("Save and Resubmit");n.setIconClass("sm-ready-icon");n.actionType="";n.setTooltip("This button is disabled because the review has not been modified.");break}}}else{if(a.reviewChanged()){r.enable();r.setText("Save without submitting");r.setIconClass("sm-disk-icon");r.actionType="save and unsubmit";r.setTooltip("");n.disable();n.setText("Save and Submit");n.setIconClass("sm-ready-icon");n.actionType="";n.setTooltip("This button is disabled because the review is not complete and cannot be submitted.")}else{if(g==="submitted"){r.enable();r.setText("Unsubmit");r.setIconClass("sm-disk-icon");r.actionType="unsubmit";r.setTooltip("")}else{r.disable();r.setText("Save without submitting");r.setIconClass("sm-disk-icon");r.actionType="";r.setTooltip("This button is disabled because the review has not been modified.")}n.disable();n.setText("Save and Submit");n.setIconClass("sm-ready-icon");n.actionType="";n.setTooltip("This button is disabled because the review is not complete and cannot be submitted.")}}}let o={cls:"sm-round-panel",bodyCssClass:"sm-review-form",footerCssClass:"sm-review-footer",labelWidth:65,border:false,isLoaded:false,groupGridRecord:{},monitorValid:false,trackResetOnLoad:false,reviewChanged:e,loadValues:t,initLastSavedData:r,isReviewSubmittable:x,setReviewFormItemStates:a,setReviewFormTips:n,fieldSettings:this.fieldSettings||{detailEnabled:"always",detailRequired:"always",commentEnabled:"findings",commentRequired:"findings"},items:[{xtype:"fieldset",layout:"form",layoutConfig:{getLayoutTargetSize:function(){var e=this.container.getLayoutTarget(),t={};if(e){t=e.getViewSize();if(Ext.isIE9m&&Ext.isStrict&&t.width==0){t=e.getStyleSize()}t.width-=e.getPadding("lr");t.height-=e.getPadding("tb");t.height-=34}return t}},anchor:"100%, -90",title:"Evaluation",items:[{layout:"column",baseCls:"x-plain",items:[{width:170,layout:"form",baseCls:"x-plain",items:[f]},c]},u,h]},{xtype:"fieldset",title:"Attributions",items:[i,s]}],buttons:[p,m],listeners:{render:function(e){e.getForm().waitMsgTarget=e.getEl();const t=e.body.dom;const n=new Ext.dd.DropTarget(t,{ddGroup:"gridDDGroup",notifyEnter:function(e,t,i){const s=d.groupGridRecord.data.status=="saved"||d.groupGridRecord.data.status=="rejected"||d.groupGridRecord.data.status==="";const r=i.selections[0].data.autoResult==false||i.selections[0].data.autoResult==true;if(s&&r){}else{return n.dropNotAllowed}},notifyOver:function(e,t,i){const s=d.groupGridRecord.data.status=="saved"||d.groupGridRecord.data.status=="rejected"||d.groupGridRecord.data.status==="";const r=i.selections[0].data.autoResult==false||i.selections[0].data.autoResult==true;if(s&&r){return n.dropAllowed}else{return n.dropNotAllowed}},notifyDrop:function(e,t,i){const s=d.groupGridRecord.data.status=="saved"||d.groupGridRecord.data.status=="rejected"||d.groupGridRecord.data.status==="";const r=i.selections[0].data.autoResult==false||i.selections[0].data.autoResult==true;if(s&&r){const n=i.selections[0];if(!f.disabled&&n.data.autoResult==false){f.setValue(n.data.result)}u.setValue(n.data.detail);if(f.getValue()==="fail"){h.enable()}else{h.disable()}if(!h.disabled){h.setValue(n.data.comment)}d.setReviewFormItemStates()}return true}})}}};Ext.apply(this,Ext.apply(this.initialConfig,o));SM.Review.Form.Panel.superclass.initComponent.call(this)}});Ext.ns("SM.ReviewsImport");SM.ReviewsImport.Grid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const i=this;const e=[{name:"filename",mapping:"checklist.file.name"},{name:"fullPath",mapping:"checklist.file.fullPath"},{name:"date",mapping:"checklist.file.lastModifiedDate"},{name:"file",mapping:"checklist.file"},{name:"assetId",mapping:"taskAsset.assetProps.assetId"},{name:"assetName",mapping:"taskAsset.assetProps.name"},{name:"ip",mapping:"taskAsset.assetProps.ip"},{name:"noncomputing",mapping:"taskAsset.assetProps.noncomputing"},{name:"metadata",mapping:"taskAsset.assetProps.metadata"},{name:"benchmarkId",mapping:"checklist.benchmarkId"},{name:"newAssignment",mapping:"checklist.newAssignment"},{name:"informational",mapping:"checklist.stats.informational"},{name:"notchecked",mapping:"checklist.stats.notchecked"},{name:"pass",mapping:"checklist.stats.pass"},{name:"fail",mapping:"checklist.stats.fail"},{name:"notapplicable",mapping:"checklist.stats.notapplicable"},{name:"reviews",mapping:"checklist.reviews"},"taskAsset","checklist"];const t=new Ext.data.GroupingStore({grid:this,root:"",reader:new Ext.data.JsonReader({fields:e,idProperty:e=>`${e.checklist.file.name}-${e.taskAsset.assetProps.name}-${e.checklist.benchmarkId}`}),sortInfo:{field:"assetName",direction:"ASC"}});const s=new SM.RowCountTextItem({store:t});const r=[{header:"Asset",width:150,dataIndex:"assetName",sortable:true,renderer:(e,t,i)=>{if(i.data.assetId){return e}else{return`(+) ${e}`}}},{header:"IP",hidden:true,width:100,dataIndex:"ip",sortable:true,renderer:SM.styledEmptyRenderer},{xtype:"booleancolumn",trueText:"&#x2714;",falseText:"",header:"Non-computing",width:75,dataIndex:"noncomputing",align:"center",sortable:true,hidden:true},{header:"STIG",width:150,dataIndex:"benchmarkId",sortable:true,renderer:(e,t,i)=>{if(i.data.newAssignment){return`(+) ${e}`}else{return e}}},{header:'<div class="sm-grid-result-sprite sm-result-na">I</div></div>',width:50,align:"center",dataIndex:"informational",sortable:true,renderer:e=>i.importReviews?e:"--"},{header:'<div class="sm-grid-result-sprite sm-result-na">NR</div></div>',width:50,align:"center",dataIndex:"notchecked",sortable:true,renderer:e=>i.importReviews?e:"--"},{header:'<div class="sm-grid-result-sprite sm-result-na">NA</div></div>',width:50,align:"center",dataIndex:"notapplicable",sortable:true,renderer:e=>i.importReviews?e:"--"},{header:'<div class="sm-grid-result-sprite sm-result-pass">NF</div></div>',width:50,align:"center",dataIndex:"pass",sortable:true,renderer:e=>i.importReviews?e:"--"},{header:'<div class="sm-grid-result-sprite sm-result-fail">O</div></div>',width:50,align:"center",dataIndex:"fail",sortable:true,renderer:e=>i.importReviews?e:"--"},{header:"File",width:150,dataIndex:"filename",sortable:true,renderer:(e,t,i)=>{t.attr=`ext:qtip="${i.data.fullPath}"`;return e}},{xtype:"datecolumn",format:"Y-m-d H:i:s",header:"Date",width:100,dataIndex:"date",sortable:true}];const n={isFormField:true,name:"imports",allowBlank:false,layout:"fit",store:t,cm:new Ext.grid.ColumnModel({columns:r}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),view:new Ext.grid.GroupingView({enableGrouping:true,hideGroupedColumn:true,forceFit:true,emptyText:"No records to display",groupTextTpl:'{[SM.he(values.text)]} ({[values.rs.length]} {[values.text.split(":")[0] == "Asset" ? "checklist" : "asset"]}{[values.rs.length > 1 ? "s assigned" : " assigned"]})'}),bbar:new Ext.Toolbar({items:[{xtype:"tbfill"},{xtype:"tbseparator"},s]}),listeners:{},getValue:function(){return true},setValue:function(e){t.loadData(e)},validator:function(e){let t=1},markInvalid:function(){let e=1},clearInvalid:function(){let e=1},isValid:function(){return true},getName:()=>this.name,validate:function(){let e=1},createObjects:true,importReviews:true,enableCreateObjects:(e=true)=>{i.createObjects=e;if(e){i.store.clearFilter()}else{const t=e=>e.data.assetId&&!e.data.newAssignment;i.store.filterBy(t)}},enableImportReviews:(e=true)=>{i.importReviews=e;i.getView().refresh()}};Ext.apply(this,Ext.apply(this.initialConfig,n));SM.ReviewsImport.Grid.superclass.initComponent.call(this)}});SM.ReviewsImport.ReviewsFilterCombo=Ext.extend(Ext.form.ComboBox,{initComponent:function(){let e=this;let t={width:140,forceSelection:true,editable:false,mode:"local",triggerAction:"all",displayField:"display",valueField:"filter",store:new Ext.data.SimpleStore({fields:["display","filter"],data:[["All results","all"],["Updated results only","resultchange"]]})};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.ReviewsImport.ReviewsFilterCombo.superclass.initComponent.call(this)}});Ext.reg("sm-reviews-filter-combo",SM.ReviewsImport.ReviewsFilterCombo);SM.ReviewsImport.ReviewsGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const s=this;const e=Ext.data.Record.create(["new",{name:"groupId",type:"string",mapping:"current.groupId",sortType:sortGroupId},{name:"ruleId",type:"string",mapping:"new.ruleId",sortType:sortRuleId},{name:"groupTitle",mapping:"current.groupTitle",type:"string"},{name:"ruleTitle",mapping:"current.ruleTitle",type:"string"},{name:"severity",type:"string",mapping:"current.severity",sortType:sortSeverity},{name:"result",mapping:"new.result",type:"string"},{name:"curResult",mapping:"current.result",type:"string"},{name:"detail",mapping:"new.detail",type:"string"},{name:"comment",mapping:"new.comment",type:"string"},{name:"status",mapping:"new.status",type:"string"}]);const t=new Ext.data.JsonStore({grid:this,root:"",fields:e,idProperty:"ruleId",sortInfo:{field:"ruleId",direction:"ASC"},listeners:{load:function(e,t){r.setText(t.length+" records")},datachanged:function(e,t,i){r.setText(e.getCount()+" records")}}});const r=new SM.RowCountTextItem({store:t});const i=[{header:"<b>Rule</b>",width:150,fixed:true,dataIndex:"ruleId",sortable:true,renderer:e=>`<b>${e}</b>`,align:"left"},{header:"Rule Title",width:220,fixed:true,dataIndex:"ruleTitle",renderer:columnWrap,sortable:false},{header:"Group",width:55,dataIndex:"groupId",fixed:true,sortable:true,align:"left"},{header:"CAT",fixed:true,width:48,align:"center",dataIndex:"severity",sortable:true,renderer:renderSeverity},{header:"Current",align:"center",menuDisabled:true,width:64,fixed:true,dataIndex:"curResult",sortable:true,renderer:renderResult},{header:"New",align:"center",menuDisabled:true,width:64,fixed:true,dataIndex:"result",sortable:true,renderer:renderResult},{header:"Detail",menuDisabled:true,width:220,dataIndex:"detail",renderer:columnWrap,sortable:false}];const n=new Ext.Toolbar({items:[{xtype:"tbtext",text:"Filter:"}," "," "," ",{xtype:"sm-reviews-filter-combo",value:"all",listeners:{select:function(e,t,i){s.filterValue=e.getValue();s.fireEvent("filterchanged",s.filterValue)}}}]});const a=e=>{switch(e){case"resultchange":t.filterBy(e=>e.data.result!==e.data.curResult);break;default:t.clearFilter()}};let o={layout:"fit",isFormField:true,loadMask:true,store:t,columns:i,view:new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true}),tbar:n,bbar:new Ext.Toolbar({items:[{xtype:"tbfill"},{xtype:"tbseparator"},r]}),listeners:{filterchanged:a}};Ext.apply(this,Ext.apply(this.initialConfig,o));SM.ReviewsImport.ReviewsGrid.superclass.initComponent.call(this)}});SM.ReviewsImport.ParseErrorsGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const e=this;const t=[{name:"file"},{name:"filename",mapping:"file.name"},{name:"error"}];const s=new Ext.Toolbar.TextItem({text:"0 records",width:80});const i=new Ext.data.GroupingStore({grid:this,root:"",reader:new Ext.data.JsonReader({fields:t,idProperty:"filename"}),sortInfo:{field:"filename",direction:"ASC"},listeners:{load:function(e,t){s.setText(t.length+" records")},remove:function(e,t,i){s.setText(e.getCount()+" records")}}});const r=[{header:"File",width:100,dataIndex:"filename",sortable:true},{header:"Error",width:150,dataIndex:"error",sortable:true}];const n={isFormField:true,name:"imports",allowBlank:false,layout:"fit",store:i,cm:new Ext.grid.ColumnModel({columns:r}),sm:new Ext.grid.RowSelectionModel({singleSelect:true}),view:new SM.ColumnFilters.GridView({forceFit:true,emptyText:"No records to display"}),bbar:new Ext.Toolbar({items:[{xtype:"tbfill"},{xtype:"tbseparator"},s]}),listeners:{},getValue:function(){return true},setValue:function(e){i.loadData(e)},validator:function(e){let t=1},markInvalid:function(){let e=1},clearInvalid:function(){let e=1},isValid:function(){return true},getName:()=>this.name,validate:function(){let e=1}};Ext.apply(this,Ext.apply(this.initialConfig,n));SM.ReviewsImport.ParseErrorsGrid.superclass.initComponent.call(this)}});SM.ReviewsImport.WarningPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;let t={border:false,layout:"vbox",layoutConfig:{pack:"start",padding:"0 20 20 20"},items:[{html:`<div class="sm-dialog-panel-title">${e.contentTitle}</div>`,border:false},{html:`<div class="sm-dialog-panel-content">${e.contentText}</div>`,width:500,border:false}],buttons:[{xtype:"button",text:"Continue",handler:e.continueHandler}],buttonAlign:"right"};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.ReviewsImport.WarningPanel.superclass.initComponent.call(this)}});SM.ReviewsImport.SelectFilesPanel=Ext.extend(Ext.Panel,{initComponent:function(){const i=this;function s(e){e.stopPropagation();e.preventDefault();e.dataTransfer.dropEffect="copy";this.style.border="2px dashed red"}function r(e){e.stopPropagation();e.preventDefault();e.dataTransfer.dropEffect="copy";this.style.border=""}const n=new Ext.form.Checkbox({boxLabel:`Remove existing text when &lt;FINDING_DETAILS&gt; or &lt;COMMENTS&gt; is empty<i class= "fa fa-question-circle sm-question-circle"></i>`,hideLabel:true,listeners:{render:function(e){i.sonarCloudInsists=new Ext.ToolTip({target:e.wrap.dom.getElementsByClassName("fa")[0],showDelay:0,dismissDelay:0,width:300,html:SM.TipContent.CklParseOptions.Text})}}});const a=new Ext.form.Checkbox({boxLabel:`Do not import if STIG Revision does not match<i class= "fa fa-question-circle sm-question-circle"></i>`,hideLabel:true,listeners:{render:function(e){i.sonarCloudInsists=new Ext.ToolTip({target:e.wrap.dom.getElementsByClassName("fa")[0],showDelay:0,dismissDelay:0,width:300,html:SM.TipContent.CklParseOptions.Revision})}}});const e=new Ext.form.FieldSet({title:"CKL parse options",items:[n,a]});const t={layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},items:[{html:`<div class="sm-dialog-panel-title">Select or drop file${i.initialConfig.multifile?"s":""}</div>`,width:500,border:false},{xtype:"displayfield",html:"<p>&nbsp;</p>"},{html:`<div id="droptarget">Drop ${i.initialConfig.multifile?"one or more CKL/XCCDF result files":"a CKL or XCCDF result file"} here</div>`,baseCls:"sm-drop",flex:1,listeners:{render:e=>{const t=e.getEl().dom;t.addEventListener("dragenter",s,false);t.addEventListener("dragover",s,false);t.addEventListener("dragleave",r,false);t.addEventListener("drop",function(e){i.onFileDropped(e,this,{replaceText:n.value,strictRevisionCheck:a.value})},false)}}},{xtype:"displayfield",html:"<p>&nbsp;</p>"},e,{xtype:"displayfield",html:"<p>&nbsp;</p>"},{xtype:"fileuploadfield",buttonOnly:true,na_this:"importFile",accept:".xml,.ckl",webkitdirectory:false,multiple:i.initialConfig.multifile,style:"width: 95px;",buttonText:`Select file${i.initialConfig.multifile?"s":""}...`,buttonCfg:{icon:"img/disc_drive.png"},listeners:{fileselected:e=>{i.onFileSelected(e,{replaceText:n.checked,strictRevisionCheck:a.checked})}}}],listeners:{}};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.ReviewsImport.SelectFilesPanel.superclass.initComponent.call(this)}});SM.ReviewsImport.ParseErrorsPanel=Ext.extend(Ext.Panel,{initComponent:function(){let e=this;e.errorsGrid=new SM.ReviewsImport.ParseErrorsGrid({flex:1});e.duplicatesGrid=new SM.ReviewsImport.Grid({flex:1,newIndicator:false});let t=[];if(e.errors){t.push({html:'<div class="sm-dialog-panel-title">Errors and warnings</div>',width:500,border:false},e.errorsGrid);e.errorsGrid.store.loadData(e.errors)}if(e.duplicates){t.push({html:'<div class="sm-dialog-panel-title">Duplicates excluded</div>',width:500,border:false},e.duplicatesGrid);e.duplicatesGrid.store.loadData(e.duplicates)}let i={border:false,layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},items:t,buttons:[{xtype:"button",text:"Continue",handler:e.continueHandler}],buttonAlign:"right"};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.ReviewsImport.ParseErrorsPanel.superclass.initComponent.call(this)}});SM.ReviewsImport.ParseErrorPanel=Ext.extend(Ext.Panel,{initComponent:function(){let e=this;const t=[{html:`<div class="sm-dialog-panel-title">There is a problem with your file</div>`,border:false},{html:e.error,width:500,border:false}];let i={border:false,layout:"vbox",layoutConfig:{pack:"start",padding:"0 20 20 20"},items:t,buttons:[{xtype:"button",text:"Exit",handler:e.exitHandler}],buttonAlign:"right"};Ext.apply(this,Ext.apply(this.initialConfig,i));SM.ReviewsImport.ParseErrorPanel.superclass.initComponent.call(this)}});SM.ReviewsImport.OptionsPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const i=new SM.ReviewsImport.Grid({border:true,flex:1,panel:this});i.store.loadData(e.gridData);const t=new Ext.Panel({region:"south",border:false,height:40,layout:"hbox",layoutConfig:{align:"middle",defaultMargins:"0 5",pack:"start"},items:[{xtype:"checkbox",checked:true,boxLabel:"Create or update Assets and STIG associations",margins:"0 15 -2 0",listeners:{check:function(e,t){i.enableCreateObjects(t)}}},{xtype:"checkbox",checked:true,boxLabel:"Import reviews",margins:"0 0 -2 0",listeners:{check:function(e,t){i.enableImportReviews(t)}}}]});const s={layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},border:false,items:[{html:'<div class="sm-dialog-panel-title">Choose options</div>',width:500,border:false},t,i],buttons:[{xtype:"button",iconCls:"sm-import-icon",text:"Add to Collection...",margins:"0 25",grid:i,handler:async()=>{await e.addHandler(e.taskAssets,i.createObjects,i.importReviews)}}],buttonAlign:"right",grid:i};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.ReviewsImport.OptionsPanel.superclass.initComponent.call(this)}});SM.ReviewsImport.ReviewsPanel=Ext.extend(Ext.form.FormPanel,{initComponent:function(){const t=this;const i=new SM.ReviewsImport.ReviewsGrid({border:true,name:"reviews",flex:1,emptyText:"No reviews found",getValue:function(){},setValue:function(){},markInvalid:function(){},clearInvalid:function(){},validate:()=>true,getName:()=>this.name,isValid:function(){return this.getStore().getCount()>0},panel:this});const e=t.checklistFromApi.map(e=>[e.ruleId,e]);const s=Object.fromEntries(e);const r=[];const n=[];const a=[];for(const d of t.checklistFromFile.reviews){if(s[d.ruleId]){if(d.result==="notchecked"){a.push(d.ruleId)}else{r.push({new:d,current:s[d.ruleId]})}}else{n.push(d.ruleId)}}i.store.loadData(r);const o=[{html:`<div class="sm-dialog-panel-title">Reviews matched against ${t.benchmarkId} ${t.revisionStr}</div>`,border:false},i];if(a.length>0||n.length>0){const c=[{html:'<div class="sm-dialog-panel-title">Not reviewed</div>',border:false},new Ext.form.TextArea({border:true,emptyText:"No unreviewed rules",readOnly:true,value:a.join("\n"),margins:"0 20 0 0",flex:1}),{html:'<div class="sm-dialog-panel-title">Unmatched rules</div>',border:false},new Ext.form.TextArea({border:true,emptyText:"No unmatched rules",readOnly:true,value:n.join("\n"),flex:1})];o.push({flex:.25,layout:"hbox",margins:"20 0 0 0",layoutConfig:{align:"stretch",pack:"start"},border:false,items:c})}const l={monitorValid:true,layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},border:false,items:o,buttons:[{formBind:true,iconCls:"sm-import-icon",text:"Import matched reviews",margins:"0 25",grid:i,handler:async()=>{const e=i.store.getRange().map(e=>e.data.new);await t.importHandler(e)}}],buttonAlign:"right",grid:i};Ext.apply(this,Ext.apply(this.initialConfig,l));SM.ReviewsImport.ReviewsPanel.superclass.initComponent.call(this)}});SM.ReviewsImport.ImportProgressPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t=new Ext.ProgressBar({text:"",border:false});const i=new Ext.form.TextArea({cls:"sm-progress-textarea",readOnly:true,flex:3,margins:{top:10,bottom:0,left:0,right:0}});const s={layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},border:false,items:[{html:'<div class="sm-dialog-panel-title">Importing data</div>',width:500,border:false},t,i],buttons:[{xtype:"button",text:"Done",margins:"0 25",handler:e.doneHandler}],buttonAlign:"right",pb:t,st:i};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.ReviewsImport.ImportProgressPanel.superclass.initComponent.call(this)}});class TaskObject{constructor({apiAssets:e=[],apiStigs:t=[],parsedResults:i=[],collectionId:s,config:r}){this.parsedResults=i;this.collectionId=s;this.config=r??{strictRevisionChecks:false,createObjects:true};this.apiAssets=e;this.mappedAssetNames=new Map;this.mappedCklHostnames=new Map;for(const n of e){n.stigs=n.stigs.map(e=>e.benchmarkId);this.mappedAssetNames.set(n.name.toLowerCase(),n);if(n.metadata?.cklHostName){const a=this.mappedCklHostnames.get(n.metadata.cklHostName.toLowerCase());if(a){a.push(n)}else{this.mappedCklHostnames.set(n.metadata.cklHostName.toLowerCase(),[n])}}}this.mappedStigs=new Map;for(const o of t){this.mappedStigs.set(o.benchmarkId,o.revisionStrs)}this.errors=[];this.taskAssets=this._createTaskAssets()}_findAssetFromParsedTarget(t){if(!t.metadata.cklHostName){return this.mappedAssetNames.get(t.name.toLowerCase())}const e=this.mappedCklHostnames.get(t.metadata.cklHostName.toLowerCase());if(!e)return null;const i=e.find(e=>e.metadata.cklWebDbInstance===t.metadata.cklWebDbInstance&&e.metadata.cklWebDbSite===t.metadata.cklWebDbSite);if(!i)return null;return i}_createTaskAssets(){const s=new Map;for(const r of this.parsedResults){let e,t=r.target.metadata;if(!t.cklHostName){e=r.target.name.toLowerCase()}else{e=`${t.cklHostName}-${t.cklWebDbSite??"NA"}-${t.cklWebDbInstance??"NA"}`}const n=this._findAssetFromParsedTarget(r.target);if(!n&&!this.config.createObjects){this.errors.push({file:r.file,message:`asset does not exist for target`,target:r.target});continue}let i=s.get(e);if(!i){i={knownAsset:false,assetProps:null,hasNewAssignment:false,newAssignments:[],checklists:new Map,checklistsIgnored:[],reviews:[]};if(!n){if(!t.cklHostName){i.assetProps={...r.target,collectionId:this.collectionId,stigs:[]}}else{i.assetProps={...r.target,name:e,collectionId:this.collectionId,stigs:[]}}}else{i.knownAsset=true;i.assetProps={...n,collectionId:this.collectionId}}s.set(e,i)}const a=({benchmarkId:e,revisionStr:t})=>{const i=this.mappedStigs.get(e);if(i){return t&&this.config.strictRevisionCheck?i.includes(t):true}else{return false}};const o=({benchmarkId:e})=>{return i.assetProps.stigs.includes(e)};const l=e=>{if(!o(e)){i.hasNewAssignment=true;i.newAssignments.push(e);i.assetProps.stigs.push(e)}};const d=e=>i.newAssignments.includes(e);const c=(e,t)=>{let i=e.checklists.get(t.benchmarkId);if(i){i.push(t)}else{e.checklists.set(t.benchmarkId,[t])}};for(const f of r.checklists){f.file=r.file;if(a(f)){if(o(f)){f.newAssignment=d(f.benchmarkId);c(i,f)}else if(this.config.createObjects){l(f.benchmarkId);f.newAssignment=true;c(i,f)}else{f.ignored=`Not mapped to Asset`;i.checklistsIgnored.push(f)}}else{f.ignored=`Not installed`;i.checklistsIgnored.push(f)}}}return s}}async function showImportResultFiles(v,y){try{const w={ignoreNr:true};const d={ignoreNotChecked:true};const f=new SM.ReviewsImport.SelectFilesPanel({border:false,autoScroll:true,multifile:true,onFileSelected:s,onFileDropped:i});const u=Ext.getBody().getViewSize();let e=u.height*.75;let t=u.width*.75<=1024?u.width*.75:1024;const m=new Ext.Window({title:"Import results from CKL or XCCDF files",cls:"sm-dialog-window sm-round-panel",modal:true,resizable:false,width:t,height:e,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:f});m.show(document.body);async function i(i,s,r){try{i.currentTarget.innerText=`Searching for result files...`;i.stopPropagation();i.preventDefault();s.style.border="";let e=[];let t=[];if(!i.dataTransfer){throw"Event is missing the dataTransfer property"}e=await n(i.dataTransfer.items,i.currentTarget);for(const d of e){t.push(await l(d))}t.sort((e,t)=>e.lastModified-t.lastModified);Object.assign(w,r);c(t)}catch(i){alert(i)}async function n(n,a){try{let t=0,i=0;let s=[];let r=[];for(let e=0;e<n.length;e++){r.push(n[e].webkitGetAsEntry())}while(r.length>0){let e=r.shift();t++;if(e.isFile&&e.name.toLowerCase().endsWith(".ckl")){s.push(e);i++;a.innerText=`Searching... Searched ${t} files, found ${i} results files`}else if(e.isDirectory){r.push(...await o(e.createReader()))}}a.innerText=`Finished. Searched ${t} files, found ${i} results files`;return s}catch(e){alert(e)}}async function o(i){try{let e=[];let t=await a(i);while(t?.length>0){e.push(...t);t=await a(i)}return e}catch(e){alert(e)}}async function a(i){try{return await new Promise((e,t)=>{i.readEntries(e,t)})}catch(e){alert(e)}}async function l(s){try{return await new Promise((t,e)=>{let i=s.fullPath;s.file(e=>{e.fullPath=i;t(e)},e)})}catch(e){alert(e)}}}async function s(e,t){let i=e.fileInput.dom;const s=[...i.files];s.sort((e,t)=>e.lastModified-t.lastModified);Object.assign(w,t);c(s)}function c(t){if(t.length>=250){let e=new SM.ReviewsImport.WarningPanel({continueHandler:i,contentTitle:`<b>We notice you have selected ${t.length} files to process.</b>`,contentText:`This browser app is not optimized for parsing a large number of files and performance is highly dependent on your available client resources.<br><br>
                    <b>Recommendations</b><br><br>
                    <ul>
                    <li>Process your files in smaller batches.</li>
                    <li>Consider using STIG Manager Watcher</li>
                    </ul>
                    <div class="sm-dialog-panel-callout">
                    <img src="img/watcher-icon.svg" width=40px height=40px align="left" style="padding-right: 16px;"/>
                    If you have an on-going requirement to process large batches of files you should use STIG Manager Watcher, a CLI client that
                    can monitor your file system, process large numbers of test result files asynchronously, and post the results to your Collection.<br><br>
                    Watcher is suitable for use as a service or daemon, as a scheduled task, in automated testing pipelines, or from the command line. 
                    Available from <a href="https://github.com/NUWCDIVNPT/stigman-watcher">https://github.com/NUWCDIVNPT/stigman-watcher</a> 
                    and as an NPM module.</div>`});m.removeAll();m.setAutoScroll(true);m.add(e);m.doLayout()}else{i()}function i(){r(t)}}async function r(e){try{const t=new Ext.ProgressBar({text:"",border:false});const i=new Ext.Panel({layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},border:false,items:[{html:'<div class="sm-dialog-panel-title">Parsing your files</div>',width:500,margins:"0 0",border:false},t]});const s=new Ext.util.DelayedTask(function(){m.removeAll();m.add(i);m.doLayout()});s.delay(250);const r=await n(e,t);s.cancel();if(r.errors.length>0||r.hasDuplicates){a(r)}else{o(r)}}catch(e){alert(e)}}async function n(r,n){try{let e=Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets`,params:{collectionId:v,projection:"stigs"},method:"GET"});let t=Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs`,method:"GET"});let i=await getScapBenchmarkMap();let s=0;const a={success:[],fail:[]};for(const u of r){n.updateText(u.name);let e=u.name.substring(u.name.lastIndexOf(".")+1);let t=await readTextFileAsync(u);if(e==="ckl"){try{const h=reviewsFromCkl(t,w,y);h.file=u;a.success.push(h)}catch(e){a.fail.push({file:u,error:e.message})}}if(e==="xml"){try{const h=reviewsFromScc(t,{ignoreNotChecked:false,scapBenchmarkMap:i});h.file=u;a.success.push(h)}catch(e){a.fail.push({file:u,error:e.message})}}s++;n.updateProgress(s/r.length)}e=await e;const o=JSON.parse(e.response.responseText);t=await t;const l=JSON.parse(t.response.responseText);const d={createObjects:true,strictRevisionCheck:w.strictRevisionCheck};const c=new TaskObject({apiAssets:o,apiStigs:l,parsedResults:a.success,collectionId:v,config:d});const f={taskAssets:c.taskAssets,rows:[],dupedRows:[],errors:a.fail,hasDuplicates:false};for(const p of c.taskAssets.values()){for(const m of p.checklists.values()){if(m.length>1){f.hasDuplicates=true;const g=m.slice(0,-1);const x=g.map(e=>({taskAsset:p,checklist:e}));f.dupedRows.push(...x)}f.rows.push({taskAsset:p,checklist:m.slice(-1)[0]})}for(const b of p.checklistsIgnored){f.errors.push({file:b.file,error:`Ignoring ${b.benchmarkId} ${b.revisionStr}. ${b.ignored}`})}}return f}catch(e){throw e}}function a(e){let t=new SM.ReviewsImport.ParseErrorsPanel({errors:e.errors.length>0?e.errors:null,duplicates:e.hasDuplicates?e.dupedRows:null,continueHandler:i,backHandler:s});m.removeAll();m.setAutoScroll(true);m.add(t);m.doLayout();function i(){o(e)}function s(){}}function o(e){let t=new SM.ReviewsImport.OptionsPanel({gridData:e.rows,taskAssets:e.taskAssets,addHandler:l});m.removeAll();m.add(t);m.doLayout()}async function l(s,r,n){let a="";let o;try{o=new SM.ReviewsImport.ImportProgressPanel({doneHandler:()=>{m.close()}});m.removeAll();m.add(o);m.doLayout();let e=0;for(const u of s.values()){try{let t=u.assetProps.assetId;let i=false;l(e/s.size,u.assetProps.name);if(r&&(!u.knownAsset||u.hasNewAssignment)){t=await c(u);d(` OK (${u.assetProps.name}, id: ${t})`);i=true}if(n){let e=[];for(const h of u.checklists.keys()){e=e.concat(u.checklists.get(h).slice(-1)[0].reviews)}await f(v,t,e);d(" OK");i=true}if(i){const p=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${t}`,method:"GET",params:{projection:["stigs","statusStats"]},headers:{"Content-Type":"application/json;charset=utf-8"}});apiAsset=JSON.parse(p.response.responseText);SM.Dispatcher.fireEvent("assetchanged",apiAsset)}else{d(` Nothing to do for ${u.assetProps.name}`)}}catch(e){d(` ERROR (${e.message})`)}finally{e++;l(e/s.size,u.assetProps.name)}}l(0,"Finished")}catch(e){alert(e.message)}function l(e,t){o.pb.updateProgress(e,SM.he(t))}function d(e,t,i){var t=t||false;if(t){a+=e}else{a+=e+"\n"}o.st.setRawValue(a);o.st.getEl().dom.scrollTop=99999}async function c(n){try{let e,t,i;if(n.knownAsset&&n.hasNewAssignment){e=`${STIGMAN.Env.apiBase}/assets/${n.assetProps.assetId}`;t="PATCH";i={collectionId:n.assetProps.collectionId,stigs:n.assetProps.stigs}}else{e=`${STIGMAN.Env.apiBase}/assets`;t="POST";i=n.assetProps}d(`${t} ${n.assetProps.name}`,true);let s=await Ext.Ajax.requestPromise({url:e,method:t,params:{projection:["stigs","statusStats"]},headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:i});const a=JSON.parse(s.response.responseText);let r=t==="POST"?"assetcreated":"assetchanged";SM.Dispatcher.fireEvent(r,a);return a.assetId}finally{}}async function f(i,s,r){try{let e=`${STIGMAN.Env.apiBase}/collections/${i}/reviews/${s}`;d(`POST reviews for assetId ${s}`,true);let t=await Ext.Ajax.requestPromise({url:e,method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:r});const n=JSON.parse(t.response.responseText);return n}finally{}}}}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}}async function showImportResultFile(f){const u={ignoreNr:true};try{const r=new SM.ReviewsImport.SelectFilesPanel({border:false,autoScroll:true,multifile:false,onFileSelected:s,onFileDropped:i});const a=Ext.getBody().getViewSize();let e=a.height*.75;let t=a.width*.75<=1024?a.width*.75:1024;fpwindow=new Ext.Window({title:`Import results (${SM.he(f.benchmarkId)} on ${SM.he(f.assetName)})`,modal:true,resizable:false,width:t,height:e,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:r});fpwindow.show()}catch(e){if(typeof e==="object"){if(e instanceof Error){e=JSON.stringify(e,Object.getOwnPropertyNames(e),2)}else{e=JSON.stringify(e)}}alert(e);Ext.getBody().unmask()}async function i(t,e,i){t.stopPropagation();t.preventDefault();e.style.border="";let s=[];let r=[];for(let e=0;e<t.dataTransfer.items.length;e++){s.push(t.dataTransfer.items[e].webkitGetAsEntry())}for(const a of s){const o=await n(a);r.push(...o)}Object.assign(u,i);l(r[0]);function n(a){return new Promise((i,e)=>{let s=0;const r=[];n(a);function n(e){if(e.isFile){s++;let t=e.fullPath;e.file(e=>{s--;e.fullPath=t;r.push(e);if(s===0){i(r)}})}else if(e.isDirectory){t(e.createReader())}}function t(e){s++;e.readEntries(function(t){s--;for(const e of t){n(e)}if(s===0){i(r)}})}})}}async function s(e,t){let i=e.fileInput.dom;const s=[...i.files];Object.assign(u,t);await l(s[0],u)}async function l(t){let i;try{const s=new Ext.ProgressBar({text:t.name,border:false});const r=new Ext.Panel({layout:"vbox",layoutConfig:{align:"stretch",pack:"start",padding:"0 20 20 20"},border:false,items:[{html:'<div class="sm-dialog-panel-title">Parsing your file</div>',width:500,margins:"0 0",border:false},s]});i=new Ext.util.DelayedTask(function(){fpwindow.removeAll();fpwindow.add(r);fpwindow.doLayout()});i.delay(250);const[n,a]=await Promise.all([Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${f.assetId}`,method:"GET"}),h(t,s)]);const o=JSON.parse(n.response.responseText);let e=false;if(a.target.metadata.cklHostName||o.metadata.cklHostName){e=o.metadata.cklHostName===a.target.metadata.cklHostName&&o.metadata.cklWebDbSite===a.target.metadata.cklWebDbSite&&o.metadata.cklWebDbInstance===a.target.metadata.cklWebDbInstance}else{e=a.target.name===o.name}if(!e){let e;if(a.target.metadata.cklHostName||o.metadata.cklHostName){e=`CKL elements and values:<br><br>
                    &lt;WEB_DB_SITE&gt; = ${a.target.metadata.cklWebDbSite??'<span style="color:grey;font-style:italic">No value</span>'}<br>
                    &lt;WEB_DB_INSTANCE&gt = ${a.target.metadata.cklWebDbInstance??'<span style="color:grey;font-style:italic">No value</span>'}<br><br>
                    Asset metadata properties and values:<br><br>
                    cklWebDbSite = ${o.metadata.cklWebDbSite??'<span style="color:grey;font-style:italic">No property</span>'}<br>
                    cklWebDbInstance = ${o.metadata.cklWebDbInstance??'<span style="color:grey;font-style:italic">No property</span>'}<br><br>
                    The corresponding values do not match.
                    </div>`}else{e=`The CKL file contains reviews for ${a.target.name}`}throw new Error(`<b>The file does not include reviews for this asset.</b><br><div class="sm-dialog-panel-callout">${e}</div>`)}const l=a.checklists.filter(e=>e.benchmarkId===f.benchmarkId)[0];if(!l){throw new Error(`The file does not include reviews for STIG: <b>${f.benchmarkId}</b><br>The file includes reviews for: ${a.checklists[0].benchmarkId}</p>`)}if(u.strictRevisionCheck&&l.revisionStr&&l.revisionStr!==f.revisionStr){throw new Error(`The file does not include reviews for STIG: <b>${f.benchmarkId}, revision ${f.revisionStr}</b><br>The file includes reviews for revision: ${l.revisionStr}</p>`)}const d=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/assets/${f.assetId}/checklists/${f.benchmarkId}/${f.revisionStr}`,method:"GET"});const c=JSON.parse(d.response.responseText);i.cancel();m(l,c,f.benchmarkId,f.revisionStr)}catch(e){i.cancel();p(e)}}async function h(e,t){let i=e.name.substring(e.name.lastIndexOf(".")+1);let s=await readTextFileAsync(e);let r;if(i==="ckl"){r=reviewsFromCkl(s,u,f.fieldSettings)}else if(i==="xml"){r=reviewsFromScc(s,{ignoreNotChecked:false})}else{throw new Error("Unknown file extension")}r.file=e;return r}function p(e){let t=new SM.ReviewsImport.ParseErrorPanel({error:e.message,exitHandler:i});fpwindow.removeAll();fpwindow.setAutoScroll(true);fpwindow.add(t);fpwindow.doLayout();function i(){fpwindow.close()}}function m(e,t,i,s){let r=new SM.ReviewsImport.ReviewsPanel({checklistFromFile:e,checklistFromApi:t,benchmarkId:i,revisionStr:s,importHandler:n});fpwindow.removeAll();fpwindow.add(r);fpwindow.doLayout()}async function n(t){let s="";let r;try{r=new SM.ReviewsImport.ImportProgressPanel({doneHandler:()=>{fpwindow.close()}});fpwindow.removeAll();fpwindow.add(r);fpwindow.doLayout();i("Importing...");let e=await a(t);n(JSON.stringify(e,null,2));n(" OK");i(0,"Finished");f.store.reload()}catch(e){alert(e.message)}function i(e,t){r.pb.updateProgress(e,SM.he(t))}function n(e,t,i){var t=t||false;if(t){s+=e}else{s+=e+"\n"}r.st.setRawValue(s);r.st.getEl().dom.scrollTop=99999}async function a(i){try{let e=`${STIGMAN.Env.apiBase}/collections/${f.collectionId}/reviews/${f.assetId}`;n(`POST reviews for assetId ${f.assetId}`,true);let t=await Ext.Ajax.requestPromise({url:e,method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:i});apiReviews=JSON.parse(t.response.responseText);return apiReviews}catch(e){throw e}}}}async function getScapBenchmarkMap(){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/scap-maps`,method:"GET"});apiScapMaps=JSON.parse(e.response.responseText);return new Map(apiScapMaps.map(e=>[e.scapBenchmarkId,e.benchmarkId]))}"use strict";Ext.ns("SM.TransferAssets");SM.TransferAssets.TransferBtn=Ext.extend(Ext.Button,{initComponent:function(){const t=this;const e={};function i(t){t.removeAll();const e=curUser.collectionGrants.filter(e=>e.collection.collectionId!==t.srcCollectionId&&e.accessLevel>=3);for(const i of e){t.addMenuItem({iconCls:"sm-collection-icon",text:SM.he(i.collection.name),collectionId:i.collection.collectionId})}}t.setSrcAssets=function(e){t.menu.srcAssets=e};t.menu=new Ext.menu.Menu({srcCollectionId:t.srcCollectionId,listeners:{beforeshow:function(e){i(e)},itemClick:t.onItemClick||Ext.emptyFn}});Ext.apply(this,Ext.apply(this.initialConfig,e));SM.TransferAssets.TransferBtn.superclass.initComponent.call(this)}});Ext.reg("sm-transferassets-btn",SM.TransferAssets.TransferBtn);Ext.ns("SM.Library");SM.Library.ChecklistGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const s=this;this.benchmarkId=this.benchmarkId||"RHEL_8_STIG";this.revisionStr=this.revisionStr||"latest";const e=this.stigTitle;const t=[{name:"groupId",type:"string",sortType:sortGroupId},{name:"ruleId",type:"string",sortType:sortRuleId},{name:"groupTitle",type:"string"},{name:"title",type:"string"},{name:"severity",type:"string",sortType:sortSeverity},{name:"check",mapping:"checks[0]?.content"},{name:"fix",mapping:"fixes[0]?.text"},{name:"discussion",mapping:"detail.vulnDiscussion"}];const r=new Ext.ux.ExportButton({hasMenu:false,exportType:"grid",gridBasename:"STIG",iconCls:"sm-export-icon",text:"CSV",gridSource:this});const n=new Ext.data.JsonStore({fields:t,root:"",idProperty:"ruleId",sortInfo:{field:"ruleId",direction:"ASC"},listeners:{load:function(e,t){s.getSelectionModel().selectFirstRow();i.setText(`${e.getCount()} records`)},reload:function(e,t){s.getSelectionModel().selectFirstRow();i.setText(`${e.getCount()} records`)}}});const i=new SM.RowCountTextItem({store:n});const a=Ext.id();const o=[{header:"CAT",fixed:true,width:48,align:"left",dataIndex:"severity",sortable:true,renderer:renderSeverity,filter:{type:"values",comparer:SM.ColumnFilters.CompareFns.severity,renderer:SM.ColumnFilters.Renderers.severity}},{header:"Group",width:75,dataIndex:"groupId",sortable:true,align:"left",filter:{type:"string"}},{header:"Group Title",width:200,dataIndex:"groupTitle",renderer:columnWrap,sortable:true,filter:{type:"string"}},{header:"Rule Id",width:150,dataIndex:"ruleId",sortable:true,align:"left",filter:{type:"string"}},{id:a,header:"Rule Title",width:300,dataIndex:"title",renderer:columnWrap,sortable:true,filter:{type:"string"}},{header:"Check",width:300,dataIndex:"check",renderer:columnWrap,sortable:true,filter:{type:"string"}},{header:"Fix",width:300,dataIndex:"fix",renderer:columnWrap,sortable:true,filter:{type:"string"}},{header:"Discussion",width:300,dataIndex:"discussion",renderer:columnWrap,sortable:true,filter:{type:"string"}}];const l=new SM.ColumnFilters.GridView({emptyText:this.emptyText||"No records to display",deferEmptyText:false,forceFit:true,rowOverCls:"sm-null",selectedRowClass:"sm-null",listeners:{filterschanged:function(e,t,i){n.filter(e.getFilterFns())}}});const d=new Ext.data.JsonStore({fields:["benchmarkId","revisionStr","version","release","benchmarkDate","status","statusDate",{name:"display",convert:(e,t)=>`Version ${t.version} Release ${t.release} (${t.benchmarkDate})`}],url:`${STIGMAN.Env.apiBase}/stigs/${s.benchmarkId}/revisions`});const c=new Ext.form.ComboBox({store:d,displayField:"display",valueField:"revisionStr",triggerAction:"all",mode:"local",editable:false,listeners:{select:function(e,t,i){s.revisionStr=e.getValue();s.loadStig()}}});const f=new Ext.Toolbar({items:["Revision",c]});const u=new Ext.Toolbar({items:[r,"->",i]});async function h(e,t){let i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${e}/revisions/${t}/rules?projection=checks&projection=fixes&projection=detail`,method:"GET",params:{projection:["checks","fixes","detail"]}});return JSON.parse(i.response.responseText)}this.loadStig=async function(e=s.benchmarkId,t=s.revisionStr||"latest"){try{r.gridBasename=e;s.benchmarkId=e;s.getEl().mask("Please wait");const i=await h(e,t);n.loadData(i)}catch(e){console.error(e.message)}finally{s.getEl().unmask()}};this.loadRevisions=async function(e=s.benchmarkId,t=s.revisionStr){try{await d.loadPromise();c.setValue(t)}catch(e){console.error(e.message)}};const p={title:e,store:n,columns:o,view:l,tbar:f,bbar:u,autoExpandColumn:a,stripeRows:true,loadMask:true};Ext.apply(this,Ext.apply(this.initialConfig,p));SM.Library.ChecklistGrid.superclass.initComponent.call(this)}});SM.Library.RuleContentPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e={padding:20,autoScroll:true,title:"Rule",tpl:SM.RuleContentTpl};Ext.apply(this,Ext.apply(this.initialConfig,e));SM.Library.RuleContentPanel.superclass.initComponent.call(this)}});SM.Library.StigPanel=Ext.extend(Ext.Panel,{initComponent:function(){const e=this;const t=new SM.Library.ChecklistGrid({benchmarkId:this.benchmarkId,revisionStr:this.revisionStr||"latest",stigTitle:this.stigTitle,cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.adjacent,bottom:SM.Margin.bottom,left:SM.Margin.edge},border:false,region:"center"});this.load=async function(){await t.loadStig(this.benchmarkId);await t.loadRevisions(this.benchmarkId)};async function i(e,t,i){try{const s=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/rules/${i.data.ruleId}`,method:"GET",params:{projection:["detail","ccis","checks","fixes"]}});let e=JSON.parse(s.response.responseText)}catch(e){console.log(e);alert(e.message)}}t.getSelectionModel().on("rowselect",i);const s={iconCls:"sm-stig-icon",closable:true,layout:"border",layoutConfig:{targetCls:"sm-border-layout-ct"},items:[t]};Ext.apply(this,Ext.apply(this.initialConfig,s));SM.Library.RuleContentPanel.superclass.initComponent.call(this)}});Ext.ns("SM.StigRevision");SM.StigRevision.RevisionMenuBtn=Ext.extend(Ext.Button,{initComponent:function(){const e=this;menu=new SM.StigRevision.RevisionMenu({iconCls:"icon-del"});const t={menu:menu};Ext.apply(this,Ext.apply(this.initialConfig,t));SM.StigRevision.RevisionMenuBtn.superclass.initComponent.call(this)}});SM.StigRevision.RevisionMenu=Ext.extend(Ext.menu.Menu,{load:async function(e){this.removeAll();const t=/^V([\d,\.]{1,5})R([\d,\.]{1,5})$/;for(const i of e.data.revisionStrs){const s=t.exec(i);if(s&&s.length===3){const r=`Version ${SM.he(s[1])} Release ${SM.he(s[2])}${i===e.data.lastRevisionStr?'<span class="sm-navtree-sprite">latest</span>':""}`;this.addItem({iconCls:"icon-del",text:r,revisionStr:i,benchmarkId:e.data.benchmarkId,record:e})}}this.addItem("-");this.addItem({iconCls:"icon-del",text:"Remove all revisions",benchmarkId:e.data.benchmarkId,record:e})}});SM.StigRevision.removeStig=async function(e){const t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${e}`,method:"DELETE"});return JSON.parse(t.response.responseText)};SM.StigRevision.removeStigRevision=async function(e,t){const i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${e}/revisions/${t}`,method:"DELETE"});return JSON.parse(i.response.responseText)};SM.StigRevision.getStig=async function(e){const t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${e}`,method:"GET"});return JSON.parse(t.response.responseText)};SM.StigRevision.StigGrid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){const a=this;const e=Ext.data.Record.create(["benchmarkId","title","status","lastRevisionStr","lastRevisionDate","ruleCount","autoCount","revisionStrs"]);const t=new Ext.grid.CheckboxSelectionModel({singleSelect:false,checkOnly:false,listeners:{selectionchange:function(e){const t=e.getCount();if(t===1){const s=e.getSelected();if(s.data.revisionStrs.length>=2){c.load(s);f.setVisible(true);d.setVisible(false)}else{f.setVisible(false);d.setVisible(true);d.setDisabled(false);d.setText(`Remove STIG`)}l.setDisabled(false)}else{l.setDisabled(true);f.setVisible(false);if(t>0){d.setText(`Remove STIG (${t})`);d.setDisabled(false)}else{d.setText(`Remove`);d.setDisabled(true)}d.setVisible(true)}const i=this.grid.view.innerHd.querySelector(".x-grid3-hd-row .x-grid3-td-checker .x-grid3-hd-checker");if(i){const r=this.selections.length===0?null:this.grid.store.getCount()===this.selections.length?"on":"ind";i.classList.remove("x-grid3-hd-checker-on");i.classList.remove("x-grid3-hd-checker-ind");if(r){i.classList.add(`x-grid3-hd-checker-${r}`)}}}}});const i=[t,{header:"Benchmark ID",width:300,dataIndex:"benchmarkId",sortable:true,filter:{type:"string"}},{header:"Title",id:"stigGrid-title-column",width:350,dataIndex:"title",sortable:true,filter:{type:"string"}},{header:"Status",width:150,align:"center",dataIndex:"status",sortable:true,filter:{type:"values"}},{header:"Latest revision",width:150,align:"center",dataIndex:"lastRevisionStr",sortable:true},{header:"Revision date",width:150,align:"center",dataIndex:"lastRevisionDate",xtype:"datecolumn",format:"Y-m-d",sortable:true},{header:"Earlier revisions",width:150,align:"center",dataIndex:"revisionStrs",sortable:true,renderer:(e,t,i)=>e.filter(e=>e!==i.data.lastRevisionStr).join(", ")||"--"},{header:"Rules",width:150,align:"center",dataIndex:"ruleCount",sortable:true},{header:"SCAP Rules",width:150,align:"center",dataIndex:"autoCount",sortable:true,renderer:e=>e?e:"--"}];const s=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/stigs`,method:"GET"}),root:"",fields:e,idProperty:"benchmarkId",sortInfo:{field:"benchmarkId",direction:"ASC"},listeners:{}});const r=new SM.RowCountTextItem({store:s});const n=new SM.ColumnFilters.GridView({forceFit:true,listeners:{beforerefresh:function(e){e.scrollTop=e.scroller.dom.scrollTop;e.scrollHeight=e.scroller.dom.scrollHeight},refresh:function(e){setTimeout(function(){e.scroller.dom.scrollTop=e.scrollTop+(e.scrollTop==0?0:e.scroller.dom.scrollHeight-e.scrollHeight)},100)},filterschanged:function(e){s.filter(e.getFilterFns())}},deferEmptyText:false});const o=new Ext.Button({iconCls:"sm-import-icon",text:"Import STIGs",disabled:false,handler:function(){SM.StigRevision.ImportStigs(a)}});const l=new Ext.Button({iconCls:"sm-library-icon",text:"Open in Library",disabled:true,handler:function(){const e=a.getSelectionModel().getSelected();addLibraryStig({benchmarkId:e.data.benchmarkId,revisionStr:e.data.lastRevisionStr,stigTitle:e.data.title})}});const d=new Ext.Button({iconCls:"icon-del",text:"Remove",disabled:true,handler:async function(){try{const t=a.getSelectionModel().getSelections();const i=t.map(e=>SM.he(e.data.benchmarkId));let e;if(i.length>25){e=`The ${i.length} selected STIGs`}else{e=i.join("<br>")}const s=Ext.MessageBox.minWidth;Ext.MessageBox.minWidth=400;Ext.MessageBox.buttonText.yes="Remove";Ext.MessageBox.buttonText.no="Cancel";const r=await SM.confirmPromise("Confirm",`Do you wish to remove:<br/><br/>${e}<br/>`);if(r==="yes"){Ext.getBody().mask("Removing");for(const n of t){await SM.StigRevision.removeStig(n.data.benchmarkId);a.store.remove(n)}}}catch(e){alert("Error removing STIGs")}finally{Ext.getBody().unmask()}}});const c=new SM.StigRevision.RevisionMenu({listeners:{itemclick:async function(t,e){try{Ext.MessageBox.minWidth=400;Ext.MessageBox.buttonText.yes="Remove";Ext.MessageBox.buttonText.no="Cancel";const i=await SM.confirmPromise("Confirm",`Do you wish to remove:<br><br>${t.benchmarkId} ${t.revisionStr?t.revisionStr:""}<br/>`);if(i==="yes"){Ext.getBody().mask("Removing");const s=t.record;if(!t.revisionStr){await SM.StigRevision.removeStig(t.benchmarkId);a.store.remove(s)}else{await SM.StigRevision.removeStigRevision(t.benchmarkId,t.revisionStr);const r=await SM.StigRevision.getStig(t.benchmarkId);s.data=r;s.commit();const e=a.getSelectionModel();e.onRefresh();e.fireEvent("selectionchange",e)}}}catch(e){alert("Error removing revision(s)")}finally{Ext.getBody().unmask()}}}});const f=new Ext.Button({iconCls:"icon-del",text:"Remove Revision",hidden:true,menu:c});const u=[o,"-",d,f,"-",l];const h=new Ext.Toolbar({items:[{xtype:"exportbutton",hasMenu:false,gridBasename:"Installed-STIGs",exportType:"grid",iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},r]});const p={store:s,columns:i,view:n,tbar:u,bbar:h,sm:t,listeners:{rowdblclick:function(e,t){const i=e.store.getAt(t);addLibraryStig({benchmarkId:i.data.benchmarkId,revisionStr:i.data.lastRevisionStr,stigTitle:i.data.title})}}};Ext.apply(this,Ext.apply(this.initialConfig,p));SM.StigRevision.StigGrid.superclass.initComponent.call(this)}});SM.StigRevision.ImportStigs=function(e){const a=new Ext.FormPanel({padding:10,standardSubmit:false,fileUpload:true,baseCls:"x-plain",monitorValid:true,autoHeight:true,labelWidth:1,hideLabel:true,defaults:{anchor:"100%",allowBlank:false},items:[{xtype:"fieldset",title:"Instructions",autoHeight:true,items:[{xtype:"displayfield",id:"infoText1",name:"infoText",html:"Please browse for STIG"}]},{xtype:"fileuploadfield",id:"form-file",emptyText:"Browse for a file...",name:"importFile",accept:".zip,.xml",buttonText:"Browse...",buttonCfg:{icon:"img/disc_drive.png"}},{xtype:"displayfield",id:"infoText2",name:"infoText",html:"<i><b>IMPORTANT: Results from the imported file will overwrite any existing results!</b></i>"}],buttonAlign:"center",buttons:[{text:"Import",icon:"img/page_white_get.png",tooltip:"Import the archive",formBind:true,handler:async function(){try{let e=document.getElementById("form-file-file");let r=e.files[0];let t=r.name.substring(r.name.lastIndexOf(".")+1);if(t.toLowerCase()==="xml"){let e=a.getForm().getEl().dom;let t=new FormData(e);t.set("replace","true");o.close();initProgress("Importing file","Initializing...");updateStatusText(r.name);await window.oidcProvider.updateToken(10);let i=await fetch(`${STIGMAN.Env.apiBase}/stigs`,{method:"POST",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`}),body:t});let s=await i.json();updateStatusText(JSON.stringify(s,null,2));updateStatusText("------------------------------------");updateStatusText("Done");updateProgress(0,"Done")}else if(t==="zip"){o.close();initProgress("Importing file","Initializing...");await n(e.files[0]);updateStatusText("Done");updateProgress(0,"Done")}else{alert(`No handler for ${t}`)}}catch(e){alert(e)}finally{e?.getStore()?.reload()}async function n(i){try{let a=new JSZip;let e=await a.loadAsync(i);let t=Object.keys(e.files);let o=t.filter(e=>e.toLowerCase().endsWith(".xml"));let r=t.filter(e=>e.toLowerCase().endsWith(".zip"));for(let n=0,e=o.length;n<e;n++){let e=o[n];updateStatusText(e);let t=await a.files[e].async("blob");let i=new FormData;i.append("importFile",t,e);i.append("replace","true");await window.oidcProvider.updateToken(10);let s=await fetch(`${STIGMAN.Env.apiBase}/stigs`,{method:"POST",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`}),body:i});let r=await s.json();updateStatusText(JSON.stringify(r,null,2));updateStatusText("------------------------------------")}for(let i=0,s=r.length;i<s;i++){let e=r[i];updateProgress((i+1)/s,e.slice(e.lastIndexOf("/")+1));updateStatusText(`Extracting member ${e}`);let t=await a.files[e].async("blob");updateStatusText(`Processing member ${e}`);await n(t)}updateProgress(0,"")}catch(e){updateStatusText(`Error processing ZIP: ${e.message}`);updateStatusText("------------------------------------")}}}},{text:"Cancel",handler:function(){o.close()}}]});const o=new Ext.Window({title:"Import STIG ZIP archive or XCCDF file",cls:"sm-dialog-window sm-round-panel",modal:true,width:500,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:a});o.show(document.body)};async function addLibraryStig(e){let{benchmarkId:r,revisionStr:n="latest",stigTitle:a,treePath:o}=e;try{const l=Ext.getCmp("main-tab-panel").getItem(`library-stig-${r}-tab`);if(l){l.show();return}const d=new SM.Library.StigPanel({id:`library-stig-${r}-tab`,benchmarkId:r,revisionStr:n,stigTitle:a,sm_tabMode:"ephemeral",sm_treePath:o});d.updateTitle=function(){this.setTitle(`${this.sm_tabMode==="ephemeral"?"<i>":""}${this.benchmarkId}${this.sm_tabMode==="ephemeral"?"</i>":""}`)};d.makePermanent=function(){this.sm_tabMode="permanent";this.updateTitle.call(this)};let t=Ext.getCmp("main-tab-panel");let i=t.items.findIndex("sm_tabMode","ephemeral");let s;if(i!==-1){let e=t.items.itemAt(i);t.remove(e);s=t.insert(i,d)}else{s=t.add(d)}s.updateTitle.call(s);s.show();d.load(r)}catch(e){console.error(e);alert(e.message)}}var statusText;function renderPct(e,t,i){const s=e>0&&e<=.5?1:e>=99.5&&e<100?99:Math.round(e);const r=e>0&&e<1?"<":e>99&&e<100?">":"";const n=s>=100?"sm-cell-mercury-low":s>=50?"sm-cell-mercury-medium":"sm-cell-mercury-high";let a=`
	<div class="sm-cell-thermometer-text">
		${r}${s}%
	</div>
	<div class="sm-cell-thermometer-bg">
		<div class="${n}" style="width: ${s}%;">&nbsp;</div>
	</div>`;return a}function renderPctAllHigh(e,t,i,s,r,n){const a=e>0&&e<=.5?1:e>=99.5&&e<100?99:Math.round(e);const o=e>0&&e<1?"<":e>99&&e<100?">":"";const l="sm-cell-mercury-high";let d=`
	<div class="sm-cell-thermometer-text">
		${o}${a}%
	</div>
	<div class="sm-cell-thermometer-bg">
		<div class="${l}" style="width: ${a}%;">&nbsp;</div>
	</div>`;return d}function renderDurationToNow(e,t){if(!e){return"-"}let i=Math.abs(e-new Date)/1e3;const s={};const r={day:86400,hour:3600,minute:60,second:1};Object.keys(r).forEach(function(e){s[e]=Math.floor(i/r[e]);i-=s[e]*r[e]});let n=s.day>0?`${s.day} d`:s.hour>0?`${s.hour} h`:s.minute>0?`${s.minute} m`:`now`;let a=Ext.util.Format.date(e,"Y-m-d H:i T");t.attr=` ext:qwidth=130 ext:qtip="${a}"`;return n}function initProgress(e,t,i,s){var r=new Ext.ProgressBar({text:t,id:"pbar1",flex:0,textLog:"",listeners:{destroy:function(){var e=1}}});var n=new Ext.form.TextArea({id:"statusText1",cls:"sm-progress-textarea",readOnly:true,flex:3,margins:{top:10,bottom:0,left:0,right:0}});var a=new Ext.Window({title:e,modal:true,closable:true,width:"50%",height:600,id:"uploadWindow",layout:{type:"vbox",align:"stretch"},plain:true,bodyStyle:"padding:5px;",listeners:{close:function(){if(i!=undefined){reloadStore(i)}}},buttons:[{xtype:"tbbutton",text:"Save log...",download:"log.txt",disabled:false,handler:function(t,e){let i=Ext.getCmp("statusText1").getRawValue();let s=new Blob([i],{type:"text/plain;charset=utf-8"});if(window.navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(s,t.download)}else{let e=window.document.createElement("a");e.style.display="none";e.href=window.URL.createObjectURL(s);e.download=t.download;document.body.appendChild(e);e.click();document.body.removeChild(e)}}},{text:"Close",disabled:false,handler:function(e,t){a.close()}}],buttonAlign:"center",items:[r,n]});statusText="";a.show(document.body)}function updateProgress(e,t){var i=Ext.getCmp("pbar1");i.updateProgress(e,SM.he(t))}function updateStatusText(e,t,i){var t=t||false;var s=Ext.getCmp("statusText1");if(t){statusText+=e}else{statusText+=e+"\n"}s.setRawValue(statusText);s.getEl().dom.scrollTop=99999}function resetProgress(){var e=Ext.getCmp("pbar1");e.updateProgress(0,"")}function closeProgress(){var e=Ext.getCmp("uploadWindow");e.close()}function reloadStore(e){var t=Ext.StoreMgr.lookup(e);t.reload()}function Sm_HistoryData(e){const s=this;this.fields=Ext.data.Record.create([{name:"result",type:"string"},{name:"detail",type:"string"},{name:"comment",type:"string"},{name:"autoResult",type:"boolean"},{name:"userId",type:"string"},{name:"username",type:"string"},{name:"touchTs",type:"date",dateFormat:"c"},{name:"statusLabel",type:"string",mapping:"status.label"},"status"]);this.store=new Ext.data.JsonStore({root:"",storeId:"historyStore"+e,fields:this.fields,sortInfo:{field:"touchTs",direction:"DESC"},idProperty:e=>{return e.touchTs}});expander=new Ext.ux.grid.RowExpander({tpl:new Ext.XTemplate('<tpl if="detail">',"<p><b>Detail:</b> {[SM.he(values.detail)]}</p>","</tpl>",'<tpl if="comment">',"<p><b>Comment:</b> {[SM.he(values.comment)]}</p>","</tpl>",'<tpl if="status">',"<p><b>Status user:</b> {[SM.he(values.status.user.username)]}</p>","</tpl>",'<tpl if="status">',"<p><b>Status text:</b> {[SM.he(values.status.text)]}</p>","</tpl>")});const t=new SM.RowCountTextItem({store:this.store});const i=new Ext.ux.ExportButton({hasMenu:false,exportType:"grid",gridBasename:`Log`,iconCls:"sm-export-icon",text:"CSV"});this.grid=new Ext.grid.GridPanel({layout:"fit",enableDragDrop:true,ddGroup:"gridDDGroup",plugins:expander,border:false,id:"historyGrid"+e,store:this.store,stripeRows:true,view:new SM.ColumnFilters.GridView({forceFit:true,emptyText:"No log to display.",deferEmptyText:false,listeners:{filterschanged:function(e,t,i){s.store.filter(e.getFilterFns())}}}),bbar:new Ext.Toolbar({items:[i,"->",t]}),columns:[expander,{header:"Timestamp",width:120,resizeable:false,dataIndex:"touchTs",sortable:true,align:"left",xtype:"datecolumn",format:"Y-m-d H:i:s T"},{header:"Status",width:50,fixed:true,dataIndex:"statusLabel",sortable:true,renderer:renderStatuses,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.status}},{id:"result"+e,header:"Result",width:50,fixed:true,dataIndex:"result",renderer:renderResult,sortable:true,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.result}},{header:"User",width:50,dataIndex:"username",sortable:true,filter:{type:"values"}}]})}function sortGroupId(e){function t(e,t){return(1e15+e+"").slice(-t)}var i=e.match(/^V-(\d+)/);if(i==null){return e}else{return t(i[1],8)}}function sortRuleId(e){function t(e,t){return(1e15+e+"").slice(-t)}var i=e.match(/^SV-(\d+)r*/);if(i==null){return e}else{return t(i[1],8)}}function sortSeverity(e){switch(e){case"mixed":return 0;case"low":return 1;case"medium":return 2;case"high":return 3}}function getFileIcon(e){var t=e.substr((~-e.lastIndexOf(".")>>>0)+2).toLowerCase();switch(t){case"doc":case"docx":return"img/page_word.png";case"pdf":return"img/page_white_acrobat.png";case"jpg":case"png":case"gif":case"bmp":return"img/page_white_camera.png";case"xls":case"xlsx":return"img/page_excel.png";case"ppt":case"pptx":return"img/page_white_powerpoint.png";case"zip":return"img/page_white_compressed.png";default:return"img/page.png"}}function encodeSm(e,t){var i=new Array;var s=e.getSelections();for(var r=0;r<s.length;r++){i.push(s[r].data[t])}return Ext.util.JSON.encode(i)}function renderResult(e,t,i,s,r,n){if(!e)return"";return`<div class="sm-grid-result-sprite ${SM.RenderResult[e]?.css}" ext:qtip="${e}">${SM.RenderResult[e]?.textDisa}</div>`}function renderStatuses(e,t,i,s,r,n){var a="";const o=[];switch(e){case"saved":o.push("Saved");a+='<img src="img/disk-16.png" width=12 height=12 ext:qtip="Saved" style="padding-top: 1px;">';break;case"submitted":o.push("Submitted");a+='<img src="img/ready-16.png" width=12 height=12 ext:qtip="Submitted" style="padding-top: 1px;">';break;case"rejected":o.push("Rejected");a+='<img src="img/rejected-16.png" width=12 height=12 ext:qtip="Rejected" style="padding-top: 1px;">';break;case"accepted":o.push("Accepted");a+='<img src="img/star.svg" width=12 height=12 ext:qtip="Accepted" style="padding-top: 1px;">';break;default:a+='<img src="img/pixel.gif" width=12 height=12>';break}a+='<img src="img/pixel.gif" width=4 height=12>';if(i.data.autoResult){o.push("Auto");a+='<img src="img/bot.svg" width=12 height=12 ext:qtip="Automated evaluation" style="padding-top: 1px;">'}else{a+='<img src="img/pixel.gif" width=12 height=12>'}t.attr=`exportvalue="${o.join(",")}"`;return a}function renderStatus(e){switch(e){case"submitted":return'<img src="img/ready-16.png" width=12 height=12 ext:qtip="Submitted">';case"rejected":return'<img src="img/rejected-16.png" width=12 height=12 ext:qtip="Rejected">';case"accepted":return'<img src="img/star.svg" width=12 height=12 ext:qtip="Accepted">';default:return'<img src="img/pixel.gif" width=12 height=12>'}}const renderSeverity=e=>{switch(e){case"high":return'<span class="sm-grid-sprite sm-severity-high">CAT 1</span>';case"medium":return'<span class="sm-grid-sprite sm-severity-medium">CAT 2</span>';case"low":return'<span class="sm-grid-sprite sm-severity-low">CAT 3</span>';case"mixed":return'<span class="sm-grid-sprite sm-severity-low">Mixed</span>';default:return'<span class="sm-grid-sprite sm-severity-low">U</span>'}};function columnWrap(e){if(undefined!=e){e=e.replace(/\n/g,"<br//>")}return'<div style="white-space:normal !important;">'+e+"</div>"}function addUserAdmin(e){let{treePath:t}=e;const i=Ext.getCmp("main-tab-panel").getItem("user-admin-tab");if(i){i.show();return}const s=Ext.data.Record.create([{name:"userId",type:"string"},{name:"username",type:"string"},{name:"name",type:"string",mapping:"statistics.lastClaims?.name"},{name:"created",type:"date",mapping:"statistics.created"},{name:"lastAccess",type:"integer",mapping:"statistics.lastAccess"},{name:"collectionGrantCount",type:"integer",mapping:"statistics.collectionGrantCount"},{name:"statistics"}]);const r=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/users`,method:"GET"}),baseParams:{elevate:curUser.privileges.canAdmin,projection:["statistics"]},root:"",fields:s,isLoaded:false,idProperty:"userId",sortInfo:{field:"username",direction:"ASC"},listeners:{load:function(e,t){e.isLoaded=true;o.getSelectionModel().selectFirstRow()}}});const n=new Function("obj","return obj?."+STIGMAN.Env.oauth.claims.privileges+" || [];");const a=new SM.RowCountTextItem({store:r});const o=new Ext.grid.GridPanel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.edge},region:"center",id:"userGrid",store:r,border:true,stripeRows:true,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),columns:[{header:"Username",width:150,dataIndex:"username",sortable:true,filter:{type:"string"}},{header:"Name",width:150,dataIndex:"name",sortable:true,filter:{type:"string"}},{header:"Grants",width:50,align:"center",dataIndex:"collectionGrantCount",sortable:true},{header:"Added",xtype:"datecolumn",format:"Y-m-d H:i T",width:150,dataIndex:"created",sortable:true},{header:"Last Access",width:150,dataIndex:"lastAccess",sortable:true,renderer:e=>e?Ext.util.Format.date(new Date(e*1e3),"Y-m-d H:i T"):SM.styledEmptyRenderer()},{header:"Create Collection",width:100,align:"center",renderer:function(e,t,i){return n(i.data.statistics.lastClaims).includes("create_collection")?"&#x2714;":""}},{header:"Administrator",width:100,align:"center",renderer:function(e,t,i){return n(i.data.statistics.lastClaims).includes("admin")?"&#x2714;":""}},{header:"userId",width:100,dataIndex:"userId",sortable:true}],view:new SM.ColumnFilters.GridView({forceFit:true,listeners:{filterschanged:function(e){r.filter(e.getFilterFns())},beforerefresh:function(e){e.scrollTop=e.scroller.dom.scrollTop;e.scrollHeight=e.scroller.dom.scrollHeight},refresh:function(e){setTimeout(function(){e.scroller.dom.scrollTop=e.scrollTop+(e.scrollTop==0?0:e.scroller.dom.scrollHeight-e.scrollHeight)},100)}},deferEmptyText:false}),listeners:{rowdblclick:{fn:function(e,t,i){var s=e.getStore().getAt(t);Ext.getBody().mask("Getting grants for "+s.get("name")+"...");showUserProps(s.get("userId"))}}},tbar:[{iconCls:"icon-add",text:"Pre-register User",disabled:!curUser.privileges.canAdmin,handler:function(){Ext.getBody().mask("Loading form...");showUserProps(0)}},"-",{ref:"../removeBtn",iconCls:"icon-del",text:"Unregister User",disabled:!curUser.privileges.canAdmin,handler:function(){let i=o.getSelectionModel().getSelected();let e=`Unregister user ${i.data.username}?<br><br>This will remove all Collection Grants for the user and is not reversable.`;Ext.Msg.show({title:"Confirm unregister action",icon:Ext.Msg.WARNING,msg:e,buttons:{yes:"Unregister",no:"Cancel"},fn:async function(e,t){try{if(e=="yes"){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/users/${i.data.userId}?elevate=${curUser.privileges.canAdmin}`,method:"DELETE"});let t=JSON.parse(e.response.responseText);r.remove(i);SM.Dispatcher.fireEvent("userdeleted",t)}}catch(e){alert(e.message)}}})}},"-",{iconCls:"icon-edit",text:"Modify User",handler:function(){var e=o.getSelectionModel().getSelected();Ext.getBody().mask("Getting properties...");showUserProps(e.get("userId"))}}],bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){o.getStore().reload()}},{xtype:"tbseparator"},{xtype:"tbfill"},{xtype:"tbseparator"},a]}),width:"50%",loadMask:true});const l=function(e){r.loadData(e,true);const t=r.getSortState();r.sort(t.field,t.direction);o.getSelectionModel().selectRow(r.findExact("userId",e.userId))};SM.Dispatcher.addListener("userchanged",l);const d=function(e){r.loadData(e,true);const t=r.getSortState();r.sort(t.field,t.direction);o.getSelectionModel().selectRow(r.findExact("userId",e.userId))};SM.Dispatcher.addListener("usercreated",d);const c=Ext.getCmp("main-tab-panel").add({id:"user-admin-tab",sm_treePath:t,iconCls:"sm-users-icon",title:"User Grants",closable:true,layout:"border",border:false,items:[o],listeners:{beforedestroy:function(e){SM.Dispatcher.removeListener("userchanged",l);SM.Dispatcher.removeListener("usercreated",d)}}});c.show();o.getStore().load()}function addCollectionAdmin(e){let{treePath:t}=e;const i=Ext.getCmp("main-tab-panel").getItem("collection-admin-tab");if(i){i.show();return}const s=Ext.data.Record.create([{name:"collectionId",type:"string"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"metadata"},{name:"owners"},{name:"assets",type:"integer",mapping:"statistics.assetCount"},{name:"grants",type:"integer",mapping:"statistics.grantCount"},{name:"checklists",type:"integer",mapping:"statistics.checklistCount"},{name:"created",type:"date",mapping:"statistics.created"}]);const r=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/collections`,method:"GET"}),baseParams:{elevate:curUser.privileges.canAdmin,projection:["owners","statistics"]},root:"",fields:s,isLoaded:false,idProperty:"collectionId",sortInfo:{field:"name",direction:"ASC"},listeners:{load:function(e,t){e.isLoaded=true;a.getSelectionModel().selectFirstRow()}}});const n=new SM.RowCountTextItem({store:r});const a=new Ext.grid.GridPanel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.edge},region:"center",id:"collectionGrid",store:r,border:true,stripeRows:true,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),columns:[{header:"Name",width:150,dataIndex:"name",sortable:true,filter:{type:"string"}},{header:"Description",width:300,dataIndex:"description",sortable:true,filter:{type:"string"}},{header:"Owners",width:150,dataIndex:"owners",sortable:true,renderer:e=>{return columnWrap(e.map(e=>e.username).join("\n"))}},{header:"Grants",width:150,dataIndex:"grants",sortable:true},{header:"Assets",width:150,dataIndex:"assets",sortable:true},{header:"Checklists",width:150,dataIndex:"checklists",sortable:true},{header:"Created",xtype:"datecolumn",format:"Y-m-d H:i T",width:150,dataIndex:"created",sortable:true},{header:"ID",width:150,dataIndex:"collectionId",sortable:true}],view:new SM.ColumnFilters.GridView({forceFit:false,listeners:{filterschanged:function(e,t,i){r.filter(e.getFilterFns())},beforerefresh:function(e){e.scrollTop=e.scroller.dom.scrollTop;e.scrollHeight=e.scroller.dom.scrollHeight},refresh:function(e){setTimeout(function(){e.scroller.dom.scrollTop=e.scrollTop+(e.scrollTop==0?0:e.scroller.dom.scrollHeight-e.scrollHeight)},100)}},deferEmptyText:false}),listeners:{rowdblclick:{fn:function(e,t,i){var s=e.getStore().getAt(t);showCollectionProps(s.get("collectionId"))}}},tbar:[{iconCls:"icon-add",text:"New Collection",disabled:!curUser.privileges.canAdmin,handler:function(){showCollectionProps(0)}},"-",{ref:"../removeBtn",iconCls:"icon-del",text:"Delete Collection",disabled:!curUser.privileges.canAdmin,handler:function(){let i=a.getSelectionModel().getSelected();let e="Delete collection, "+i.data.name+"?";Ext.Msg.confirm("Confirm",e,async function(e,t){try{if(e=="yes"){Ext.getBody().mask("Deleting collection");let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${i.data.collectionId}?elevate=true`,method:"DELETE"});SM.Dispatcher.fireEvent("collectiondeleted",i.data.collectionId)}}catch(e){alert(e.message)}finally{Ext.getBody().unmask()}})}},"-",{iconCls:"icon-edit",text:"Collection Properties",handler:function(){var e=a.getSelectionModel().getSelected();showCollectionProps(e.get("collectionId"))}}],bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){a.getStore().reload()}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,gridBasename:"Collection-Info",exportType:"grid",iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},n]}),width:"50%",loadMask:true});function o(e){r.reload()}function l(e){r.reload()}function d(e){r.reload()}SM.Dispatcher.addListener("collectionchanged",o);SM.Dispatcher.addListener("collectioncreated",l);SM.Dispatcher.addListener("collectiondeleted",d);const c=Ext.getCmp("main-tab-panel").add({id:"collection-admin-tab",sm_treePath:t,iconCls:"sm-collection-icon",title:"Collections",closable:true,layout:"border",border:false,items:[a],listeners:{beforedestroy:function(){SM.Dispatcher.removeListener("collectionchanged",o);SM.Dispatcher.removeListener("collectioncreated",l);SM.Dispatcher.removeListener("collectiondeleted",d)}}});c.show();a.getStore().load()}async function showCollectionProps(s){try{let i=new SM.Collection.CreateForm({btnText:s?"Update":"Create",btnHandler:async()=>{try{let e=i.getForm().getFieldValues();await addOrUpdateCollection(s,e,{elevate:true,showManager:false})}catch(e){alert(e.message)}finally{e.close()}}});if(s){let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${s}`,params:{elevate:curUser.privileges.canAdmin,projection:"grants"},method:"GET"});let t=JSON.parse(e.response.responseText);i.setFieldValues(t)}let e=new Ext.Window({id:"window-project-info",cls:"sm-dialog-window sm-round-panel",title:s?"Modify Collection":"Create Collection",modal:true,width:460,height:560,layout:"fit",plain:false,buttonAlign:"right",items:i});e.show(document.body)}catch(t){alert(e.message)}}async function addCollectionManager(e){let{collectionId:h,collectionName:p,treePath:m}=e;try{const x=Ext.getCmp("main-tab-panel").getItem(`${h}-collection-manager-tab`);if(x){x.show();return}let e=curUser.collectionGrants.find(e=>e.collection.collectionId===h);let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${h}`,params:{projection:"grants"},method:"GET"});let i=JSON.parse(t.response.responseText);let s=i.metadata.fieldSettings?JSON.parse(i.metadata.fieldSettings):{detailEnabled:"always",detailRequired:"always",commentEnabled:"findings",commentRequired:"findings"};function g(e,t){if(e===i.collectionId){s=t;n.apiFieldSettings=s}}let r=new SM.Collection.ManagePanel({collectionId:h,apiCollection:i,title:`Collection Properties (ID ${h})`,cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.adjacent,bottom:SM.Margin.bottom,left:SM.Margin.edge},region:"west",width:"30%",minWidth:430,padding:"10px 10px 10px 10px",border:false,split:true,layout:"fit",allowDelete:e.accessLevel===4});let n=new SM.CollectionAssetGrid({collectionId:h,collectionName:p,apiFieldSettings:s,url:`${STIGMAN.Env.apiBase}/assets`,cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.adjacent,left:SM.Margin.adjacent},title:"Assets",region:"north",border:false,split:true,height:"50%"});let a=new SM.CollectionStigsGrid({collectionId:h,collectionName:p,url:`${STIGMAN.Env.apiBase}/collections/${h}/stigs`,cls:"sm-round-panel",margins:{top:SM.Margin.adjacent,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.adjacent},border:false,title:"STIGs",region:"center"});let o=new Ext.Panel({id:`${h}-collection-manager-tab`,collectionId:h,collectionName:p,iconCls:"sm-collection-tab-icon",sm_tabMode:"permanent",sm_treePath:m,closable:true,layout:"border",layoutConfig:{targetCls:"sm-border-layout-ct"},listeners:{beforedestroy:()=>{SM.Dispatcher.removeListener("assetchanged",l);SM.Dispatcher.removeListener("assetcreated",l);SM.Dispatcher.removeListener("assetdeleted",l);SM.Dispatcher.removeListener("stigassetschanged",d)}},items:[r,{region:"center",layout:"border",border:false,layoutConfig:{targetCls:"sm-border-layout-ct"},items:[n,a]}]});let l=e=>{if(e.collection.collectionId===h){n.getStore().reload();a.getStore().reload()}};let d=e=>{if(e===h){n.getStore().reload();a.getStore().reload()}};o.updateTitle=function(){o.setTitle(`${o.sm_tabMode==="ephemeral"?"<i>":""}${SM.he(o.collectionName)} / Manage${this.sm_tabMode==="ephemeral"?"</i>":""}`)};o.makePermanent=function(){o.sm_tabMode="permanent";o.updateTitle.call(o)};let c=Ext.getCmp("main-tab-panel");let f=c.items.findIndex("sm_tabMode","ephemeral");let u;if(f!==-1){let e=c.items.itemAt(f);c.remove(e);u=c.insert(f,o)}else{u=c.add(o)}u.updateTitle.call(u);u.show();n.getStore().load();a.getStore().load();SM.Dispatcher.addListener("assetchanged",l);SM.Dispatcher.addListener("assetcreated",l);SM.Dispatcher.addListener("assetdeleted",l);SM.Dispatcher.addListener("stigassetschanged",d);SM.Dispatcher.addListener("fieldsettingschanged",g)}catch(e){throw e}}function addStigAdmin(e){let{treePath:t}=e;const i=Ext.getCmp("main-tab-panel").getItem("stig-admin-tab");if(i){i.show();return}const s=new SM.StigRevision.StigGrid({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.edge},region:"center",stripeRows:true,loadMask:true});var r=Ext.getCmp("main-tab-panel").add({id:"stig-admin-tab",sm_treePath:t,iconCls:"sm-stig-icon",title:"STIG checklists",closable:true,layout:"border",items:[s]});function n(e){var a=new Ext.FormPanel({padding:10,standardSubmit:false,fileUpload:true,baseCls:"x-plain",monitorValid:true,autoHeight:true,labelWidth:1,hideLabel:true,defaults:{anchor:"100%",allowBlank:false},items:[{xtype:"fieldset",title:"Instructions",autoHeight:true,items:[{xtype:"displayfield",id:"infoText1",name:"infoText",html:"Please browse for STIG"}]},{xtype:"fileuploadfield",id:"form-file",emptyText:"Browse for a file...",name:"importFile",accept:".zip,.xml",buttonText:"Browse...",buttonCfg:{icon:"img/disc_drive.png"}},{xtype:"displayfield",id:"infoText2",name:"infoText",html:"<i><b>IMPORTANT: Results from the imported file will overwrite any existing results!</b></i>"}],buttonAlign:"center",buttons:[{text:"Import",icon:"img/page_white_get.png",tooltip:"Import the archive",formBind:true,handler:async function(){try{let e=document.getElementById("form-file-file");let r=e.files[0];let t=r.name.substring(r.name.lastIndexOf(".")+1);if(t.toLowerCase()==="xml"){let e=a.getForm().getEl().dom;let t=new FormData(e);t.set("replace","true");o.close();initProgress("Importing file","Initializing...");updateStatusText(r.name);await window.oidcProvider.updateToken(10);let i=await fetch(`${STIGMAN.Env.apiBase}/stigs`,{method:"POST",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`}),body:t});let s=await i.json();updateStatusText(JSON.stringify(s,null,2));updateStatusText("------------------------------------");updateStatusText("Done");updateProgress(0,"Done")}else if(t==="zip"){o.close();initProgress("Importing file","Initializing...");await n(e.files[0]);updateStatusText("Done");updateProgress(0,"Done")}else{alert(`No handler for ${t}`)}}catch(e){alert(e)}finally{Ext.getCmp("stigGrid").getStore().reload()}async function n(i){try{let a=new JSZip;let e=await a.loadAsync(i);let t=Object.keys(e.files);let o=t.filter(e=>e.toLowerCase().endsWith(".xml"));let r=t.filter(e=>e.toLowerCase().endsWith(".zip"));for(let n=0,e=o.length;n<e;n++){let e=o[n];updateStatusText(e);let t=await a.files[e].async("blob");let i=new FormData;i.append("importFile",t,e);i.append("replace","true");await window.oidcProvider.updateToken(10);let s=await fetch(`${STIGMAN.Env.apiBase}/stigs`,{method:"POST",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`}),body:i});let r=await s.json();updateStatusText(JSON.stringify(r,null,2));updateStatusText("------------------------------------")}for(let i=0,s=r.length;i<s;i++){let e=r[i];updateProgress((i+1)/s,e.slice(e.lastIndexOf("/")+1));updateStatusText(`Extracting member ${e}`);let t=await a.files[e].async("blob");updateStatusText(`Processing member ${e}`);await n(t)}updateProgress(0,"")}catch(e){updateStatusText(`Error processing ZIP: ${e.message}`);updateStatusText("------------------------------------")}}}},{text:"Cancel",handler:function(){o.close()}}]});var o=new Ext.Window({title:"Import STIG ZIP archive or XCCDF file",cls:"sm-dialog-window sm-round-panel",modal:true,width:500,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:a});o.show(document.body)}r.show();s.getStore().load()}function addAppDataAdmin(e){let{treePath:t}=e;const i=Ext.getCmp("main-tab-panel").getItem("appdata-admin-tab");if(i){i.show();return}const s=new Ext.Panel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.edge},region:"center",labelWidth:1,hideLabel:true,padding:10,defaults:{anchor:"100%",allowBlank:false},items:[{xtype:"fieldset",title:"Export",items:[{xtype:"button",id:"appdata-admin-form-export-btn",text:"Download Application Data",iconCls:"sm-export-icon",handler:async function(){try{Ext.getBody().mask("Waiting for JSON...");let e=await n();a(e.blob,e.filename)}catch(e){alert(e.blob)}finally{Ext.getBody().unmask()}}}]},{xtype:"fieldset",title:"Import",items:[{xtype:"button",id:"appdata-admin-form-import-btn",text:"Replace Application Data...",iconCls:"sm-import-icon",handler:r}]}]});function r(e,t){let c=new Ext.FormPanel({standardSubmit:false,fileUpload:true,baseCls:"x-plain",monitorValid:true,autoHeight:true,labelWidth:1,hideLabel:true,defaults:{anchor:"100%",allowBlank:false},items:[{xtype:"fieldset",title:"Instructions",autoHeight:true,items:[{xtype:"displayfield",id:"infoText1",name:"infoText",html:"Please browse for an Application Data file"}]},{xtype:"fileuploadfield",id:"form-file",emptyText:"Browse for a file...",name:"importFile",accept:".json,.zip",buttonText:"Browse...",buttonCfg:{icon:"img/disc_drive.png"}},{xtype:"displayfield",id:"infoText2",name:"infoText",html:"<i><b>IMPORTANT: Content from the imported file will replace ALL existing application data!</b></i>"}],buttonAlign:"center",buttons:[{text:"Import",icon:"img/page_white_get.png",tooltip:"Import the data",formBind:true,handler:async function(){try{let e=document.getElementById("form-file-file");let t=e.files[0];let i=c.getForm().getEl().dom;let s=new FormData(i);initProgress("Importing file","Waiting for response...");updateStatusText("Waiting for API response...");await window.oidcProvider.updateToken(10);let r=await fetch(`${STIGMAN.Env.apiBase}/op/appdata?elevate=true`,{method:"POST",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`}),body:s});const a=r.body.getReader();const o=new TextDecoder("utf-8");let n=false;do{const{value:l,done:d}=await a.read();updateStatusText(o.decode(l),true);n=d}while(!n);updateProgress(0,"Done")}catch(e){alert(e)}}},{text:"Cancel",handler:function(){i.close()}}]});var i=new Ext.Window({title:"Initialize Application Data",cls:"sm-dialog-window sm-round-panel",modal:true,width:500,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:c});i.show(document.body)}const n=async function(){try{let e=`${STIGMAN.Env.apiBase}/op/appdata?elevate=true`;await window.oidcProvider.updateToken(10);let t=await fetch(e,{method:"GET",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`})});const i=t.headers.get("content-disposition");const s=i.match(/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/)[1];const r=await t.blob();return{blob:r,filename:s}}catch(e){alert(e.message)}};const a=function(e,t){let i=document.createElement("a");i.style.display="none";let s=window.URL.createObjectURL(e);i.href=s;i.download=t;document.body.appendChild(i);i.click();document.body.removeChild(i);window.URL.revokeObjectURL(s)};const o=Ext.getCmp("main-tab-panel").add({id:"appdata-admin-tab",sm_treePath:t,iconCls:"sm-database-save-icon",title:"Application Data",closable:true,layout:"border",border:false,items:[s]});o.show()}function getAdministrationItems(){return getTree()}function adminTreeClick(e){var t=Ext.getCmp("admin-center-tab").getItem("admin-tab-"+e.attributes.id);if(t){t.show()}else{addAdminTab(e.attributes)}}function addAdminTab(e){switch(e.id){case"user-admin":addUserAdmin();break;case"collection-admin":addCollectionAdmin();break;case"stig-admin":addStigAdmin();break;case"artifact-admin":addArtifactAdmin();break;case"appdata-admin":addAppDataAdmin();break}}function getTree(){let e=[];if(curUser.privileges.canAdmin){e.push({id:"appdata-admin",text:"Application Data ",leaf:true,iconCls:"sm-database-save-icon"},{id:"department-admin",text:"Departments",leaf:true,iconCls:"sm-department-icon"})}if(curUser.privileges.canAdmin||curUser.accessLevel===3){e.push({id:"collection-admin",text:"Collections",leaf:true,iconCls:"sm-collection-icon"})}e.push({id:"user-admin",text:"Users",leaf:true,iconCls:"sm-users-icon"},{id:"stig-admin",text:"STIG checklists",leaf:true,iconCls:"sm-stig-icon"});return new Ext.tree.AsyncTreeNode({id:"global-admin",text:"Administration areas",icon:"img/Settings-icon-16.png",expanded:true,children:e})}function addCompletionStatus(e){const{collectionId:t,collectionName:i,treePath:s}=e;var r=new Ext.ux.grid.GroupSummary;const n=new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/collections/${t}/status`,method:"GET"}),sortInfo:{field:"assetName"},groupField:"assetName",reader:new Ext.data.JsonReader({root:"",fields:[{name:"assetId",type:"int"},"assetName",{name:"benchmarkId",type:"string"},{name:"rulesAuto",type:"int",mapping:"rules.auto"},{name:"rulesTotal",type:"int",mapping:"rules.total"},{name:"savedTotal",type:"int",mapping:"status.saved.total"},{name:"submittedTotal",type:"int",mapping:"status.submitted.total"},{name:"rejectedTotal",type:"int",mapping:"status.rejected.total"},{name:"acceptedTotal",type:"int",mapping:"status.accepted.total"},{name:"highCount",type:"int",mapping:"findings.high"},{name:"mediumCount",type:"int",mapping:"findings.medium"},{name:"lowCount",type:"int",mapping:"findings.low"},{name:"minTs",type:"date"},{name:"maxTs",type:"date"},{name:"notCheckedTotal",type:"int",convert:function(e,t){return t.rules.total-(t.status.saved.total+t.status.submitted.total+t.status.rejected.total+t.status.accepted.total)}}],idProperty:e=>{return e.assetId+e.benchmarkId}})});const a=new SM.RowCountTextItem({store:n});var o=new Ext.grid.GridPanel({id:"completionGrid-"+t,cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.edge},plugins:r,region:"center",layout:"fit",store:n,columns:[{header:"Asset",width:35,dataIndex:"assetName",sortable:true,summaryRenderer:function(e,t,i){return"Totals"}},{header:"Checklist",width:35,dataIndex:"benchmarkId",sortable:true,id:"completionGrid-"+t+"becnhmarkId",summaryRenderer:function(e,t,i){return"Totals"}},{header:"Checks",width:10,dataIndex:"rulesTotal",sortable:true,align:"right",renderer:renderGrey,summaryType:"sum"},{header:"Not Checked",width:10,dataIndex:"notCheckedTotal",sortable:true,align:"right",renderer:renderCat23,summaryType:"sum"},{header:"Oldest",width:10,dataIndex:"minTs",sortable:true,align:"center",renderer:renderDurationToNow,summaryType:"min"},{header:"Newest",width:10,dataIndex:"maxTs",sortable:true,align:"center",renderer:renderDurationToNow,summaryType:"max"},{header:"Saved",width:10,dataIndex:"savedTotal",sortable:true,align:"right",renderer:renderGrey,summaryType:"sum"},{header:"<img src=img/ready-16.png width=12 height=12> Submitted",width:10,dataIndex:"submittedTotal",sortable:true,align:"right",renderer:renderGrey,summaryType:"sum"},{header:"<img src=img/rejected-16.png width=12 height=12> Rejected",width:10,dataIndex:"rejectedTotal",sortable:true,align:"right",renderer:renderGrey,summaryType:"sum"},{header:"<img src=img/star.svg width=12 height=12> Accepted",width:10,dataIndex:"acceptedTotal",sortable:true,align:"right",renderer:renderGrey,summaryType:"sum"},{header:"Cat 1",width:10,dataIndex:"highCount",sortable:true,align:"right",renderer:renderCat1,summaryType:"sum"},{header:"Cat 2",width:10,dataIndex:"mediumCount",sortable:true,align:"right",renderer:renderCat23,summaryType:"sum"},{header:"Cat 3",width:10,dataIndex:"lowCount",sortable:true,align:"right",renderer:renderCat23,summaryType:"sum"}],loadMask:true,stripeRows:true,view:new Ext.grid.GroupingView({enableGrouping:true,hideGroupedColumn:true,forceFit:true,emptyText:"No records found.",groupTextTpl:'{[SM.he(values.text)]} ({[values.rs.length]} {[values.text.split(":")[0] == "Asset" ? "checklist" : "asset"]}{[values.rs.length > 1 ? "s assigned" : " assigned"]})',getRowClass:function(e,t,i,s){if(e.data.stigTitle=="!! NO STIG ASSIGNMENTS !!"){return"sm-grid3-row-black"}}}),sm:new Ext.grid.RowSelectionModel({}),listeners:{rowdblclick:{fn:function(e,t,i){var s=e.getStore().getAt(t);if(s.get("stigTitle")!="!! NO STIG ASSIGNMENTS !!"){Ext.getCmp("main-tabs").setActiveTab("tab-reviews");var r=new Object;var n=new Object;n.report="review";n.assetId=s.get("assetId");n.assetName=s.get("assetName");n.benchmarkId=s.get("benchmarkId");n.stigName=s.get("benchmarkId");n.revId=s.get("revId");r.attributes=n;reviewsTreeClick(r)}}}},tbar:new Ext.Toolbar({items:[{xtype:"buttongroup",title:"Grouping",items:[{xtype:"tbbutton",icon:"img/security_firewall_on.png",tooltip:"Group by STIG",toggleGroup:"completionGrid-groupBy"+t,enableToggle:true,allowDepress:false,width:20,handler:function(e){if(e.pressed){Ext.getCmp("completionGrid-expandButton"+t).enable();Ext.getCmp("completionGrid-collapseButton"+t).enable();o.getStore().groupBy("benchmarkId")}else{Ext.getCmp("completionGrid-expandButton"+t).disable();Ext.getCmp("completionGrid-collapseButton"+t).disable();o.getStore().clearGrouping()}}},{xtype:"tbbutton",icon:"img/accuracy-16.png",tooltip:"Group by asset",toggleGroup:"completionGrid-groupBy"+t,enableToggle:true,allowDepress:false,pressed:true,width:20,handler:function(e){if(e.pressed){Ext.getCmp("completionGrid-expandButton"+t).enable();Ext.getCmp("completionGrid-collapseButton"+t).enable();o.getStore().groupBy("assetName")}else{Ext.getCmp("completionGrid-expandButton"+t).disable();Ext.getCmp("completionGrid-collapseButton"+t).disable();o.getStore().clearGrouping()}}},{xtype:"tbseparator"},{xtype:"tbbutton",icon:"img/minus-grey.png",id:"completionGrid-collapseButton"+t,tooltip:"Collapse all groups",width:20,handler:function(e){o.getView().collapseAllGroups()}},{xtype:"tbbutton",icon:"img/plus-grey.png",id:"completionGrid-expandButton"+t,tooltip:"Expand all groups",width:20,handler:function(e){o.getView().expandAllGroups()}}]}]}),bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){o.getStore().reload()}},{xtype:"tbseparator"},{xtype:"exportbutton",hasMenu:false,exportType:"store",storeBasename:i+"-Status",iconCls:"sm-export-icon",text:"CSV"},{xtype:"tbfill"},{xtype:"tbseparator"},a]})});let l=new Ext.Panel({id:"completionTab-"+t,collectionId:t,collectionName:i,iconCls:"sm-report-icon",title:"",closable:true,layout:"border",sm_tabMode:"ephemeral",sm_treePath:s,items:[o]});l.updateTitle=function(){l.setTitle(`${l.sm_tabMode==="ephemeral"?"<i>":""}${SM.he(l.collectionName)} / Status${l.sm_tabMode==="ephemeral"?"</i>":""}`)};l.makePermanent=function(){l.sm_tabMode="permanent";l.updateTitle()};let d=Ext.getCmp("main-tab-panel");let c=d.items.findIndex("sm_tabMode","ephemeral");let f;if(c!==-1){let e=d.items.itemAt(c);d.remove(e);f=d.insert(c,l)}else{f=d.add(l)}f.updateTitle.call(f);f.show();o.getStore().load()}function renderGrey(e,t,i,s,r,n){t.css="sm-cell-grey";return e}function renderDays(e,t,i,s,r,n){t.css="sm-cell-grey";if(isNaN(e)){return"-"}else if(e==0){return"Today"}else if(e==1){return e+" day"}else{return e+" days"}}function renderCat1(e,t,i,s,r,n){if(e>0){t.css="sm-cell-red"}else{t.css="sm-cell-green"}return e}function renderCat23(e,t,i,s,r,n){if(e>0){t.css="sm-cell-orange"}else{t.css="sm-cell-green"}return e}function renderUndone(e,t,i,s,r,n){if(e==0){t.css="sm-cell-green"}else{t.css="sm-cell-red"}return e}function renderDone(e,t,i,s,r,n){if(e==i.data.totalCheckCount){t.css="sm-cell-green"}else{t.css="sm-cell-red"}return e}function renderChecklist(e,t,i,s,r,n){t.css="sm-cell-checklist";return e}function renderAsset(e,t,i,s,r,n){t.css="sm-cell-asset";return e}function addFindingsSummary(e){const{collectionId:t,collectionName:i,treePath:s}=e;const r="groupId";const n=new SM.FindingsPanel({collectionId:t,aggregator:r});const a=new Ext.Panel({id:"findingsTab-"+t,collectionId:t,collectionName:i,iconCls:"sm-report-icon",title:"",closable:true,layout:"fit",sm_tabMode:"ephemeral",sm_treePath:s,items:[n]});a.updateTitle=function(){a.setTitle(`${a.sm_tabMode==="ephemeral"?"<i>":""}${SM.he(a.collectionName)} / Findings${a.sm_tabMode==="ephemeral"?"</i>":""}`)};a.makePermanent=function(){a.sm_tabMode="permanent";a.updateTitle.call(a)};let o=Ext.getCmp("main-tab-panel");let l=o.items.findIndex("sm_tabMode","ephemeral");let d;if(l!==-1){let e=o.items.itemAt(l);o.remove(e);d=o.insert(l,a)}else{d=o.add(a)}d.updateTitle.call(d);d.show();n.parent.getStore().load({params:{aggregator:r}})}async function addReview(e){let{leaf:o,selectedRule:r,selectedResource:t,treePath:i}=e;let s=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${o.collectionId}`,method:"GET"});let n=JSON.parse(s.response.responseText);let a=n.metadata.fieldSettings?JSON.parse(n.metadata.fieldSettings):{detailEnabled:"always",detailRequired:"always",commentEnabled:"findings",commentRequired:"findings"};if(o.stigRevStr){let e=o.stigRevStr.match(/V(\d+)R(\d+)/);o.revId=`${o.benchmarkId}-${e[1]}-${e[2]}`}var d="-"+o.assetId+"-"+o.benchmarkId.replace(".","_");var l="!_TEMPLATE";var c="You have modified your review. Would you like to save your changes?";var f=Ext.data.Record.create([{name:"assetId"},{name:"groupId",type:"string",sortType:sortGroupId},{name:"ruleId",type:"string",sortType:sortRuleId},{name:"groupTitle",type:"string"},{name:"ruleTitle",type:"string"},{name:"severity",type:"string",sortType:sortSeverity},{name:"result",type:"string"},{name:"status",type:"string"},{name:"hasAttach",type:"boolean"},{name:"autoResult",type:"boolean"},{name:"reviewComplete",type:"boolean"},{name:"autoCheckAvailable",type:"boolean"}]);var u=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/assets/${o.assetId}/checklists/${o.benchmarkId}/latest`,method:"GET"}),root:"",storeId:"groupStore"+d,fields:f,idProperty:"ruleId",sortInfo:{field:"ruleId",direction:"ASC"},listeners:{load:function(e,t){if("undefined"!==typeof r){var i=ourGrid.getStore().find("ruleId",r);x.getSelectionModel().selectRow(i);var s=ourGrid.getView().getRow(i);s.scrollIntoView()}else{x.getSelectionModel().selectFirstRow()}x.totalText.setText(p(e))},clear:function(){x.totalText.setText("0 rules")},update:function(e){x.totalText.setText(p(e))},datachanged:function(e){x.totalText.setText(p(e))},exception:function(e){var t=x.getView();var i=e.events.exception.listeners[1].fn.arguments[4];if(i.status!=0){t.emptyText="Load failed: "+i.responseText}else{t.emptyText="HTTP Server Error: "+i.statusText}t.refresh()}}});var h=new Ext.menu.Menu({id:"groupChecklistMenu"+d,items:[{text:"Group/Rule display",hideOnClick:false,menu:{items:[{id:"groupFileMenu-title-groupItem"+d,text:"Group ID and title",checked:false,group:"titleType"+d,handler:function(e,t){var i=x.getColumnModel();var s=i.findColumnIndex("groupTitle");var r=i.findColumnIndex("ruleTitle");var n=i.findColumnIndex("groupId");var a=i.findColumnIndex("ruleId");var o=i.getColumnWidth(r);var l=i.getColumnWidth(a);i.setColumnWidth(s,o);i.setColumnWidth(n,l);w();i.setHidden(r,true);i.setHidden(a,true);i.setHidden(s,false);i.setHidden(n,false);x.autoExpandColumn="groupTitle"+d}},{id:"groupFileMenu-title-ruleItem"+d,text:"Rule ID and title",checked:true,group:"titleType"+d,handler:function(e,t){var i=x.getColumnModel();var s=i.findColumnIndex("groupTitle");var r=i.findColumnIndex("ruleTitle");var n=i.findColumnIndex("groupId");var a=i.findColumnIndex("ruleId");var o=i.getColumnWidth(s);var l=i.getColumnWidth(n);i.setColumnWidth(r,o);i.setColumnWidth(a,l);w();i.setHidden(s,true);i.setHidden(n,true);i.setHidden(r,false);i.setHidden(a,false);x.autoExpandColumn="ruleTitle"+d}}]}},"-",{text:"Export CKL",iconCls:"sm-export-icon",tooltip:"Download this checklist in DISA STIG Viewer format",handler:async function(t,e){try{document.body.style.cursor="wait";let e=await t.getCkl(o);t.downloadBlob(e.blob,e.filename);document.body.style.cursor="default"}catch(e){alert(e.message)}},getCkl:function(t){return new Promise(async(i,s)=>{var r=new XMLHttpRequest;var e=`${STIGMAN.Env.apiBase}/assets/${t.assetId}/checklists/${x.sm_benchmarkId}/${x.sm_revisionStr}?format=ckl`;r.open("GET",e);r.responseType="blob";await window.oidcProvider.updateToken(10);r.setRequestHeader("Authorization","Bearer "+window.oidcProvider.token);r.onload=function(){if(this.status>=200&&this.status<300){var e=this.getResponseHeader("Content-Disposition");var t=e.match(/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/)[1];i({blob:r.response,filename:t})}else{s({status:this.status,message:r.statusText})}};r.onerror=function(){s({status:this.status,message:r.responseText})};r.send()})},downloadBlob:function(e,t){let i=document.createElement("a");i.style.display="none";let s=window.URL.createObjectURL(e);i.href=s;i.download=t;document.body.appendChild(i);i.click();document.body.removeChild(i);window.URL.revokeObjectURL(s)}},{text:"Import Results...",iconCls:"sm-import-icon",handler:function(){showImportResultFile({...o,revisionStr:x.sm_revisionStr,store:u,fieldSettings:a})}}]});var p=function(e){var t=e.getCount();var s=0;var r=0;var n=0;var a=0;e.data.each(function(e,t,i){switch(e.data.result){case"fail":s++;break;case"pass":r++;break;case"notapplicable":n++;break;default:a++;break}});return t+" checks ("+s+" Open, "+r+" NF, "+n+" NA, "+a+" NR/Other )"};const m=new Ext.ux.ExportButton({hasMenu:false,exportType:"grid",gridBasename:`${o.assetName}-${o.benchmarkId}`,iconCls:"sm-export-icon",text:"CSV"});const g=new SM.ColumnFilters.GridView({forceFit:false,emptyText:"No checks to display",holdPosition:true,deferEmptyText:false,lastHide:new Date,getRowClass:function(e,t){var i=e.get("autoCheckAvailable");if(i===true){return"sm-scap-grid-item"}},listeners:{filterschanged:function(e,t,i){u.filter(e.getFilterFns())}}});var x=new Ext.grid.GridPanel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.adjacent,bottom:SM.Margin.bottom,left:SM.Margin.edge},border:false,region:"west",id:"groupGrid"+d,sm_benchmarkId:o.benchmarkId,sm_revisionStr:"latest",width:"35%",minWidth:340,hideMode:"offsets",enableColumnMove:false,title:"Checklist",split:true,store:u,stripeRows:true,listeners:{beforehide:{fn:function(e){var t="1"}},beforeshow:{fn:function(e){var t="1"}}},sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{beforerowselect:function(s,r,e,t){if(R.groupGridRecord!=t){var i=R.reviewChanged();var n=R.getForm().isValid();if(i&&n&&R.isLoaded){Ext.Msg.show({title:"Save Changes?",msg:c,buttons:{yes:"Save",no:"Discard",cancel:"Cancel"},fn:function(e,t,i){switch(e){case"yes":L({source:"selectGroup",sm:s,index:r,type:"save"});R.isLoaded=false;break;case"no":R.isLoaded=false;s.selectRow(r);break;case"cancel":break}}});return false}else{return true}}return true},rowselect:{fn:function(e,t,i){P(i,o.collectionId,o.assetId,d,x.sm_benchmarkId,x.sm_revisionStr)}}}}),view:g,columns:[{id:"severity"+d,header:"CAT",fixed:true,width:48,align:"left",dataIndex:"severity",sortable:true,renderer:renderSeverity,filter:{type:"values",renderer:renderSeverity,comparer:SM.ColumnFilters.CompareFns.severity}},{id:"groupId"+d,header:"Group",width:95,dataIndex:"groupId",sortable:true,hidden:true,align:"left",filter:{type:"string"}},{id:"ruleId"+d,header:"Rule Id",width:100,dataIndex:"ruleId",hidden:false,sortable:true,align:"left",filter:{type:"string"}},{id:"groupTitle"+d,header:"Group Title",width:80,hidden:true,dataIndex:"groupTitle",renderer:columnWrap,sortable:true,filter:{type:"string"}},{id:"ruleTitle"+d,header:"Rule Title",width:80,hidden:false,dataIndex:"ruleTitle",renderer:columnWrap,sortable:true,filter:{type:"string"}},{id:"result"+d,header:'<span exportvalue="Result">&#160;</span>',width:32,fixed:true,dataIndex:"result",sortable:true,renderer:renderResult,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.result}},{id:"status"+d,header:"Status",fixed:true,width:44,align:"center",dataIndex:"status",sortable:true,renderer:renderStatuses,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.status}}],autoExpandColumn:"ruleTitle"+d,loadMask:true,tbar:new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"sm-checklist-icon",text:"Checklist",menu:h},"->",{xtype:"tbitem",html:'<div class="sm-toolbar-legend-box sm-scap-grid-item"></div>'},{xtype:"tbtext",text:" SCAP available",style:"margin-right: 15px;"}]}),bbar:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){x.getStore().reload()}},{xtype:"tbseparator"},m,{xtype:"tbseparator"},{xtype:"tbtext",ref:"../totalText",id:"groupGrid-totalText"+d,text:"0 rules",width:80}]});var b=function(e,t){let i=x.getStore();i.proxy.setUrl(`${STIGMAN.Env.apiBase}/assets/${o.assetId}/checklists/${o.benchmarkId}/${e.revisionStr}`,true);i.load();v(o.benchmarkId,e.revisionStr,d);x.sm_revisionStr=e.revisionStr};async function v(s,r,n){try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${s}/revisions`,method:"GET"});let t=JSON.parse(e.response.responseText);let i=y(t,r,n);if(h.revisionMenuItem===undefined){h.addItem(i.menu)}x.setTitle(SM.he(i.activeRevisionLabel))}catch(e){alert(e.message)}}let y=function(s,r,n){let a={};var o={id:"revision-menuItem"+n,ref:"revisionMenuItem",text:"Revisions",hideOnClick:false,menu:{items:[]}};for(var l=0;l<s.length;l++){let e=s[l];let t=new Date(e.benchmarkDate);let i={id:`revision-submenu${e.benchmarkId}-${e.version}-${e.release}${n}`,text:SM.he(`Version ${e.version} Release ${e.release} (${t.format("j M Y")})`),revisionStr:e.revisionStr,group:"revision-submenu-group"+n,handler:b};if(i.revisionStr==r||r==="latest"&&l===0){i.checked=true;x.sm_revisionStr=i.revisionStr;a.activeRevisionLabel=i.text}else{i.checked=false}o.menu.items.push(i)}a.menu=o;return a};function w(){u.filter(g.getFilterFns())}let S=SM.RuleContentTpl;var E=Ext.data.Record.create([{name:"assetName",type:"string"},{name:"status",type:"string",mapping:"status.label"},{name:"result",type:"string"},{name:"autoResult",type:"boolean"},{name:"username",type:"string"},{name:"detail",type:"string"},{name:"comment",type:"string"},{name:"reviewId",type:"int"}]);var C=new Ext.data.JsonStore({root:"",id:"otherStore"+d,fields:E,sortInfo:{field:"assetName",direction:"ASC"},listeners:{exception:function(e){var t=k.getView();var i=e.events.exception.listeners[1].fn.arguments[4];if(i.status!=0){var s="Load failed: "+i.responseText}else{var s="HTTP Server Error: "+i.statusText}k.getEl().mask(s)}},idProperty:"reviewId"});var I=new Ext.ux.grid.RowExpander({tpl:new Ext.XTemplate('<tpl if="detail">',"<p><b>Detail:</b> {[SM.he(values.detail)]}</p>","</tpl>",'<tpl if="comment">',"<p><b>Comment:</b> {[SM.he(values.comment)]}</p>","</tpl>")});const T=new Ext.ux.ExportButton({hasMenu:false,exportType:"grid",gridBasename:`Other-Reviews`,iconCls:"sm-export-icon",text:"CSV"});var k=new Ext.grid.GridPanel({enableDragDrop:true,ddGroup:"gridDDGroup",plugins:I,layout:"fit",height:350,border:false,id:"otherGrid"+d,store:C,stripeRows:true,sm:new Ext.grid.RowSelectionModel({singleSelect:true}),view:new SM.ColumnFilters.GridView({forceFit:true,emptyText:"No other assets to display.",deferEmptyText:false,listeners:{filterschanged:function(e,t,i){C.filter(e.getFilterFns())}}}),tbar:new Ext.Toolbar({items:[]}),bbar:new Ext.Toolbar({items:[T,"->",new SM.RowCountTextItem({store:C})]}),columns:[I,{id:"target"+d,header:"Asset",width:120,dataIndex:"assetName",sortable:true,align:"left",renderer:function(e,t,i,s,r,n){t.css+=" sm-cell-asset";return e},filter:{type:"string"}},{header:"Status",width:50,fixed:true,dataIndex:"status",sortable:true,renderer:function(e,t,i,s,r,n){return renderStatuses(e,t,i,s,r,n)},filter:{type:"values",renderer:SM.ColumnFilters.Renderers.status}},{id:"state"+d,header:"Result",width:50,fixed:true,dataIndex:"result",sortable:true,renderer:renderResult,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.result}},{header:"User",width:50,dataIndex:"username",sortable:true,filter:{type:"values"}}],loadMask:true,autoExpandColumn:"target"+d,emptyText:"No other assets to display"});const A=new SM.Attachments.Grid({id:"attachmentsGrid"+d,title:"Attachments",collectionId:o.collectionId,assetId:o.assetId});var M=new Sm_HistoryData(d);var _=new Ext.Panel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.adjacent,left:SM.Margin.adjacent},border:false,region:"center",title:"Review Resources",layout:"fit",items:[{xtype:"tabpanel",border:false,deferredRender:false,id:"resources-tabs"+d,activeTab:"undefined"!==typeof t?t:"other-tab"+d,listeners:{beforerender:function(e){}},items:[{title:"Other Assets",border:false,layout:"fit",id:"other-tab"+d,items:k},A,{title:"Status Text",ref:"../statusTextPanel",padding:10,autoScroll:true},{title:"History",layout:"fit",id:"history-tab"+d,items:M.grid}]}]});const R=new SM.Review.Form.Panel({cls:"sm-round-panel",bodyCssClass:"sm-review-form",border:false,margins:{top:SM.Margin.adjacent,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.adjacent},region:"south",split:true,height:"65%",minHeight:320,id:"reviewForm"+d,title:"Review on "+SM.he(o.assetName),padding:10,labelWidth:54,fieldSettings:a,btnHandler:function(e){console.log(e);L({source:"form",type:e.actionType})}});function N(e,t){if(e===n.collectionId){R.fieldSettings=t;R.setReviewFormItemStates();R.setReviewFormTips()}}SM.Dispatcher.addListener("fieldsettingschanged",N);async function P(d,c,f,e,u,h){try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${u}/revisions/${h}/rules/${d.data.ruleId}`,method:"GET",params:{projection:["detail","ccis","checks","fixes"]}});let t=JSON.parse(e.response.responseText);F.contentPanel.update(t);F.contentPanel.setTitle("Rule for Group "+SM.he(d.data.groupId));let i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${c}/reviews`,method:"GET",params:{rules:"all",ruleId:d.data.ruleId}});let s=Ext.util.JSON.decode(i.response.responseText);let r=s.filter(e=>e.assetId==f)[0]||{};let n=s.filter(e=>e.assetId!=f);let a=R.getForm();a.reset();R.isLoaded=false;R.groupGridRecord=d;R.loadValues(r);R.isLoaded=true;k.getStore().loadData(n);let o=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${c}/reviews/${f}/${d.data.ruleId}`,method:"GET",params:{projection:["history","metadata"]}});let l=Ext.util.JSON.decode(o.response.responseText);if(!l){M.store.removeAll();A.getStore().removeAll()}if(l.history){let e={comment:l.comment,autoResult:l.autoResult,rejectText:l.rejectText,result:l.result,detail:l.detail,status:l.status,ts:l.ts,touchTs:l.touchTs,userId:l.userId,username:l.username};l.history.push(e);M.store.loadData(l.history)}_.statusTextPanel.update(l.status?.text);A.ruleId=d.data.ruleId;A.loadArtifacts();R.setReviewFormItemStates()}catch(e){if(e.response){alert(e.response.responseText)}else{alert(e)}}}var D=[x,{cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.adjacent,bottom:SM.Margin.bottom,left:SM.Margin.adjacent},border:false,region:"center",xtype:"panel",split:true,collapsible:false,padding:20,autoScroll:true,id:"content-panel"+d,ref:"contentPanel",title:"Rule",tpl:S},{region:"east",layout:"border",width:"35%",minWidth:340,border:false,split:true,collapsible:false,id:"east-panel"+d,items:[_,R]}];let F=new Ext.Panel({id:"reviewTab"+d,border:false,collectionId:o.collectionId,collectionName:n.name,assetName:o.assetName,stigName:o.stigName,iconCls:"sm-stig-icon",title:" ",closable:true,layout:"border",sm_tabMode:"ephemeral",sm_treePath:i,sm_TabType:"asset_review",sm_GroupGridView:x.getView(),items:D,listeners:{beforedestroy:()=>{SM.Dispatcher.removeListener("fieldsettingschanged",N)},beforeclose:function(s){var e=R.reviewChanged();var t=R.getForm().isValid();if(e&&t){Ext.Msg.show({title:"Save Changes?",msg:c,buttons:Ext.Msg.YESNOCANCEL,fn:function(e,t,i){switch(e){case"yes":L({source:"closeTab",type:"save"});break;case"no":s.ownerCt.remove(s);break;case"cancel":break}}});return false}else{return true}}}});F.updateTitle=function(){F.setTitle(`${this.sm_tabMode==="ephemeral"?"<i>":""}${SM.he(this.collectionName)} / ${SM.he(this.assetName)} / ${SM.he(this.stigName)}${this.sm_tabMode==="ephemeral"?"</i>":""}`)};F.makePermanent=function(){F.sm_tabMode="permanent";F.updateTitle.call(F)};let B=Ext.getCmp("main-tab-panel");let G=B.items.findIndex("sm_tabMode","ephemeral");let O;if(G!==-1){let e=B.items.itemAt(G);B.remove(e);O=B.insert(G,F)}else{O=B.add(F)}O.updateTitle.call(O);O.show();x.getStore().load();v(o.benchmarkId,"latest",d);async function L(n){let a;try{a=R;a.getEl().mask("Saving...");let e=a.getForm().getFieldValues(false,false);let t={result:e.result,detail:e.detail||null,comment:e.comment||null,autoResult:e.autoResult};let i,s;switch(n.type){case"submit":case"unsubmit":i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${o.collectionId}/reviews/${o.assetId}/${a.groupGridRecord.data.ruleId}`,method:"PATCH",params:{projection:"history"},headers:{"Content-Type":"application/json;charset=utf-8"},jsonData:{status:n.type=="submit"?"submitted":"saved"}});s=JSON.parse(i.response.responseText);break;case"save and unsubmit":t.status="saved";i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${o.collectionId}/reviews/${o.assetId}/${a.groupGridRecord.data.ruleId}`,method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},params:{projection:"history"},jsonData:t});s=JSON.parse(i.response.responseText);break;case"save and submit":t.status="submitted";i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${o.collectionId}/reviews/${o.assetId}/${a.groupGridRecord.data.ruleId}`,method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},params:{projection:"history"},jsonData:t});s=JSON.parse(i.response.responseText);break;case"save":t.status="saved";i=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${o.collectionId}/reviews/${o.assetId}/${a.groupGridRecord.data.ruleId}`,method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},params:{projection:"history"},jsonData:t});s=JSON.parse(i.response.responseText);break}a.groupGridRecord.data.result=s.result;a.groupGridRecord.data.reviewComplete=s.reviewComplete;a.groupGridRecord.data.status=s.status.label;a.groupGridRecord.data.autoResult=s.autoResult;a.groupGridRecord.commit();w();R.loadValues(s);_.statusTextPanel.update(s.status?.text);let r={comment:s.comment,autoResult:s.autoResult,rejectText:s.rejectText,result:s.result,detail:s.detail,status:s.status,ts:s.ts,touchTs:s.touchTs,userId:s.userId,username:s.username};s.history.push(r);M.store.loadData(s.history);if(n.source=="closeTab"){Ext.getCmp("main-tab-panel").remove("reviewTab"+d)}else if(n.source=="selectGroup"){n.sm.selectRow(n.index)}R.setReviewFormItemStates(R)}catch(e){Ext.Msg.alert("Fail",`Failed to update review.\n${e.message}`)}finally{a.getEl().unmask()}}}async function addCollectionReview(e){let{leaf:p,selectedRule:m,selectedAsset:g,treePath:x}=e;try{var b="-"+p.collectionId+"-"+p.benchmarkId.replace(".","_");let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}`,method:"GET"});let d=JSON.parse(e.response.responseText);let n=d.metadata.fieldSettings?JSON.parse(d.metadata.fieldSettings):{detailEnabled:"always",detailRequired:"always",commentEnabled:"findings",commentRequired:"findings"};let s=d.metadata.statusSettings?JSON.parse(d.metadata.statusSettings):{canAccept:true,minGrant:3};e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/stigs/${p.benchmarkId}/assets`,method:"GET"});let c=JSON.parse(e.response.responseText);let f=c.map(e=>({assetId:e.assetId,assetName:e.name,result:null,detail:null,comment:null,autoResult:null,userId:null,username:null,ts:null,status:null}));var v=Ext.data.Record.create([{name:"oCnt",type:"int",mapping:"counts.results.fail"},{name:"nfCnt",type:"int",mapping:"counts.results.pass"},{name:"naCnt",type:"int",mapping:"counts.results.notapplicable"},{name:"nrCnt",type:"int",mapping:"counts.results.notchecked"},{name:"approveCnt",type:"int",mapping:"counts.statuses.accepted"},{name:"rejectCnt",type:"int",mapping:"counts.statuses.rejected"},{name:"readyCnt",type:"int",mapping:"counts.statuses.submitted"},{name:"groupId",type:"string",sortType:sortGroupId},{name:"ruleId",type:"string"},{name:"groupTitle",type:"string"},{name:"ruleTitle",type:"string"},{name:"severity",type:"string"},{name:"autoCheckAvailable",type:"boolean"}]);var y=new Ext.data.JsonStore({proxy:new Ext.data.HttpProxy({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/checklists/${p.benchmarkId}/latest`,method:"GET"}),root:"",fields:v,idProperty:"ruleId",sortInfo:{field:"groupId",direction:"ASC"},listeners:{load:function(e,t,i){var s=C;if(i.preselect!==undefined){if(i.preselect.ruleId!==undefined){var r=e.find("ruleId",i.preselect.ruleId);s.getSelectionModel().selectRow(r);s.getView().focusRow(r)}else{s.getSelectionModel().selectFirstRow()}}else{s.getSelectionModel().selectFirstRow()}k();Ext.getCmp("groupGrid-totalText"+b).setText(E(e))},clear:function(){Ext.getCmp("groupGrid-totalText"+b).setText("0 checks")},update:function(e){Ext.getCmp("groupGrid-totalText"+b).setText(E(e))},datachanged:function(e){Ext.getCmp("groupGrid-totalText"+b).setText(E(e))},exception:function(e){var t=C.getView();var i=e.events.exception.listeners[1].fn.arguments[4];if(i.status!=0){t.emptyText="Load failed: "+i.responseText}else{t.emptyText="HTTP Server Error: "+i.statusText}t.refresh()}}});var w=new Ext.menu.Menu({id:"groupChecklistMenu"+b,items:[{text:"Displayed title",hideOnClick:false,menu:{items:[{id:"groupFileMenu-title-groupItem"+b,text:"Group ID and title",checked:false,group:"titleType"+b,handler:function(e,t){var i=C.getColumnModel();var s=i.findColumnIndex("groupTitle");var r=i.findColumnIndex("ruleTitle");var n=i.findColumnIndex("groupId");var a=i.findColumnIndex("ruleId");var o=i.getColumnWidth(r);var l=i.getColumnWidth(a);i.setColumnWidth(s,o);i.setColumnWidth(n,l);C.titleColumnDataIndex="groupTitle";k();i.setHidden(r,true);i.setHidden(a,true);i.setHidden(s,false);i.setHidden(n,false);C.autoExpandColumn="groupTitle"+b}},{id:"groupFileMenu-title-ruleItem"+b,text:"Rule ID and title",checked:true,group:"titleType"+b,handler:function(e,t){var i=C.getColumnModel();var s=i.findColumnIndex("groupTitle");var r=i.findColumnIndex("ruleTitle");var n=i.findColumnIndex("groupId");var a=i.findColumnIndex("ruleId");var o=i.getColumnWidth(s);var l=i.getColumnWidth(n);i.setColumnWidth(r,o);i.setColumnWidth(a,l);C.titleColumnDataIndex="ruleTitle";k();i.setHidden(s,true);i.setHidden(n,true);i.setHidden(r,false);i.setHidden(a,false);C.autoExpandColumn="ruleTitle"+b}}]}},{text:"Export Results",disabled:false,iconCls:"sm-export-icon",hideOnClick:false,menu:{items:[{text:"CKL (Zip archive)",iconCls:"sm-export-icon",tooltip:"Download an archive with a checklist in DISA STIG Viewer format for each asset in the collection",handler:S}]}},"-"]});async function S(){try{const i=new JSZip;initProgress("Exporting checklists","Initializing...");let t=0;const s=c.length;for(const n of c){updateProgress(t/s,`Fetching CKL for ${n.name}`);updateStatusText(`Fetching checklist for ${n.name}: `,true);await window.oidcProvider.updateToken(10);const a=`${STIGMAN.Env.apiBase}/assets/${n.assetId}/checklists/${p.benchmarkId}/${C.sm_revisionStr}?format=ckl`;let e=await fetch(a,{method:"GET",headers:new Headers({Authorization:`Bearer ${window.oidcProvider.token}`})});const o=e.headers.get("content-disposition");const l=o.match(/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/)[1];console.log(l);const r=await e.blob();updateStatusText(`Fetched ${l}`);t++;i.file(l,r)}updateProgress(1,"Generating Zip archive...");updateStatusText("Generating Zip archive...");const r=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},e=>{updateProgress(e.percent/100,`Compressing ${e.currentFile}`)});updateProgress(1,"Done");updateStatusText("Done");saveAs(r,`${d.name}-${p.benchmarkId}.zip`)}catch(e){alert(`${e.message}\n${e.stack}`)}}var E=function(e){let t=c.length;var i=e.getCount();var s=0;var r=0;e.data.each(function(e,t,i){switch(e.data.autoCheckAvailable){case false:s++;break;case true:r++;break}});var n=" checks";if(i==1){n=" check"}var a=" assets";if(t==1){a=" asset"}return t+a+" assigned "+i+n+" ("+s+" Manual, "+r+" SCAP)"};const K=new Ext.ux.ExportButton({hasMenu:false,exportType:"grid",gridBasename:`${p.benchmarkId}`,iconCls:"sm-export-icon",text:"CSV"});var C=new Ext.grid.GridPanel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.adjacent,bottom:SM.Margin.adjacent,left:SM.Margin.edge},border:false,region:"north",sm_benchmarkId:p.benchmarkId,sm_revisionStr:"latest",filterState:"All",title:"Checklist",split:true,titleColumnDataIndex:"ruleTitle",store:y,stripeRows:true,listeners:{afterrender:{fn:function(e){var t="1"}}},sm:new Ext.grid.RowSelectionModel({singleSelect:true,listeners:{rowselect:{fn:function(e,t,i){O(i,b,p,C.sm_benchmarkId,C.sm_revisionStr)}}}}),view:new SM.ColumnFilters.GridView({forceFit:false,emptyText:"",holdPosition:true,lastHide:new Date,deferEmptyText:false,listeners:{filterschanged:function(e,t,i){y.filter(e.getFilterFns())}},getRowClass:function(e,t){var i=e.get("autoCheckAvailable");if(i===true){return"sm-scap-grid-item"}}}),columns:[{id:"cat"+b,header:"CAT",width:48,align:"left",dataIndex:"severity",fixed:true,sortable:true,renderer:renderSeverity,filter:{type:"values",comparer:SM.ColumnFilters.CompareFns.severity,renderer:SM.ColumnFilters.Renderers.severity}},{id:"groupId"+b,header:"Group",width:95,dataIndex:"groupId",sortable:true,hidden:true,hideable:false,align:"left",filter:{type:"string"}},{id:"ruleId"+b,header:"Rule Id",width:95,dataIndex:"ruleId",sortable:true,hideable:false,align:"left",filter:{type:"string"}},{id:"groupTitle"+b,header:"Group Title",width:80,dataIndex:"groupTitle",renderer:columnWrap,hidden:true,hideable:false,sortable:true,filter:{type:"string"}},{id:"ruleTitle"+b,header:"Rule Title",width:80,dataIndex:"ruleTitle",renderer:columnWrap,hideable:false,sortable:true,filter:{type:"string"}},{id:"oCnt"+b,header:'<div style="color:red;font-weight:bolder;" exportvalue="O">O</div>',width:32,align:"center",dataIndex:"oCnt",renderer:renderOpen,fixed:true,sortable:true},{id:"nfCnt"+b,header:'<div style="color:green;font-weight:bolder;" exportvalue="NF">NF</div>',width:32,align:"center",renderer:renderCounts,dataIndex:"nfCnt",fixed:true,sortable:true},{id:"naCnt"+b,header:'<div style="color:grey;font-weight:bolder;" exportvalue="NA">NA</div>',width:32,align:"center",renderer:renderCounts,dataIndex:"naCnt",fixed:true,sortable:true},{id:"nrCnt"+b,header:"NR",width:32,align:"center",renderer:renderOpen,dataIndex:"nrCnt",fixed:true,sortable:true},{id:"readyCnt"+b,header:'<img src=img/ready-16.png width=12 height=12 exportvalue="Submitted">',width:32,align:"center",dataIndex:"readyCnt",fixed:true,renderer:renderStatusCounts,sortable:true},{id:"rejectCnt"+b,header:'<img src=img/rejected-16.png width=12 height=12 exportvalue="Rejected">',width:32,align:"center",dataIndex:"rejectCnt",fixed:true,renderer:renderStatusCounts,sortable:true},{id:"approveCnt"+b,header:'<img src=img/star.svg width=12 height=12 exportvalue="Approved">',width:32,align:"center",dataIndex:"approveCnt",fixed:true,renderer:renderStatusCounts,sortable:true}],autoExpandColumn:"ruleTitle"+b,height:"50%",loadMask:true,tbar:new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"sm-checklist-icon",text:"Checklist",menu:w},"->",{xtype:"tbitem",html:'<div class="sm-toolbar-legend-box sm-scap-grid-item"></div>'},{xtype:"tbtext",text:" SCAP available",style:"margin-right: 15px;"}]}),bbar:new Ext.Toolbar({items:[{xtype:"tbbutton",iconCls:"icon-refresh",tooltip:"Reload this grid",width:20,handler:function(e){C.getStore().reload();Ext.getCmp("content-panel"+b).update("");P.getStore().removeAll(true);P.getView().refresh()}},{xtype:"tbseparator"},K,{xtype:"tbseparator"},{xtype:"tbtext",id:"groupGrid-totalText"+b,text:"",width:80}]})});var I=function(e,t){let i=C.getStore();i.proxy.setUrl(`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/checklists/${p.benchmarkId}/${e.revisionStr}`,true);i.load();T(p.benchmarkId,e.revisionStr,b);C.sm_revisionStr=e.revisionStr};async function T(s,r,n){try{let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${s}/revisions`,method:"GET"});let t=JSON.parse(e.response.responseText);let i=a(t,r,n);if(Ext.getCmp("revision-menuItem"+n)===undefined){Ext.getCmp("groupChecklistMenu"+n).addItem(i.menu)}C.setTitle(SM.he(i.activeRevisionLabel))}catch(e){alert(e.message)}}let a=function(s,r,n){let a={};var o={id:"revision-menuItem"+n,text:"Revisions",hideOnClick:false,menu:{items:[]}};for(var l=0;l<s.length;l++){let e=s[l];let t=new Date(e.benchmarkDate);let i={id:`revision-submenu${e.benchmarkId}-${e.version}-${e.release}${n}`,text:SM.he(`Version ${e.version} Release ${e.release} (${t.format("j M Y")})`),revisionStr:e.revisionStr,group:"revision-submenu-group"+n,handler:I};if(i.revisionStr==r||r==="latest"&&l===0){i.checked=true;a.activeRevisionLabel=i.text}else{i.checked=false}o.menu.items.push(i)}a.menu=o;return a};function k(){y.filter(C.getView().getFilterFns())}var A=Ext.data.Record.create([{name:"assetId",type:"string"},,{name:"assetName",type:"string"},{name:"ruleId",type:"string"},{name:"result",type:"string"},{name:"detail",type:"string"},{name:"comment",type:"string"},,{name:"autoResult",type:"boolean"},{name:"userId",type:"string"},{name:"username",type:"string"},{name:"ts",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"status",type:"string",mapping:"status?.label"}]);var M=new Ext.data.JsonStore({storeId:"reviewsStore"+b,sortInfo:{field:"assetName",direction:"ASC"},root:"",fields:A,listeners:{save:function(e,t,i){var s=Ext.getCmp("reviewsGrid"+b);$();Ext.getBody().unmask()}},idProperty:"assetId"});var _=new Ext.ux.grid.RowEditor({saveText:"Update",height:200,listeners:{beforeedit:function(e,t){}}});var R=new Ext.grid.ColumnModel({columns:[{id:"status"+b,header:"Status",width:50,fixed:true,dataIndex:"status",sortable:true,renderer:renderStatuses,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.status}},{id:"target"+b,header:"Asset",width:50,dataIndex:"assetName",sortable:true,align:"left",filter:{type:"string"}},{id:"Result"+b,header:'<span exportvalue="Result">Result<i class= "fa fa-question-circle sm-question-circle"></i></span>',width:70,fixed:true,dataIndex:"result",editor:new Ext.form.ComboBox({id:"reviewsGrid-editor-resultCombo"+b,mode:"local",forceSelection:true,autoSelect:true,editable:false,store:new Ext.data.SimpleStore({fields:["result","resultStr"],data:[["pass","NF"],["notapplicable","NA"],["fail","O"]]}),valueField:"result",displayField:"resultStr",monitorValid:false,listeners:{select:function(e,t,i){if(e.startValue!==e.value){e.fireEvent("blur")}else{console.log("No Change")}}},triggerAction:"all"}),renderer:function(e){let t;switch(e){case"informational":t='<div style="color:red;font-weight:bolder;text-align:center">I</div>';break;case"fail":t='<div style="color:red;font-weight:bolder;text-align:center">O</div>';break;case"pass":t='<div style="color:green;font-weight:bolder;text-align:center">NF</div>';break;case"notapplicable":t='<div style="color:grey;font-weight:bolder;text-align:center">NA</div>';break}return SM.styledEmptyRenderer(t)},sortable:true,filter:{type:"values",renderer:SM.ColumnFilters.Renderers.result}},{id:"Detail"+b,header:'<span exportvalue="Detail">Detail<i class= "fa fa-question-circle sm-question-circle"></i></span>',width:100,dataIndex:"detail",renderer:function(e){return columnWrap(SM.styledEmptyRenderer(e))},sortable:true,filter:{type:"string"},editor:new Ext.form.TextArea({id:"reviewsGrid-editor-detail"+b,grow:true,listeners:{focus:function(e){P.getEl().set({onselectstart:"return true;"})},blur:function(e){P.getEl().set({onselectstart:"return false;"})}}})},{id:"Comment"+b,header:'<span exportvalue="Comment">Comment<i class= "fa fa-question-circle sm-question-circle"></i></span>',width:100,dataIndex:"comment",renderer:function(e){return columnWrap(SM.styledEmptyRenderer(e))},filter:{type:"string"},editor:new Ext.form.TextArea({id:"reviewsGrid-editor-comment"+b,grow:true,listeners:{focus:function(e){P.getEl().set({onselectstart:"return true;"})},blur:function(e){P.getEl().set({onselectstart:"return false;"})}}}),sortable:true},{id:"userName"+b,header:"User",width:100,dataIndex:"username",fixed:50,sortable:true,filter:{type:"values"}}],isCellEditable:function(e,t){var i=M.getAt(t);if(!i.data.result&&this.getDataIndex(e)!=="result"){return false}switch(this.getDataIndex(e)){case"result":return true;case"detail":if(n.detailEnabled==="always"){return true}if(n.detailEnabled==="findings"){return i.data.result==="fail"}case"comment":if(n.commentEnabled==="always"){return true}if(n.commentEnabled==="findings"){return i.data.result==="fail"}}return Ext.grid.ColumnModel.prototype.isCellEditable.call(this,e,t)}});function N(){const e=p.collectionGrant>=s.minGrant;const t=s.canAccept;return e&&t}const X=new Ext.ux.ExportButton({hasMenu:false,exportType:"grid",gridBasename:`${p.benchmarkId}-Rule`,iconCls:"sm-export-icon",text:"CSV"});var P=new Ext.grid.EditorGridPanel({cls:"sm-round-panel",margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.adjacent,left:SM.Margin.adjacent},border:false,region:"center",layout:"fit",id:"reviewsGrid"+b,title:"Reviews",store:M,stripeRows:true,colModel:R,updateGroupStore:function(e){let t=e.getStore().getRange();let i=e.currentChecklistRecord;let s={oCnt:0,nfCnt:0,naCnt:0,nrCnt:0,approveCnt:0,rejectCnt:0,readyCnt:0};for(const r of t){switch(r.data.result){case"pass":s.nfCnt++;break;case"fail":s.oCnt++;break;case"notapplicable":s.naCnt++;break;default:s.nrCnt++;break}switch(r.data.status){case"submitted":s.readyCnt++;break;case"accepted":s.approveCnt++;break;case"rejected":s.rejectCnt++;break}}for(const n of Object.keys(s)){i.data[n]=s[n]}i.commit()},sm:new Ext.grid.RowSelectionModel({singleSelect:false,id:"reviewsSm"+b,listeners:{rowselect:function(e,t,i){if(e.getCount()==1){H.grid.enable();U(i)}else{H.store.removeAll();H.grid.disable();J()}$()},rowdeselect:function(e,t,i){if(e.getCount()==1){selectedRecord=e.getSelected();H.grid.enable();U(selectedRecord)}else{H.store.removeAll();H.grid.disable();J()}$()}}}),listeners:{afterrender:function(e){e.getEl().set({onselectstart:"return false;"})},afteredit:async function(s){try{let e={},t;if(s.record.data.status){e[s.field]=s.value;if(s.record.data.autoResult&&s.originalValue!==s.value){e.autoResult=false}t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/reviews/${s.record.data.assetId}/${s.record.data.ruleId}`,method:"PATCH",jsonData:e})}else{e={result:s.record.data.result,detail:null,comment:null,autoResult:false,status:"saved"};t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/reviews/${s.record.data.assetId}/${s.record.data.ruleId}`,method:"PUT",jsonData:e})}let i=JSON.parse(t.response.responseText);const r=s.grid.store.reader.recordType.prototype.fields;const n=r.items;const a=r.length;const o=s.grid.store.reader.extractValues(i,n,a);s.record.data=o;s.record.commit();s.grid.getSelectionModel().onRefresh();U(s.grid.getStore().getById(i.assetId));$();s.grid.updateGroupStore(s.grid)}catch(s){alert(s.message)}}},view:new SM.ColumnFilters.GridView({forceFit:true,holdPosition:true,autoFill:true,emptyText:"No data to display.",deferEmptyText:false,listeners:{filterschanged:function(e,t,i){M.filter(e.getFilterFns())},refresh:function(t){const i=t.grid.getColumnModel().columns;for(let e=0;e<i.length;e++){const s=t.getHeaderCell(e).getElementsByClassName("fa")[0];if(s){const r=i[e].id.split("-")[0];new Ext.ToolTip({target:s,showDelay:0,dismissDelay:0,autoWidth:true,tpl:SM[`${r}TipTpl`],data:n})}}}}}),tbar:new Ext.Toolbar({items:[{xtype:"tbbutton",disabled:true,iconCls:"sm-star-icon-16",id:"reviewsGrid-approveButton"+b,text:"Accept",hidden:!N(),handler:function(e){var t=P.getSelectionModel();j(P,t,"accepted")}},{xtype:"tbseparator",hidden:!N()},{xtype:"tbbutton",disabled:true,icon:"img/ready-16.png",id:"reviewsGrid-submitButton"+b,text:"Submit",handler:function(e){var t=P.getSelectionModel();j(P,t,"submitted")}},{xtype:"tbseparator"},{xtype:"tbbutton",disabled:true,icon:"img/disk-16.png",id:"reviewsGrid-unsubmitButton"+b,text:"Unsubmit",handler:function(e){var t=P.getSelectionModel();j(P,t,"saved")}}]}),bbar:new Ext.Toolbar({items:[X,"->",new SM.RowCountTextItem({store:M})]}),loadMask:true,emptyText:"No data to display"});P.on("beforeedit",V,this);function D(e,t){if(e===d.collectionId){n=t;$()}}SM.Dispatcher.addListener("statussettingschanged",F);function F(e,t){if(e===d.collectionId){apStatusSettings=t;$()}}SM.Dispatcher.addListener("fieldsettingschanged",D);async function B(s,r,n,a){try{let e=Ext.getCmp("content-panel"+b);let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/stigs/${s}/revisions/${r}/rules/${n}`,method:"GET",params:{projection:["detail","ccis","checks","fixes"]}});let i=JSON.parse(t.response.responseText);e.update(i);e.setTitle("Rule for Group "+SM.he(a))}catch(e){alert(e.message)}}async function G(n,a){try{let e=Ext.getCmp("reviewsGrid"+b);let t=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${n}/reviews`,method:"GET",params:{rules:"all",ruleId:a.data.ruleId}});let i=JSON.parse(t.response.responseText);let s={};for(const o of i){s[o.assetId]=o}let r=f.map(e=>{if(!s[e.assetId]){return{...e,...{ruleId:a.data.ruleId}}}else{return{...e,...s[e.assetId]}}});e.getStore().loadData(r);e.setTitle(`Reviews of ${SM.he(a.data.ruleId)}`);e.currentChecklistRecord=a;X.gridBasename=`${p.benchmarkId}-${a.data.ruleId}`}catch(e){alert(e.message)}}function O(e,t,i,s,r){B(s,r,e.data.ruleId,e.data.groupId);G(i.collectionId,e);P.getSelectionModel().clearSelections()}function L(e,t,i){if(!e)return false;if(n.detailRequired==="always"&&!t)return false;if(n.detailRequired==="findings"&&e==="fail"&&!t)return false;if(n.commentRequired==="always"&&!i)return false;if(n.commentRequired==="findings"&&e==="fail"&&!i)return false;return true}function $(){const e=P.getSelectionModel();const t=Ext.getCmp("reviewsGrid-approveButton"+b);const s=Ext.getCmp("reviewsGrid-submitButton"+b);const r=Ext.getCmp("reviewsGrid-unsubmitButton"+b);const n=Ext.getCmp("feedback-panel"+b);const a=Ext.getCmp("resources-tab-panel"+b);const o=e.getSelections();const l=o.length;let d=true;let c=true;let f=true;let u=true;if(l===0){d=false;c=false;f=false;u=false}else if(l===1){const p=o[0];if(!p.data.status){d=false;c=false;f=false;u=false}else{const m=p.data.status;switch(m){case"saved":approveBtnDisabled=true;if(L(p.data.result,p.data.detail,p.data.comment)){d=false;c=true;f=false;u=false}else{d=false;c=false;f=false;u=false}break;case"submitted":d=true;c=false;f=true;u=true;break;case"rejected":d=true;c=true;f=true;u=true;break;case"accepted":d=false;c=false;f=true;u=false;break}}}else{const g={unsaved:0,savedComplete:0,saved:0,submitted:0,rejected:0,accepted:0};for(i=0;i<o.length;i++){if(!o[i].data.status){g.unsaved++;break}const m=o[i].data.status;if(m==="saved"){if(L(o[i].data.result,o[i].data.detail,o[i].data.comment)){g.savedComplete++}else{g.saved++}}else{g[m]++}}d=(g.submitted||g.rejected)&&(!g.unsaved&&!g.saved&&!g.savedComplete)&&g.accepted!==l;c=(g.savedComplete||g.submitted||g.accepted||g.rejected)&&(!g.unsaved&&!g.saved)&&g.submitted!==l;f=(g.submitted||g.accepted||g.rejected)&&(!g.unsaved&&!g.saved);u=g.submitted&&(!g.unsaved&&!g.saved&&!g.savedComplete&&!g.accepted&&!g.rejected)}t.setDisabled(!d);s.setDisabled(!c);r.setDisabled(!f);n.setDisabled(!u);const h=a.getActiveTab();if(!u&&h.itemId==="reject"){a.setActiveTab("history")}}async function j(i,s,r){try{const n=s.getSelections();const a=[];let e,t;for(e=0,t=n.length;e<t;e++){const o=n[e];Ext.getBody().mask(`Updating ${e+1}/${t} Reviews`);try{const e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/reviews/${o.data.assetId}/${o.data.ruleId}`,method:"PATCH",jsonData:{status:r}});a.push({success:true,result:e})}catch(e){a.push({success:false,result:e})}}for(e=0,t=n.length;e<t;e++){if(a[e].success){n[e].data.status=r;n[e].commit()}}if(n.length===1){U(n[0])}i.updateGroupStore(i);$()}catch(e){alert(e.message)}finally{Ext.getBody().unmask()}}function V(e){if(e.field=="result"){var t=e.grid.getColumnModel().getCellEditor(e.column,e.row);t.gridRecord=e.record}}let t=SM.RuleContentTpl;async function U(e){let t;try{t=Ext.getCmp("resources-tab-panel"+b).getActiveTab();const i=Ext.getCmp("attachmentsGrid"+b);i.assetId=e.data.assetId;i.ruleId=e.data.ruleId;let s=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/reviews/${e.data.assetId}/${e.data.ruleId}`,method:"GET",params:{projection:["history","metadata"]}});if(s.response.status===200){let e=JSON.parse(s.response.responseText);let t={comment:e.comment,autoResult:e.autoResult,rejectText:e.rejectText,result:e.result,detail:e.detail,status:e.status,ts:e.ts,touchTs:e.touchTs,userId:e.userId,username:e.username};e.history.push(t);Ext.getCmp("historyGrid"+b).getStore().loadData(e.history);const r=Ext.getCmp("rejectFormPanel"+b);r.getForm().setValues(e);J();i.loadArtifacts()}}catch(e){alert(e.message)}finally{t.getEl().unmask()}}var H=new Sm_HistoryData(b);const Y=new SM.Attachments.Grid({id:"attachmentsGrid"+b,title:"Attachments",collectionId:p.collectionId});var z=new Ext.Panel({layout:"fit",id:"rejectOtherPanel"+b,title:"Rejected review feedback",bodyCssClass:"sm-background-blue",padding:"5",flex:50,items:[{xtype:"textarea",id:"rejectTextArea"+b,enableKeyEvents:true,emptyText:"Provide feedback explaining this rejection.",name:"rejectText",listeners:{keyup:J}}]});var W=new Ext.form.FormPanel({baseCls:"x-plain",id:"rejectFormPanel"+b,cls:"sm-background-blue",labelWidth:95,monitorValid:false,items:[{layout:"hbox",anchor:"100% -1",padding:"10",baseCls:"x-plain",border:false,layoutConfig:{align:"stretch"},items:[z]}],buttons:[{text:"Reject review with this feedback",disabled:true,id:"rejectSubmitButton"+b,iconCls:"sm-rejected-icon",reviewsGrid:P,hidden:!N(),handler:q}]});async function q(){try{Ext.getBody().mask("Rejecting");const t="rejected";const s=W.getForm().getFieldValues();const r=P.getSelectionModel().getSelections();const n=[];for(const a of r){n.push(Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/collections/${p.collectionId}/reviews/${a.data.assetId}/${a.data.ruleId}`,method:"PATCH",jsonData:{status:{label:t,text:s.rejectText}}}))}let e=await Promise.allSettled(n);for(i=0,l=r.length;i<l;i++){if(e[i].status==="fulfilled"){r[i].data.status=t;r[i].commit()}}P.updateGroupStore(P);$();Ext.getBody().unmask()}catch(e){alert(e.message)}finally{}}function J(){var e=Ext.getCmp("rejectSubmitButton"+b);var t=Ext.getCmp("rejectTextArea"+b);var i=P.getSelectionModel().getCount();if(i>1){e.setText("Reject "+i+" reviews with this feedback")}else{e.setText("Reject review with this feedback")}if(!t.getValue()){e.disable()}else{e.enable()}}var Z=[{region:"west",layout:"border",width:"40%",minWidth:330,border:false,split:true,collapsible:false,id:"west-panel"+b,items:[C,{region:"center",xtype:"panel",cls:"sm-round-panel",margins:{top:SM.Margin.adjacent,right:SM.Margin.adjacent,bottom:SM.Margin.bottom,left:SM.Margin.edge},border:false,split:true,collapsible:false,padding:20,autoScroll:true,id:"content-panel"+b,title:"Rule",tpl:t}]},{region:"center",layout:"border",border:false,split:true,collapsible:false,id:"center-panel"+b,items:[P,{region:"south",xtype:"tabpanel",cls:"sm-round-panel",style:{"background-color":"#eeeeee"},margins:{top:SM.Margin.adjacent,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.adjacent},border:true,id:"resources-tab-panel"+b,height:"33%",split:true,collapsible:false,activeTab:"history",items:[{title:"History",itemId:"history",layout:"fit",id:"history-tab"+b,items:H.grid},{title:"Attachments",id:"attachment-panel"+b,layout:"fit",items:Y},{title:"Reject",itemId:"reject",iconCls:"sm-rejected-icon",disabled:true,id:"feedback-panel"+b,layout:"fit",items:W}]}]}];let r=new Ext.Panel({id:"collection-review-tab"+b,iconCls:"sm-collection-tab-icon",title:"",collectionId:p.collectionId,benchmarkId:p.benchmarkId,collectionName:d.name,stigName:p.benchmarkId,closable:true,layout:"border",border:false,items:Z,sm_TabType:"asset_review",sm_tabMode:"ephemeral",sm_treePath:x,listeners:{beforedestroy:()=>{SM.Dispatcher.removeListener("fieldsettingschanged",D);SM.Dispatcher.removeListener("statussettingschanged",F)}}});r.updateTitle=function(){r.setTitle(`${this.sm_tabMode==="ephemeral"?"<i>":""}${SM.he(this.collectionName)} / ${SM.he(this.stigName)}${this.sm_tabMode==="ephemeral"?"</i>":""}`)};r.makePermanent=function(){r.sm_tabMode="permanent";r.updateTitle.call(r)};let o=Ext.getCmp("main-tab-panel");let u=o.items.findIndex("sm_tabMode","ephemeral");let h;if(u!==-1){let e=o.items.itemAt(u);o.remove(e);h=o.insert(u,r)}else{h=o.add(r)}h.updateTitle.call(h);h.show();C.getStore().load({preselect:{ruleId:m,assetId:g}});T(p.benchmarkId,"latest",b)}catch(e){alert(e.message)}}function renderOpen(e,t,i,s,r,n){var a=e;if(e>0){t.css="sm-cell-red"}else{a="-";t.css="sm-cell-green"}return a}function renderCounts(e,t,i,s,r,n){var a=e;if(e==0){a="-"}t.css="sm-cell-grey";return a}function renderStatusCounts(e,t,i,s,r,n){var a=e;if(e==0){a="-"}t.css="sm-cell-status";return a}Ext.ux.ExportButton=Ext.extend(Ext.Button,{constructor:function(e){if(e.hasMenu==true){Ext.applyIf(e,{menu:new Ext.menu.Menu({items:[{text:"Grid data (.csv)",iconCls:"sm-table-icon",exportType:"grid",exportFormat:"csv",href:"#"},{text:"Store data (.csv)",iconCls:"sm-database-icon",exportType:"store",exportFormat:"csv",href:"#"}]})})}this.gridBasename=e.gridBasename||"grid_export",this.gridSource=e.grid||undefined,this.storeBasename=e.storeBasename||"store_export",this.storeSource=e.store||undefined,this.exportType=e.exportType||"grid";this.exportFormat=e.exportFormat||"csv";Ext.ux.ExportButton.superclass.constructor.call(this,e);if(this.menu){this.menu.addListener("itemclick",this.menuItemClick,this);this.menu.addListener("beforeshow",this.menuBeforeShow,this)}else{this.addListener("click",this.buttonClick,this)}},onRender:function(e,t){if(this.gridSource==undefined){this.gridSource=this.findParentByType("grid")}if(this.storeSource==undefined&&this.gridSource!=undefined){this.storeSource=this.gridSource.store}Ext.ux.ExportButton.superclass.onRender.call(this,e,t)},buttonClick:function(e,t){let i="\ufeff";let s="";if(e.exportFormat=="csv"){if(e.exportType=="grid"){i+=this.gridToCsv(this.gridSource);s=this.gridBasename+".csv"}else if(e.exportType=="store"){i+=this.storeToCsv(this.storeSource);s=this.storeBasename+".csv"}}let r=new Blob([i],{type:"text/csv;charset=utf-8"});if(window.navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(r,s)}else{let e=window.document.createElement("a");e.style.display="none";e.href=window.URL.createObjectURL(r);e.download=s;document.body.appendChild(e);e.click();document.body.removeChild(e)}},menuBeforeShow:function(e){e.items.each(function(e){switch(e.exportType){case"grid":e.setDisabled(this.gridSource==undefined);break;case"store":e.setDisabled(this.storeSource==undefined);break}},this)},menuItemClick:function(t){let i="\ufeff";let s="";if(t.exportFormat=="csv"){if(t.exportType=="grid"){i+=this.gridToCsv(this.gridSource);s=this.gridBasename+".csv"}else if(t.exportType=="store"){i+=this.storeToCsv(this.storeSource);s=this.storeBasename+".csv"}}if(window.navigator.msSaveOrOpenBlob){let e=new Blob([i],{type:"text/csv;charset=utf-8"});navigator.msSaveOrOpenBlob(e,s)}else{t.el.dom.setAttribute("download",s);let e=encodeURI("data:text/csv;charset=utf-8,"+i);t.el.dom.setAttribute("href",e);t.el.dom.setAttribute("target","_self")}},gridToCsv:function(e){let t="";let r=e.getView();let i=e.store;let n=e.getColumnModel().getColumnsBy(function(e){return true});let a=["Marking"];let o=[];for(let s=0;s<n.length;s++){let i=n[s];if(i.dataIndex!=""&&i.header!=""&&!i.hidden){let e=document.createElement("html");e.innerHTML=i.header;let t=e.querySelector("[exportvalue]");if(t!=null){a.push('"'+t.getAttribute("exportvalue")+'"')}else{a.push('"'+i.header+'"')}o.push(s)}}t+=a.join(",")+"\n";let s=i.getCount();for(let e=0;e<s;e++){let i=r.getRow(e).getElementsByTagName("tr")[0].cells;let s=[`(${appConfig.classification})`];for(let t=0;t<o.length;t++){let e=i[o[t]].querySelector("[exportvalue]");if(e!=null){s.push('"'+e.getAttribute("exportvalue")+'"')}else{let e='"'+i[o[t]].firstChild.textContent.replace(/"/g,'""')+'"';s.push(e)}}t+=s.join(",")+"\n"}return t},storeToCsv:function(e){let t="";let i=[];let n=[];e.fields.each(function(e){i.push('"'+e.name+'"');n.push(e.name)});t+=i.join(",")+"\n";e.each(function(s){let r=[];for(let i=0;i<n.length;i++){let e=n[i];let t="";switch(Object.prototype.toString.call(s.data[e])){case"[object String]":t='"'+s.data[e]+'"';break;case"[object Number]":t=s.data[e];break;case"[object Date]":t=s.data[e].format("Y-m-d H:i:s");break;default:t=s.data[e];break}r.push(t)}t+=r.join(",")+"\n"});return t}});Ext.reg("exportbutton",Ext.ux.ExportButton);!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=e()}}(function(){return function n(a,o,l){function d(i,e){if(!o[i]){if(!a[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(c)return c(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var r=o[i]={exports:{}};a[i][0].call(r.exports,function(e){var t=a[i][1][e];return d(t||e)},r,r.exports,n,a,o,l)}return o[i].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)d(l[e]);return d}({1:[function(e,t,i){"use strict";var h=e("./utils"),u=e("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,s,r,n,a,o,l=[],d=0,c=e.length,f=c,u="string"!==h.getTypeOf(e);d<e.length;)f=c-d,s=u?(t=e[d++],i=d<c?e[d++]:0,d<c?e[d++]:0):(t=e.charCodeAt(d++),i=d<c?e.charCodeAt(d++):0,d<c?e.charCodeAt(d++):0),r=t>>2,n=(3&t)<<4|i>>4,a=1<f?(15&i)<<2|s>>6:64,o=2<f?63&s:64,l.push(p.charAt(r)+p.charAt(n)+p.charAt(a)+p.charAt(o));return l.join("")},i.decode=function(e){var t,i,s,r,n,a,o=0,l=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var c,f=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===p.charAt(64)&&f--,e.charAt(e.length-2)===p.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(c=u.uint8array?new Uint8Array(0|f):new Array(0|f);o<e.length;)t=p.indexOf(e.charAt(o++))<<2|(r=p.indexOf(e.charAt(o++)))>>4,i=(15&r)<<4|(n=p.indexOf(e.charAt(o++)))>>2,s=(3&n)<<6|(a=p.indexOf(e.charAt(o++))),c[l++]=t,64!==n&&(c[l++]=i),64!==a&&(c[l++]=s);return c}},{"./support":30,"./utils":32}],2:[function(e,t,i){"use strict";var s=e("./external"),r=e("./stream/DataWorker"),n=e("./stream/DataLengthProbe"),a=e("./stream/Crc32Probe");n=e("./stream/DataLengthProbe");function o(e,t,i,s,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=s,this.compressedContent=r}o.prototype={getContentWorker:function(){var e=new r(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new n("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new r(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,i){return e.pipe(new a).pipe(new n("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new n("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){"use strict";var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(e){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){"use strict";var s=e("./utils");var o=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==s.getTypeOf(e)?function(e,t,i,s){var r=o,n=s+i;e^=-1;for(var a=s;a<n;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}(0|t,e,e.length,0):function(e,t,i,s){var r=o,n=s+i;e^=-1;for(var a=s;a<n;a++)e=e>>>8^r[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,i){"use strict";i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){"use strict";var s=null;s="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:s}},{lie:37}],7:[function(e,t,i){"use strict";var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),n=e("./utils"),a=e("./stream/GenericWorker"),o=s?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",n.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(n.transformTo(o,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},i.compressWorker=function(e){return new l("Deflate",e)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){"use strict";function A(e,t){var i,s="";for(i=0;i<t;i++)s+=String.fromCharCode(255&e),e>>>=8;return s}function s(e,t,i,s,r,n){var a,o,l=e.file,d=e.compression,c=n!==_.utf8encode,f=M.transformTo("string",n(l.name)),u=M.transformTo("string",_.utf8encode(l.name)),h=l.comment,p=M.transformTo("string",n(h)),m=M.transformTo("string",_.utf8encode(h)),g=u.length!==l.name.length,x=m.length!==h.length,b="",v="",y="",w=l.dir,S=l.date,E={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(E.crc32=e.crc32,E.compressedSize=e.compressedSize,E.uncompressedSize=e.uncompressedSize);var C=0;t&&(C|=8),c||!g&&!x||(C|=2048);var I=0,T=0;w&&(I|=16),"UNIX"===r?(T=798,I|=function(e,t){var i=e;return e||(i=t?16893:33204),(65535&i)<<16}(l.unixPermissions,w)):(T=20,I|=function(e){return 63&(e||0)}(l.dosPermissions)),a=S.getUTCHours(),a<<=6,a|=S.getUTCMinutes(),a<<=5,a|=S.getUTCSeconds()/2,o=S.getUTCFullYear()-1980,o<<=4,o|=S.getUTCMonth()+1,o<<=5,o|=S.getUTCDate(),g&&(v=A(1,1)+A(R(f),4)+u,b+="up"+A(v.length,2)+v),x&&(y=A(1,1)+A(R(p),4)+m,b+="uc"+A(y.length,2)+y);var k="";return k+="\n\0",k+=A(C,2),k+=d.magic,k+=A(a,2),k+=A(o,2),k+=A(E.crc32,4),k+=A(E.compressedSize,4),k+=A(E.uncompressedSize,4),k+=A(f.length,2),k+=A(b.length,2),{fileRecord:N.LOCAL_FILE_HEADER+k+f+b,dirRecord:N.CENTRAL_FILE_HEADER+A(T,2)+k+A(p.length,2)+"\0\0\0\0"+A(I,4)+A(s,4)+f+b+p}}var M=e("../utils"),r=e("../stream/GenericWorker"),_=e("../utf8"),R=e("../crc32"),N=e("../signature");function n(e,t,i,s){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=s,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}M.inherits(n,r),n.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,s=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,r.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-s-1))/i:100}}))},n.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=s(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},n.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,i=s(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),t)this.push({data:function(e){return N.DATA_DESCRIPTOR+A(e.crc32,4)+A(e.compressedSize,4)+A(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},n.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i=this.bytesWritten-e,s=function(e,t,i,s,r){var n=M.transformTo("string",r(s));return N.CENTRAL_DIRECTORY_END+"\0\0\0\0"+A(e,2)+A(e,2)+A(t,4)+A(i,4)+A(n.length,2)+n}(this.dirRecords.length,i,e,this.zipComment,this.encodeFileName);this.push({data:s,meta:{percent:100}})},n.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},n.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},n.prototype.error=function(e){var t=this._sources;if(!r.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(e){}return!0},n.prototype.lock=function(){r.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=n},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){"use strict";var d=e("../compressions"),s=e("./ZipFileWorker");i.generateWorker=function(e,a,t){var o=new s(a.streamFiles,t,a.platform,a.encodeFileName),l=0;try{e.forEach(function(e,t){l++;var i=function(e,t){var i=e||t,s=d[i];if(!s)throw new Error(i+" is not a valid compression method !");return s}(t.options.compression,a.compression),s=t.options.compressionOptions||a.compressionOptions||{},r=t.dir,n=t.date;t._compressWorker(i,s).withStreamInfo("file",{name:e,dir:r,date:n,comment:t.comment||"",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(o)}),o.entriesCount=l}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){"use strict";function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new s;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.2.0",s.loadAsync=function(e,t){return(new s).loadAsync(e,t)},s.external=e("./external"),t.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){"use strict";var s=e("./utils"),r=e("./external"),o=e("./utf8"),l=(s=e("./utils"),e("./zipEntries")),n=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function c(s){return new r.Promise(function(e,t){var i=s.decompressed.getContentWorker().pipe(new n);i.on("error",function(e){t(e)}).on("end",function(){i.streamInfo.crc32!==s.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):e()}).resume()})}t.exports=function(e,n){var a=this;return n=s.extend(n||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),d.isNode&&d.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",e,!0,n.optimizedBinaryString,n.base64).then(function(e){var t=new l(n);return t.load(e),t}).then(function(e){var t=[r.Promise.resolve(e)],i=e.files;if(n.checkCRC32)for(var s=0;s<i.length;s++)t.push(c(i[s]));return r.Promise.all(t)}).then(function(e){for(var t=e.shift(),i=t.files,s=0;s<i.length;s++){var r=i[s];a.file(r.fileNameStr,r.decompressed,{binary:!0,optimizedBinaryString:!0,date:r.date,dir:r.dir,comment:r.fileCommentStr.length?r.fileCommentStr:null,unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions,createFolders:n.createFolders})}return t.zipComment.length&&(a.comment=t.zipComment),a})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){"use strict";var s=e("../utils"),r=e("../stream/GenericWorker");function n(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}s.inherits(n,r),n.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},n.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){"use strict";var r=e("readable-stream").Readable;function s(e,t,i){r.call(this,t),this._helper=e;var s=this;e.on("data",function(e,t){s.push(e)||s._helper.pause(),i&&i(t)}).on("error",function(e){s.emit("error",e)}).on("end",function(){s.push(null)})}e("../utils").inherits(s,r),s.prototype._read=function(){this._helper.resume()},t.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){"use strict";function n(e,t,i){var s,r=d.getTypeOf(t),n=d.extend(i||{},f);n.date=n.date||new Date,null!==n.compression&&(n.compression=n.compression.toUpperCase()),"string"==typeof n.unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(e=x(e)),n.createFolders&&(s=g(e))&&b.call(this,s,!0);var a="string"===r&&!1===n.binary&&!1===n.base64;i&&void 0!==i.binary||(n.binary=!a),(t instanceof u&&0===t.uncompressedSize||n.dir||!t||0===t.length)&&(n.base64=!1,n.binary=!0,t="",n.compression="STORE",r="string");var o=null;o=t instanceof u||t instanceof c?t:p.isNode&&p.isStream(t)?new m(e,t):d.prepareContent(e,t,n.binary,n.optimizedBinaryString,n.base64);var l=new h(e,o,n);this.files[e]=l}var r=e("./utf8"),d=e("./utils"),c=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),f=e("./defaults"),u=e("./compressedObject"),h=e("./zipObject"),o=e("./generate"),p=e("./nodejsUtils"),m=e("./nodejs/NodejsStreamInputAdapter"),g=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},x=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},b=function(e,t){return t=void 0!==t?t:f.createFolders,e=x(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function l(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var s={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,s;for(t in this.files)this.files.hasOwnProperty(t)&&(s=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,s))},filter:function(i){var s=[];return this.forEach(function(e,t){i(e,t)&&s.push(t)}),s},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,i),this;if(l(e)){var s=e;return this.filter(function(e,t){return!t.dir&&s.test(e)})}var r=this.files[this.root+e];return r&&!r.dir?r:null},folder:function(i){if(!i)return this;if(l(i))return this.filter(function(e,t){return t.dir&&i.test(e)});var e=this.root+i,t=b.call(this,e),s=this.clone();return s.root=t.name,s},remove:function(i){i=this.root+i;var e=this.files[i];if(e||("/"!==i.slice(-1)&&(i+="/"),e=this.files[i]),e&&!e.dir)delete this.files[i];else for(var t=this.filter(function(e,t){return t.name.slice(0,i.length)===i}),s=0;s<t.length;s++)delete this.files[t[s].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=d.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");d.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var s=i.comment||this.comment||"";t=o.generateWorker(this,i,s)}catch(e){(t=new c("error")).error(e)}return new a(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=s},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){"use strict";var s=e("./DataReader");function r(e){s.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,s),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),r=e.charCodeAt(3),n=this.length-4;0<=n;--n)if(this.data[n]===t&&this.data[n+1]===i&&this.data[n+2]===s&&this.data[n+3]===r)return n-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),r=e.charCodeAt(3),n=this.readData(4);return t===n[0]&&i===n[1]&&s===n[2]&&r===n[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){"use strict";var s=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return s.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,i){"use strict";var s=e("./Uint8ArrayReader");function r(e){s.call(this,e)}e("../utils").inherits(r,s),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){"use strict";var s=e("./DataReader");function r(e){s.call(this,e)}e("../utils").inherits(r,s),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){"use strict";var s=e("./ArrayReader");function r(e){s.call(this,e)}e("../utils").inherits(r,s),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){"use strict";var s=e("../utils"),r=e("../support"),n=e("./ArrayReader"),a=e("./StringReader"),o=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=s.getTypeOf(e);return s.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new o(e):r.uint8array?new l(s.transformTo("uint8array",e)):new n(s.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){"use strict";i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){"use strict";var s=e("./GenericWorker"),r=e("../utils");function n(e){s.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(n,s),n.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){"use strict";var s=e("./GenericWorker"),r=e("../crc32");function n(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(n,s),n.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){"use strict";var s=e("../utils"),r=e("./GenericWorker");function n(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}s.inherits(n,r),n.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){"use strict";var s=e("../utils"),r=e("./GenericWorker");function n(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=s.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}s.inherits(n,r),n.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){"use strict";function s(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=s},{}],29:[function(e,t,i){"use strict";var l=e("../utils"),r=e("./ConvertWorker"),n=e("./GenericWorker"),d=e("../base64"),s=e("../support"),a=e("../external"),o=null;if(s.nodestream)try{o=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,o){return new a.Promise(function(t,i){var s=[],r=e._internalType,n=e._outputType,a=e._mimeType;e.on("data",function(e,t){s.push(e),o&&o(t)}).on("error",function(e){s=[],i(e)}).on("end",function(){try{var e=function(e,t,i){switch(e){case"blob":return l.newBlob(l.transformTo("arraybuffer",t),i);case"base64":return d.encode(t);default:return l.transformTo(e,t)}}(n,function(e,t){var i,s=0,r=null,n=0;for(i=0;i<t.length;i++)n+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(n),i=0;i<t.length;i++)r.set(t[i],s),s+=t[i].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(r,s),a);t(e)}catch(e){i(e)}s=[]}).resume()})}function f(e,t,i){var s=t;switch(t){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=t,this._mimeType=i,l.checkSupport(s),this._worker=e.pipe(new r(s)),e.lock()}catch(e){this._worker=new n("error"),this._worker.error(e)}}f.prototype={accumulate:function(e){return c(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,function(e){t.call(i,e.data,e.meta)}):this._worker.on(e,function(){l.delay(t,arguments,i)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(l.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new o(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){"use strict";if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=0===new Blob([s],{type:"application/zip"}).size}catch(e){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(s),i.blob=0===r.getBlob("application/zip").size}catch(e){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(e){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var o=e("./utils"),l=e("./support"),i=e("./nodejsUtils"),s=e("./stream/GenericWorker"),d=new Array(256),r=0;r<256;r++)d[r]=252<=r?6:248<=r?5:240<=r?4:224<=r?3:192<=r?2:1;d[254]=d[254]=1;function a(){s.call(this,"utf-8 decode"),this.leftOver=null}function c(){s.call(this,"utf-8 encode")}n.utf8encode=function(e){return l.nodebuffer?i.newBufferFrom(e,"utf-8"):function(e){var t,i,s,r,n,a=e.length,o=0;for(r=0;r<a;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),o+=i<128?1:i<2048?2:i<65536?3:4;for(t=l.uint8array?new Uint8Array(o):new Array(o),r=n=0;n<o;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),i<128?t[n++]=i:(i<2048?t[n++]=192|i>>>6:(i<65536?t[n++]=224|i>>>12:(t[n++]=240|i>>>18,t[n++]=128|i>>>12&63),t[n++]=128|i>>>6&63),t[n++]=128|63&i);return t}(e)},n.utf8decode=function(e){return l.nodebuffer?o.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,s,r,n=e.length,a=new Array(2*n);for(t=i=0;t<n;)if((s=e[t++])<128)a[i++]=s;else if(4<(r=d[s]))a[i++]=65533,t+=r-1;else{for(s&=2===r?31:3===r?15:7;1<r&&t<n;)s=s<<6|63&e[t++],r--;1<r?a[i++]=65533:s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|1023&s)}return a.length!==i&&(a.subarray?a=a.subarray(0,i):a.length=i),o.applyFromCharCode(a)}(e=o.transformTo(l.uint8array?"uint8array":"array",e))},o.inherits(a,s),a.prototype.processChunk=function(e){var t=o.transformTo(l.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var s=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0?t:0===i?t:i+d[e[i]]>t?i:t}(t),r=t;s!==t.length&&(l.uint8array?(r=t.subarray(0,s),this.leftOver=t.subarray(s,t.length)):(r=t.slice(0,s),this.leftOver=t.slice(s,t.length))),this.push({data:n.utf8decode(r),meta:e.meta})},a.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=a,o.inherits(c,s),c.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,a){"use strict";var o=e("./support"),l=e("./base64"),i=e("./nodejsUtils"),s=e("set-immediate-shim"),d=e("./external");function r(e){return e}function c(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}a.newBlob=function(t,i){a.checkSupport("blob");try{return new Blob([t],{type:i})}catch(e){try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return s.append(t),s.getBlob(i)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var n={stringifyByChunk:function(e,t,i){var s=[],r=0,n=e.length;if(n<=i)return String.fromCharCode.apply(null,e);for(;r<n;)"array"===t||"nodebuffer"===t?s.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+i,n)))):s.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+i,n)))),r+=i;return s.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&1===String.fromCharCode.apply(null,i.allocBuffer(1)).length}catch(e){return!1}}()}};function f(e){var t=65536,i=a.getTypeOf(e),s=!0;if("uint8array"===i?s=n.applyCanBeUsed.uint8array:"nodebuffer"===i&&(s=n.applyCanBeUsed.nodebuffer),s)for(;1<t;)try{return n.stringifyByChunk(e,i,t)}catch(e){t=Math.floor(t/2)}return n.stringifyByChar(e)}function u(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}a.applyFromCharCode=f;var h={};h.string={string:r,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,i.allocBuffer(e.length))}},h.array={string:f,array:r,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(e)}},h.arraybuffer={string:function(e){return f(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:r,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:f,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:r,nodebuffer:function(e){return i.newBufferFrom(e)}},h.nodebuffer={string:f,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:r},a.transformTo=function(e,t){if(t=t||"",!e)return t;a.checkSupport(e);var i=a.getTypeOf(t);return h[i][e](t)},a.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":o.nodebuffer&&i.isBuffer(e)?"nodebuffer":o.uint8array&&e instanceof Uint8Array?"uint8array":o.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(e){if(!o[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(e){var t,i,s="";for(i=0;i<(e||"").length;i++)s+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return s},a.delay=function(e,t,i){s(function(){e.apply(i||null,t||[])})},a.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},a.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},a.prepareContent=function(i,e,s,r,n){return d.Promise.resolve(e).then(function(s){return o.blob&&(s instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(s)))&&"undefined"!=typeof FileReader?new d.Promise(function(t,i){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=function(e){i(e.target.error)},e.readAsArrayBuffer(s)}):s}).then(function(e){var t=a.getTypeOf(e);return t?("arraybuffer"===t?e=a.transformTo("uint8array",e):"string"===t&&(n?e=l.decode(e):s&&!0!==r&&(e=function(e){return c(e,o.uint8array?new Uint8Array(e.length):new Array(e.length))}(e))),e):d.Promise.reject(new Error("Can't read the data of '"+i+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,i){"use strict";var s=e("./reader/readerFor"),r=e("./utils"),n=e("./signature"),a=e("./zipEntry"),o=(e("./utf8"),e("./support"));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var s=this.reader.readString(4)===t;return this.reader.setIndex(i),s},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",i=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,s=this.zip64EndOfCentralSize-44;0<s;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var s=t-i;if(0<s)this.isSignature(t,n.CENTRAL_FILE_HEADER)||(this.reader.zero=s);else if(s<0)throw new Error("Corrupted zip: missing "+Math.abs(s)+" bytes.")},prepareReader:function(e){this.reader=s(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){"use strict";var s=e("./reader/readerFor"),n=e("./utils"),r=e("./compressedObject"),a=e("./crc32"),o=e("./utf8"),l=e("./compressions"),d=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=s(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,i,s,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<r;)t=e.readInt(2),i=e.readInt(2),s=e.readData(i),this.extraFields[t]={id:t,length:i,value:s}},handleUTF8:function(){var e=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var s=this.findExtraFieldUnicodeComment();if(null!==s)this.fileCommentStr=s;else{var r=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=s(e.value);return 1!==t.readInt(1)?null:a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=s(e.value);return 1!==t.readInt(1)?null:a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){"use strict";function s(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var n=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),a=e("./utf8"),o=e("./compressedObject"),l=e("./stream/GenericWorker");s.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var s="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var r=!this._dataBinary;r&&!s&&(t=t.pipe(new a.Utf8EncodeWorker)),!r&&s&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new n(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof l?this._data:new r(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)s.prototype[d[f]]=c;t.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,c,t){(function(t){"use strict";var i,s,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var r=0,n=new e(d),a=t.document.createTextNode("");n.observe(a,{characterData:!0}),i=function(){a.data=r=++r%2}}else if(t.setImmediate||void 0===t.MessageChannel)i="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){d(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(d,0)};else{var o=new t.MessageChannel;o.port1.onmessage=d,i=function(){o.port2.postMessage(0)}}var l=[];function d(){var e,t;s=!0;for(var i=l.length;i;){for(t=l,l=[],e=-1;++e<i;)t[e]();i=l.length}s=!1}c.exports=function(e){1!==l.push(e)||s||i()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){"use strict";var r=e("immediate");function d(){}var c={},n=["REJECTED"],a=["FULFILLED"],s=["PENDING"];function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,e!==d&&h(this,e)}function l(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function f(t,i,s){r(function(){var e;try{e=i(s)}catch(e){return c.reject(t,e)}e===t?c.reject(t,new TypeError("Cannot resolve promise with itself")):c.resolve(t,e)})}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(t,e){var i=!1;function s(e){i||(i=!0,c.reject(t,e))}function r(e){i||(i=!0,c.resolve(t,e))}var n=p(function(){e(r,s)});"error"===n.status&&s(n.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}(t.exports=o).prototype.finally=function(t){if("function"!=typeof t)return this;var i=this.constructor;return this.then(function(e){return i.resolve(t()).then(function(){return e})},function(e){return i.resolve(t()).then(function(){throw e})})},o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===n)return this;var i=new this.constructor(d);this.state!==s?f(i,this.state===a?e:t,this.outcome):this.queue.push(new l(i,e,t));return i},l.prototype.callFulfilled=function(e){c.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){c.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},c.resolve=function(e,t){var i=p(u,t);if("error"===i.status)return c.reject(e,i.value);var s=i.value;if(s)h(e,s);else{e.state=a,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callFulfilled(t)}return e},c.reject=function(e,t){e.state=n,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callRejected(t);return e},o.resolve=function(e){if(e instanceof this)return e;return c.resolve(new this(d),e)},o.reject=function(e){var t=new this(d);return c.reject(t,e)},o.all=function(e){var i=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,r=!1;if(!s)return this.resolve([]);var n=new Array(s),a=0,t=-1,o=new this(d);for(;++t<s;)l(e[t],t);return o;function l(e,t){i.resolve(e).then(function(e){n[t]=e,++a!==s||r||(r=!0,c.resolve(o,n))},function(e){r||(r=!0,c.reject(o,e))})}},o.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,s=!1;if(!i)return this.resolve([]);var r=-1,n=new this(d);for(;++r<i;)a=e[r],t.resolve(a).then(function(e){s||(s=!0,c.resolve(n,e))},function(e){s||(s=!0,c.reject(n,e))});var a;return n}},{immediate:36}],38:[function(e,t,i){"use strict";var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){"use strict";var a=e("./zlib/deflate"),o=e("./utils/common"),l=e("./utils/strings"),r=e("./zlib/messages"),n=e("./zlib/zstream"),d=Object.prototype.toString,c=0,f=-1,u=0,h=8;function p(e){if(!(this instanceof p))return new p(e);this.options=o.assign({level:f,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;var i=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==c)throw new Error(r[i]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var s;if(s="string"==typeof t.dictionary?l.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=a.deflateSetDictionary(this.strm,s))!==c)throw new Error(r[i]);this._dict_set=!0}}function s(e,t){var i=new p(t);if(i.push(e,!0),i.err)throw i.msg||r[i.err];return i.result}p.prototype.push=function(e,t){var i,s,r=this.strm,n=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?r.input=l.string2buf(e):"[object ArrayBuffer]"===d.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new o.Buf8(n),r.next_out=0,r.avail_out=n),1!==(i=a.deflate(r,s))&&i!==c)return this.onEnd(i),!(this.ended=!0);0!==r.avail_out&&(0!==r.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(l.buf2binstring(o.shrinkBuf(r.output,r.next_out))):this.onData(o.shrinkBuf(r.output,r.next_out)))}while((0<r.avail_in||0===r.avail_out)&&1!==i);return 4===s?(i=a.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==s||(this.onEnd(c),!(r.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=p,i.deflate=s,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,s(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,s(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){"use strict";var u=e("./zlib/inflate"),h=e("./utils/common"),p=e("./utils/strings"),m=e("./zlib/constants"),s=e("./zlib/messages"),r=e("./zlib/zstream"),n=e("./zlib/gzheader"),g=Object.prototype.toString;function a(e){if(!(this instanceof a))return new a(e);this.options=h.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var i=u.inflateInit2(this.strm,t.windowBits);if(i!==m.Z_OK)throw new Error(s[i]);this.header=new n,u.inflateGetHeader(this.strm,this.header)}function o(e,t){var i=new a(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}a.prototype.push=function(e,t){var i,s,r,n,a,o,l=this.strm,d=this.options.chunkSize,c=this.options.dictionary,f=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof e?l.input=p.binstring2buf(e):"[object ArrayBuffer]"===g.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new h.Buf8(d),l.next_out=0,l.avail_out=d),(i=u.inflate(l,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&c&&(o="string"==typeof c?p.string2buf(c):"[object ArrayBuffer]"===g.call(c)?new Uint8Array(c):c,i=u.inflateSetDictionary(this.strm,o)),i===m.Z_BUF_ERROR&&!0===f&&(i=m.Z_OK,f=!1),i!==m.Z_STREAM_END&&i!==m.Z_OK)return this.onEnd(i),!(this.ended=!0);l.next_out&&(0!==l.avail_out&&i!==m.Z_STREAM_END&&(0!==l.avail_in||s!==m.Z_FINISH&&s!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(r=p.utf8border(l.output,l.next_out),n=l.next_out-r,a=p.buf2string(l.output,r),l.next_out=n,l.avail_out=d-n,n&&h.arraySet(l.output,l.output,r,n,0),this.onData(a)):this.onData(h.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(f=!0)}while((0<l.avail_in||0===l.avail_out)&&i!==m.Z_STREAM_END);return i===m.Z_STREAM_END&&(s=m.Z_FINISH),s===m.Z_FINISH?(i=u.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===m.Z_OK):s!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(l.avail_out=0))},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=a,i.inflate=o,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,o(e,t)},i.ungzip=o},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){"use strict";var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,i,s,r){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+s),r);else for(var n=0;n<s;n++)e[r+n]=t[i+n]},flattenChunks:function(e){var t,i,s,r,n,a;for(t=s=0,i=e.length;t<i;t++)s+=e[t].length;for(a=new Uint8Array(s),t=r=0,i=e.length;t<i;t++)n=e[t],a.set(n,r),r+=n.length;return a}},n={arraySet:function(e,t,i,s,r){for(var n=0;n<s;n++)e[r+n]=t[i+n]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,r)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,n))},i.setTyped(s)},{}],42:[function(e,t,i){"use strict";var l=e("./common"),r=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){n=!1}for(var d=new l.Buf8(256),s=0;s<256;s++)d[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function c(e,t){if(t<65537&&(e.subarray&&n||!e.subarray&&r))return String.fromCharCode.apply(null,l.shrinkBuf(e,t));for(var i="",s=0;s<t;s++)i+=String.fromCharCode(e[s]);return i}d[254]=d[254]=1,i.string2buf=function(e){var t,i,s,r,n,a=e.length,o=0;for(r=0;r<a;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),o+=i<128?1:i<2048?2:i<65536?3:4;for(t=new l.Buf8(o),r=n=0;n<o;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),i<128?t[n++]=i:(i<2048?t[n++]=192|i>>>6:(i<65536?t[n++]=224|i>>>12:(t[n++]=240|i>>>18,t[n++]=128|i>>>12&63),t[n++]=128|i>>>6&63),t[n++]=128|63&i);return t},i.buf2binstring=function(e){return c(e,e.length)},i.binstring2buf=function(e){for(var t=new l.Buf8(e.length),i=0,s=t.length;i<s;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,s,r,n,a=t||e.length,o=new Array(2*a);for(i=s=0;i<a;)if((r=e[i++])<128)o[s++]=r;else if(4<(n=d[r]))o[s++]=65533,i+=n-1;else{for(r&=2===n?31:3===n?15:7;1<n&&i<a;)r=r<<6|63&e[i++],n--;1<n?o[s++]=65533:r<65536?o[s++]=r:(r-=65536,o[s++]=55296|r>>10&1023,o[s++]=56320|1023&r)}return c(o,s)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0?t:0===i?t:i+d[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){"use strict";t.exports=function(e,t,i,s){for(var r=65535&e|0,n=e>>>16&65535|0,a=0;0!==i;){for(i-=a=2e3<i?2e3:i;n=n+(r=r+t[s++]|0)|0,--a;);r%=65521,n%=65521}return r|n<<16|0}},{}],44:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){"use strict";var o=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,s){var r=o,n=s+i;e^=-1;for(var a=s;a<n;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}},{}],46:[function(e,t,i){"use strict";var l,u=e("../utils/common"),d=e("./trees"),h=e("./adler32"),p=e("./crc32"),s=e("./messages"),c=0,f=4,m=0,g=-2,x=-1,b=4,r=2,v=8,y=9,n=286,a=30,o=19,w=2*n+1,S=15,E=3,C=258,I=C+E+1,T=42,k=113,A=1,M=2,_=3,R=4;function N(e,t){return e.msg=s[t],t}function P(e){return(e<<1)-(4<e?9:0)}function D(e){for(var t=e.length;0<=--t;)e[t]=0}function F(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(u.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function B(e,t){d._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,F(e.strm)}function G(e,t){e.pending_buf[e.pending++]=t}function O(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function L(e,t){var i,s,r=e.max_chain_length,n=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-I?e.strstart-(e.w_size-I):0,d=e.window,c=e.w_mask,f=e.prev,u=e.strstart+C,h=d[n+a-1],p=d[n+a];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(d[(i=t)+a]===p&&d[i+a-1]===h&&d[i]===d[n]&&d[++i]===d[n+1]){n+=2,i++;do{}while(d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&n<u);if(s=C-(u-n),n=u-C,a<s){if(e.match_start=t,o<=(a=s))break;h=d[n+a-1],p=d[n+a]}}}while((t=f[t&c])>l&&0!=--r);return a<=e.lookahead?a:e.lookahead}function $(e){var t,i,s,r,n,a,o,l,d,c,f=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-I)){for(u.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=i=e.hash_size;s=e.head[--t],e.head[t]=f<=s?s-f:0,--i;);for(t=i=f;s=e.prev[--t],e.prev[t]=f<=s?s-f:0,--i;);r+=f}if(0===e.strm.avail_in)break;if(a=e.strm,o=e.window,l=e.strstart+e.lookahead,d=r,c=void 0,c=a.avail_in,d<c&&(c=d),i=0===c?0:(a.avail_in-=c,u.arraySet(o,a.input,a.next_in,c,l),1===a.state.wrap?a.adler=h(a.adler,o,c,l):2===a.state.wrap&&(a.adler=p(a.adler,o,c,l)),a.next_in+=c,a.total_in+=c,c),e.lookahead+=i,e.lookahead+e.insert>=E)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=(e.ins_h<<e.hash_shift^e.window[n+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[n+E-1])&e.hash_mask,e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<E)););}while(e.lookahead<I&&0!==e.strm.avail_in)}function j(e,t){for(var i,s;;){if(e.lookahead<I){if($(e),e.lookahead<I&&t===c)return A;if(0===e.lookahead)break}if(i=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-I&&(e.match_length=L(e,i)),e.match_length>=E)if(s=d._tr_tally(e,e.strstart-e.match_start,e.match_length-E),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=E){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else s=d._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(B(e,!1),0===e.strm.avail_out))return A}return e.insert=e.strstart<E-1?e.strstart:E-1,t===f?(B(e,!0),0===e.strm.avail_out?_:R):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?A:M}function V(e,t){for(var i,s,r;;){if(e.lookahead<I){if($(e),e.lookahead<I&&t===c)return A;if(0===e.lookahead)break}if(i=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=E-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-I&&(e.match_length=L(e,i),e.match_length<=5&&(1===e.strategy||e.match_length===E&&4096<e.strstart-e.match_start)&&(e.match_length=E-1)),e.prev_length>=E&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-E,s=d._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-E),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=E-1,e.strstart++,s&&(B(e,!1),0===e.strm.avail_out))return A}else if(e.match_available){if((s=d._tr_tally(e,0,e.window[e.strstart-1]))&&B(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return A}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=d._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<E-1?e.strstart:E-1,t===f?(B(e,!0),0===e.strm.avail_out?_:R):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?A:M}function U(e,t,i,s,r){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=s,this.func=r}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(2*w),this.dyn_dtree=new u.Buf16(2*(2*a+1)),this.bl_tree=new u.Buf16(2*(2*o+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(S+1),this.heap=new u.Buf16(2*n+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*n+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function z(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=r,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?T:k,e.adler=2===t.wrap?0:1,t.last_flush=c,d._tr_init(t),m):N(e,g)}function W(e){var t=z(e);return t===m&&function(e){e.window_size=2*e.w_size,D(e.head),e.max_lazy_match=l[e.level].max_lazy,e.good_match=l[e.level].good_length,e.nice_match=l[e.level].nice_length,e.max_chain_length=l[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=E-1,e.match_available=0,e.ins_h=0}(e.state),t}function q(e,t,i,s,r,n){if(!e)return g;var a=1;if(t===x&&(t=6),s<0?(a=0,s=-s):15<s&&(a=2,s-=16),r<1||y<r||i!==v||s<8||15<s||t<0||9<t||n<0||b<n)return N(e,g);8===s&&(s=9);var o=new H;return(e.state=o).strm=e,o.wrap=a,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+E-1)/E),o.window=new u.Buf8(2*o.w_size),o.head=new u.Buf16(o.hash_size),o.prev=new u.Buf16(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new u.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=n,o.method=i,W(e)}l=[new U(0,0,0,0,function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if($(e),0===e.lookahead&&t===c)return A;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var s=e.block_start+i;if((0===e.strstart||e.strstart>=s)&&(e.lookahead=e.strstart-s,e.strstart=s,B(e,!1),0===e.strm.avail_out))return A;if(e.strstart-e.block_start>=e.w_size-I&&(B(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(B(e,!0),0===e.strm.avail_out?_:R):(e.strstart>e.block_start&&(B(e,!1),e.strm.avail_out),A)}),new U(4,4,8,4,j),new U(4,5,16,8,j),new U(4,6,32,32,j),new U(4,4,16,16,V),new U(8,16,32,32,V),new U(8,16,128,128,V),new U(8,32,128,256,V),new U(32,128,258,1024,V),new U(32,258,258,4096,V)],i.deflateInit=function(e,t){return q(e,t,v,15,8,0)},i.deflateInit2=q,i.deflateReset=W,i.deflateResetKeep=z,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?g:(e.state.gzhead=t,m):g},i.deflate=function(e,t){var i,s,r,n;if(!e||!e.state||5<t||t<0)return e?N(e,g):g;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||666===s.status&&t!==f)return N(e,0===e.avail_out?-5:g);if(s.strm=e,i=s.last_flush,s.last_flush=t,s.status===T)if(2===s.wrap)e.adler=0,G(s,31),G(s,139),G(s,8),s.gzhead?(G(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),G(s,255&s.gzhead.time),G(s,s.gzhead.time>>8&255),G(s,s.gzhead.time>>16&255),G(s,s.gzhead.time>>24&255),G(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),G(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(G(s,255&s.gzhead.extra.length),G(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=p(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(G(s,0),G(s,0),G(s,0),G(s,0),G(s,0),G(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),G(s,3),s.status=k);else{var a=v+(s.w_bits-8<<4)<<8;a|=(2<=s.strategy||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(a|=32),a+=31-a%31,s.status=k,O(s,a),0!==s.strstart&&(O(s,e.adler>>>16),O(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(r=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>r&&(e.adler=p(e.adler,s.pending_buf,s.pending-r,r)),F(e),r=s.pending,s.pending!==s.pending_buf_size));)G(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>r&&(e.adler=p(e.adler,s.pending_buf,s.pending-r,r)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){r=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>r&&(e.adler=p(e.adler,s.pending_buf,s.pending-r,r)),F(e),r=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,G(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>r&&(e.adler=p(e.adler,s.pending_buf,s.pending-r,r)),0===n&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){r=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>r&&(e.adler=p(e.adler,s.pending_buf,s.pending-r,r)),F(e),r=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,G(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>r&&(e.adler=p(e.adler,s.pending_buf,s.pending-r,r)),0===n&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&F(e),s.pending+2<=s.pending_buf_size&&(G(s,255&e.adler),G(s,e.adler>>8&255),e.adler=0,s.status=k)):s.status=k),0!==s.pending){if(F(e),0===e.avail_out)return s.last_flush=-1,m}else if(0===e.avail_in&&P(t)<=P(i)&&t!==f)return N(e,-5);if(666===s.status&&0!==e.avail_in)return N(e,-5);if(0!==e.avail_in||0!==s.lookahead||t!==c&&666!==s.status){var o=2===s.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&($(e),0===e.lookahead)){if(t===c)return A;break}if(e.match_length=0,i=d._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(B(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(B(e,!0),0===e.strm.avail_out?_:R):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?A:M}(s,t):3===s.strategy?function(e,t){for(var i,s,r,n,a=e.window;;){if(e.lookahead<=C){if($(e),e.lookahead<=C&&t===c)return A;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=E&&0<e.strstart&&(s=a[r=e.strstart-1])===a[++r]&&s===a[++r]&&s===a[++r]){n=e.strstart+C;do{}while(s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&r<n);e.match_length=C-(n-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=E?(i=d._tr_tally(e,1,e.match_length-E),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=d._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(B(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===f?(B(e,!0),0===e.strm.avail_out?_:R):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?A:M}(s,t):l[s.level].func(s,t);if(o!==_&&o!==R||(s.status=666),o===A||o===_)return 0===e.avail_out&&(s.last_flush=-1),m;if(o===M&&(1===t?d._tr_align(s):5!==t&&(d._tr_stored_block(s,0,0,!1),3===t&&(D(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),F(e),0===e.avail_out))return s.last_flush=-1,m}return t!==f?m:s.wrap<=0?1:(2===s.wrap?(G(s,255&e.adler),G(s,e.adler>>8&255),G(s,e.adler>>16&255),G(s,e.adler>>24&255),G(s,255&e.total_in),G(s,e.total_in>>8&255),G(s,e.total_in>>16&255),G(s,e.total_in>>24&255)):(O(s,e.adler>>>16),O(s,65535&e.adler)),F(e),0<s.wrap&&(s.wrap=-s.wrap),0!==s.pending?m:1)},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==T&&69!==t&&73!==t&&91!==t&&103!==t&&t!==k&&666!==t?N(e,g):(e.state=null,t===k?N(e,-3):m):g},i.deflateSetDictionary=function(e,t){var i,s,r,n,a,o,l,d,c=t.length;if(!e||!e.state)return g;if(2===(n=(i=e.state).wrap)||1===n&&i.status!==T||i.lookahead)return g;for(1===n&&(e.adler=h(e.adler,t,c,0)),i.wrap=0,c>=i.w_size&&(0===n&&(D(i.head),i.strstart=0,i.block_start=0,i.insert=0),d=new u.Buf8(i.w_size),u.arraySet(d,t,c-i.w_size,i.w_size,0),t=d,c=i.w_size),a=e.avail_in,o=e.next_in,l=e.input,e.avail_in=c,e.next_in=0,e.input=t,$(i);i.lookahead>=E;){for(s=i.strstart,r=i.lookahead-(E-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+E-1])&i.hash_mask,i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++,--r;);i.strstart=s,i.lookahead=E-1,$(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=E-1,i.match_available=0,e.next_in=o,e.input=l,e.avail_in=a,i.wrap=n,m},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){"use strict";t.exports=function(e,t){var i,s,r,n,a,o,l,d,c,f,u,h,p,m,g,x,b,v,y,w,S,E,C,I,T;i=e.state,s=e.next_in,I=e.input,r=s+(e.avail_in-5),n=e.next_out,T=e.output,a=n-(t-e.avail_out),o=n+(e.avail_out-257),l=i.dmax,d=i.wsize,c=i.whave,f=i.wnext,u=i.window,h=i.hold,p=i.bits,m=i.lencode,g=i.distcode,x=(1<<i.lenbits)-1,b=(1<<i.distbits)-1;e:do{p<15&&(h+=I[s++]<<p,p+=8,h+=I[s++]<<p,p+=8),v=m[h&x];t:for(;;){if(h>>>=y=v>>>24,p-=y,0===(y=v>>>16&255))T[n++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=m[(65535&v)+(h&(1<<y)-1)];continue t}if(32&y){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}w=65535&v,(y&=15)&&(p<y&&(h+=I[s++]<<p,p+=8),w+=h&(1<<y)-1,h>>>=y,p-=y),p<15&&(h+=I[s++]<<p,p+=8,h+=I[s++]<<p,p+=8),v=g[h&b];i:for(;;){if(h>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=g[(65535&v)+(h&(1<<y)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(S=65535&v,p<(y&=15)&&(h+=I[s++]<<p,(p+=8)<y&&(h+=I[s++]<<p,p+=8)),l<(S+=h&(1<<y)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(h>>>=y,p-=y,(y=n-a)<S){if(c<(y=S-y)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(C=u,(E=0)===f){if(E+=d-y,y<w){for(w-=y;T[n++]=u[E++],--y;);E=n-S,C=T}}else if(f<y){if(E+=d+f-y,(y-=f)<w){for(w-=y;T[n++]=u[E++],--y;);if(E=0,f<w){for(w-=y=f;T[n++]=u[E++],--y;);E=n-S,C=T}}}else if(E+=f-y,y<w){for(w-=y;T[n++]=u[E++],--y;);E=n-S,C=T}for(;2<w;)T[n++]=C[E++],T[n++]=C[E++],T[n++]=C[E++],w-=3;w&&(T[n++]=C[E++],1<w&&(T[n++]=C[E++]))}else{for(E=n-S;T[n++]=T[E++],T[n++]=T[E++],T[n++]=T[E++],2<(w-=3););w&&(T[n++]=T[E++],1<w&&(T[n++]=T[E++]))}break}}break}}while(s<r&&n<o);s-=w=p>>3,h&=(1<<(p-=w<<3))-1,e.next_in=s,e.next_out=n,e.avail_in=s<r?r-s+5:5-(s-r),e.avail_out=n<o?o-n+257:257-(n-o),i.hold=h,i.bits=p}},{}],49:[function(e,t,i){"use strict";var M=e("../utils/common"),_=e("./adler32"),R=e("./crc32"),N=e("./inffast"),P=e("./inftrees"),D=1,F=2,B=0,G=-2,O=1,s=852,r=592;function L(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new M.Buf16(320),this.work=new M.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=O,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new M.Buf32(s),t.distcode=t.distdyn=new M.Buf32(r),t.sane=1,t.back=-1,B):G}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,a(e)):G}function l(e,t){var i,s;return e&&e.state?(s=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?G:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=i,s.wbits=t,o(e))):G}function d(e,t){var i,s;return e?(s=new n,(e.state=s).window=null,(i=l(e,t))!==B&&(e.state=null),i):G}var c,f,u=!0;function $(e){if(u){var t;for(c=new M.Buf32(512),f=new M.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(P(D,e.lens,0,288,c,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;P(F,e.lens,0,32,f,0,e.work,{bits:5}),u=!1}e.lencode=c,e.lenbits=9,e.distcode=f,e.distbits=5}function j(e,t,i,s){var r,n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new M.Buf8(n.wsize)),s>=n.wsize?(M.arraySet(n.window,t,i-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):(s<(r=n.wsize-n.wnext)&&(r=s),M.arraySet(n.window,t,i-s,r,n.wnext),(s-=r)?(M.arraySet(n.window,t,i-s,s,0),n.wnext=s,n.whave=n.wsize):(n.wnext+=r,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=r))),0}i.inflateReset=o,i.inflateReset2=l,i.inflateResetKeep=a,i.inflateInit=function(e){return d(e,15)},i.inflateInit2=d,i.inflate=function(e,t){var i,s,r,n,a,o,l,d,c,f,u,h,p,m,g,x,b,v,y,w,S,E,C,I,T=0,k=new M.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return G;12===(i=e.state).mode&&(i.mode=13),a=e.next_out,r=e.output,l=e.avail_out,n=e.next_in,s=e.input,o=e.avail_in,d=i.hold,c=i.bits,f=o,u=l,E=B;e:for(;;)switch(i.mode){case O:if(0===i.wrap){i.mode=13;break}for(;c<16;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(2&i.wrap&&35615===d){k[i.check=0]=255&d,k[1]=d>>>8&255,i.check=R(i.check,k,2,0),c=d=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&d)){e.msg="unknown compression method",i.mode=30;break}if(c-=4,S=8+(15&(d>>>=4)),0===i.wbits)i.wbits=S;else if(S>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<S,e.adler=i.check=1,i.mode=512&d?10:12,c=d=0;break;case 2:for(;c<16;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(i.flags=d,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&(k[0]=255&d,k[1]=d>>>8&255,i.check=R(i.check,k,2,0)),c=d=0,i.mode=3;case 3:for(;c<32;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}i.head&&(i.head.time=d),512&i.flags&&(k[0]=255&d,k[1]=d>>>8&255,k[2]=d>>>16&255,k[3]=d>>>24&255,i.check=R(i.check,k,4,0)),c=d=0,i.mode=4;case 4:for(;c<16;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&(k[0]=255&d,k[1]=d>>>8&255,i.check=R(i.check,k,2,0)),c=d=0,i.mode=5;case 5:if(1024&i.flags){for(;c<16;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&(k[0]=255&d,k[1]=d>>>8&255,i.check=R(i.check,k,2,0)),c=d=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(o<(h=i.length)&&(h=o),h&&(i.head&&(S=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),M.arraySet(i.head.extra,s,n,h,S)),512&i.flags&&(i.check=R(i.check,s,h,n)),o-=h,n+=h,i.length-=h),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===o)break e;for(h=0;S=s[n+h++],i.head&&S&&i.length<65536&&(i.head.name+=String.fromCharCode(S)),S&&h<o;);if(512&i.flags&&(i.check=R(i.check,s,h,n)),o-=h,n+=h,S)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===o)break e;for(h=0;S=s[n+h++],i.head&&S&&i.length<65536&&(i.head.comment+=String.fromCharCode(S)),S&&h<o;);if(512&i.flags&&(i.check=R(i.check,s,h,n)),o-=h,n+=h,S)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;c<16;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(d!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}c=d=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;c<32;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}e.adler=i.check=L(d),c=d=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=a,e.avail_out=l,e.next_in=n,e.avail_in=o,i.hold=d,i.bits=c,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){d>>>=7&c,c-=7&c,i.mode=27;break}for(;c<3;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}switch(i.last=1&d,c-=1,3&(d>>>=1)){case 0:i.mode=14;break;case 1:if($(i),i.mode=20,6!==t)break;d>>>=2,c-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}d>>>=2,c-=2;break;case 14:for(d>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&d,c=d=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(h=i.length){if(o<h&&(h=o),l<h&&(h=l),0===h)break e;M.arraySet(r,s,n,h,a),o-=h,n+=h,l-=h,a+=h,i.length-=h;break}i.mode=12;break;case 17:for(;c<14;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(i.nlen=257+(31&d),d>>>=5,c-=5,i.ndist=1+(31&d),d>>>=5,c-=5,i.ncode=4+(15&d),d>>>=4,c-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;c<3;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}i.lens[A[i.have++]]=7&d,d>>>=3,c-=3}for(;i.have<19;)i.lens[A[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},E=P(0,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,E){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;x=(T=i.lencode[d&(1<<i.lenbits)-1])>>>16&255,b=65535&T,!((g=T>>>24)<=c);){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(b<16)d>>>=g,c-=g,i.lens[i.have++]=b;else{if(16===b){for(I=g+2;c<I;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(d>>>=g,c-=g,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}S=i.lens[i.have-1],h=3+(3&d),d>>>=2,c-=2}else if(17===b){for(I=g+3;c<I;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}c-=g,S=0,h=3+(7&(d>>>=g)),d>>>=3,c-=3}else{for(I=g+7;c<I;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}c-=g,S=0,h=11+(127&(d>>>=g)),d>>>=7,c-=7}if(i.have+h>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;h--;)i.lens[i.have++]=S}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,C={bits:i.lenbits},E=P(D,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,E){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},E=P(F,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,E){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=o&&258<=l){e.next_out=a,e.avail_out=l,e.next_in=n,e.avail_in=o,i.hold=d,i.bits=c,N(e,u),a=e.next_out,r=e.output,l=e.avail_out,n=e.next_in,s=e.input,o=e.avail_in,d=i.hold,c=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;x=(T=i.lencode[d&(1<<i.lenbits)-1])>>>16&255,b=65535&T,!((g=T>>>24)<=c);){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(x&&0==(240&x)){for(v=g,y=x,w=b;x=(T=i.lencode[w+((d&(1<<v+y)-1)>>v)])>>>16&255,b=65535&T,!(v+(g=T>>>24)<=c);){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}d>>>=v,c-=v,i.back+=v}if(d>>>=g,c-=g,i.back+=g,i.length=b,0===x){i.mode=26;break}if(32&x){i.back=-1,i.mode=12;break}if(64&x){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&x,i.mode=22;case 22:if(i.extra){for(I=i.extra;c<I;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;x=(T=i.distcode[d&(1<<i.distbits)-1])>>>16&255,b=65535&T,!((g=T>>>24)<=c);){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(0==(240&x)){for(v=g,y=x,w=b;x=(T=i.distcode[w+((d&(1<<v+y)-1)>>v)])>>>16&255,b=65535&T,!(v+(g=T>>>24)<=c);){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}d>>>=v,c-=v,i.back+=v}if(d>>>=g,c-=g,i.back+=g,64&x){e.msg="invalid distance code",i.mode=30;break}i.offset=b,i.extra=15&x,i.mode=24;case 24:if(i.extra){for(I=i.extra;c<I;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===l)break e;if(h=u-l,i.offset>h){if((h=i.offset-h)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}p=h>i.wnext?(h-=i.wnext,i.wsize-h):i.wnext-h,h>i.length&&(h=i.length),m=i.window}else m=r,p=a-i.offset,h=i.length;for(l<h&&(h=l),l-=h,i.length-=h;r[a++]=m[p++],--h;);0===i.length&&(i.mode=21);break;case 26:if(0===l)break e;r[a++]=i.length,l--,i.mode=21;break;case 27:if(i.wrap){for(;c<32;){if(0===o)break e;o--,d|=s[n++]<<c,c+=8}if(u-=l,e.total_out+=u,i.total+=u,u&&(e.adler=i.check=i.flags?R(i.check,r,u,a-u):_(i.check,r,u,a-u)),u=l,(i.flags?d:L(d))!==i.check){e.msg="incorrect data check",i.mode=30;break}c=d=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;c<32;){if(0===o)break e;o--,d+=s[n++]<<c,c+=8}if(d!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}c=d=0}i.mode=29;case 29:E=1;break e;case 30:E=-3;break e;case 31:return-4;case 32:default:return G}return e.next_out=a,e.avail_out=l,e.next_in=n,e.avail_in=o,i.hold=d,i.bits=c,(i.wsize||u!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&j(e,e.output,e.next_out,u-e.avail_out)?(i.mode=31,-4):(f-=e.avail_in,u-=e.avail_out,e.total_in+=f,e.total_out+=u,i.total+=u,i.wrap&&u&&(e.adler=i.check=i.flags?R(i.check,r,u,e.next_out-u):_(i.check,r,u,e.next_out-u)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==f&&0===u||4===t)&&E===B&&(E=-5),E)},i.inflateEnd=function(e){if(!e||!e.state)return G;var t=e.state;return t.window&&(t.window=null),e.state=null,B},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?G:((i.head=t).done=!1,B):G},i.inflateSetDictionary=function(e,t){var i,s=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?G:11===i.mode&&_(1,t,s,0)!==i.check?-3:j(e,t,s,s)?(i.mode=31,-4):(i.havedict=1,B):G},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){"use strict";var D=e("../utils/common"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],B=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],O=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,s,r,n,a,o){var l,d,c,f,u,h,p,m,g,x=o.bits,b=0,v=0,y=0,w=0,S=0,E=0,C=0,I=0,T=0,k=0,A=null,M=0,_=new D.Buf16(16),R=new D.Buf16(16),N=null,P=0;for(b=0;b<=15;b++)_[b]=0;for(v=0;v<s;v++)_[t[i+v]]++;for(S=x,w=15;1<=w&&0===_[w];w--);if(w<S&&(S=w),0===w)return r[n++]=20971520,r[n++]=20971520,o.bits=1,0;for(y=1;y<w&&0===_[y];y++);for(S<y&&(S=y),b=I=1;b<=15;b++)if(I<<=1,(I-=_[b])<0)return-1;if(0<I&&(0===e||1!==w))return-1;for(R[1]=0,b=1;b<15;b++)R[b+1]=R[b]+_[b];for(v=0;v<s;v++)0!==t[i+v]&&(a[R[t[i+v]]++]=v);if(h=0===e?(A=N=a,19):1===e?(A=F,M-=257,N=B,P-=257,256):(A=G,N=O,-1),b=y,u=n,C=v=k=0,c=-1,f=(T=1<<(E=S))-1,1===e&&852<T||2===e&&592<T)return 1;for(;;){for(p=b-C,g=a[v]<h?(m=0,a[v]):a[v]>h?(m=N[P+a[v]],A[M+a[v]]):(m=96,0),l=1<<b-C,y=d=1<<E;r[u+(k>>C)+(d-=l)]=p<<24|m<<16|g|0,0!==d;);for(l=1<<b-1;k&l;)l>>=1;if(0!==l?(k&=l-1,k+=l):k=0,v++,0==--_[b]){if(b===w)break;b=t[i+a[v]]}if(S<b&&(k&f)!==c){for(0===C&&(C=S),u+=y,I=1<<(E=b-C);E+C<w&&!((I-=_[E+C])<=0);)E++,I<<=1;if(T+=1<<E,1===e&&852<T||2===e&&592<T)return 1;r[c=k&f]=S<<24|E<<16|u-n|0}}return 0!==k&&(r[u+k]=b-C<<24|64<<16|0),o.bits=S,0}},{"../utils/common":41}],51:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){"use strict";var r=e("../utils/common"),o=0,l=1;function s(e){for(var t=e.length;0<=--t;)e[t]=0}var n=0,a=29,d=256,c=d+1+a,f=30,u=19,g=2*c+1,x=15,h=16,p=7,m=256,b=16,v=17,y=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=new Array(2*(c+2));s(I);var T=new Array(2*f);s(T);var k=new Array(512);s(k);var A=new Array(256);s(A);var M=new Array(a);s(M);var _,R,N,P=new Array(f);function D(e,t,i,s,r){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=s,this.max_length=r,this.has_stree=e&&e.length}function F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function B(e){return e<256?k[e]:k[256+(e>>>7)]}function G(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function O(e,t,i){e.bi_valid>h-i?(e.bi_buf|=t<<e.bi_valid&65535,G(e,e.bi_buf),e.bi_buf=t>>h-e.bi_valid,e.bi_valid+=i-h):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function L(e,t,i){O(e,i[2*t],i[2*t+1])}function $(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function j(e,t,i){var s,r,n=new Array(x+1),a=0;for(s=1;s<=x;s++)n[s]=a=a+i[s-1]<<1;for(r=0;r<=t;r++){var o=e[2*r+1];0!==o&&(e[2*r]=$(n[o]++,o))}}function V(e){var t;for(t=0;t<c;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<u;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*m]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function U(e){8<e.bi_valid?G(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,i,s){var r=2*t,n=2*i;return e[r]<e[n]||e[r]===e[n]&&s[t]<=s[i]}function z(e,t,i){for(var s=e.heap[i],r=i<<1;r<=e.heap_len&&(r<e.heap_len&&H(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!H(t,s,e.heap[r],e.depth));)e.heap[i]=e.heap[r],i=r,r<<=1;e.heap[i]=s}function W(e,t,i){var s,r,n,a,o=0;if(0!==e.last_lit)for(;s=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],r=e.pending_buf[e.l_buf+o],o++,0===s?L(e,r,t):(L(e,(n=A[r])+d+1,t),0!==(a=w[n])&&O(e,r-=M[n],a),L(e,n=B(--s),i),0!==(a=S[n])&&O(e,s-=P[n],a)),o<e.last_lit;);L(e,m,t)}function q(e,t){var i,s,r,n=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,d=-1;for(e.heap_len=0,e.heap_max=g,i=0;i<l;i++)0!==n[2*i]?(e.heap[++e.heap_len]=d=i,e.depth[i]=0):n[2*i+1]=0;for(;e.heap_len<2;)n[2*(r=e.heap[++e.heap_len]=d<2?++d:0)]=1,e.depth[r]=0,e.opt_len--,o&&(e.static_len-=a[2*r+1]);for(t.max_code=d,i=e.heap_len>>1;1<=i;i--)z(e,n,i);for(r=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],z(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=s,n[2*r]=n[2*i]+n[2*s],e.depth[r]=(e.depth[i]>=e.depth[s]?e.depth[i]:e.depth[s])+1,n[2*i+1]=n[2*s+1]=r,e.heap[1]=r++,z(e,n,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,s,r,n,a,o,l=t.dyn_tree,d=t.max_code,c=t.stat_desc.static_tree,f=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(n=0;n<=x;n++)e.bl_count[n]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<g;i++)p<(n=l[2*l[2*(s=e.heap[i])+1]+1]+1)&&(n=p,m++),l[2*s+1]=n,d<s||(e.bl_count[n]++,a=0,h<=s&&(a=u[s-h]),o=l[2*s],e.opt_len+=o*(n+a),f&&(e.static_len+=o*(c[2*s+1]+a)));if(0!==m){do{for(n=p-1;0===e.bl_count[n];)n--;e.bl_count[n]--,e.bl_count[n+1]+=2,e.bl_count[p]--,m-=2}while(0<m);for(n=p;0!==n;n--)for(s=e.bl_count[n];0!==s;)d<(r=e.heap[--i])||(l[2*r+1]!==n&&(e.opt_len+=(n-l[2*r+1])*l[2*r],l[2*r+1]=n),s--)}}(e,t),j(n,d,e.bl_count)}function J(e,t,i){var s,r,n=-1,a=t[1],o=0,l=7,d=4;for(0===a&&(l=138,d=3),t[2*(i+1)+1]=65535,s=0;s<=i;s++)r=a,a=t[2*(s+1)+1],++o<l&&r===a||(o<d?e.bl_tree[2*r]+=o:0!==r?(r!==n&&e.bl_tree[2*r]++,e.bl_tree[2*b]++):o<=10?e.bl_tree[2*v]++:e.bl_tree[2*y]++,n=r,d=(o=0)===a?(l=138,3):r===a?(l=6,3):(l=7,4))}function Z(e,t,i){var s,r,n=-1,a=t[1],o=0,l=7,d=4;for(0===a&&(l=138,d=3),s=0;s<=i;s++)if(r=a,a=t[2*(s+1)+1],!(++o<l&&r===a)){if(o<d)for(;L(e,r,e.bl_tree),0!=--o;);else 0!==r?(r!==n&&(L(e,r,e.bl_tree),o--),L(e,b,e.bl_tree),O(e,o-3,2)):o<=10?(L(e,v,e.bl_tree),O(e,o-3,3)):(L(e,y,e.bl_tree),O(e,o-11,7));n=r,d=(o=0)===a?(l=138,3):r===a?(l=6,3):(l=7,4)}}s(P);var K=!1;function X(e,t,i,s){O(e,(n<<1)+(s?1:0),3),function(e,t,i,s){U(e),s&&(G(e,i),G(e,~i)),r.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}(e,t,i,!0)}i._tr_init=function(e){K||(function(){var e,t,i,s,r,n=new Array(x+1);for(s=i=0;s<a-1;s++)for(M[s]=i,e=0;e<1<<w[s];e++)A[i++]=s;for(A[i-1]=s,s=r=0;s<16;s++)for(P[s]=r,e=0;e<1<<S[s];e++)k[r++]=s;for(r>>=7;s<f;s++)for(P[s]=r<<7,e=0;e<1<<S[s]-7;e++)k[256+r++]=s;for(t=0;t<=x;t++)n[t]=0;for(e=0;e<=143;)I[2*e+1]=8,e++,n[8]++;for(;e<=255;)I[2*e+1]=9,e++,n[9]++;for(;e<=279;)I[2*e+1]=7,e++,n[7]++;for(;e<=287;)I[2*e+1]=8,e++,n[8]++;for(j(I,c+1,n),e=0;e<f;e++)T[2*e+1]=5,T[2*e]=$(e,5);_=new D(I,w,d+1,c,x),R=new D(T,S,0,f,x),N=new D(new Array(0),E,0,u,p)}(),K=!0),e.l_desc=new F(e.dyn_ltree,_),e.d_desc=new F(e.dyn_dtree,R),e.bl_desc=new F(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,V(e)},i._tr_stored_block=X,i._tr_flush_block=function(e,t,i,s){var r,n,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return l;for(t=32;t<d;t++)if(0!==e.dyn_ltree[2*t])return l;return o}(e)),q(e,e.l_desc),q(e,e.d_desc),a=function(e){var t;for(J(e,e.dyn_ltree,e.l_desc.max_code),J(e,e.dyn_dtree,e.d_desc.max_code),q(e,e.bl_desc),t=u-1;3<=t&&0===e.bl_tree[2*C[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(n=e.static_len+3+7>>>3)<=r&&(r=n)):r=n=i+5,i+4<=r&&-1!==t?X(e,t,i,s):4===e.strategy||n===r?(O(e,2+(s?1:0),3),W(e,I,T)):(O(e,4+(s?1:0),3),function(e,t,i,s){var r;for(O(e,t-257,5),O(e,i-1,5),O(e,s-4,4),r=0;r<s;r++)O(e,e.bl_tree[2*C[r]+1],3);Z(e,e.dyn_ltree,t-1),Z(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),W(e,e.dyn_ltree,e.dyn_dtree)),V(e),s&&U(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(A[i]+d+1)]++,e.dyn_dtree[2*B(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){O(e,2,3),L(e,m,I),function(e){16===e.bi_valid?(G(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){"use strict";t.exports="function"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)});(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof exports!=="undefined"){t()}else{var i={exports:{}};t();e.FileSaver=i.exports}})(this,function(){"use strict";var f=typeof window==="object"&&window.window===window?window:typeof self==="object"&&self.self===self?self:typeof global==="object"&&global.global===global?global:void 0;function n(e,t){if(typeof t==="undefined")t={autoBom:false};else if(typeof t!=="object"){console.warn("Deprecated: Expected third argument to be a object");t={autoBom:!t}}if(t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)){return new Blob([String.fromCharCode(65279),e],{type:e.type})}return e}function u(e,t,i){var s=new XMLHttpRequest;s.open("GET",e);s.responseType="blob";s.onload=function(){r(s.response,t,i)};s.onerror=function(){console.error("could not download file")};s.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,false);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",true,true,window,0,0,0,80,20,false,false,false,false,0,null);t.dispatchEvent(i)}}var h=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent);var r=f.saveAs||(typeof window!=="object"||window!==f?function e(){}:"download"in HTMLAnchorElement.prototype&&!h?function e(t,i,s){var r=f.URL||f.webkitURL;var n=document.createElement("a");i=i||t.name||"download";n.download=i;n.rel="noopener";if(typeof t==="string"){n.href=t;if(n.origin!==location.origin){a(n.href)?u(t,i,s):o(n,n.target="_blank")}else{o(n)}}else{n.href=r.createObjectURL(t);setTimeout(function(){r.revokeObjectURL(n.href)},4e4);setTimeout(function(){o(n)},0)}}:"msSaveOrOpenBlob"in navigator?function e(t,i,s){i=i||t.name||"download";if(typeof t==="string"){if(a(t)){u(t,i,s)}else{var r=document.createElement("a");r.href=t;r.target="_blank";setTimeout(function(){o(r)})}}else{navigator.msSaveOrOpenBlob(n(t,s),i)}}:function e(t,i,s,r){r=r||open("","_blank");if(r){r.document.title=r.document.body.innerText="downloading..."}if(typeof t==="string")return u(t,i,s);var n=t.type==="application/octet-stream";var a=/constructor/i.test(f.HTMLElement)||f.safari;var o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&a||h)&&typeof FileReader!=="undefined"){var l=new FileReader;l.onloadend=function(){var e=l.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;");if(r)r.location.href=e;else location=e;r=null};l.readAsDataURL(t)}else{var d=f.URL||f.webkitURL;var c=d.createObjectURL(t);if(r)r.location=c;else location.href=c;r=null;setTimeout(function(){d.revokeObjectURL(c)},4e4)}});f.saveAs=r.saveAs=r;if(typeof module!=="undefined"){module.exports=r}});var parser=function(i){var s={};function r(e){if(s[e])return s[e].exports;var t=s[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=i,r.c=s,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,i){"use strict";var s=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+s+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",n=new RegExp("^"+r+"$");t.isExist=function(e){return void 0!==e},t.isEmptyObject=function(e){return 0===Object.keys(e).length},t.merge=function(e,t,i){if(t)for(var s=Object.keys(t),r=s.length,n=0;n<r;n++)e[s[n]]="strict"===i?[t[s[n]]]:t[s[n]]},t.getValue=function(e){return t.isExist(e)?e:""},t.buildOptions=function(e,t,i){var s={};if(!e)return t;for(var r=0;r<i.length;r++)void 0!==e[i[r]]?s[i[r]]=e[i[r]]:s[i[r]]=t[i[r]];return s},t.isName=function(e){var t=n.exec(e);return!(null==t)},t.getAllMatches=function(e,t){for(var i=[],s=t.exec(e);s;){for(var r=[],n=s.length,a=0;a<n;a++)r.push(s[a]);i.push(r),s=t.exec(e)}return i},t.nameRegexp=r},function(e,t,i){"use strict";var w=i(0),S=i(0).buildOptions,E=i(4);"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,w.nameRegexp);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var C={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",tagValueProcessor:function(e,t){return e},attrValueProcessor:function(e,t){return e},stopNodes:[]};t.defaultOptions=C;var I=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];function T(e,t,i){return t&&(i.trimValues&&(t=t.trim()),t=d(t=i.tagValueProcessor(t,e),i.parseNodeValue,i.parseTrueNumberOnly)),t}function l(e,t){if(t.ignoreNameSpace){var i=e.split(":"),s="/"===e.charAt(0)?"/":"";if("xmlns"===i[0])return"";2===i.length&&(e=s+i[1])}return e}function d(e,t,i){var s;return t&&"string"==typeof e?(""===e.trim()||isNaN(e)?s="true"===e||"false"!==e&&e:(-1!==e.indexOf("0x")?s=Number.parseInt(e,16):-1!==e.indexOf(".")?(s=Number.parseFloat(e),e=e.replace(/\.?0+$/,"")):s=Number.parseInt(e,10),i&&(s=String(s)===e?s:e)),s):w.isExist(e)?e:""}t.props=I;var c=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function k(e,t){if(!t.ignoreAttributes&&"string"==typeof e){e=e.replace(/\r?\n/g," ");for(var i=w.getAllMatches(e,c),s=i.length,r={},n=0;n<s;n++){var a=l(i[n][1],t);a.length&&(void 0!==i[n][4]?(t.trimValues&&(i[n][4]=i[n][4].trim()),i[n][4]=t.attrValueProcessor(i[n][4],a),r[t.attributeNamePrefix+a]=d(i[n][4],t.parseAttributeValue,t.parseTrueNumberOnly)):t.allowBooleanAttributes&&(r[t.attributeNamePrefix+a]=!0))}if(!Object.keys(r).length)return;if(t.attrNodeName){var o={};return o[t.attrNodeName]=r,o}return r}}function A(e,t){for(var i,s="",r=t;r<e.length;r++){var n=e[r];if(i)n===i&&(i="");else if('"'===n||"'"===n)i=n;else{if(">"===n)return{data:s,index:r};"\t"===n&&(n=" ")}s+=n}}function M(e,t,i,s){var r=e.indexOf(t,i);if(-1===r)throw new Error(s);return r+t.length-1}t.getTraversalObj=function(e,t){e=e.replace(/(\r\n)|\n/," "),t=S(t,C,I);for(var i=new E("!xml"),s=i,r="",n=0;n<e.length;n++){if("<"===e[n])if("/"===e[n+1]){var a=M(e,">",n,"Closing Tag is not closed."),o=e.substring(n+2,a).trim();if(t.ignoreNameSpace){var l=o.indexOf(":");-1!==l&&(o=o.substr(l+1))}s&&(s.val?s.val=w.getValue(s.val)+""+T(o,r,t):s.val=T(o,r,t)),t.stopNodes.length&&t.stopNodes.includes(s.tagname)&&(s.child=[],null==s.attrsMap&&(s.attrsMap={}),s.val=e.substr(s.startIndex+1,n-s.startIndex-1)),s=s.parent,r="",n=a}else if("?"===e[n+1])n=M(e,"?>",n,"Pi Tag is not closed.");else if("!--"===e.substr(n+1,3))n=M(e,"--\x3e",n,"Comment is not closed.");else if("!D"===e.substr(n+1,2)){var d=M(e,">",n,"DOCTYPE is not closed.");n=e.substring(n,d).indexOf("[")>=0?e.indexOf("]>",n)+1:d}else if("!["===e.substr(n+1,2)){var c=M(e,"]]>",n,"CDATA is not closed.")-2,f=e.substring(n+9,c);if(r&&(s.val=w.getValue(s.val)+""+T(s.tagname,r,t),r=""),t.cdataTagName){var u=new E(t.cdataTagName,s,f);s.addChild(u),s.val=w.getValue(s.val)+t.cdataPositionChar,f&&(u.val=f)}else s.val=(s.val||"")+(f||"");n=c+2}else{var h=A(e,n+1),p=h.data,m=h.index,g=p.indexOf(" "),x=p;if(-1!==g&&(x=p.substr(0,g).trimRight(),p=p.substr(g+1)),t.ignoreNameSpace){var b=x.indexOf(":");-1!==b&&(x=x.substr(b+1))}if(s&&r&&"!xml"!==s.tagname&&(s.val=w.getValue(s.val)+""+T(s.tagname,r,t)),p.length>0&&p.lastIndexOf("/")===p.length-1){p="/"===x[x.length-1]?x=x.substr(0,x.length-1):p.substr(0,p.length-1);var v=new E(x,s,"");x!==p&&(v.attrsMap=k(p,t)),s.addChild(v)}else{var y=new E(x,s);t.stopNodes.length&&t.stopNodes.includes(y.tagname)&&(y.startIndex=m),x!==p&&(y.attrsMap=k(p,t)),s.addChild(y),s=y}r="",n=m}else r+=e[n]}return i}},function(e,s,t){"use strict";var n=t(3),a=t(1),o=t(1),l=t(0).buildOptions,d=t(5);s.parse=function(e,t,i){if(i){!0===i&&(i={});var s=d.validate(e,i);if(!0!==s)throw Error(s.err.msg)}t=l(t,o.defaultOptions,o.props);var r=a.getTraversalObj(e,t);return n.convertToJson(r,t)},s.convertTonimn=t(6).convert2nimn,s.getTraversalObj=a.getTraversalObj,s.convertToJson=n.convertToJson,s.convertToJsonString=t(7).convertToJsonString,s.validate=d.validate,s.j2xParser=t(8),s.parseToNimn=function(e,t,i){return s.convertTonimn(s.getTraversalObj(e,i),t,i)}},function(e,t,i){"use strict";var d=i(0);t.convertToJson=function e(t,i){var s={};if(!(t.child&&!d.isEmptyObject(t.child)||t.attrsMap&&!d.isEmptyObject(t.attrsMap)))return d.isExist(t.val)?t.val:"";d.isExist(t.val)&&("string"!=typeof t.val||""!==t.val&&t.val!==i.cdataPositionChar)&&("strict"===i.arrayMode?s[i.textNodeName]=[t.val]:s[i.textNodeName]=t.val),d.merge(s,t.attrsMap,i.arrayMode);for(var r=Object.keys(t.child),n=0;n<r.length;n++){var a=r[n];if(t.child[a]&&t.child[a].length>1)for(var o in s[a]=[],t.child[a])s[a].push(e(t.child[a][o],i));else if(!0===i.arrayMode){var l=e(t.child[a][0],i);s[a]="object"==typeof l?[l]:l}else"strict"===i.arrayMode?s[a]=[e(t.child[a][0],i)]:s[a]=e(t.child[a][0],i)}return s}},function(e,t,i){"use strict";e.exports=function(e,t,i){this.tagname=e,this.parent=t,this.child={},this.attrsMap={},this.val=i,this.addChild=function(e){Array.isArray(this.child[e.tagname])?this.child[e.tagname].push(e):this.child[e.tagname]=[e]}}},function(e,t,i){"use strict";var m=i(0),g={allowBooleanAttributes:!1},x=["allowBooleanAttributes"];function b(e,t){for(var i=t;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{var s=e.substr(i,t-i);if(t>5&&"xml"===s)return E("InvalidXml","XML declaration allowed only at the start of the document.",C(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function v(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){var i=1;for(t+=8;t<e.length;t++)if("<"===e[t])i++;else if(">"===e[t]&&0===--i)break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}t.validate=function(e,t){t=m.buildOptions(t,g,x);var i,s=[],r=!1,n=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(var a=0;a<e.length;a++){if("<"!==e[a]){if(" "===e[a]||"\t"===e[a]||"\n"===e[a]||"\r"===e[a])continue;return E("InvalidChar","char '"+e[a]+"' is not expected.",C(e,a))}if("?"===e[++a]){if((a=b(e,++a)).err)return a}else{if("!"===e[a]){a=v(e,a);continue}var o=!1;"/"===e[a]&&(o=!0,a++);for(var l="";a<e.length&&">"!==e[a]&&" "!==e[a]&&"\t"!==e[a]&&"\n"!==e[a]&&"\r"!==e[a];a++)l+=e[a];if("/"===(l=l.trim())[l.length-1]&&(l=l.substring(0,l.length-1),a--),i=l,!m.isName(i)){return E("InvalidTag",0===l.trim().length?"There is an unnecessary space between tag name and backward slash '</ ..'.":"Tag '"+l+"' is an invalid name.",C(e,a))}var d=y(e,a);if(!1===d)return E("InvalidAttr","Attributes for '"+l+"' have open quote.",C(e,a));var c=d.value;if(a=d.index,"/"===c[c.length-1]){var f=w(c=c.substring(0,c.length-1),t);if(!0!==f)return E(f.err.code,f.err.msg,C(e,a-c.length+f.err.line));r=!0}else if(o){if(!d.tagClosed)return E("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",C(e,a));if(c.trim().length>0)return E("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",C(e,a));var u=s.pop();if(l!==u)return E("InvalidTag","Closing tag '"+u+"' is expected inplace of '"+l+"'.",C(e,a));0==s.length&&(n=!0)}else{var h=w(c,t);if(!0!==h)return E(h.err.code,h.err.msg,C(e,a-c.length+h.err.line));if(!0===n)return E("InvalidXml","Multiple possible root nodes found.",C(e,a));s.push(l),r=!0}for(a++;a<e.length;a++){if("<"===e[a]){if("!"===e[a+1]){a=v(e,++a);continue}break}if("&"===e[a]){var p=S(e,a);if(-1==p)return E("InvalidChar","char '&' is not expected.",C(e,a));a=p}}"<"===e[a]&&a--}}return r?!(s.length>0)||E("InvalidXml","Invalid '"+JSON.stringify(s,null,4).replace(/\r?\n/g,"")+"' found.",1):E("InvalidXml","Start tag expected.",1)};function y(e,t){for(var i="",s="",r=!1;t<e.length;t++){if('"'===e[t]||"'"===e[t])if(""===s)s=e[t];else{if(s!==e[t])continue;s=""}else if(">"===e[t]&&""===s){r=!0;break}i+=e[t]}return""===s&&{value:i,index:t,tagClosed:r}}var a=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function w(e,t){for(var i=m.getAllMatches(e,a),s={},r=0;r<i.length;r++){if(0===i[r][1].length)return E("InvalidAttr","Attribute '"+i[r][2]+"' has no space in starting.",l(e,i[r][0]));if(void 0===i[r][3]&&!t.allowBooleanAttributes)return E("InvalidAttr","boolean attribute '"+i[r][2]+"' is not allowed.",l(e,i[r][0]));var n=i[r][2];if(!o(n))return E("InvalidAttr","Attribute '"+n+"' is an invalid name.",l(e,i[r][0]));if(s.hasOwnProperty(n))return E("InvalidAttr","Attribute '"+n+"' is repeated.",l(e,i[r][0]));s[n]=1}return!0}function S(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){var i=/\d/;for("x"===e[t]&&(t++,i=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(i))break}return-1}(e,++t);for(var i=0;t<e.length;t++,i++)if(!(e[t].match(/\w/)&&i<20)){if(";"===e[t])break;return-1}return t}function E(e,t,i){return{err:{code:e,msg:t,line:i}}}function o(e){return m.isName(e)}function C(e,t){return e.substring(0,t).split(/\r?\n/).length}function l(e,t){return e.indexOf(t)+t.length}},function(e,t,i){"use strict";var s=function(e){return String.fromCharCode(e)},x={nilChar:s(176),missingChar:s(201),nilPremitive:s(175),missingPremitive:s(200),emptyChar:s(178),emptyValue:s(177),boundryChar:s(179),objStart:s(198),arrStart:s(204),arrayEnd:s(185)},r=[x.nilChar,x.nilPremitive,x.missingChar,x.missingPremitive,x.boundryChar,x.emptyChar,x.emptyValue,x.arrayEnd,x.objStart,x.arrStart],n=function e(t,i,s){if("string"==typeof i)return t&&t[0]&&void 0!==t[0].val?b(t[0].val,i):b(t,i);var r,n=void 0===(r=t)?x.missingChar:null===r?x.nilChar:!(r.child&&0===Object.keys(r.child).length&&(!r.attrsMap||0===Object.keys(r.attrsMap).length))||x.emptyChar;if(!0===n){var a="";if(Array.isArray(i)){a+=x.arrStart;var o=i[0],l=t.length;if("string"==typeof o)for(var d=0;d<l;d++){var c=b(t[d].val,o);a=v(a,c)}else for(var f=0;f<l;f++){var u=e(t[f],o,s);a=v(a,u)}a+=x.arrayEnd}else{a+=x.objStart;var h=Object.keys(i);for(var p in Array.isArray(t)&&(t=t[0]),h){var m=h[p],g=void 0;g=!s.ignoreAttributes&&t.attrsMap&&t.attrsMap[m]?e(t.attrsMap[m],i[m],s):m===s.textNodeName?e(t.val,i[m],s):e(t.child[m],i[m],s),a=v(a,g)}}return a}return n},b=function(e){switch(e){case void 0:return x.missingPremitive;case null:return x.nilPremitive;case"":return x.emptyValue;default:return e}},v=function(e,t){return a(t[0])||a(e[e.length-1])||(e+=x.boundryChar),e+t},a=function(e){return-1!==r.indexOf(e)};var o=i(1),l=i(0).buildOptions;t.convert2nimn=function(e,t,i){return i=l(i,o.defaultOptions,o.props),n(e,t,i)}},function(e,t,i){"use strict";var c=i(0),s=i(0).buildOptions,r=i(1),n=function e(t,i,s){for(var r,n="{",a=Object.keys(t.child),o=0;o<a.length;o++){var l=a[o];if(t.child[l]&&t.child[l].length>1){for(var d in n+='"'+l+'" : [ ',t.child[l])n+=e(t.child[l][d],i)+" , ";n=n.substr(0,n.length-1)+" ] "}else n+='"'+l+'" : '+e(t.child[l][0],i)+" ,"}return c.merge(n,t.attrsMap),c.isEmptyObject(n)?c.isExist(t.val)?t.val:"":(c.isExist(t.val)&&("string"!=typeof t.val||""!==t.val&&t.val!==i.cdataPositionChar)&&(n+='"'+i.textNodeName+'" : '+(!0!==(r=t.val)&&!1!==r&&isNaN(r)?'"'+r+'"':r)),","===n[n.length-1]&&(n=n.substr(0,n.length-2)),n+"}")};t.convertToJsonString=function(e,t){return(t=s(t,r.defaultOptions,r.props)).indentBy=t.indentBy||"",n(e,t,0)}},function(e,t,i){"use strict";var s=i(0).buildOptions,r={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(e){return e},attrValueProcessor:function(e){return e}},n=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function a(e){this.options=s(e,r,n),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=p),this.options.cdataTagName?this.isCDATA=m:this.isCDATA=function(){return!1},this.replaceCDATAstr=o,this.replaceCDATAarr=l,this.options.format?(this.indentate=h,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=u,this.buildObjNode=c):(this.buildTextNode=f,this.buildObjNode=d),this.buildTextValNode=f,this.buildObjectNode=d}function o(e,t){return e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e?e+"<![CDATA["+t+"]]"+this.tagEndChar:e.replace(this.options.cdataPositionChar,"<![CDATA["+t+"]]"+this.tagEndChar)}function l(e,t){if(e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e)return e+"<![CDATA["+t.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(var i in t)e=e.replace(this.options.cdataPositionChar,"<![CDATA["+t[i]+"]]>");return e+this.newLine}function d(e,t,i,s){return i&&!e.includes("<")?this.indentate(s)+"<"+t+i+">"+e+"</"+t+this.tagEndChar:this.indentate(s)+"<"+t+i+this.tagEndChar+e+this.indentate(s)+"</"+t+this.tagEndChar}function c(e,t,i,s){return""!==e?this.buildObjectNode(e,t,i,s):this.indentate(s)+"<"+t+i+"/"+this.tagEndChar}function f(e,t,i,s){return this.indentate(s)+"<"+t+i+">"+this.options.tagValueProcessor(e)+"</"+t+this.tagEndChar}function u(e,t,i,s){return""!==e?this.buildTextValNode(e,t,i,s):this.indentate(s)+"<"+t+i+"/"+this.tagEndChar}function h(e){return this.options.indentBy.repeat(e)}function p(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}function m(e){return e===this.options.cdataTagName}a.prototype.parse=function(e){return this.j2x(e,0).val},a.prototype.j2x=function(e,t){for(var i="",s="",r=Object.keys(e),n=r.length,a=0;a<n;a++){var o=r[a];if(void 0===e[o]);else if(null===e[o])s+=this.indentate(t)+"<"+o+"/"+this.tagEndChar;else if(e[o]instanceof Date)s+=this.buildTextNode(e[o],o,"",t);else if("object"!=typeof e[o]){var l=this.isAttribute(o);l?i+=" "+l+'="'+this.options.attrValueProcessor(""+e[o])+'"':this.isCDATA(o)?e[this.options.textNodeName]?s+=this.replaceCDATAstr(e[this.options.textNodeName],e[o]):s+=this.replaceCDATAstr("",e[o]):o===this.options.textNodeName?e[this.options.cdataTagName]||(s+=this.options.tagValueProcessor(""+e[o])):s+=this.buildTextNode(e[o],o,"",t)}else if(Array.isArray(e[o]))if(this.isCDATA(o))s+=this.indentate(t),e[this.options.textNodeName]?s+=this.replaceCDATAarr(e[this.options.textNodeName],e[o]):s+=this.replaceCDATAarr("",e[o]);else for(var d=e[o].length,c=0;c<d;c++){var f=e[o][c];if(void 0===f);else if(null===f)s+=this.indentate(t)+"<"+o+"/"+this.tagEndChar;else if("object"==typeof f){var u=this.j2x(f,t+1);s+=this.buildObjNode(u.val,o,u.attrStr,t)}else s+=this.buildTextNode(f,o,"",t)}else if(this.options.attrNodeName&&o===this.options.attrNodeName)for(var h=Object.keys(e[o]),p=h.length,m=0;m<p;m++)i+=" "+h[m]+'="'+this.options.attrValueProcessor(""+e[o][h[m]])+'"';else{var g=this.j2x(e[o],t+1);s+=this.buildObjNode(g.val,o,g.attrStr,t)}}return{attrStr:i,val:s}},e.exports=a}]);var JsonView=function(e){"use strict";function n(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function(e){return typeof e}}else{n=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return n(e)}function a(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=e.key,i=e.size;return'\n    <div class="line">\n      <div class="caret-icon"><i class="sms sm-caret-right"></i></div>\n      <div class="json-key">'.concat(t,'</div>\n      <div class="json-size">').concat(i,"</div>\n    </div>\n  ")}function o(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=e.key,i=e.value,s=e.type;return'\n    <div class="line">\n      <div class="empty-icon"></div>\n      <div class="json-key">'.concat(t,'</div>\n      <div class="json-separator">:</div>\n      <div class="json-value json-').concat(s,'">').concat(i,"</div>\n    </div>\n  ")}function t(e){e.children.forEach(function(e){e.el.classList.add("hide");if(e.isExpanded){t(e)}})}function i(e){e.children.forEach(function(e){e.el.classList.remove("hide");if(e.isExpanded){i(e)}})}function s(e){if(e.children.length>0){var t=e.el.querySelector(".sms");if(t){t.classList.replace("sm-caret-right","sm-caret-down")}}}function r(e){if(e.children.length>0){var t=e.el.querySelector(".sms");if(t){t.classList.replace("sm-caret-down","sm-caret-right")}}}function l(e){if(e.isExpanded){e.isExpanded=false;r(e);t(e)}else{e.isExpanded=true;s(e);i(e)}}function d(){var e=document.createElement("div");e.className="json-container";return e}function c(e){var t=document.createElement("div");var i=function e(t){var i=t.children.length;if(t.type==="array")return"[".concat(i,"]");if(t.type==="object")return"{".concat(i,"}");return null};if(e.children.length>0){t.innerHTML=a({key:e.key,size:i(e)});var s=t.querySelector(".caret-icon");s.addEventListener("click",function(){l(e)})}else{t.innerHTML=o({key:e.key,value:e.value,type:n(e.value)})}var r=t.children[0];if(e.parent!==null){r.classList.add("hide")}r.style="margin-left: "+e.depth*18+"px;";return r}function f(e){var t=n(e);if(Array.isArray(e))t="array";if(e instanceof Date&&!isNaN(e))t="date";if(e===null)t="null";return t}function u(e,t){t(e);if(e.children.length>0){e.children.forEach(function(e){u(e,t)})}}function h(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{key:e.key||null,parent:e.parent||null,value:e.hasOwnProperty("value")?e.value:null,isExpanded:e.isExpanded||false,type:e.type||null,children:e.children||[],el:e.el||null,depth:e.depth||0}}function p(e,t){if(n(e)==="object"&&t.type!=="date"){for(var i in e){var s=h({value:e[i],key:i,depth:t.depth+1,type:f(e[i]),parent:t});t.children.push(s);p(e[i],s)}}}function m(e){var t=typeof e==="string"?JSON.parse(e):e;var i=h({value:t,key:f(t),type:f(t)});p(t,i);return i}function g(e,t){var i=typeof e==="string"?JSON.parse(e):e;var s=m(i);x(s,t);return s}function x(e,t){var i=d();u(e,function(e){e.el=c(e);i.appendChild(e.el)});t.appendChild(i)}function b(e){u(e,function(e){e.el.classList.remove("hide");e.isExpanded=true;s(e)})}function v(t){u(t,function(e){e.isExpanded=false;if(e.depth>t.depth)e.el.classList.add("hide");r(e)})}e.collapseChildren=v;e.createTree=m;e.expandChildren=b;e.render=x;e.renderJSON=g;e.traverseTree=u;return e}({});Ext.Ajax.timeout=3e7;Ext.Msg.minWidth=300;function GetXmlHttpObject(){if(window.XMLHttpRequest){return new XMLHttpRequest}if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}return null}function myContextMenu(e,t,i){if(!Ext.fly(e.getTarget()).hasClass("x-form-textarea")){e.preventDefault();return false}}Ext.Ajax.disableCaching=false;async function start(){let t;try{t=setTimeout(()=>{Ext.get("loading-text").dom.innerHTML="Getting configuration..."},250);await SM.GetUserObject();if(curUser.username!==undefined){clearTimeout(t);loadApp()}else{Ext.get("loading-text").dom.innerHTML=`No account for ${window.oidcProvider.token}`}}catch(e){clearTimeout(t);Ext.get("loading-text").dom.innerHTML=e.message}}async function loadApp(){try{Ext.isReady=true;Ext.BLANK_IMAGE_URL=Ext.isIE6||Ext.isIE7||Ext.isAir?"/ext/resources/images/default/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";Ext.getBody().on("contextmenu",myContextMenu);Ext.QuickTips.init();Ext.apply(Ext.QuickTips.getQuickTip(),{maxWidth:200,minWidth:10,showDelay:500,trackMouse:false});let e=await Ext.Ajax.requestPromise({url:`${STIGMAN.Env.apiBase}/op/configuration`,method:"GET"});appConfig=JSON.parse(e.response.responseText);const n=new SM.AppNavTree({id:"app-nav-tree",cls:"sm-round-panel",margins:{top:10,right:5,bottom:10,left:10},border:false,region:"west"});const a=new SM.MainTabPanel({id:"main-tab-panel",region:"center",margins:{top:5,right:10,bottom:10,left:5},border:false});const t=`ext:qtitle="Commit info" ext:qwidth=200 ext:qtip="branch: ${STIGMAN.Env.commit.branch}&lt;br/&gt;sha: ${STIGMAN.Env.commit.sha}&lt;br/&gt;describe: ${STIGMAN.Env.commit.describe}"`;Ext.QuickTips.register({target:"sm-home-version-sprite",title:"Commit info",text:`branch: ${STIGMAN.Env.commit.branch}&lt;br/&gt;sha: ${STIGMAN.Env.commit.sha}&lt;br/&gt;describe: ${STIGMAN.Env.commit.describe}`,width:200,dismissDelay:0});const o=`<div class='sm-home-title'>
		STIG Manager<span id='sm-home-oss-sprite'>OSS</span><span id='sm-home-version-sprite'>${STIGMAN.Env.version}</span></div>`;const l=new SM.HomeTab({border:false,region:"center",layout:"table",layoutConfig:{tableAttrs:{style:{width:"100%",padding:"20px","table-layout":"fixed"}},columns:3},items:[{html:o,colspan:3,border:false},{xtype:"sm-home-widget-welcome"},{xtype:"sm-home-widget-doc"},{xtype:"sm-home-widget-resources"}]});a.add({layout:"border",border:false,title:"Home",iconCls:"sm-stig-icon",items:[{region:"center",cls:"sm-round-panel",border:false,margins:{top:SM.Margin.top,right:SM.Margin.edge,bottom:SM.Margin.bottom,left:SM.Margin.edge},layout:"fit",items:l}]});let i={id:"app-viewport",layout:"border",items:[]};let s=new Classification(appConfig.classification);let r;if(s.showBanner){r=new Ext.Panel({region:"center",layout:"border",border:false,items:[n,a]});let e=new Ext.XTemplate(`<div class=sm-banner-{classificationCls}>`,`<div class='sm-banner-body-text'>{classificationText}</div>`);let t=new Ext.Panel({region:"north",height:20,border:false,tpl:e,data:{classificationCls:s.classificationCls,classificationText:s.classificationText}});i.items.push(t,r)}else{i.items.push(n,a)}new Ext.Viewport(i);if(r)SM.contentEl=r.getEl();Ext.get("loading").remove();Ext.get("loading-mask").fadeOut({duration:.5,remove:true});Ext.QuickTips.register({target:"sm-home-version-sprite",title:"Commit info",text:`branch: ${STIGMAN.Env.commit.branch}<br/>sha: ${STIGMAN.Env.commit.sha}<br/>describe: ${STIGMAN.Env.commit.describe}`,width:200,dismissDelay:6e4})}catch(e){Ext.get("indicator").dom.innerHTML=e.message}}function showAbout(){alert(copyrightStr+"\n\n"+licenseStr)}start();
